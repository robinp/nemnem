<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE CPP, ForeignFunctionInterface #-}
</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      :  Distribution.Simple.Utils</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright   :  Isaac Jones, Simon Marlow 2003-2004</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--                portions Copyright (c) 2007, Galois Inc.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  :  cabal-devel@haskell.org</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability :  portable</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- A large and somewhat miscellaneous collection of utility functions used</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- throughout the rest of the Cabal lib and in other tools that use the Cabal</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- lib like @cabal-install@. It has a very simple set of logging actions. It</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- has low level functions for running programs, a bunch of wrappers for</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- various directory and file functions that do extra logging.</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">{- All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are
met:

    * Redistributions of source code must retain the above copyright
      notice, this list of conditions and the following disclaimer.

    * Redistributions in binary form must reproduce the above
      copyright notice, this list of conditions and the following
      disclaimer in the documentation and/or other materials provided
      with the distribution.

    * Neither the name of Isaac Jones nor the names of other
      contributors may be used to endorse or promote products derived
      from this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
&quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE. -}</span></span><span class="mpre">

module Distribution.Simple.Utils (
        cabalVersion,

        </span><span class="hl_comment"><span class="mpre">-- * logging and errors</span></span><span class="mpre">
        die,
        dieWithLocation,
        topHandler, topHandlerWith,
        warn, notice, setupMessage, info, debug,
        debugNoWrap, chattyTry,

        </span><span class="hl_comment"><span class="mpre">-- * running programs</span></span><span class="mpre">
        rawSystemExit,
        rawSystemExitCode,
        rawSystemExitWithEnv,
        rawSystemStdout,
        rawSystemStdInOut,
        rawSystemIOWithEnv,
        maybeExit,
        xargs,
        findProgramLocation,
        findProgramVersion,

        </span><span class="hl_comment"><span class="mpre">-- * copying files</span></span><span class="mpre">
        smartCopySources,
        createDirectoryIfMissingVerbose,
        copyFileVerbose,
        copyDirectoryRecursiveVerbose,
        copyFiles,
        copyFileTo,

        </span><span class="hl_comment"><span class="mpre">-- * installing files</span></span><span class="mpre">
        installOrdinaryFile,
        installExecutableFile,
        installMaybeExecutableFile,
        installOrdinaryFiles,
        installExecutableFiles,
        installMaybeExecutableFiles,
        installDirectoryContents,

        </span><span class="hl_comment"><span class="mpre">-- * File permissions</span></span><span class="mpre">
        setFileOrdinary,
        setFileExecutable,

        </span><span class="hl_comment"><span class="mpre">-- * file names</span></span><span class="mpre">
        currentDir,

        </span><span class="hl_comment"><span class="mpre">-- * finding files</span></span><span class="mpre">
        findFile,
        findFirstFile,
        findFileWithExtension,
        findFileWithExtension&#39;,
        findModuleFile,
        findModuleFiles,
        getDirectoryContentsRecursive,

        </span><span class="hl_comment"><span class="mpre">-- * environment variables</span></span><span class="mpre">
        isInSearchPath,

        </span><span class="hl_comment"><span class="mpre">-- * simple file globbing</span></span><span class="mpre">
        matchFileGlob,
        matchDirFileGlob,
        parseFileGlob,
        FileGlob(..),

        </span><span class="hl_comment"><span class="mpre">-- * modification time</span></span><span class="mpre">
        moreRecentFile,

        </span><span class="hl_comment"><span class="mpre">-- * temp files and dirs</span></span><span class="mpre">
        TempFileOptions(..), defaultTempFileOptions,
        withTempFile, withTempFileEx,
        withTempDirectory, withTempDirectoryEx,

        </span><span class="hl_comment"><span class="mpre">-- * .cabal and .buildinfo files</span></span><span class="mpre">
        defaultPackageDesc,
        findPackageDesc,
        defaultHookedPackageDesc,
        findHookedPackageDesc,

        </span><span class="hl_comment"><span class="mpre">-- * reading and writing files safely</span></span><span class="mpre">
        withFileContents,
        writeFileAtomic,
        rewriteFile,

        </span><span class="hl_comment"><span class="mpre">-- * Unicode</span></span><span class="mpre">
        fromUTF8,
        toUTF8,
        readUTF8File,
        withUTF8FileContents,
        writeUTF8File,
        normaliseLineEndings,

        </span><span class="hl_comment"><span class="mpre">-- * generic utils</span></span><span class="mpre">
        equating,
        comparing,
        isInfixOf,
        intercalate,
        lowercase,
        wrapText,
        wrapLine,
  ) where

import Control.Monad
    ( </span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="mpre">when</span></a><span class="mpre">, </span><a href="Control.Monad.html#loc_270_1_270_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_270_1_270_7&#39;)"><span class="mpre">unless</span></a><span class="mpre">, </span><a href="Control.Monad.html#loc_154_1_154_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_154_1_154_8&#39;)"><span class="mpre">filterM</span></a><span class="mpre"> )
import Control.Concurrent.MVar
    ( </span><a href="GHC.MVar.html#loc_64_1_64_13" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.MVar.html#loc_64_1_64_13&#39;)"><span class="mpre">newEmptyMVar</span></a><span class="mpre">, </span><a href="GHC.MVar.html#loc_133_1_133_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.MVar.html#loc_133_1_133_8&#39;)"><span class="mpre">putMVar</span></a><span class="mpre">, </span><a href="GHC.MVar.html#loc_91_1_91_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.MVar.html#loc_91_1_91_9&#39;)"><span class="mpre">takeMVar</span></a><span class="mpre"> )
import Data.List
  ( </span><a href="Data.List.html#loc_314_1_314_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_314_1_314_4&#39;)"><span class="mpre">nub</span></a><span class="mpre">, </span><a href="Data.List.html#loc_984_1_984_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_984_1_984_8&#39;)"><span class="mpre">unfoldr</span></a><span class="mpre">, </span><a href="Data.List.html#loc_286_1_286_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_286_1_286_11&#39;)"><span class="mpre">isPrefixOf</span></a><span class="mpre">, </span><a href="Data.List.html#loc_763_1_763_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_763_1_763_6&#39;)"><span class="mpre">tails</span></a><span class="mpre">, </span><a href="Data.List.html#loc_443_1_443_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_443_1_443_12&#39;)"><span class="mpre">intercalate</span></a><span class="mpre"> )
import Data.Char as Char
    ( </span><a href="GHC.Unicode.html#loc_143_1_143_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_143_1_143_8&#39;)"><span class="mpre">toLower</span></a><span class="mpre">, </span><a href="GHC.Char.html#loc_11_1_11_4" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Char.html#loc_11_1_11_4&#39;)"><span class="mpre">chr</span></a><span class="mpre">, ord )
import Data.Bits
    ( </span><a href="Data.Bits.html#loc_79_15_79_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_79_15_79_19&#39;)"><span class="mpre">Bits</span></a><span class="mpre">((.|.), (.&amp;.), </span><a href="Data.Bits.html#loc_200_5_200_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_200_5_200_11&#39;)"><span class="mpre">shiftL</span></a><span class="mpre">, </span><a href="Data.Bits.html#loc_226_5_226_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_226_5_226_11&#39;)"><span class="mpre">shiftR</span></a><span class="mpre">) )
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Simple/Utils.hs&quot;, srcSpanStartLine = 158, srcSpanStartColumn = 18, srcSpanEndLine = 158, srcSpanEndColumn = 38}, srcInfoPoints = []}) &quot;Data.ByteString.Lazy&quot;"><span class="mpre">Data.ByteString.Lazy</span></span><span class="mpre"> as BS
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Simple/Utils.hs&quot;, srcSpanStartLine = 159, srcSpanStartColumn = 18, srcSpanEndLine = 159, srcSpanEndColumn = 44}, srcInfoPoints = []}) &quot;Data.ByteString.Lazy.Char8&quot;"><span class="mpre">Data.ByteString.Lazy.Char8</span></span><span class="mpre"> as BS.Char8

import System.Directory
    ( </span><a href="System.Directory.html#loc_134_6_134_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Directory.html#loc_134_6_134_17&#39;)"><span class="mpre">Permissions</span></a><span class="mpre">(</span><a href="System.Directory.html#loc_137_5_137_15" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Directory.html#loc_137_5_137_15&#39;)"><span class="mpre">executable</span></a><span class="mpre">), </span><a href="System.Directory.html#loc_628_1_628_21" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Directory.html#loc_628_1_628_21&#39;)"><span class="mpre">getDirectoryContents</span></a><span class="mpre">, </span><a href="System.Directory.html#loc_153_1_153_15" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Directory.html#loc_153_1_153_15&#39;)"><span class="mpre">getPermissions</span></a><span class="mpre">
    , </span><a href="System.Directory.html#loc_717_1_717_19" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Directory.html#loc_717_1_717_19&#39;)"><span class="mpre">doesDirectoryExist</span></a><span class="mpre">, </span><a href="System.Directory.html#loc_726_1_726_14" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Directory.html#loc_726_1_726_14&#39;)"><span class="mpre">doesFileExist</span></a><span class="mpre">, </span><a href="System.Directory.html#loc_400_1_400_11" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Directory.html#loc_400_1_400_11&#39;)"><span class="mpre">removeFile</span></a><span class="mpre">, </span><a href="System.Directory.html#loc_592_1_592_15" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Directory.html#loc_592_1_592_15&#39;)"><span class="mpre">findExecutable</span></a><span class="mpre">
    , </span><a href="System.Directory.html#loc_743_1_743_20" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Directory.html#loc_743_1_743_20&#39;)"><span class="mpre">getModificationTime</span></a><span class="mpre"> )
import System.Environment
    ( getProgName )
import System.Exit
    ( </span><a href="System.Exit.html#loc_60_1_60_9" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Exit.html#loc_60_1_60_9&#39;)"><span class="mpre">exitWith</span></a><span class="mpre">, </span><a href="GHC.IO.Exception.html#loc_205_6_205_14" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Exception.html#loc_205_6_205_14&#39;)"><span class="mpre">ExitCode</span></a><span class="mpre">(..) )
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Simple/Utils.hs&quot;, srcSpanStartLine = 169, srcSpanStartColumn = 8, srcSpanEndLine = 169, srcSpanEndColumn = 23}, srcInfoPoints = []}) &quot;System.FilePath&quot;"><span class="mpre">System.FilePath</span></span><span class="mpre">
    ( normalise, (&lt;/&gt;), (&lt;.&gt;)
    , getSearchPath, takeDirectory, splitFileName
    , splitExtension, splitExtensions, splitDirectories )
import System.Directory
    ( </span><a href="System.Directory.html#loc_258_1_258_16" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Directory.html#loc_258_1_258_16&#39;)"><span class="mpre">createDirectory</span></a><span class="mpre">, </span><a href="System.Directory.html#loc_510_1_510_11" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Directory.html#loc_510_1_510_11&#39;)"><span class="mpre">renameFile</span></a><span class="mpre">, </span><a href="System.Directory.html#loc_351_1_351_25" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Directory.html#loc_351_1_351_25&#39;)"><span class="mpre">removeDirectoryRecursive</span></a><span class="mpre"> )
import System.IO
    ( </span><a href="GHC.IO.Handle.Types.html#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Types.html#loc_100_6_100_12&#39;)"><span class="mpre">Handle</span></a><span class="mpre">, </span><a href="GHC.IO.Handle.FD.html#loc_150_1_150_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.FD.html#loc_150_1_150_9&#39;)"><span class="mpre">openFile</span></a><span class="mpre">, </span><a href="GHC.IO.Handle.FD.html#loc_177_1_177_15" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.FD.html#loc_177_1_177_15&#39;)"><span class="mpre">openBinaryFile</span></a><span class="mpre">, </span><a href="System.IO.html#loc_450_1_450_19" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.html#loc_450_1_450_19&#39;)"><span class="mpre">openBinaryTempFile</span></a><span class="mpre">
    , </span><a href="GHC.IO.IOMode.html#loc_28_6_28_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.IOMode.html#loc_28_6_28_12&#39;)"><span class="mpre">IOMode</span></a><span class="mpre">(</span><a href="GHC.IO.IOMode.html#loc_28_21_28_29" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.IOMode.html#loc_28_21_28_29&#39;)"><span class="mpre">ReadMode</span></a><span class="mpre">), </span><a href="GHC.IO.Handle.html#loc_559_1_559_15" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.html#loc_559_1_559_15&#39;)"><span class="mpre">hSetBinaryMode</span></a><span class="mpre">
    , </span><a href="GHC.IO.Handle.Text.html#loc_379_1_379_13" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Text.html#loc_379_1_379_13&#39;)"><span class="mpre">hGetContents</span></a><span class="mpre">, </span><a href="GHC.IO.Handle.FD.html#loc_52_1_52_6" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.FD.html#loc_52_1_52_6&#39;)"><span class="mpre">stdin</span></a><span class="mpre">, </span><a href="GHC.IO.Handle.FD.html#loc_74_1_74_7" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.FD.html#loc_74_1_74_7&#39;)"><span class="mpre">stderr</span></a><span class="mpre">, </span><a href="GHC.IO.Handle.FD.html#loc_63_1_63_7" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.FD.html#loc_63_1_63_7&#39;)"><span class="mpre">stdout</span></a><span class="mpre">, </span><a href="GHC.IO.Handle.Text.html#loc_529_1_529_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Text.html#loc_529_1_529_8&#39;)"><span class="mpre">hPutStr</span></a><span class="mpre">, </span><a href="GHC.IO.Handle.html#loc_293_1_293_7" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.html#loc_293_1_293_7&#39;)"><span class="mpre">hFlush</span></a><span class="mpre">, </span><a href="GHC.IO.Handle.html#loc_86_1_86_7" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.html#loc_86_1_86_7&#39;)"><span class="mpre">hClose</span></a><span class="mpre"> )
import System.IO.Error as IO.Error
    ( </span><a href="System.IO.Error.html#loc_135_1_135_20" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Error.html#loc_135_1_135_20&#39;)"><span class="mpre">isDoesNotExistError</span></a><span class="mpre">, </span><a href="System.IO.Error.html#loc_130_1_130_21" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Error.html#loc_130_1_130_21&#39;)"><span class="mpre">isAlreadyExistsError</span></a><span class="mpre">
    , </span><a href="System.IO.Error.html#loc_292_1_292_15" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Error.html#loc_292_1_292_15&#39;)"><span class="mpre">ioeSetFileName</span></a><span class="mpre">, </span><a href="System.IO.Error.html#loc_280_1_280_15" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Error.html#loc_280_1_280_15&#39;)"><span class="mpre">ioeGetFileName</span></a><span class="mpre">, </span><a href="System.IO.Error.html#loc_272_1_272_18" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Error.html#loc_272_1_272_18&#39;)"><span class="mpre">ioeGetErrorString</span></a><span class="mpre"> )
import System.IO.Error
    ( </span><a href="System.IO.Error.html#loc_290_1_290_15" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Error.html#loc_290_1_290_15&#39;)"><span class="mpre">ioeSetLocation</span></a><span class="mpre">, </span><a href="System.IO.Error.html#loc_276_1_276_15" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Error.html#loc_276_1_276_15&#39;)"><span class="mpre">ioeGetLocation</span></a><span class="mpre"> )
import System.IO.Unsafe
    ( </span><a href="GHC.IO.html#loc_213_1_213_19" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_213_1_213_19&#39;)"><span class="mpre">unsafeInterleaveIO</span></a><span class="mpre"> )
import qualified Control.Exception as Exception

import Distribution.Text
    ( </span><a href="Distribution.Text.html#loc_31_1_31_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Text.html#loc_31_1_31_8&#39;)"><span class="mpre">display</span></a><span class="mpre">, </span><a href="Distribution.Text.html#loc_39_1_39_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Text.html#loc_39_1_39_12&#39;)"><span class="mpre">simpleParse</span></a><span class="mpre"> )
import Distribution.Package
    ( </span><a href="Distribution.Package.html#loc_102_6_102_23" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Package.html#loc_102_6_102_23&#39;)"><span class="mpre">PackageIdentifier</span></a><span class="mpre"> )
import Distribution.ModuleName (</span><a href="Distribution.ModuleName.html#loc_67_9_67_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.ModuleName.html#loc_67_9_67_19&#39;)"><span class="mpre">ModuleName</span></a><span class="mpre">)
import qualified Distribution.ModuleName as ModuleName
import Distribution.Version
    (</span><a href="Data.Version.html#loc_68_6_68_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Version.html#loc_68_6_68_13&#39;)"><span class="mpre">Version</span></a><span class="mpre">(..))

import Control.Exception (</span><a href="GHC.IO.Exception.html#loc_238_6_238_17" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Exception.html#loc_238_6_238_17&#39;)"><span class="mpre">IOException</span></a><span class="mpre">, </span><a href="GHC.IO.html#loc_480_1_480_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_480_1_480_9&#39;)"><span class="mpre">evaluate</span></a><span class="mpre">, </span><a href="GHC.IO.html#loc_304_1_304_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_304_1_304_8&#39;)"><span class="mpre">throwIO</span></a><span class="mpre">)
import System.Process (</span><a href="System.Process.html#loc_900_1_900_10" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Process.html#loc_900_1_900_10&#39;)"><span class="mpre">rawSystem</span></a><span class="mpre">)
import qualified System.Process as Process (CreateProcess(..))

import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Simple/Utils.hs&quot;, srcSpanStartLine = 201, srcSpanStartColumn = 8, srcSpanEndLine = 201, srcSpanEndColumn = 26}, srcInfoPoints = []}) &quot;Control.Concurrent&quot;"><span class="mpre">Control.Concurrent</span></span><span class="mpre"> (forkIO)
import System.Process (</span><a href="System.Process.html#loc_833_1_833_22" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Process.html#loc_833_1_833_22&#39;)"><span class="mpre">runInteractiveProcess</span></a><span class="mpre">, </span><a href="System.Process.html#loc_575_1_575_15" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Process.html#loc_575_1_575_15&#39;)"><span class="mpre">waitForProcess</span></a><span class="mpre">, </span><a href="System.Process.html#loc_145_1_145_5" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Process.html#loc_145_1_145_5&#39;)"><span class="mpre">proc</span></a><span class="mpre">,
                       StdStream(..))
#if __GLASGOW_HASKELL__ &gt;= 702
import System.Process (</span><a href="System.Process.html#loc_552_1_552_19" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Process.html#loc_552_1_552_19&#39;)"><span class="mpre">showCommandForUser</span></a><span class="mpre">)
#endif

#ifndef mingw32_HOST_OS
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Simple/Utils.hs&quot;, srcSpanStartLine = 209, srcSpanStartColumn = 8, srcSpanEndLine = 209, srcSpanEndColumn = 28}, srcInfoPoints = []}) &quot;System.Posix.Signals&quot;"><span class="mpre">System.Posix.Signals</span></span><span class="mpre"> (installHandler, sigINT, sigQUIT, Handler(..))
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Simple/Utils.hs&quot;, srcSpanStartLine = 210, srcSpanStartColumn = 8, srcSpanEndLine = 210, srcSpanEndColumn = 32}, srcInfoPoints = []}) &quot;System.Process.Internals&quot;"><span class="mpre">System.Process.Internals</span></span><span class="mpre"> (defaultSignal, runGenProcess_)
#else
import System.Process (</span><a href="System.Process.html#loc_211_1_211_14" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Process.html#loc_211_1_211_14&#39;)"><span class="mpre">createProcess</span></a><span class="mpre">)
#endif

import Distribution.Compat.CopyFile
         ( </span><a href="Distribution.Compat.CopyFile.html#loc_63_1_63_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Compat.CopyFile.html#loc_63_1_63_9&#39;)"><span class="mpre">copyFile</span></a><span class="mpre">, </span><a href="Distribution.Compat.CopyFile.html#loc_43_1_43_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Compat.CopyFile.html#loc_43_1_43_17&#39;)"><span class="mpre">copyOrdinaryFile</span></a><span class="mpre">, </span><a href="Distribution.Compat.CopyFile.html#loc_44_1_44_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Compat.CopyFile.html#loc_44_1_44_19&#39;)"><span class="mpre">copyExecutableFile</span></a><span class="mpre">
         , </span><a href="Distribution.Compat.CopyFile.html#loc_48_1_48_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Compat.CopyFile.html#loc_48_1_48_16&#39;)"><span class="mpre">setFileOrdinary</span></a><span class="mpre">, </span><a href="Distribution.Compat.CopyFile.html#loc_49_1_49_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Compat.CopyFile.html#loc_49_1_49_18&#39;)"><span class="mpre">setFileExecutable</span></a><span class="mpre">, </span><a href="Distribution.Compat.CopyFile.html#loc_60_1_60_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Compat.CopyFile.html#loc_60_1_60_15&#39;)"><span class="mpre">setDirOrdinary</span></a><span class="mpre"> )
import Distribution.Compat.TempFile
         ( openTempFile, </span><a href="Distribution.Compat.TempFile.html#loc_110_1_110_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Compat.TempFile.html#loc_110_1_110_20&#39;)"><span class="mpre">createTempDirectory</span></a><span class="mpre"> )
import Distribution.Compat.Exception
         ( </span><a href="Distribution.Compat.Exception.html#loc_11_1_11_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Compat.Exception.html#loc_11_1_11_6&#39;)"><span class="mpre">tryIO</span></a><span class="mpre">, </span><a href="Distribution.Compat.Exception.html#loc_14_1_14_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Compat.Exception.html#loc_14_1_14_8&#39;)"><span class="mpre">catchIO</span></a><span class="mpre">, </span><a href="Distribution.Compat.Exception.html#loc_17_1_17_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Compat.Exception.html#loc_17_1_17_10&#39;)"><span class="mpre">catchExit</span></a><span class="mpre"> )
import Distribution.Verbosity

#ifdef VERSION_base
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Simple/Utils.hs&quot;, srcSpanStartLine = 225, srcSpanStartColumn = 18, srcSpanEndLine = 225, srcSpanEndColumn = 29}, srcInfoPoints = []}) &quot;Paths_Cabal&quot;"><span class="mpre">Paths_Cabal</span></span><span class="mpre"> (version)
#endif

</span><span class="hl_comment"><span class="mpre">-- We only get our own version number when we&#39;re building with ourselves</span></span><span class="mpre">
</span><a href="#loc_231_1_231_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_1_231_13&#39;)"><span class="mpre">cabalVersion</span></a><span class="mpre"> :: </span><a href="Data.Version.html#loc_68_6_68_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Version.html#loc_68_6_68_13&#39;)"><span class="hl_tyconref"><span class="mpre">Version</span></span></a><span class="mpre">
#if defined(VERSION_base)
</span><a name="loc_231_1_231_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_1_231_13&#39;)"><span class="hl_vardecl"><span class="mpre">cabalVersion</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">Paths_Cabal.version</span></span><span class="mpre">
#elif defined(CABAL_VERSION)
</span><span class="hl_vardecl"><span class="mpre">cabalVersion</span></span><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Version</span></span><span class="mpre"> [</span><span class="hl_conref"><span class="mpre">CABAL_VERSION</span></span><span class="mpre">] []
#else
</span><span class="hl_vardecl"><span class="mpre">cabalVersion</span></span><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Version</span></span><span class="mpre"> [</span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">9999</span></span><span class="mpre">] []  </span><span class="hl_comment"><span class="mpre">--used when bootstrapping</span></span><span class="mpre">
#endif

</span><span class="hl_comment"><span class="mpre">-- ----------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Exception and logging utils</span></span><span class="mpre">

</span><a href="#loc_242_1_242_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_1_242_16&#39;)"><span class="mpre">dieWithLocation</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_242_1_242_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_1_242_16&#39;)"><span class="hl_fundecl"><span class="mpre">dieWithLocation</span></span></a><span class="mpre"> </span><a name="loc_242_17_242_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_17_242_25&#39;)"><span class="hl_vardecl"><span class="mpre">filename</span></span></a><span class="mpre"> </span><a name="loc_242_26_242_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_26_242_32&#39;)"><span class="hl_vardecl"><span class="mpre">lineno</span></span></a><span class="mpre"> </span><a name="loc_242_33_242_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_33_242_36&#39;)"><span class="hl_vardecl"><span class="mpre">msg</span></span></a><span class="mpre"> =
  </span><span class="hl_varref"><span class="mpre">ioError</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_247_5_247_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_247_5_247_16&#39;)"><span class="hl_varref"><span class="mpre">setLocation</span></span></a><span class="mpre"> </span><a href="#loc_242_26_242_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_26_242_32&#39;)"><span class="hl_varref"><span class="mpre">lineno</span></span></a><span class="mpre">
          </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">flip</span></span><span class="mpre"> </span><a href="System.IO.Error.html#loc_292_1_292_15" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Error.html#loc_292_1_292_15&#39;)"><span class="hl_varref"><span class="mpre">ioeSetFileName</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">normalise</span></span><span class="mpre"> </span><a href="#loc_242_17_242_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_17_242_25&#39;)"><span class="hl_varref"><span class="mpre">filename</span></span></a><span class="mpre">)
          </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">userError</span></span><span class="mpre"> </span><a href="#loc_242_33_242_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_33_242_36&#39;)"><span class="hl_varref"><span class="mpre">msg</span></span></a><span class="mpre">
  where
    </span><a name="loc_247_5_247_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_247_5_247_16&#39;)"><span class="hl_fundecl"><span class="mpre">setLocation</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">  </span><a name="loc_247_26_247_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_247_26_247_29&#39;)"><span class="hl_vardecl"><span class="mpre">err</span></span></a><span class="mpre"> = </span><a href="#loc_247_26_247_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_247_26_247_29&#39;)"><span class="hl_varref"><span class="mpre">err</span></span></a><span class="mpre">
    </span><a href="#loc_247_5_247_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_247_5_247_16&#39;)"><span class="hl_fundecl"><span class="mpre">setLocation</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_248_23_248_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_23_248_24&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre">) </span><a name="loc_248_26_248_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_26_248_29&#39;)"><span class="hl_vardecl"><span class="mpre">err</span></span></a><span class="mpre"> = </span><a href="System.IO.Error.html#loc_290_1_290_15" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Error.html#loc_290_1_290_15&#39;)"><span class="hl_varref"><span class="mpre">ioeSetLocation</span></span></a><span class="mpre"> </span><a href="#loc_248_26_248_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_26_248_29&#39;)"><span class="hl_varref"><span class="mpre">err</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_248_23_248_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_23_248_24&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">)

</span><a href="#loc_251_1_251_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_251_1_251_4&#39;)"><span class="mpre">die</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_251_1_251_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_251_1_251_4&#39;)"><span class="hl_fundecl"><span class="mpre">die</span></span></a><span class="mpre"> </span><a name="loc_251_5_251_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_251_5_251_8&#39;)"><span class="hl_vardecl"><span class="mpre">msg</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">ioError</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">userError</span></span><span class="mpre"> </span><a href="#loc_251_5_251_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_251_5_251_8&#39;)"><span class="hl_varref"><span class="mpre">msg</span></span></a><span class="mpre">)

</span><a href="#loc_254_1_254_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_1_254_15&#39;)"><span class="mpre">topHandlerWith</span></a><span class="mpre"> :: (</span><a href="GHC.IO.Exception.html#loc_238_6_238_17" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Exception.html#loc_238_6_238_17&#39;)"><span class="hl_tyconref"><span class="mpre">Exception.IOException</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_254_1_254_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_1_254_15&#39;)"><span class="hl_fundecl"><span class="mpre">topHandlerWith</span></span></a><span class="mpre"> </span><a name="loc_254_16_254_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_16_254_20&#39;)"><span class="hl_vardecl"><span class="mpre">cont</span></span></a><span class="mpre"> </span><a name="loc_254_21_254_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_21_254_25&#39;)"><span class="hl_vardecl"><span class="mpre">prog</span></span></a><span class="mpre"> = </span><a href="Distribution.Compat.Exception.html#loc_14_1_14_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Compat.Exception.html#loc_14_1_14_8&#39;)"><span class="hl_varref"><span class="mpre">catchIO</span></span></a><span class="mpre"> </span><a href="#loc_254_21_254_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_21_254_25&#39;)"><span class="hl_varref"><span class="mpre">prog</span></span></a><span class="mpre"> </span><a href="#loc_256_5_256_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_256_5_256_11&#39;)"><span class="hl_varref"><span class="mpre">handle</span></span></a><span class="mpre">
  where
    </span><a name="loc_256_5_256_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_256_5_256_11&#39;)"><span class="hl_fundecl"><span class="mpre">handle</span></span></a><span class="mpre"> </span><a name="loc_256_12_256_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_256_12_256_15&#39;)"><span class="hl_vardecl"><span class="mpre">ioe</span></span></a><span class="mpre"> = do
      </span><a href="GHC.IO.Handle.html#loc_293_1_293_7" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.html#loc_293_1_293_7&#39;)"><span class="hl_varref"><span class="mpre">hFlush</span></span></a><span class="mpre"> </span><a href="GHC.IO.Handle.FD.html#loc_63_1_63_7" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.FD.html#loc_63_1_63_7&#39;)"><span class="hl_varref"><span class="mpre">stdout</span></span></a><span class="mpre">
      </span><a name="loc_258_7_258_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_258_7_258_12&#39;)"><span class="hl_vardecl"><span class="mpre">pname</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">getProgName</span></span><span class="mpre">
      </span><a href="GHC.IO.Handle.Text.html#loc_529_1_529_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Text.html#loc_529_1_529_8&#39;)"><span class="hl_varref"><span class="mpre">hPutStr</span></span></a><span class="mpre"> </span><a href="GHC.IO.Handle.FD.html#loc_74_1_74_7" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.FD.html#loc_74_1_74_7&#39;)"><span class="hl_varref"><span class="mpre">stderr</span></span></a><span class="mpre"> (</span><a href="#loc_262_9_262_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_9_262_15&#39;)"><span class="hl_varref"><span class="mpre">mesage</span></span></a><span class="mpre"> </span><a href="#loc_258_7_258_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_258_7_258_12&#39;)"><span class="hl_varref"><span class="mpre">pname</span></span></a><span class="mpre">)
      </span><a href="#loc_254_16_254_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_16_254_20&#39;)"><span class="hl_varref"><span class="mpre">cont</span></span></a><span class="mpre"> </span><a href="#loc_256_12_256_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_256_12_256_15&#39;)"><span class="hl_varref"><span class="mpre">ioe</span></span></a><span class="mpre">
      where
        </span><a name="loc_262_9_262_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_9_262_15&#39;)"><span class="hl_fundecl"><span class="mpre">mesage</span></span></a><span class="mpre"> </span><a name="loc_262_16_262_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_16_262_21&#39;)"><span class="hl_vardecl"><span class="mpre">pname</span></span></a><span class="mpre"> = </span><a href="#loc_341_1_341_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_341_1_341_9&#39;)"><span class="hl_varref"><span class="mpre">wrapText</span></span></a><span class="mpre"> (</span><a href="#loc_262_16_262_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_16_262_21&#39;)"><span class="hl_varref"><span class="mpre">pname</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_263_9_263_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_263_9_263_13&#39;)"><span class="hl_varref"><span class="mpre">file</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_269_9_269_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_269_9_269_15&#39;)"><span class="hl_varref"><span class="mpre">detail</span></span></a><span class="mpre">)
        </span><a name="loc_263_9_263_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_263_9_263_13&#39;)"><span class="hl_vardecl"><span class="mpre">file</span></span></a><span class="mpre">         = case </span><a href="System.IO.Error.html#loc_280_1_280_15" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Error.html#loc_280_1_280_15&#39;)"><span class="hl_varref"><span class="mpre">ioeGetFileName</span></span></a><span class="mpre"> </span><a href="#loc_256_12_256_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_256_12_256_15&#39;)"><span class="hl_varref"><span class="mpre">ioe</span></span></a><span class="mpre"> of
                         </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">   -&gt; </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">
                         </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_265_31_265_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_265_31_265_35&#39;)"><span class="hl_vardecl"><span class="mpre">path</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_265_31_265_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_265_31_265_35&#39;)"><span class="hl_varref"><span class="mpre">path</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_266_9_266_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_266_9_266_17&#39;)"><span class="hl_varref"><span class="mpre">location</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;: &quot;</span></span><span class="mpre">
        </span><a name="loc_266_9_266_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_266_9_266_17&#39;)"><span class="hl_vardecl"><span class="mpre">location</span></span></a><span class="mpre">     = case </span><a href="System.IO.Error.html#loc_276_1_276_15" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Error.html#loc_276_1_276_15&#39;)"><span class="hl_varref"><span class="mpre">ioeGetLocation</span></span></a><span class="mpre"> </span><a href="#loc_256_12_256_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_256_12_256_15&#39;)"><span class="hl_varref"><span class="mpre">ioe</span></span></a><span class="mpre"> of
                         </span><a name="loc_267_26_267_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_26_267_27&#39;)"><span class="hl_specname"><span class="mpre">l</span></span></a><span class="mpre">@(</span><a name="loc_267_29_267_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_29_267_30&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_) | </span><a href="#loc_267_29_267_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_29_267_30&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;0&#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_267_29_267_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_29_267_30&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;9&#39;</span></span><span class="mpre"> -&gt; </span><span class="hl_char"><span class="mpre">&#39;:&#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_267_26_267_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_26_267_27&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">
                         _                              -&gt; </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">
        </span><a name="loc_269_9_269_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_269_9_269_15&#39;)"><span class="hl_vardecl"><span class="mpre">detail</span></span></a><span class="mpre">       = </span><a href="System.IO.Error.html#loc_272_1_272_18" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Error.html#loc_272_1_272_18&#39;)"><span class="hl_varref"><span class="mpre">ioeGetErrorString</span></span></a><span class="mpre"> </span><a href="#loc_256_12_256_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_256_12_256_15&#39;)"><span class="hl_varref"><span class="mpre">ioe</span></span></a><span class="mpre">

</span><a href="#loc_272_1_272_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_272_1_272_11&#39;)"><span class="mpre">topHandler</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_272_1_272_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_272_1_272_11&#39;)"><span class="hl_fundecl"><span class="mpre">topHandler</span></span></a><span class="mpre"> </span><a name="loc_272_12_272_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_272_12_272_16&#39;)"><span class="hl_vardecl"><span class="mpre">prog</span></span></a><span class="mpre"> = </span><a href="#loc_254_1_254_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_1_254_15&#39;)"><span class="hl_varref"><span class="mpre">topHandlerWith</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">const</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="System.Exit.html#loc_60_1_60_9" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Exit.html#loc_60_1_60_9&#39;)"><span class="hl_varref"><span class="mpre">exitWith</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">ExitFailure</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)) </span><a href="#loc_272_12_272_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_272_12_272_16&#39;)"><span class="hl_varref"><span class="mpre">prog</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Non fatal conditions that may be indicative of an error or problem.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- We display these at the &#39;normal&#39; verbosity level.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_279_1_279_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_279_1_279_5&#39;)"><span class="mpre">warn</span></a><span class="mpre"> :: </span><a href="Distribution.Verbosity.html#loc_58_6_58_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Verbosity.html#loc_58_6_58_15&#39;)"><span class="hl_tyconref"><span class="mpre">Verbosity</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_279_1_279_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_279_1_279_5&#39;)"><span class="hl_fundecl"><span class="mpre">warn</span></span></a><span class="mpre"> </span><a name="loc_279_6_279_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_279_6_279_15&#39;)"><span class="hl_vardecl"><span class="mpre">verbosity</span></span></a><span class="mpre"> </span><a name="loc_279_16_279_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_279_16_279_19&#39;)"><span class="hl_vardecl"><span class="mpre">msg</span></span></a><span class="mpre"> =
  </span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="hl_varref"><span class="mpre">when</span></span></a><span class="mpre"> (</span><a href="#loc_279_6_279_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_279_6_279_15&#39;)"><span class="hl_varref"><span class="mpre">verbosity</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><a href="Distribution.Verbosity.html#loc_67_1_67_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Verbosity.html#loc_67_1_67_7&#39;)"><span class="hl_varref"><span class="mpre">normal</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
    </span><a href="GHC.IO.Handle.html#loc_293_1_293_7" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.html#loc_293_1_293_7&#39;)"><span class="hl_varref"><span class="mpre">hFlush</span></span></a><span class="mpre"> </span><a href="GHC.IO.Handle.FD.html#loc_63_1_63_7" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.FD.html#loc_63_1_63_7&#39;)"><span class="hl_varref"><span class="mpre">stdout</span></span></a><span class="mpre">
    </span><a href="GHC.IO.Handle.Text.html#loc_529_1_529_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Text.html#loc_529_1_529_8&#39;)"><span class="hl_varref"><span class="mpre">hPutStr</span></span></a><span class="mpre"> </span><a href="GHC.IO.Handle.FD.html#loc_74_1_74_7" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.FD.html#loc_74_1_74_7&#39;)"><span class="hl_varref"><span class="mpre">stderr</span></span></a><span class="mpre"> (</span><a href="#loc_341_1_341_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_341_1_341_9&#39;)"><span class="hl_varref"><span class="mpre">wrapText</span></span></a><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;Warning: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_279_16_279_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_279_16_279_19&#39;)"><span class="hl_varref"><span class="mpre">msg</span></span></a><span class="mpre">))

</span><span class="hl_comment"><span class="mpre">-- | Useful status messages.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- We display these at the &#39;normal&#39; verbosity level.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This is for the ordinary helpful status messages that users see. Just</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- enough information to know that things are working but not floods of detail.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_292_1_292_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_292_1_292_7&#39;)"><span class="mpre">notice</span></a><span class="mpre"> :: </span><a href="Distribution.Verbosity.html#loc_58_6_58_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Verbosity.html#loc_58_6_58_15&#39;)"><span class="hl_tyconref"><span class="mpre">Verbosity</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_292_1_292_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_292_1_292_7&#39;)"><span class="hl_fundecl"><span class="mpre">notice</span></span></a><span class="mpre"> </span><a name="loc_292_8_292_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_292_8_292_17&#39;)"><span class="hl_vardecl"><span class="mpre">verbosity</span></span></a><span class="mpre"> </span><a name="loc_292_18_292_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_292_18_292_21&#39;)"><span class="hl_vardecl"><span class="mpre">msg</span></span></a><span class="mpre"> =
  </span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="hl_varref"><span class="mpre">when</span></span></a><span class="mpre"> (</span><a href="#loc_292_8_292_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_292_8_292_17&#39;)"><span class="hl_varref"><span class="mpre">verbosity</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><a href="Distribution.Verbosity.html#loc_67_1_67_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Verbosity.html#loc_67_1_67_7&#39;)"><span class="hl_varref"><span class="mpre">normal</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">putStr</span></span><span class="mpre"> (</span><a href="#loc_341_1_341_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_341_1_341_9&#39;)"><span class="hl_varref"><span class="mpre">wrapText</span></span></a><span class="mpre"> </span><a href="#loc_292_18_292_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_292_18_292_21&#39;)"><span class="hl_varref"><span class="mpre">msg</span></span></a><span class="mpre">)

</span><a href="#loc_297_1_297_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_297_1_297_13&#39;)"><span class="mpre">setupMessage</span></a><span class="mpre"> :: </span><a href="Distribution.Verbosity.html#loc_58_6_58_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Verbosity.html#loc_58_6_58_15&#39;)"><span class="hl_tyconref"><span class="mpre">Verbosity</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><a href="Distribution.Package.html#loc_102_6_102_23" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Package.html#loc_102_6_102_23&#39;)"><span class="hl_tyconref"><span class="mpre">PackageIdentifier</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_297_1_297_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_297_1_297_13&#39;)"><span class="hl_fundecl"><span class="mpre">setupMessage</span></span></a><span class="mpre"> </span><a name="loc_297_14_297_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_297_14_297_23&#39;)"><span class="hl_vardecl"><span class="mpre">verbosity</span></span></a><span class="mpre"> </span><a name="loc_297_24_297_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_297_24_297_27&#39;)"><span class="hl_vardecl"><span class="mpre">msg</span></span></a><span class="mpre"> </span><a name="loc_297_28_297_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_297_28_297_33&#39;)"><span class="hl_vardecl"><span class="mpre">pkgid</span></span></a><span class="mpre"> =
    </span><a href="#loc_292_1_292_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_292_1_292_7&#39;)"><span class="hl_varref"><span class="mpre">notice</span></span></a><span class="mpre"> </span><a href="#loc_297_14_297_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_297_14_297_23&#39;)"><span class="hl_varref"><span class="mpre">verbosity</span></span></a><span class="mpre"> (</span><a href="#loc_297_24_297_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_297_24_297_27&#39;)"><span class="hl_varref"><span class="mpre">msg</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39; &#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="Distribution.Text.html#loc_31_1_31_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Text.html#loc_31_1_31_8&#39;)"><span class="hl_varref"><span class="mpre">display</span></span></a><span class="mpre"> </span><a href="#loc_297_28_297_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_297_28_297_33&#39;)"><span class="hl_varref"><span class="mpre">pkgid</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;...&quot;</span></span><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | More detail on the operation of some action.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- We display these messages when the verbosity level is &#39;verbose&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_305_1_305_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_305_1_305_5&#39;)"><span class="mpre">info</span></a><span class="mpre"> :: </span><a href="Distribution.Verbosity.html#loc_58_6_58_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Verbosity.html#loc_58_6_58_15&#39;)"><span class="hl_tyconref"><span class="mpre">Verbosity</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_305_1_305_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_305_1_305_5&#39;)"><span class="hl_fundecl"><span class="mpre">info</span></span></a><span class="mpre"> </span><a name="loc_305_6_305_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_305_6_305_15&#39;)"><span class="hl_vardecl"><span class="mpre">verbosity</span></span></a><span class="mpre"> </span><a name="loc_305_16_305_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_305_16_305_19&#39;)"><span class="hl_vardecl"><span class="mpre">msg</span></span></a><span class="mpre"> =
  </span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="hl_varref"><span class="mpre">when</span></span></a><span class="mpre"> (</span><a href="#loc_305_6_305_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_305_6_305_15&#39;)"><span class="hl_varref"><span class="mpre">verbosity</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><a href="Distribution.Verbosity.html#loc_71_1_71_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Verbosity.html#loc_71_1_71_8&#39;)"><span class="hl_varref"><span class="mpre">verbose</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">putStr</span></span><span class="mpre"> (</span><a href="#loc_341_1_341_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_341_1_341_9&#39;)"><span class="hl_varref"><span class="mpre">wrapText</span></span></a><span class="mpre"> </span><a href="#loc_305_16_305_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_305_16_305_19&#39;)"><span class="hl_varref"><span class="mpre">msg</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Detailed internal debugging information</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- We display these messages when the verbosity level is &#39;deafening&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_314_1_314_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_314_1_314_6&#39;)"><span class="mpre">debug</span></a><span class="mpre"> :: </span><a href="Distribution.Verbosity.html#loc_58_6_58_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Verbosity.html#loc_58_6_58_15&#39;)"><span class="hl_tyconref"><span class="mpre">Verbosity</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_314_1_314_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_314_1_314_6&#39;)"><span class="hl_fundecl"><span class="mpre">debug</span></span></a><span class="mpre"> </span><a name="loc_314_7_314_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_314_7_314_16&#39;)"><span class="hl_vardecl"><span class="mpre">verbosity</span></span></a><span class="mpre"> </span><a name="loc_314_17_314_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_314_17_314_20&#39;)"><span class="hl_vardecl"><span class="mpre">msg</span></span></a><span class="mpre"> =
  </span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="hl_varref"><span class="mpre">when</span></span></a><span class="mpre"> (</span><a href="#loc_314_7_314_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_314_7_314_16&#39;)"><span class="hl_varref"><span class="mpre">verbosity</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><a href="Distribution.Verbosity.html#loc_76_1_76_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Verbosity.html#loc_76_1_76_10&#39;)"><span class="hl_varref"><span class="mpre">deafening</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
    </span><span class="hl_varref"><span class="mpre">putStr</span></span><span class="mpre"> (</span><a href="#loc_341_1_341_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_341_1_341_9&#39;)"><span class="hl_varref"><span class="mpre">wrapText</span></span></a><span class="mpre"> </span><a href="#loc_314_17_314_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_314_17_314_20&#39;)"><span class="hl_varref"><span class="mpre">msg</span></span></a><span class="mpre">)
    </span><a href="GHC.IO.Handle.html#loc_293_1_293_7" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.html#loc_293_1_293_7&#39;)"><span class="hl_varref"><span class="mpre">hFlush</span></span></a><span class="mpre"> </span><a href="GHC.IO.Handle.FD.html#loc_63_1_63_7" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.FD.html#loc_63_1_63_7&#39;)"><span class="hl_varref"><span class="mpre">stdout</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | A variant of &#39;debug&#39; that doesn&#39;t perform the automatic line</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- wrapping. Produces better output in some cases.</span></span><span class="mpre">
</span><a href="#loc_322_1_322_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_322_1_322_12&#39;)"><span class="mpre">debugNoWrap</span></a><span class="mpre"> :: </span><a href="Distribution.Verbosity.html#loc_58_6_58_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Verbosity.html#loc_58_6_58_15&#39;)"><span class="hl_tyconref"><span class="mpre">Verbosity</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_322_1_322_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_322_1_322_12&#39;)"><span class="hl_fundecl"><span class="mpre">debugNoWrap</span></span></a><span class="mpre"> </span><a name="loc_322_13_322_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_322_13_322_22&#39;)"><span class="hl_vardecl"><span class="mpre">verbosity</span></span></a><span class="mpre"> </span><a name="loc_322_23_322_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_322_23_322_26&#39;)"><span class="hl_vardecl"><span class="mpre">msg</span></span></a><span class="mpre"> =
  </span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="hl_varref"><span class="mpre">when</span></span></a><span class="mpre"> (</span><a href="#loc_322_13_322_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_322_13_322_22&#39;)"><span class="hl_varref"><span class="mpre">verbosity</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><a href="Distribution.Verbosity.html#loc_76_1_76_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Verbosity.html#loc_76_1_76_10&#39;)"><span class="hl_varref"><span class="mpre">deafening</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
    </span><span class="hl_varref"><span class="mpre">putStrLn</span></span><span class="mpre"> </span><a href="#loc_322_23_322_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_322_23_322_26&#39;)"><span class="hl_varref"><span class="mpre">msg</span></span></a><span class="mpre">
    </span><a href="GHC.IO.Handle.html#loc_293_1_293_7" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.html#loc_293_1_293_7&#39;)"><span class="hl_varref"><span class="mpre">hFlush</span></span></a><span class="mpre"> </span><a href="GHC.IO.Handle.FD.html#loc_63_1_63_7" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.FD.html#loc_63_1_63_7&#39;)"><span class="hl_varref"><span class="mpre">stdout</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Perform an IO action, catching any IO exceptions and printing an error</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   if one occurs.</span></span><span class="mpre">
</span><a href="#loc_332_1_332_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_332_1_332_10&#39;)"><span class="mpre">chattyTry</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- ^ a description of the action we were attempting</span></span><span class="mpre">
          -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">   </span><span class="hl_comment"><span class="mpre">-- ^ the action itself</span></span><span class="mpre">
          -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_332_1_332_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_332_1_332_10&#39;)"><span class="hl_fundecl"><span class="mpre">chattyTry</span></span></a><span class="mpre"> </span><a name="loc_332_11_332_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_332_11_332_15&#39;)"><span class="hl_vardecl"><span class="mpre">desc</span></span></a><span class="mpre"> </span><a name="loc_332_16_332_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_332_16_332_22&#39;)"><span class="hl_vardecl"><span class="mpre">action</span></span></a><span class="mpre"> =
  </span><a href="Distribution.Compat.Exception.html#loc_14_1_14_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Compat.Exception.html#loc_14_1_14_8&#39;)"><span class="hl_varref"><span class="mpre">catchIO</span></span></a><span class="mpre"> </span><a href="#loc_332_16_332_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_332_16_332_22&#39;)"><span class="hl_varref"><span class="mpre">action</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_333_21_333_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_333_21_333_30&#39;)"><span class="hl_vardecl"><span class="mpre">exception</span></span></a><span class="mpre"> -&gt;
    </span><span class="hl_varref"><span class="mpre">putStrLn</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Error while &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_332_11_332_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_332_11_332_15&#39;)"><span class="hl_varref"><span class="mpre">desc</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_333_21_333_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_333_21_333_30&#39;)"><span class="hl_varref"><span class="mpre">exception</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- -----------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Helper functions</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Wraps text to the default line width. Existing newlines are preserved.</span></span><span class="mpre">
</span><a href="#loc_341_1_341_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_341_1_341_9&#39;)"><span class="mpre">wrapText</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_341_1_341_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_341_1_341_9&#39;)"><span class="hl_vardecl"><span class="mpre">wrapText</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">unlines</span></span><span class="mpre">
         </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><a href="Data.List.html#loc_443_1_443_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_443_1_443_12&#39;)"><span class="hl_varref"><span class="mpre">intercalate</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;\n&quot;</span></span><span class="mpre">
              </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">unwords</span></span><span class="mpre">
              </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_350_1_350_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_350_1_350_9&#39;)"><span class="hl_varref"><span class="mpre">wrapLine</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">79</span></span><span class="mpre">
              </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">words</span></span><span class="mpre">)
         </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">lines</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Wraps a list of words to a list of lines of words of a particular width.</span></span><span class="mpre">
</span><a href="#loc_350_1_350_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_350_1_350_9&#39;)"><span class="mpre">wrapLine</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">] -&gt; [[</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">]]
</span><a name="loc_350_1_350_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_350_1_350_9&#39;)"><span class="hl_fundecl"><span class="mpre">wrapLine</span></span></a><span class="mpre"> </span><a name="loc_350_10_350_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_350_10_350_15&#39;)"><span class="hl_vardecl"><span class="mpre">width</span></span></a><span class="mpre"> = </span><a href="#loc_352_9_352_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_352_9_352_13&#39;)"><span class="hl_varref"><span class="mpre">wrap</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> []
  where </span><a href="#loc_352_9_352_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_352_9_352_13&#39;)"><span class="mpre">wrap</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">] -&gt; [</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">] -&gt; [[</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">]]
        </span><a name="loc_352_9_352_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_352_9_352_13&#39;)"><span class="hl_fundecl"><span class="mpre">wrap</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">   []   (</span><a name="loc_352_24_352_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_352_24_352_25&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_352_26_352_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_352_26_352_28&#39;)"><span class="hl_vardecl"><span class="mpre">ws</span></span></a><span class="mpre">)
          | </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_352_24_352_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_352_24_352_25&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><a href="#loc_350_10_350_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_350_10_350_15&#39;)"><span class="hl_varref"><span class="mpre">width</span></span></a><span class="mpre">
          = </span><a href="#loc_352_9_352_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_352_9_352_13&#39;)"><span class="hl_varref"><span class="mpre">wrap</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_352_24_352_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_352_24_352_25&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">) [</span><a href="#loc_352_24_352_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_352_24_352_25&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">] </span><a href="#loc_352_26_352_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_352_26_352_28&#39;)"><span class="hl_varref"><span class="mpre">ws</span></span></a><span class="mpre">
        </span><a href="#loc_352_9_352_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_352_9_352_13&#39;)"><span class="hl_fundecl"><span class="mpre">wrap</span></span></a><span class="mpre"> </span><a name="loc_355_14_355_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_355_14_355_17&#39;)"><span class="hl_vardecl"><span class="mpre">col</span></span></a><span class="mpre"> </span><a name="loc_355_18_355_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_355_18_355_22&#39;)"><span class="hl_vardecl"><span class="mpre">line</span></span></a><span class="mpre"> (</span><a name="loc_355_24_355_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_355_24_355_25&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_355_26_355_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_355_26_355_28&#39;)"><span class="hl_vardecl"><span class="mpre">ws</span></span></a><span class="mpre">)
          | </span><a href="#loc_355_14_355_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_355_14_355_17&#39;)"><span class="hl_varref"><span class="mpre">col</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_355_24_355_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_355_24_355_25&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><a href="#loc_350_10_350_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_350_10_350_15&#39;)"><span class="hl_varref"><span class="mpre">width</span></span></a><span class="mpre">
          = </span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><a href="#loc_355_18_355_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_355_18_355_22&#39;)"><span class="hl_varref"><span class="mpre">line</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_352_9_352_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_352_9_352_13&#39;)"><span class="hl_varref"><span class="mpre">wrap</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> [] (</span><a href="#loc_355_24_355_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_355_24_355_25&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_355_26_355_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_355_26_355_28&#39;)"><span class="hl_varref"><span class="mpre">ws</span></span></a><span class="mpre">)
        </span><a href="#loc_352_9_352_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_352_9_352_13&#39;)"><span class="hl_fundecl"><span class="mpre">wrap</span></span></a><span class="mpre"> </span><a name="loc_358_14_358_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_358_14_358_17&#39;)"><span class="hl_vardecl"><span class="mpre">col</span></span></a><span class="mpre"> </span><a name="loc_358_18_358_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_358_18_358_22&#39;)"><span class="hl_vardecl"><span class="mpre">line</span></span></a><span class="mpre"> (</span><a name="loc_358_24_358_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_358_24_358_25&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_358_26_358_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_358_26_358_28&#39;)"><span class="hl_vardecl"><span class="mpre">ws</span></span></a><span class="mpre">)
          = let </span><a name="loc_359_17_359_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_359_17_359_21&#39;)"><span class="hl_vardecl"><span class="mpre">col&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_358_14_358_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_358_14_358_17&#39;)"><span class="hl_varref"><span class="mpre">col</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_358_24_358_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_358_24_358_25&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
             in </span><a href="#loc_352_9_352_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_352_9_352_13&#39;)"><span class="hl_varref"><span class="mpre">wrap</span></span></a><span class="mpre"> </span><a href="#loc_359_17_359_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_359_17_359_21&#39;)"><span class="hl_varref"><span class="mpre">col&#39;</span></span></a><span class="mpre"> (</span><a href="#loc_358_24_358_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_358_24_358_25&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_358_18_358_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_358_18_358_22&#39;)"><span class="hl_varref"><span class="mpre">line</span></span></a><span class="mpre">) </span><a href="#loc_358_26_358_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_358_26_358_28&#39;)"><span class="hl_varref"><span class="mpre">ws</span></span></a><span class="mpre">
        </span><a href="#loc_352_9_352_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_352_9_352_13&#39;)"><span class="hl_fundecl"><span class="mpre">wrap</span></span></a><span class="mpre"> _ []   [] = []
        </span><a href="#loc_352_9_352_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_352_9_352_13&#39;)"><span class="hl_fundecl"><span class="mpre">wrap</span></span></a><span class="mpre"> _ </span><a name="loc_362_16_362_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_362_16_362_20&#39;)"><span class="hl_vardecl"><span class="mpre">line</span></span></a><span class="mpre"> [] = [</span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><a href="#loc_362_16_362_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_362_16_362_20&#39;)"><span class="hl_varref"><span class="mpre">line</span></span></a><span class="mpre">]

</span><span class="hl_comment"><span class="mpre">-- -----------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- rawSystem variants</span></span><span class="mpre">
</span><a href="#loc_367_1_367_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_367_1_367_10&#39;)"><span class="mpre">maybeExit</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><a href="GHC.IO.Exception.html#loc_205_6_205_14" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Exception.html#loc_205_6_205_14&#39;)"><span class="hl_tyconref"><span class="mpre">ExitCode</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_367_1_367_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_367_1_367_10&#39;)"><span class="hl_fundecl"><span class="mpre">maybeExit</span></span></a><span class="mpre"> </span><a name="loc_367_11_367_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_367_11_367_14&#39;)"><span class="hl_vardecl"><span class="mpre">cmd</span></span></a><span class="mpre"> = do
  </span><a name="loc_368_3_368_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_368_3_368_6&#39;)"><span class="hl_vardecl"><span class="mpre">res</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_367_11_367_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_367_11_367_14&#39;)"><span class="hl_varref"><span class="mpre">cmd</span></span></a><span class="mpre">
  </span><a href="Control.Monad.html#loc_270_1_270_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_270_1_270_7&#39;)"><span class="hl_varref"><span class="mpre">unless</span></span></a><span class="mpre"> (</span><a href="#loc_368_3_368_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_368_3_368_6&#39;)"><span class="hl_varref"><span class="mpre">res</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">ExitSuccess</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="System.Exit.html#loc_60_1_60_9" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Exit.html#loc_60_1_60_9&#39;)"><span class="hl_varref"><span class="mpre">exitWith</span></span></a><span class="mpre"> </span><a href="#loc_368_3_368_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_368_3_368_6&#39;)"><span class="hl_varref"><span class="mpre">res</span></span></a><span class="mpre">

</span><a href="#loc_372_1_372_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_372_1_372_23&#39;)"><span class="mpre">printRawCommandAndArgs</span></a><span class="mpre"> :: </span><a href="Distribution.Verbosity.html#loc_58_6_58_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Verbosity.html#loc_58_6_58_15&#39;)"><span class="hl_tyconref"><span class="mpre">Verbosity</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_372_1_372_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_372_1_372_23&#39;)"><span class="hl_fundecl"><span class="mpre">printRawCommandAndArgs</span></span></a><span class="mpre"> </span><a name="loc_372_24_372_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_372_24_372_33&#39;)"><span class="hl_vardecl"><span class="mpre">verbosity</span></span></a><span class="mpre"> </span><a name="loc_372_34_372_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_372_34_372_38&#39;)"><span class="hl_vardecl"><span class="mpre">path</span></span></a><span class="mpre"> </span><a name="loc_372_39_372_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_372_39_372_43&#39;)"><span class="hl_vardecl"><span class="mpre">args</span></span></a><span class="mpre">
 | </span><a href="#loc_372_24_372_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_372_24_372_33&#39;)"><span class="hl_varref"><span class="mpre">verbosity</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><a href="Distribution.Verbosity.html#loc_76_1_76_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Verbosity.html#loc_76_1_76_10&#39;)"><span class="hl_varref"><span class="mpre">deafening</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">print</span></span><span class="mpre"> (</span><a href="#loc_372_34_372_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_372_34_372_38&#39;)"><span class="hl_varref"><span class="mpre">path</span></span></a><span class="mpre">, </span><a href="#loc_372_39_372_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_372_39_372_43&#39;)"><span class="hl_varref"><span class="mpre">args</span></span></a><span class="mpre">)
 | </span><a href="#loc_372_24_372_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_372_24_372_33&#39;)"><span class="hl_varref"><span class="mpre">verbosity</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><a href="Distribution.Verbosity.html#loc_71_1_71_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Verbosity.html#loc_71_1_71_8&#39;)"><span class="hl_varref"><span class="mpre">verbose</span></span></a><span class="mpre">   =
#if __GLASGOW_HASKELL__ &gt;= 702
                            </span><span class="hl_varref"><span class="mpre">putStrLn</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="System.Process.html#loc_552_1_552_19" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Process.html#loc_552_1_552_19&#39;)"><span class="hl_varref"><span class="mpre">showCommandForUser</span></span></a><span class="mpre"> </span><a href="#loc_372_34_372_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_372_34_372_38&#39;)"><span class="hl_varref"><span class="mpre">path</span></span></a><span class="mpre"> </span><a href="#loc_372_39_372_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_372_39_372_43&#39;)"><span class="hl_varref"><span class="mpre">args</span></span></a><span class="mpre">
#else
                            </span><span class="hl_varref"><span class="mpre">putStrLn</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">unwords</span></span><span class="mpre"> (</span><a href="#loc_372_34_372_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_372_34_372_38&#39;)"><span class="hl_varref"><span class="mpre">path</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_372_39_372_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_372_39_372_43&#39;)"><span class="hl_varref"><span class="mpre">args</span></span></a><span class="mpre">)
#endif
 | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">              = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">

</span><a href="#loc_387_1_387_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_387_1_387_29&#39;)"><span class="mpre">printRawCommandAndArgsAndEnv</span></a><span class="mpre"> :: </span><a href="Distribution.Verbosity.html#loc_58_6_58_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Verbosity.html#loc_58_6_58_15&#39;)"><span class="hl_tyconref"><span class="mpre">Verbosity</span></span></a><span class="mpre">
                             -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">
                             -&gt; [</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">]
                             -&gt; [(</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">)]
                             -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_387_1_387_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_387_1_387_29&#39;)"><span class="hl_fundecl"><span class="mpre">printRawCommandAndArgsAndEnv</span></span></a><span class="mpre"> </span><a name="loc_387_30_387_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_387_30_387_39&#39;)"><span class="hl_vardecl"><span class="mpre">verbosity</span></span></a><span class="mpre"> </span><a name="loc_387_40_387_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_387_40_387_44&#39;)"><span class="hl_vardecl"><span class="mpre">path</span></span></a><span class="mpre"> </span><a name="loc_387_45_387_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_387_45_387_49&#39;)"><span class="hl_vardecl"><span class="mpre">args</span></span></a><span class="mpre"> </span><a name="loc_387_50_387_53" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_387_50_387_53&#39;)"><span class="hl_vardecl"><span class="mpre">env</span></span></a><span class="mpre">
 | </span><a href="#loc_387_30_387_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_387_30_387_39&#39;)"><span class="hl_varref"><span class="mpre">verbosity</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><a href="Distribution.Verbosity.html#loc_76_1_76_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Verbosity.html#loc_76_1_76_10&#39;)"><span class="hl_varref"><span class="mpre">deafening</span></span></a><span class="mpre"> = do </span><span class="hl_varref"><span class="mpre">putStrLn</span></span><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;Environment: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_387_50_387_53" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_387_50_387_53&#39;)"><span class="hl_varref"><span class="mpre">env</span></span></a><span class="mpre">)
                               </span><span class="hl_varref"><span class="mpre">print</span></span><span class="mpre"> (</span><a href="#loc_387_40_387_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_387_40_387_44&#39;)"><span class="hl_varref"><span class="mpre">path</span></span></a><span class="mpre">, </span><a href="#loc_387_45_387_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_387_45_387_49&#39;)"><span class="hl_varref"><span class="mpre">args</span></span></a><span class="mpre">)
 | </span><a href="#loc_387_30_387_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_387_30_387_39&#39;)"><span class="hl_varref"><span class="mpre">verbosity</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><a href="Distribution.Verbosity.html#loc_71_1_71_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Verbosity.html#loc_71_1_71_8&#39;)"><span class="hl_varref"><span class="mpre">verbose</span></span></a><span class="mpre">   = </span><span class="hl_varref"><span class="mpre">putStrLn</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">unwords</span></span><span class="mpre"> (</span><a href="#loc_387_40_387_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_387_40_387_44&#39;)"><span class="hl_varref"><span class="mpre">path</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_387_45_387_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_387_45_387_49&#39;)"><span class="hl_varref"><span class="mpre">args</span></span></a><span class="mpre">)
 | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">              = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- This is taken directly from the process package.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The reason we need it is that runProcess doesn&#39;t handle ^C in the same</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- way that rawSystem handles it, but rawSystem doesn&#39;t allow us to pass</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- an environment.</span></span><span class="mpre">
</span><a href="#loc_400_1_400_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_400_1_400_12&#39;)"><span class="mpre">syncProcess</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Process.CreateProcess</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><a href="GHC.IO.Exception.html#loc_205_6_205_14" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Exception.html#loc_205_6_205_14&#39;)"><span class="hl_tyconref"><span class="mpre">ExitCode</span></span></a><span class="mpre">
#if mingw32_HOST_OS
</span><a name="loc_400_1_400_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_400_1_400_12&#39;)"><span class="hl_fundecl"><span class="mpre">syncProcess</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">_fun</span></span><span class="mpre"> </span><a name="loc_400_18_400_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_400_18_400_19&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> = do
  (_,_,_,</span><a name="loc_401_10_401_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_401_10_401_11&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">) &lt;- </span><a href="System.Process.html#loc_211_1_211_14" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Process.html#loc_211_1_211_14&#39;)"><span class="hl_varref"><span class="mpre">createProcess</span></span></a><span class="mpre"> </span><a href="#loc_400_18_400_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_400_18_400_19&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">
  </span><a href="System.Process.html#loc_575_1_575_15" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Process.html#loc_575_1_575_15&#39;)"><span class="hl_varref"><span class="mpre">waitForProcess</span></span></a><span class="mpre"> </span><a href="#loc_401_10_401_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_401_10_401_11&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
#else
</span><a href="#loc_400_1_400_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_400_1_400_12&#39;)"><span class="hl_fundecl"><span class="mpre">syncProcess</span></span></a><span class="mpre"> </span><a name="loc_404_13_404_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_404_13_404_16&#39;)"><span class="hl_vardecl"><span class="mpre">fun</span></span></a><span class="mpre"> </span><a name="loc_404_17_404_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_404_17_404_18&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> = do
  </span><span class="hl_comment"><span class="mpre">-- The POSIX version of system needs to do some manipulation of signal</span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">-- handlers.  Since we&#39;re going to be synchronously waiting for the child,</span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">-- we want to ignore ^C in the parent, but handle it the default way</span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">-- in the child (using SIG_DFL isn&#39;t really correct, it should be the</span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">-- original signal handler, but the GHC RTS will have already set up</span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">-- its own handler and we don&#39;t want to use that).</span></span><span class="mpre">
  </span><a name="loc_411_3_411_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_411_3_411_4&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> &lt;- </span><a href="Control.Exception.Base.html#loc_259_1_259_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Exception.Base.html#loc_259_1_259_8&#39;)"><span class="hl_varref"><span class="mpre">Exception.bracket</span></span></a><span class="mpre"> (</span><a href="#loc_417_7_417_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_417_7_417_22&#39;)"><span class="hl_varref"><span class="mpre">installHandlers</span></span></a><span class="mpre">) (</span><a href="#loc_421_7_421_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_421_7_421_22&#39;)"><span class="hl_varref"><span class="mpre">restoreHandlers</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
       (\_ -&gt; do (_,_,_,</span><a name="loc_412_25_412_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_412_25_412_26&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">) &lt;- </span><span class="hl_varref"><span class="mpre">runGenProcess_</span></span><span class="mpre"> </span><a href="#loc_404_13_404_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_404_13_404_16&#39;)"><span class="hl_varref"><span class="mpre">fun</span></span></a><span class="mpre"> </span><a href="#loc_404_17_404_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_404_17_404_18&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">
                              (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">defaultSignal</span></span><span class="mpre">) (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">defaultSignal</span></span><span class="mpre">)
                 </span><a href="System.Process.html#loc_575_1_575_15" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Process.html#loc_575_1_575_15&#39;)"><span class="hl_varref"><span class="mpre">waitForProcess</span></span></a><span class="mpre"> </span><a href="#loc_412_25_412_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_412_25_412_26&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">)
  </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_411_3_411_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_411_3_411_4&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">
    where
      </span><a name="loc_417_7_417_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_417_7_417_22&#39;)"><span class="hl_vardecl"><span class="mpre">installHandlers</span></span></a><span class="mpre"> = do
        </span><a name="loc_418_9_418_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_418_9_418_16&#39;)"><span class="hl_vardecl"><span class="mpre">old_int</span></span></a><span class="mpre">  &lt;- </span><span class="hl_varref"><span class="mpre">installHandler</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">sigINT</span></span><span class="mpre">  </span><span class="hl_conref"><span class="mpre">Ignore</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
        </span><a name="loc_419_9_419_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_419_9_419_17&#39;)"><span class="hl_vardecl"><span class="mpre">old_quit</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">installHandler</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">sigQUIT</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Ignore</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_418_9_418_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_418_9_418_16&#39;)"><span class="hl_varref"><span class="mpre">old_int</span></span></a><span class="mpre">, </span><a href="#loc_419_9_419_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_419_9_419_17&#39;)"><span class="hl_varref"><span class="mpre">old_quit</span></span></a><span class="mpre">)
      </span><a name="loc_421_7_421_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_421_7_421_22&#39;)"><span class="hl_fundecl"><span class="mpre">restoreHandlers</span></span></a><span class="mpre"> (</span><a name="loc_421_24_421_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_421_24_421_31&#39;)"><span class="hl_vardecl"><span class="mpre">old_int</span></span></a><span class="mpre">, </span><a name="loc_421_33_421_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_421_33_421_41&#39;)"><span class="hl_vardecl"><span class="mpre">old_quit</span></span></a><span class="mpre">) = do
        _ &lt;- </span><span class="hl_varref"><span class="mpre">installHandler</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">sigINT</span></span><span class="mpre">  </span><a href="#loc_421_24_421_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_421_24_421_31&#39;)"><span class="hl_varref"><span class="mpre">old_int</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
        _ &lt;- </span><span class="hl_varref"><span class="mpre">installHandler</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">sigQUIT</span></span><span class="mpre"> </span><a href="#loc_421_33_421_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_421_33_421_41&#39;)"><span class="hl_varref"><span class="mpre">old_quit</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">
#endif  /* mingw32_HOST_OS */

</span><span class="hl_comment"><span class="mpre">-- Exit with the same exitcode if the subcommand fails</span></span><span class="mpre">
</span><a href="#loc_429_1_429_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_429_1_429_14&#39;)"><span class="mpre">rawSystemExit</span></a><span class="mpre"> :: </span><a href="Distribution.Verbosity.html#loc_58_6_58_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Verbosity.html#loc_58_6_58_15&#39;)"><span class="hl_tyconref"><span class="mpre">Verbosity</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_429_1_429_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_429_1_429_14&#39;)"><span class="hl_fundecl"><span class="mpre">rawSystemExit</span></span></a><span class="mpre"> </span><a name="loc_429_15_429_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_429_15_429_24&#39;)"><span class="hl_vardecl"><span class="mpre">verbosity</span></span></a><span class="mpre"> </span><a name="loc_429_25_429_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_429_25_429_29&#39;)"><span class="hl_vardecl"><span class="mpre">path</span></span></a><span class="mpre"> </span><a name="loc_429_30_429_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_429_30_429_34&#39;)"><span class="hl_vardecl"><span class="mpre">args</span></span></a><span class="mpre"> = do
  </span><a href="#loc_372_1_372_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_372_1_372_23&#39;)"><span class="hl_varref"><span class="mpre">printRawCommandAndArgs</span></span></a><span class="mpre"> </span><a href="#loc_429_15_429_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_429_15_429_24&#39;)"><span class="hl_varref"><span class="mpre">verbosity</span></span></a><span class="mpre"> </span><a href="#loc_429_25_429_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_429_25_429_29&#39;)"><span class="hl_varref"><span class="mpre">path</span></span></a><span class="mpre"> </span><a href="#loc_429_30_429_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_429_30_429_34&#39;)"><span class="hl_varref"><span class="mpre">args</span></span></a><span class="mpre">
  </span><a href="GHC.IO.Handle.html#loc_293_1_293_7" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.html#loc_293_1_293_7&#39;)"><span class="hl_varref"><span class="mpre">hFlush</span></span></a><span class="mpre"> </span><a href="GHC.IO.Handle.FD.html#loc_63_1_63_7" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.FD.html#loc_63_1_63_7&#39;)"><span class="hl_varref"><span class="mpre">stdout</span></span></a><span class="mpre">
  </span><a name="loc_432_3_432_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_432_3_432_11&#39;)"><span class="hl_vardecl"><span class="mpre">exitcode</span></span></a><span class="mpre"> &lt;- </span><a href="System.Process.html#loc_900_1_900_10" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Process.html#loc_900_1_900_10&#39;)"><span class="hl_varref"><span class="mpre">rawSystem</span></span></a><span class="mpre"> </span><a href="#loc_429_25_429_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_429_25_429_29&#39;)"><span class="hl_varref"><span class="mpre">path</span></span></a><span class="mpre"> </span><a href="#loc_429_30_429_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_429_30_429_34&#39;)"><span class="hl_varref"><span class="mpre">args</span></span></a><span class="mpre">
  </span><a href="Control.Monad.html#loc_270_1_270_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_270_1_270_7&#39;)"><span class="hl_varref"><span class="mpre">unless</span></span></a><span class="mpre"> (</span><a href="#loc_432_3_432_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_432_3_432_11&#39;)"><span class="hl_varref"><span class="mpre">exitcode</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">ExitSuccess</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
    </span><a href="#loc_314_1_314_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_314_1_314_6&#39;)"><span class="hl_varref"><span class="mpre">debug</span></span></a><span class="mpre"> </span><a href="#loc_429_15_429_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_429_15_429_24&#39;)"><span class="hl_varref"><span class="mpre">verbosity</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_429_25_429_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_429_25_429_29&#39;)"><span class="hl_varref"><span class="mpre">path</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot; returned &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_432_3_432_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_432_3_432_11&#39;)"><span class="hl_varref"><span class="mpre">exitcode</span></span></a><span class="mpre">
    </span><a href="System.Exit.html#loc_60_1_60_9" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Exit.html#loc_60_1_60_9&#39;)"><span class="hl_varref"><span class="mpre">exitWith</span></span></a><span class="mpre"> </span><a href="#loc_432_3_432_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_432_3_432_11&#39;)"><span class="hl_varref"><span class="mpre">exitcode</span></span></a><span class="mpre">

</span><a href="#loc_438_1_438_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_438_1_438_18&#39;)"><span class="mpre">rawSystemExitCode</span></a><span class="mpre"> :: </span><a href="Distribution.Verbosity.html#loc_58_6_58_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Verbosity.html#loc_58_6_58_15&#39;)"><span class="hl_tyconref"><span class="mpre">Verbosity</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><a href="GHC.IO.Exception.html#loc_205_6_205_14" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Exception.html#loc_205_6_205_14&#39;)"><span class="hl_tyconref"><span class="mpre">ExitCode</span></span></a><span class="mpre">
</span><a name="loc_438_1_438_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_438_1_438_18&#39;)"><span class="hl_fundecl"><span class="mpre">rawSystemExitCode</span></span></a><span class="mpre"> </span><a name="loc_438_19_438_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_438_19_438_28&#39;)"><span class="hl_vardecl"><span class="mpre">verbosity</span></span></a><span class="mpre"> </span><a name="loc_438_29_438_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_438_29_438_33&#39;)"><span class="hl_vardecl"><span class="mpre">path</span></span></a><span class="mpre"> </span><a name="loc_438_34_438_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_438_34_438_38&#39;)"><span class="hl_vardecl"><span class="mpre">args</span></span></a><span class="mpre"> = do
  </span><a href="#loc_372_1_372_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_372_1_372_23&#39;)"><span class="hl_varref"><span class="mpre">printRawCommandAndArgs</span></span></a><span class="mpre"> </span><a href="#loc_438_19_438_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_438_19_438_28&#39;)"><span class="hl_varref"><span class="mpre">verbosity</span></span></a><span class="mpre"> </span><a href="#loc_438_29_438_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_438_29_438_33&#39;)"><span class="hl_varref"><span class="mpre">path</span></span></a><span class="mpre"> </span><a href="#loc_438_34_438_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_438_34_438_38&#39;)"><span class="hl_varref"><span class="mpre">args</span></span></a><span class="mpre">
  </span><a href="GHC.IO.Handle.html#loc_293_1_293_7" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.html#loc_293_1_293_7&#39;)"><span class="hl_varref"><span class="mpre">hFlush</span></span></a><span class="mpre"> </span><a href="GHC.IO.Handle.FD.html#loc_63_1_63_7" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.FD.html#loc_63_1_63_7&#39;)"><span class="hl_varref"><span class="mpre">stdout</span></span></a><span class="mpre">
  </span><a name="loc_441_3_441_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_441_3_441_11&#39;)"><span class="hl_vardecl"><span class="mpre">exitcode</span></span></a><span class="mpre"> &lt;- </span><a href="System.Process.html#loc_900_1_900_10" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Process.html#loc_900_1_900_10&#39;)"><span class="hl_varref"><span class="mpre">rawSystem</span></span></a><span class="mpre"> </span><a href="#loc_438_29_438_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_438_29_438_33&#39;)"><span class="hl_varref"><span class="mpre">path</span></span></a><span class="mpre"> </span><a href="#loc_438_34_438_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_438_34_438_38&#39;)"><span class="hl_varref"><span class="mpre">args</span></span></a><span class="mpre">
  </span><a href="Control.Monad.html#loc_270_1_270_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_270_1_270_7&#39;)"><span class="hl_varref"><span class="mpre">unless</span></span></a><span class="mpre"> (</span><a href="#loc_441_3_441_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_441_3_441_11&#39;)"><span class="hl_varref"><span class="mpre">exitcode</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">ExitSuccess</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
    </span><a href="#loc_314_1_314_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_314_1_314_6&#39;)"><span class="hl_varref"><span class="mpre">debug</span></span></a><span class="mpre"> </span><a href="#loc_438_19_438_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_438_19_438_28&#39;)"><span class="hl_varref"><span class="mpre">verbosity</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_438_29_438_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_438_29_438_33&#39;)"><span class="hl_varref"><span class="mpre">path</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot; returned &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_441_3_441_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_441_3_441_11&#39;)"><span class="hl_varref"><span class="mpre">exitcode</span></span></a><span class="mpre">
  </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_441_3_441_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_441_3_441_11&#39;)"><span class="hl_varref"><span class="mpre">exitcode</span></span></a><span class="mpre">

</span><a href="#loc_451_1_451_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_451_1_451_21&#39;)"><span class="mpre">rawSystemExitWithEnv</span></a><span class="mpre"> :: </span><a href="Distribution.Verbosity.html#loc_58_6_58_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Verbosity.html#loc_58_6_58_15&#39;)"><span class="hl_tyconref"><span class="mpre">Verbosity</span></span></a><span class="mpre">
                     -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">
                     -&gt; [</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">]
                     -&gt; [(</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">)]
                     -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_451_1_451_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_451_1_451_21&#39;)"><span class="hl_fundecl"><span class="mpre">rawSystemExitWithEnv</span></span></a><span class="mpre"> </span><a name="loc_451_22_451_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_451_22_451_31&#39;)"><span class="hl_vardecl"><span class="mpre">verbosity</span></span></a><span class="mpre"> </span><a name="loc_451_32_451_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_451_32_451_36&#39;)"><span class="hl_vardecl"><span class="mpre">path</span></span></a><span class="mpre"> </span><a name="loc_451_37_451_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_451_37_451_41&#39;)"><span class="hl_vardecl"><span class="mpre">args</span></span></a><span class="mpre"> </span><a name="loc_451_42_451_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_451_42_451_45&#39;)"><span class="hl_vardecl"><span class="mpre">env</span></span></a><span class="mpre"> = do
    </span><a href="#loc_387_1_387_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_387_1_387_29&#39;)"><span class="hl_varref"><span class="mpre">printRawCommandAndArgsAndEnv</span></span></a><span class="mpre"> </span><a href="#loc_451_22_451_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_451_22_451_31&#39;)"><span class="hl_varref"><span class="mpre">verbosity</span></span></a><span class="mpre"> </span><a href="#loc_451_32_451_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_451_32_451_36&#39;)"><span class="hl_varref"><span class="mpre">path</span></span></a><span class="mpre"> </span><a href="#loc_451_37_451_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_451_37_451_41&#39;)"><span class="hl_varref"><span class="mpre">args</span></span></a><span class="mpre"> </span><a href="#loc_451_42_451_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_451_42_451_45&#39;)"><span class="hl_varref"><span class="mpre">env</span></span></a><span class="mpre">
    </span><a href="GHC.IO.Handle.html#loc_293_1_293_7" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.html#loc_293_1_293_7&#39;)"><span class="hl_varref"><span class="mpre">hFlush</span></span></a><span class="mpre"> </span><a href="GHC.IO.Handle.FD.html#loc_63_1_63_7" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.FD.html#loc_63_1_63_7&#39;)"><span class="hl_varref"><span class="mpre">stdout</span></span></a><span class="mpre">
    </span><a name="loc_454_5_454_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_454_5_454_13&#39;)"><span class="hl_vardecl"><span class="mpre">exitcode</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_400_1_400_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_400_1_400_12&#39;)"><span class="hl_varref"><span class="mpre">syncProcess</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;rawSystemExitWithEnv&quot;</span></span><span class="mpre"> </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Simple/Utils.hs&quot;, srcSpanStartLine = 454, srcSpanStartColumn = 52, srcSpanEndLine = 455, srcSpanEndColumn = 43}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Simple/Utils.hs&quot;, srcSpanStartLine = 455, srcSpanStartColumn = 17, srcSpanEndLine = 455, srcSpanEndColumn = 18},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Simp"><span class="mpre">(proc path args)
                { Process.env = Just env }</span></span><span class="mpre">
    </span><a href="Control.Monad.html#loc_270_1_270_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_270_1_270_7&#39;)"><span class="hl_varref"><span class="mpre">unless</span></span></a><span class="mpre"> (</span><a href="#loc_454_5_454_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_454_5_454_13&#39;)"><span class="hl_varref"><span class="mpre">exitcode</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">ExitSuccess</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
        </span><a href="#loc_314_1_314_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_314_1_314_6&#39;)"><span class="hl_varref"><span class="mpre">debug</span></span></a><span class="mpre"> </span><a href="#loc_451_22_451_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_451_22_451_31&#39;)"><span class="hl_varref"><span class="mpre">verbosity</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_451_32_451_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_451_32_451_36&#39;)"><span class="hl_varref"><span class="mpre">path</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot; returned &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_454_5_454_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_454_5_454_13&#39;)"><span class="hl_varref"><span class="mpre">exitcode</span></span></a><span class="mpre">
        </span><a href="System.Exit.html#loc_60_1_60_9" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Exit.html#loc_60_1_60_9&#39;)"><span class="hl_varref"><span class="mpre">exitWith</span></span></a><span class="mpre"> </span><a href="#loc_454_5_454_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_454_5_454_13&#39;)"><span class="hl_varref"><span class="mpre">exitcode</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- Closes the passed in handles before returning.</span></span><span class="mpre">
</span><a href="#loc_470_1_470_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_470_1_470_19&#39;)"><span class="mpre">rawSystemIOWithEnv</span></a><span class="mpre"> :: </span><a href="Distribution.Verbosity.html#loc_58_6_58_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Verbosity.html#loc_58_6_58_15&#39;)"><span class="hl_tyconref"><span class="mpre">Verbosity</span></span></a><span class="mpre">
                   -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">
                   -&gt; [</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">]
                   -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">           </span><span class="hl_comment"><span class="mpre">-- ^ New working dir or inherit</span></span><span class="mpre">
                   -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> [(</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">)] </span><span class="hl_comment"><span class="mpre">-- ^ New environment or inherit</span></span><span class="mpre">
                   -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><a href="GHC.IO.Handle.Types.html#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Types.html#loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Handle</span></span></a><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- ^ stdin</span></span><span class="mpre">
                   -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><a href="GHC.IO.Handle.Types.html#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Types.html#loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Handle</span></span></a><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- ^ stdout</span></span><span class="mpre">
                   -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><a href="GHC.IO.Handle.Types.html#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Types.html#loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Handle</span></span></a><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- ^ stderr</span></span><span class="mpre">
                   -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><a href="GHC.IO.Exception.html#loc_205_6_205_14" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Exception.html#loc_205_6_205_14&#39;)"><span class="hl_tyconref"><span class="mpre">ExitCode</span></span></a><span class="mpre">
</span><a name="loc_470_1_470_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_470_1_470_19&#39;)"><span class="hl_fundecl"><span class="mpre">rawSystemIOWithEnv</span></span></a><span class="mpre"> </span><a name="loc_470_20_470_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_470_20_470_29&#39;)"><span class="hl_vardecl"><span class="mpre">verbosity</span></span></a><span class="mpre"> </span><a name="loc_470_30_470_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_470_30_470_34&#39;)"><span class="hl_vardecl"><span class="mpre">path</span></span></a><span class="mpre"> </span><a name="loc_470_35_470_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_470_35_470_39&#39;)"><span class="hl_vardecl"><span class="mpre">args</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">mcwd</span></span><span class="mpre"> </span><a name="loc_470_45_470_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_470_45_470_49&#39;)"><span class="hl_vardecl"><span class="mpre">menv</span></span></a><span class="mpre"> </span><a name="loc_470_50_470_53" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_470_50_470_53&#39;)"><span class="hl_vardecl"><span class="mpre">inp</span></span></a><span class="mpre"> </span><a name="loc_470_54_470_57" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_470_54_470_57&#39;)"><span class="hl_vardecl"><span class="mpre">out</span></span></a><span class="mpre"> </span><a name="loc_470_58_470_61" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_470_58_470_61&#39;)"><span class="hl_vardecl"><span class="mpre">err</span></span></a><span class="mpre"> = do
    </span><span class="hl_varref"><span class="mpre">maybe</span></span><span class="mpre"> (</span><a href="#loc_372_1_372_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_372_1_372_23&#39;)"><span class="hl_varref"><span class="mpre">printRawCommandAndArgs</span></span></a><span class="mpre">       </span><a href="#loc_470_20_470_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_470_20_470_29&#39;)"><span class="hl_varref"><span class="mpre">verbosity</span></span></a><span class="mpre"> </span><a href="#loc_470_30_470_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_470_30_470_34&#39;)"><span class="hl_varref"><span class="mpre">path</span></span></a><span class="mpre"> </span><a href="#loc_470_35_470_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_470_35_470_39&#39;)"><span class="hl_varref"><span class="mpre">args</span></span></a><span class="mpre">)
          (</span><a href="#loc_387_1_387_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_387_1_387_29&#39;)"><span class="hl_varref"><span class="mpre">printRawCommandAndArgsAndEnv</span></span></a><span class="mpre"> </span><a href="#loc_470_20_470_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_470_20_470_29&#39;)"><span class="hl_varref"><span class="mpre">verbosity</span></span></a><span class="mpre"> </span><a href="#loc_470_30_470_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_470_30_470_34&#39;)"><span class="hl_varref"><span class="mpre">path</span></span></a><span class="mpre"> </span><a href="#loc_470_35_470_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_470_35_470_39&#39;)"><span class="hl_varref"><span class="mpre">args</span></span></a><span class="mpre">) </span><a href="#loc_470_45_470_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_470_45_470_49&#39;)"><span class="hl_varref"><span class="mpre">menv</span></span></a><span class="mpre">
    </span><a href="GHC.IO.Handle.html#loc_293_1_293_7" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.html#loc_293_1_293_7&#39;)"><span class="hl_varref"><span class="mpre">hFlush</span></span></a><span class="mpre"> </span><a href="GHC.IO.Handle.FD.html#loc_63_1_63_7" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.FD.html#loc_63_1_63_7&#39;)"><span class="hl_varref"><span class="mpre">stdout</span></span></a><span class="mpre">
    </span><a name="loc_474_5_474_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_474_5_474_13&#39;)"><span class="hl_vardecl"><span class="mpre">exitcode</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_400_1_400_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_400_1_400_12&#39;)"><span class="hl_varref"><span class="mpre">syncProcess</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;rawSystemIOWithEnv&quot;</span></span><span class="mpre"> </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Simple/Utils.hs&quot;, srcSpanStartLine = 474, srcSpanStartColumn = 50, srcSpanEndLine = 479, srcSpanEndColumn = 50}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Simple/Utils.hs&quot;, srcSpanStartLine = 475, srcSpanStartColumn = 17, srcSpanEndLine = 475, srcSpanEndColumn = 18},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Simp"><span class="mpre">(proc path args)
                { Process.cwd     = mcwd
                , Process.env     = menv
                , Process.std_in  = mbToStd inp
                , Process.std_out = mbToStd out
                , Process.std_err = mbToStd err }</span></span><span class="mpre">
                </span><a href="Control.Exception.Base.html#loc_273_3_273_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Exception.Base.html#loc_273_3_273_12&#39;)"><span class="hl_infix"><span class="mpre">`Exception.finally`</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">mapM_</span></span><span class="mpre"> </span><a href="#loc_487_3_487_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_487_3_487_13&#39;)"><span class="hl_varref"><span class="mpre">maybeClose</span></span></a><span class="mpre"> [</span><a href="#loc_470_50_470_53" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_470_50_470_53&#39;)"><span class="hl_varref"><span class="mpre">inp</span></span></a><span class="mpre">, </span><a href="#loc_470_54_470_57" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_470_54_470_57&#39;)"><span class="hl_varref"><span class="mpre">out</span></span></a><span class="mpre">, </span><a href="#loc_470_58_470_61" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_470_58_470_61&#39;)"><span class="hl_varref"><span class="mpre">err</span></span></a><span class="mpre">])
    </span><a href="Control.Monad.html#loc_270_1_270_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_270_1_270_7&#39;)"><span class="hl_varref"><span class="mpre">unless</span></span></a><span class="mpre"> (</span><a href="#loc_474_5_474_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_474_5_474_13&#39;)"><span class="hl_varref"><span class="mpre">exitcode</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">ExitSuccess</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
      </span><a href="#loc_314_1_314_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_314_1_314_6&#39;)"><span class="hl_varref"><span class="mpre">debug</span></span></a><span class="mpre"> </span><a href="#loc_470_20_470_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_470_20_470_29&#39;)"><span class="hl_varref"><span class="mpre">verbosity</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_470_30_470_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_470_30_470_34&#39;)"><span class="hl_varref"><span class="mpre">path</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot; returned &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_474_5_474_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_474_5_474_13&#39;)"><span class="hl_varref"><span class="mpre">exitcode</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_474_5_474_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_474_5_474_13&#39;)"><span class="hl_varref"><span class="mpre">exitcode</span></span></a><span class="mpre">
  where
  </span><span class="hl_comment"><span class="mpre">-- Also taken from System.Process</span></span><span class="mpre">
  </span><a href="#loc_487_3_487_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_487_3_487_13&#39;)"><span class="mpre">maybeClose</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><a href="GHC.IO.Handle.Types.html#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Types.html#loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Handle</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
  </span><a name="loc_487_3_487_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_487_3_487_13&#39;)"><span class="hl_fundecl"><span class="mpre">maybeClose</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre">  </span><a name="loc_487_21_487_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_487_21_487_24&#39;)"><span class="hl_vardecl"><span class="mpre">hdl</span></span></a><span class="mpre">)
    | </span><a href="#loc_487_21_487_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_487_21_487_24&#39;)"><span class="hl_varref"><span class="mpre">hdl</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><a href="GHC.IO.Handle.FD.html#loc_52_1_52_6" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.FD.html#loc_52_1_52_6&#39;)"><span class="hl_varref"><span class="mpre">stdin</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_487_21_487_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_487_21_487_24&#39;)"><span class="hl_varref"><span class="mpre">hdl</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><a href="GHC.IO.Handle.FD.html#loc_63_1_63_7" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.FD.html#loc_63_1_63_7&#39;)"><span class="hl_varref"><span class="mpre">stdout</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_487_21_487_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_487_21_487_24&#39;)"><span class="hl_varref"><span class="mpre">hdl</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><a href="GHC.IO.Handle.FD.html#loc_74_1_74_7" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.FD.html#loc_74_1_74_7&#39;)"><span class="hl_varref"><span class="mpre">stderr</span></span></a><span class="mpre"> = </span><a href="GHC.IO.Handle.html#loc_86_1_86_7" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.html#loc_86_1_86_7&#39;)"><span class="hl_varref"><span class="mpre">hClose</span></span></a><span class="mpre"> </span><a href="#loc_487_21_487_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_487_21_487_24&#39;)"><span class="hl_varref"><span class="mpre">hdl</span></span></a><span class="mpre">
  </span><a href="#loc_487_3_487_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_487_3_487_13&#39;)"><span class="hl_fundecl"><span class="mpre">maybeClose</span></span></a><span class="mpre"> _ = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">

  </span><a href="#loc_492_3_492_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_492_3_492_10&#39;)"><span class="mpre">mbToStd</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><a href="GHC.IO.Handle.Types.html#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Types.html#loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Handle</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">StdStream</span></span><span class="mpre">
  </span><a name="loc_492_3_492_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_492_3_492_10&#39;)"><span class="hl_fundecl"><span class="mpre">mbToStd</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">    = </span><span class="hl_conref"><span class="mpre">Inherit</span></span><span class="mpre">
  </span><a href="#loc_492_3_492_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_492_3_492_10&#39;)"><span class="hl_fundecl"><span class="mpre">mbToStd</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_493_17_493_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_493_17_493_20&#39;)"><span class="hl_vardecl"><span class="mpre">hdl</span></span></a><span class="mpre">) = </span><span class="hl_conref"><span class="mpre">UseHandle</span></span><span class="mpre"> </span><a href="#loc_493_17_493_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_493_17_493_20&#39;)"><span class="hl_varref"><span class="mpre">hdl</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Run a command and return its output.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The output is assumed to be text in the locale encoding.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_500_1_500_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_500_1_500_16&#39;)"><span class="mpre">rawSystemStdout</span></a><span class="mpre"> :: </span><a href="Distribution.Verbosity.html#loc_58_6_58_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Verbosity.html#loc_58_6_58_15&#39;)"><span class="hl_tyconref"><span class="mpre">Verbosity</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_500_1_500_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_500_1_500_16&#39;)"><span class="hl_fundecl"><span class="mpre">rawSystemStdout</span></span></a><span class="mpre"> </span><a name="loc_500_17_500_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_500_17_500_26&#39;)"><span class="hl_vardecl"><span class="mpre">verbosity</span></span></a><span class="mpre"> </span><a name="loc_500_27_500_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_500_27_500_31&#39;)"><span class="hl_vardecl"><span class="mpre">path</span></span></a><span class="mpre"> </span><a name="loc_500_32_500_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_500_32_500_36&#39;)"><span class="hl_vardecl"><span class="mpre">args</span></span></a><span class="mpre"> = do
  (</span><a name="loc_501_4_501_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_501_4_501_10&#39;)"><span class="hl_vardecl"><span class="mpre">output</span></span></a><span class="mpre">, </span><a name="loc_501_12_501_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_501_12_501_18&#39;)"><span class="hl_vardecl"><span class="mpre">errors</span></span></a><span class="mpre">, </span><a name="loc_501_20_501_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_501_20_501_28&#39;)"><span class="hl_vardecl"><span class="mpre">exitCode</span></span></a><span class="mpre">) &lt;- </span><a href="#loc_520_1_520_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_520_1_520_18&#39;)"><span class="hl_varref"><span class="mpre">rawSystemStdInOut</span></span></a><span class="mpre"> </span><a href="#loc_500_17_500_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_500_17_500_26&#39;)"><span class="hl_varref"><span class="mpre">verbosity</span></span></a><span class="mpre"> </span><a href="#loc_500_27_500_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_500_27_500_31&#39;)"><span class="hl_varref"><span class="mpre">path</span></span></a><span class="mpre"> </span><a href="#loc_500_32_500_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_500_32_500_36&#39;)"><span class="hl_varref"><span class="mpre">args</span></span></a><span class="mpre">
                                                  </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
                                                  </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
  </span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="hl_varref"><span class="mpre">when</span></span></a><span class="mpre"> (</span><a href="#loc_501_20_501_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_501_20_501_28&#39;)"><span class="hl_varref"><span class="mpre">exitCode</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">ExitSuccess</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
    </span><a href="#loc_251_1_251_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_251_1_251_4&#39;)"><span class="hl_varref"><span class="mpre">die</span></span></a><span class="mpre"> </span><a href="#loc_501_12_501_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_501_12_501_18&#39;)"><span class="hl_varref"><span class="mpre">errors</span></span></a><span class="mpre">
  </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_501_4_501_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_501_4_501_10&#39;)"><span class="hl_varref"><span class="mpre">output</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Run a command and return its output, errors and exit status. Optionally</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- also supply some input. Also provides control over whether the binary/text</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- mode of the input and output.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_520_1_520_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_520_1_520_18&#39;)"><span class="mpre">rawSystemStdInOut</span></a><span class="mpre"> :: </span><a href="Distribution.Verbosity.html#loc_58_6_58_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Verbosity.html#loc_58_6_58_15&#39;)"><span class="hl_tyconref"><span class="mpre">Verbosity</span></span></a><span class="mpre">
                  -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">                 </span><span class="hl_comment"><span class="mpre">-- ^ Program location</span></span><span class="mpre">
                  -&gt; [</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">]                 </span><span class="hl_comment"><span class="mpre">-- ^ Arguments</span></span><span class="mpre">
                  -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">           </span><span class="hl_comment"><span class="mpre">-- ^ New working dir or inherit</span></span><span class="mpre">
                  -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> [(</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">)] </span><span class="hl_comment"><span class="mpre">-- ^ New environment or inherit</span></span><span class="mpre">
                  -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">)     </span><span class="hl_comment"><span class="mpre">-- ^ input text and binary mode</span></span><span class="mpre">
                  -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">                     </span><span class="hl_comment"><span class="mpre">-- ^ output in binary mode</span></span><span class="mpre">
                  -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">, </span><a href="GHC.IO.Exception.html#loc_205_6_205_14" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Exception.html#loc_205_6_205_14&#39;)"><span class="hl_tyconref"><span class="mpre">ExitCode</span></span></a><span class="mpre">) </span><span class="hl_comment"><span class="mpre">-- ^ output, errors, exit</span></span><span class="mpre">
</span><a name="loc_520_1_520_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_520_1_520_18&#39;)"><span class="hl_fundecl"><span class="mpre">rawSystemStdInOut</span></span></a><span class="mpre"> </span><a name="loc_520_19_520_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_520_19_520_28&#39;)"><span class="hl_vardecl"><span class="mpre">verbosity</span></span></a><span class="mpre"> </span><a name="loc_520_29_520_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_520_29_520_33&#39;)"><span class="hl_vardecl"><span class="mpre">path</span></span></a><span class="mpre"> </span><a name="loc_520_34_520_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_520_34_520_38&#39;)"><span class="hl_vardecl"><span class="mpre">args</span></span></a><span class="mpre"> </span><a name="loc_520_39_520_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_520_39_520_43&#39;)"><span class="hl_vardecl"><span class="mpre">mcwd</span></span></a><span class="mpre"> </span><a name="loc_520_44_520_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_520_44_520_48&#39;)"><span class="hl_vardecl"><span class="mpre">menv</span></span></a><span class="mpre"> </span><a name="loc_520_49_520_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_520_49_520_54&#39;)"><span class="hl_vardecl"><span class="mpre">input</span></span></a><span class="mpre"> </span><a name="loc_520_55_520_67" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_520_55_520_67&#39;)"><span class="hl_vardecl"><span class="mpre">outputBinary</span></span></a><span class="mpre"> = do
  </span><a href="#loc_372_1_372_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_372_1_372_23&#39;)"><span class="hl_varref"><span class="mpre">printRawCommandAndArgs</span></span></a><span class="mpre"> </span><a href="#loc_520_19_520_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_520_19_520_28&#39;)"><span class="hl_varref"><span class="mpre">verbosity</span></span></a><span class="mpre"> </span><a href="#loc_520_29_520_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_520_29_520_33&#39;)"><span class="hl_varref"><span class="mpre">path</span></span></a><span class="mpre"> </span><a href="#loc_520_34_520_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_520_34_520_38&#39;)"><span class="hl_varref"><span class="mpre">args</span></span></a><span class="mpre">

  </span><a href="Control.Exception.Base.html#loc_259_1_259_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Exception.Base.html#loc_259_1_259_8&#39;)"><span class="hl_varref"><span class="mpre">Exception.bracket</span></span></a><span class="mpre">
     (</span><a href="System.Process.html#loc_833_1_833_22" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Process.html#loc_833_1_833_22&#39;)"><span class="hl_varref"><span class="mpre">runInteractiveProcess</span></span></a><span class="mpre"> </span><a href="#loc_520_29_520_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_520_29_520_33&#39;)"><span class="hl_varref"><span class="mpre">path</span></span></a><span class="mpre"> </span><a href="#loc_520_34_520_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_520_34_520_38&#39;)"><span class="hl_varref"><span class="mpre">args</span></span></a><span class="mpre"> </span><a href="#loc_520_39_520_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_520_39_520_43&#39;)"><span class="hl_varref"><span class="mpre">mcwd</span></span></a><span class="mpre"> </span><a href="#loc_520_44_520_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_520_44_520_48&#39;)"><span class="hl_varref"><span class="mpre">menv</span></span></a><span class="mpre">)
     (\(</span><a name="loc_525_9_525_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_525_9_525_12&#39;)"><span class="hl_vardecl"><span class="mpre">inh</span></span></a><span class="mpre">,</span><a name="loc_525_13_525_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_525_13_525_17&#39;)"><span class="hl_vardecl"><span class="mpre">outh</span></span></a><span class="mpre">,</span><a name="loc_525_18_525_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_525_18_525_22&#39;)"><span class="hl_vardecl"><span class="mpre">errh</span></span></a><span class="mpre">,_) -&gt; </span><a href="GHC.IO.Handle.html#loc_86_1_86_7" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.html#loc_86_1_86_7&#39;)"><span class="hl_varref"><span class="mpre">hClose</span></span></a><span class="mpre"> </span><a href="#loc_525_9_525_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_525_9_525_12&#39;)"><span class="hl_varref"><span class="mpre">inh</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="GHC.IO.Handle.html#loc_86_1_86_7" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.html#loc_86_1_86_7&#39;)"><span class="hl_varref"><span class="mpre">hClose</span></span></a><span class="mpre"> </span><a href="#loc_525_13_525_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_525_13_525_17&#39;)"><span class="hl_varref"><span class="mpre">outh</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="GHC.IO.Handle.html#loc_86_1_86_7" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.html#loc_86_1_86_7&#39;)"><span class="hl_varref"><span class="mpre">hClose</span></span></a><span class="mpre"> </span><a href="#loc_525_18_525_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_525_18_525_22&#39;)"><span class="hl_varref"><span class="mpre">errh</span></span></a><span class="mpre">)
    </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \(</span><a name="loc_526_9_526_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_526_9_526_12&#39;)"><span class="hl_vardecl"><span class="mpre">inh</span></span></a><span class="mpre">,</span><a name="loc_526_13_526_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_526_13_526_17&#39;)"><span class="hl_vardecl"><span class="mpre">outh</span></span></a><span class="mpre">,</span><a name="loc_526_18_526_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_526_18_526_22&#39;)"><span class="hl_vardecl"><span class="mpre">errh</span></span></a><span class="mpre">,</span><a name="loc_526_23_526_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_526_23_526_26&#39;)"><span class="hl_vardecl"><span class="mpre">pid</span></span></a><span class="mpre">) -&gt; do

      </span><span class="hl_comment"><span class="mpre">-- output mode depends on what the caller wants</span></span><span class="mpre">
      </span><a href="GHC.IO.Handle.html#loc_559_1_559_15" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.html#loc_559_1_559_15&#39;)"><span class="hl_varref"><span class="mpre">hSetBinaryMode</span></span></a><span class="mpre"> </span><a href="#loc_526_13_526_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_526_13_526_17&#39;)"><span class="hl_varref"><span class="mpre">outh</span></span></a><span class="mpre"> </span><a href="#loc_520_55_520_67" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_520_55_520_67&#39;)"><span class="hl_varref"><span class="mpre">outputBinary</span></span></a><span class="mpre">
      </span><span class="hl_comment"><span class="mpre">-- but the errors are always assumed to be text (in the current locale)</span></span><span class="mpre">
      </span><a href="GHC.IO.Handle.html#loc_559_1_559_15" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.html#loc_559_1_559_15&#39;)"><span class="hl_varref"><span class="mpre">hSetBinaryMode</span></span></a><span class="mpre"> </span><a href="#loc_526_18_526_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_526_18_526_22&#39;)"><span class="hl_varref"><span class="mpre">errh</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">

      </span><span class="hl_comment"><span class="mpre">-- fork off a couple threads to pull on the stderr and stdout</span></span><span class="mpre">
      </span><span class="hl_comment"><span class="mpre">-- so if the process writes to stderr we do not block.</span></span><span class="mpre">

      </span><a name="loc_536_7_536_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_536_7_536_10&#39;)"><span class="hl_vardecl"><span class="mpre">err</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IO.Handle.Text.html#loc_379_1_379_13" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Text.html#loc_379_1_379_13&#39;)"><span class="hl_varref"><span class="mpre">hGetContents</span></span></a><span class="mpre"> </span><a href="#loc_526_18_526_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_526_18_526_22&#39;)"><span class="hl_varref"><span class="mpre">errh</span></span></a><span class="mpre">
      </span><a name="loc_537_7_537_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_537_7_537_10&#39;)"><span class="hl_vardecl"><span class="mpre">out</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IO.Handle.Text.html#loc_379_1_379_13" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Text.html#loc_379_1_379_13&#39;)"><span class="hl_varref"><span class="mpre">hGetContents</span></span></a><span class="mpre"> </span><a href="#loc_526_13_526_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_526_13_526_17&#39;)"><span class="hl_varref"><span class="mpre">outh</span></span></a><span class="mpre">

      </span><a name="loc_539_7_539_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_539_7_539_9&#39;)"><span class="hl_vardecl"><span class="mpre">mv</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.MVar.html#loc_64_1_64_13" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.MVar.html#loc_64_1_64_13&#39;)"><span class="hl_varref"><span class="mpre">newEmptyMVar</span></span></a><span class="mpre">
      let </span><a name="loc_540_11_540_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_540_11_540_16&#39;)"><span class="hl_fundecl"><span class="mpre">force</span></span></a><span class="mpre"> </span><a name="loc_540_17_540_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_540_17_540_20&#39;)"><span class="hl_vardecl"><span class="mpre">str</span></span></a><span class="mpre"> = (</span><a href="GHC.IO.html#loc_480_1_480_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_480_1_480_9&#39;)"><span class="hl_varref"><span class="mpre">evaluate</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_540_17_540_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_540_17_540_20&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">)
            </span><a href="Control.Exception.Base.html#loc_273_3_273_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Exception.Base.html#loc_273_3_273_12&#39;)"><span class="hl_infix"><span class="mpre">`Exception.finally`</span></span></a><span class="mpre"> </span><a href="GHC.MVar.html#loc_133_1_133_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.MVar.html#loc_133_1_133_8&#39;)"><span class="hl_varref"><span class="mpre">putMVar</span></span></a><span class="mpre"> </span><a href="#loc_539_7_539_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_539_7_539_9&#39;)"><span class="hl_varref"><span class="mpre">mv</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">
          </span><span class="hl_comment"><span class="mpre">--TODO: handle exceptions like text decoding.</span></span><span class="mpre">
      _ &lt;- </span><span class="hl_varref"><span class="mpre">forkIO</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_540_11_540_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_540_11_540_16&#39;)"><span class="hl_varref"><span class="mpre">force</span></span></a><span class="mpre"> </span><a href="#loc_537_7_537_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_537_7_537_10&#39;)"><span class="hl_varref"><span class="mpre">out</span></span></a><span class="mpre">
      _ &lt;- </span><span class="hl_varref"><span class="mpre">forkIO</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_540_11_540_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_540_11_540_16&#39;)"><span class="hl_varref"><span class="mpre">force</span></span></a><span class="mpre"> </span><a href="#loc_536_7_536_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_536_7_536_10&#39;)"><span class="hl_varref"><span class="mpre">err</span></span></a><span class="mpre">

      </span><span class="hl_comment"><span class="mpre">-- push all the input, if any</span></span><span class="mpre">
      case </span><a href="#loc_520_49_520_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_520_49_520_54&#39;)"><span class="hl_varref"><span class="mpre">input</span></span></a><span class="mpre"> of
        </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">
        </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><a name="loc_549_15_549_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_549_15_549_23&#39;)"><span class="hl_vardecl"><span class="mpre">inputStr</span></span></a><span class="mpre">, </span><a name="loc_549_25_549_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_549_25_549_36&#39;)"><span class="hl_vardecl"><span class="mpre">inputBinary</span></span></a><span class="mpre">) -&gt; do
                </span><span class="hl_comment"><span class="mpre">-- input mode depends on what the caller wants</span></span><span class="mpre">
          </span><a href="GHC.IO.Handle.html#loc_559_1_559_15" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.html#loc_559_1_559_15&#39;)"><span class="hl_varref"><span class="mpre">hSetBinaryMode</span></span></a><span class="mpre"> </span><a href="#loc_526_9_526_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_526_9_526_12&#39;)"><span class="hl_varref"><span class="mpre">inh</span></span></a><span class="mpre"> </span><a href="#loc_549_25_549_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_549_25_549_36&#39;)"><span class="hl_varref"><span class="mpre">inputBinary</span></span></a><span class="mpre">
          </span><a href="GHC.IO.Handle.Text.html#loc_529_1_529_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Text.html#loc_529_1_529_8&#39;)"><span class="hl_varref"><span class="mpre">hPutStr</span></span></a><span class="mpre"> </span><a href="#loc_526_9_526_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_526_9_526_12&#39;)"><span class="hl_varref"><span class="mpre">inh</span></span></a><span class="mpre"> </span><a href="#loc_549_15_549_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_549_15_549_23&#39;)"><span class="hl_varref"><span class="mpre">inputStr</span></span></a><span class="mpre">
          </span><a href="GHC.IO.Handle.html#loc_86_1_86_7" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.html#loc_86_1_86_7&#39;)"><span class="hl_varref"><span class="mpre">hClose</span></span></a><span class="mpre"> </span><a href="#loc_526_9_526_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_526_9_526_12&#39;)"><span class="hl_varref"><span class="mpre">inh</span></span></a><span class="mpre">
          </span><span class="hl_comment"><span class="mpre">--TODO: this probably fails if the process refuses to consume</span></span><span class="mpre">
          </span><span class="hl_comment"><span class="mpre">-- or if it closes stdin (eg if it exits)</span></span><span class="mpre">

      </span><span class="hl_comment"><span class="mpre">-- wait for both to finish, in either order</span></span><span class="mpre">
      </span><a href="GHC.MVar.html#loc_91_1_91_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.MVar.html#loc_91_1_91_9&#39;)"><span class="hl_varref"><span class="mpre">takeMVar</span></span></a><span class="mpre"> </span><a href="#loc_539_7_539_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_539_7_539_9&#39;)"><span class="hl_varref"><span class="mpre">mv</span></span></a><span class="mpre">
      </span><a href="GHC.MVar.html#loc_91_1_91_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.MVar.html#loc_91_1_91_9&#39;)"><span class="hl_varref"><span class="mpre">takeMVar</span></span></a><span class="mpre"> </span><a href="#loc_539_7_539_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_539_7_539_9&#39;)"><span class="hl_varref"><span class="mpre">mv</span></span></a><span class="mpre">

      </span><span class="hl_comment"><span class="mpre">-- wait for the program to terminate</span></span><span class="mpre">
      </span><a name="loc_562_7_562_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_562_7_562_15&#39;)"><span class="hl_vardecl"><span class="mpre">exitcode</span></span></a><span class="mpre"> &lt;- </span><a href="System.Process.html#loc_575_1_575_15" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Process.html#loc_575_1_575_15&#39;)"><span class="hl_varref"><span class="mpre">waitForProcess</span></span></a><span class="mpre"> </span><a href="#loc_526_23_526_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_526_23_526_26&#39;)"><span class="hl_varref"><span class="mpre">pid</span></span></a><span class="mpre">
      </span><a href="Control.Monad.html#loc_270_1_270_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_270_1_270_7&#39;)"><span class="hl_varref"><span class="mpre">unless</span></span></a><span class="mpre"> (</span><a href="#loc_562_7_562_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_562_7_562_15&#39;)"><span class="hl_varref"><span class="mpre">exitcode</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">ExitSuccess</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
        </span><a href="#loc_314_1_314_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_314_1_314_6&#39;)"><span class="hl_varref"><span class="mpre">debug</span></span></a><span class="mpre"> </span><a href="#loc_520_19_520_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_520_19_520_28&#39;)"><span class="hl_varref"><span class="mpre">verbosity</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_520_29_520_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_520_29_520_33&#39;)"><span class="hl_varref"><span class="mpre">path</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot; returned &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_562_7_562_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_562_7_562_15&#39;)"><span class="hl_varref"><span class="mpre">exitcode</span></span></a><span class="mpre">
                       </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> if </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_536_7_536_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_536_7_536_10&#39;)"><span class="hl_varref"><span class="mpre">err</span></span></a><span class="mpre"> then </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre"> else
                          </span><span class="hl_string"><span class="mpre">&quot; with error message:\n&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_536_7_536_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_536_7_536_10&#39;)"><span class="hl_varref"><span class="mpre">err</span></span></a><span class="mpre">
                       </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> case </span><a href="#loc_520_49_520_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_520_49_520_54&#39;)"><span class="hl_varref"><span class="mpre">input</span></span></a><span class="mpre"> of
                            </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">       -&gt; </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">
                            </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">,  _) -&gt; </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">
                            </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><a name="loc_570_35_570_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_570_35_570_38&#39;)"><span class="hl_vardecl"><span class="mpre">inp</span></span></a><span class="mpre">, _) -&gt; </span><span class="hl_string"><span class="mpre">&quot;\nstdin input:\n&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_570_35_570_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_570_35_570_38&#39;)"><span class="hl_varref"><span class="mpre">inp</span></span></a><span class="mpre">

      </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_537_7_537_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_537_7_537_10&#39;)"><span class="hl_varref"><span class="mpre">out</span></span></a><span class="mpre">, </span><a href="#loc_536_7_536_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_536_7_536_10&#39;)"><span class="hl_varref"><span class="mpre">err</span></span></a><span class="mpre">, </span><a href="#loc_562_7_562_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_562_7_562_15&#39;)"><span class="hl_varref"><span class="mpre">exitcode</span></span></a><span class="mpre">)


</span><span class="hl_comment"><span class="mpre">-- | Look for a program on the path.</span></span><span class="mpre">
</span><a href="#loc_577_1_577_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_577_1_577_20&#39;)"><span class="mpre">findProgramLocation</span></a><span class="mpre"> :: </span><a href="Distribution.Verbosity.html#loc_58_6_58_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Verbosity.html#loc_58_6_58_15&#39;)"><span class="hl_tyconref"><span class="mpre">Verbosity</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">)
</span><a name="loc_577_1_577_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_577_1_577_20&#39;)"><span class="hl_fundecl"><span class="mpre">findProgramLocation</span></span></a><span class="mpre"> </span><a name="loc_577_21_577_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_577_21_577_30&#39;)"><span class="hl_vardecl"><span class="mpre">verbosity</span></span></a><span class="mpre"> </span><a name="loc_577_31_577_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_577_31_577_35&#39;)"><span class="hl_vardecl"><span class="mpre">prog</span></span></a><span class="mpre"> = do
  </span><a href="#loc_314_1_314_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_314_1_314_6&#39;)"><span class="hl_varref"><span class="mpre">debug</span></span></a><span class="mpre"> </span><a href="#loc_577_21_577_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_577_21_577_30&#39;)"><span class="hl_varref"><span class="mpre">verbosity</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;searching for &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_577_31_577_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_577_31_577_35&#39;)"><span class="hl_varref"><span class="mpre">prog</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot; in path.&quot;</span></span><span class="mpre">
  </span><a name="loc_579_3_579_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_579_3_579_6&#39;)"><span class="hl_vardecl"><span class="mpre">res</span></span></a><span class="mpre"> &lt;- </span><a href="System.Directory.html#loc_592_1_592_15" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Directory.html#loc_592_1_592_15&#39;)"><span class="hl_varref"><span class="mpre">findExecutable</span></span></a><span class="mpre"> </span><a href="#loc_577_31_577_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_577_31_577_35&#39;)"><span class="hl_varref"><span class="mpre">prog</span></span></a><span class="mpre">
  case </span><a href="#loc_579_3_579_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_579_3_579_6&#39;)"><span class="hl_varref"><span class="mpre">res</span></span></a><span class="mpre"> of
      </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">   -&gt; </span><a href="#loc_314_1_314_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_314_1_314_6&#39;)"><span class="hl_varref"><span class="mpre">debug</span></span></a><span class="mpre"> </span><a href="#loc_577_21_577_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_577_21_577_30&#39;)"><span class="hl_varref"><span class="mpre">verbosity</span></span></a><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;Cannot find &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_577_31_577_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_577_31_577_35&#39;)"><span class="hl_varref"><span class="mpre">prog</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot; on the path&quot;</span></span><span class="mpre">)
      </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_582_12_582_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_582_12_582_16&#39;)"><span class="hl_vardecl"><span class="mpre">path</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_314_1_314_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_314_1_314_6&#39;)"><span class="hl_varref"><span class="mpre">debug</span></span></a><span class="mpre"> </span><a href="#loc_577_21_577_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_577_21_577_30&#39;)"><span class="hl_varref"><span class="mpre">verbosity</span></span></a><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;found &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_577_31_577_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_577_31_577_35&#39;)"><span class="hl_varref"><span class="mpre">prog</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot; at &quot;</span></span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_582_12_582_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_582_12_582_16&#39;)"><span class="hl_varref"><span class="mpre">path</span></span></a><span class="mpre">)
  </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_579_3_579_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_579_3_579_6&#39;)"><span class="hl_varref"><span class="mpre">res</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | Look for a program and try to find it&#39;s version number. It can accept</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- either an absolute path or the name of a program binary, in which case we</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- will look for the program on the path.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_596_1_596_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_596_1_596_19&#39;)"><span class="mpre">findProgramVersion</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">             </span><span class="hl_comment"><span class="mpre">-- ^ version args</span></span><span class="mpre">
                   -&gt; (</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">) </span><span class="hl_comment"><span class="mpre">-- ^ function to select version</span></span><span class="mpre">
                                         </span><span class="hl_comment"><span class="mpre">--   number from program output</span></span><span class="mpre">
                   -&gt; </span><a href="Distribution.Verbosity.html#loc_58_6_58_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Verbosity.html#loc_58_6_58_15&#39;)"><span class="hl_tyconref"><span class="mpre">Verbosity</span></span></a><span class="mpre">
                   -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">           </span><span class="hl_comment"><span class="mpre">-- ^ location</span></span><span class="mpre">
                   -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><a href="Data.Version.html#loc_68_6_68_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Version.html#loc_68_6_68_13&#39;)"><span class="hl_tyconref"><span class="mpre">Version</span></span></a><span class="mpre">)
</span><a name="loc_596_1_596_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_596_1_596_19&#39;)"><span class="hl_fundecl"><span class="mpre">findProgramVersion</span></span></a><span class="mpre"> </span><a name="loc_596_20_596_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_596_20_596_30&#39;)"><span class="hl_vardecl"><span class="mpre">versionArg</span></span></a><span class="mpre"> </span><a name="loc_596_31_596_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_596_31_596_44&#39;)"><span class="hl_vardecl"><span class="mpre">selectVersion</span></span></a><span class="mpre"> </span><a name="loc_596_45_596_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_596_45_596_54&#39;)"><span class="hl_vardecl"><span class="mpre">verbosity</span></span></a><span class="mpre"> </span><a name="loc_596_55_596_59" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_596_55_596_59&#39;)"><span class="hl_vardecl"><span class="mpre">path</span></span></a><span class="mpre"> = do
  </span><a name="loc_597_3_597_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_597_3_597_6&#39;)"><span class="hl_vardecl"><span class="mpre">str</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_500_1_500_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_500_1_500_16&#39;)"><span class="hl_varref"><span class="mpre">rawSystemStdout</span></span></a><span class="mpre"> </span><a href="#loc_596_45_596_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_596_45_596_54&#39;)"><span class="hl_varref"><span class="mpre">verbosity</span></span></a><span class="mpre"> </span><a href="#loc_596_55_596_59" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_596_55_596_59&#39;)"><span class="hl_varref"><span class="mpre">path</span></span></a><span class="mpre"> [</span><a href="#loc_596_20_596_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_596_20_596_30&#39;)"><span class="hl_varref"><span class="mpre">versionArg</span></span></a><span class="mpre">]
         </span><a href="Distribution.Compat.Exception.html#loc_14_1_14_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Compat.Exception.html#loc_14_1_14_8&#39;)"><span class="hl_infix"><span class="mpre">`catchIO`</span></span></a><span class="mpre">   (\_ -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">)
         </span><a href="Distribution.Compat.Exception.html#loc_17_1_17_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Compat.Exception.html#loc_17_1_17_10&#39;)"><span class="hl_infix"><span class="mpre">`catchExit`</span></span></a><span class="mpre"> (\_ -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">)
  let </span><a href="#loc_601_7_601_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_601_7_601_14&#39;)"><span class="mpre">version</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><a href="Data.Version.html#loc_68_6_68_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Version.html#loc_68_6_68_13&#39;)"><span class="hl_tyconref"><span class="mpre">Version</span></span></a><span class="mpre">
      </span><a name="loc_601_7_601_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_601_7_601_14&#39;)"><span class="hl_vardecl"><span class="mpre">version</span></span></a><span class="mpre"> = </span><a href="Distribution.Text.html#loc_39_1_39_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Text.html#loc_39_1_39_12&#39;)"><span class="hl_varref"><span class="mpre">simpleParse</span></span></a><span class="mpre"> (</span><a href="#loc_596_31_596_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_596_31_596_44&#39;)"><span class="hl_varref"><span class="mpre">selectVersion</span></span></a><span class="mpre"> </span><a href="#loc_597_3_597_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_597_3_597_6&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">)
  case </span><a href="#loc_601_7_601_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_601_7_601_14&#39;)"><span class="hl_varref"><span class="mpre">version</span></span></a><span class="mpre"> of
      </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt; </span><a href="#loc_279_1_279_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_279_1_279_5&#39;)"><span class="hl_varref"><span class="mpre">warn</span></span></a><span class="mpre"> </span><a href="#loc_596_45_596_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_596_45_596_54&#39;)"><span class="hl_varref"><span class="mpre">verbosity</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;cannot determine version of &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_596_55_596_59" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_596_55_596_59&#39;)"><span class="hl_varref"><span class="mpre">path</span></span></a><span class="mpre">
                               </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot; :\n&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_597_3_597_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_597_3_597_6&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre">
      </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_605_12_605_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_605_12_605_13&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">  -&gt; </span><a href="#loc_314_1_314_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_314_1_314_6&#39;)"><span class="hl_varref"><span class="mpre">debug</span></span></a><span class="mpre"> </span><a href="#loc_596_45_596_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_596_45_596_54&#39;)"><span class="hl_varref"><span class="mpre">verbosity</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_596_55_596_59" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_596_55_596_59&#39;)"><span class="hl_varref"><span class="mpre">path</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot; is version &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="Distribution.Text.html#loc_31_1_31_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Text.html#loc_31_1_31_8&#39;)"><span class="hl_varref"><span class="mpre">display</span></span></a><span class="mpre"> </span><a href="#loc_605_12_605_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_605_12_605_13&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">
  </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_601_7_601_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_601_7_601_14&#39;)"><span class="hl_varref"><span class="mpre">version</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | Like the unix xargs program. Useful for when we&#39;ve got very long command</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- lines that might overflow an OS limit on command line length and so you</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- need to invoke a command multiple times to get all the args in.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Use it with either of the rawSystem variants above. For example:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; xargs (32*1024) (rawSystemExit verbosity) prog fixedArgs bigArgs</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_619_1_619_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_619_1_619_6&#39;)"><span class="mpre">xargs</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; ([</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">)
      -&gt; [</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">] -&gt; [</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_619_1_619_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_619_1_619_6&#39;)"><span class="hl_fundecl"><span class="mpre">xargs</span></span></a><span class="mpre"> </span><a name="loc_619_7_619_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_619_7_619_14&#39;)"><span class="hl_vardecl"><span class="mpre">maxSize</span></span></a><span class="mpre"> </span><a name="loc_619_15_619_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_619_15_619_27&#39;)"><span class="hl_vardecl"><span class="mpre">rawSystemFun</span></span></a><span class="mpre"> </span><a name="loc_619_28_619_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_619_28_619_37&#39;)"><span class="hl_vardecl"><span class="mpre">fixedArgs</span></span></a><span class="mpre"> </span><a name="loc_619_38_619_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_619_38_619_45&#39;)"><span class="hl_vardecl"><span class="mpre">bigArgs</span></span></a><span class="mpre"> =
  let </span><a name="loc_620_7_620_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_620_7_620_19&#39;)"><span class="hl_vardecl"><span class="mpre">fixedArgSize</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">sum</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_619_28_619_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_619_28_619_37&#39;)"><span class="hl_varref"><span class="mpre">fixedArgs</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_619_28_619_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_619_28_619_37&#39;)"><span class="hl_varref"><span class="mpre">fixedArgs</span></span></a><span class="mpre">
      </span><a name="loc_621_7_621_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_621_7_621_16&#39;)"><span class="hl_vardecl"><span class="mpre">chunkSize</span></span></a><span class="mpre"> = </span><a href="#loc_619_7_619_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_619_7_619_14&#39;)"><span class="hl_varref"><span class="mpre">maxSize</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_620_7_620_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_620_7_620_19&#39;)"><span class="hl_varref"><span class="mpre">fixedArgSize</span></span></a><span class="mpre">
   in </span><span class="hl_varref"><span class="mpre">mapM_</span></span><span class="mpre"> (</span><a href="#loc_619_15_619_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_619_15_619_27&#39;)"><span class="hl_varref"><span class="mpre">rawSystemFun</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> (</span><a href="#loc_619_28_619_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_619_28_619_37&#39;)"><span class="hl_varref"><span class="mpre">fixedArgs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">)) (</span><a href="#loc_624_9_624_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_624_9_624_15&#39;)"><span class="hl_varref"><span class="mpre">chunks</span></span></a><span class="mpre"> </span><a href="#loc_621_7_621_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_621_7_621_16&#39;)"><span class="hl_varref"><span class="mpre">chunkSize</span></span></a><span class="mpre"> </span><a href="#loc_619_38_619_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_619_38_619_45&#39;)"><span class="hl_varref"><span class="mpre">bigArgs</span></span></a><span class="mpre">)

  where </span><a name="loc_624_9_624_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_624_9_624_15&#39;)"><span class="hl_fundecl"><span class="mpre">chunks</span></span></a><span class="mpre"> </span><a name="loc_624_16_624_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_624_16_624_19&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre"> = </span><a href="Data.List.html#loc_984_1_984_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_984_1_984_8&#39;)"><span class="hl_varref"><span class="mpre">unfoldr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_624_33_624_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_624_33_624_34&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> -&gt;
          if </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_624_33_624_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_624_33_624_34&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> then </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
                    else </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><a href="#loc_628_9_628_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_628_9_628_14&#39;)"><span class="hl_varref"><span class="mpre">chunk</span></span></a><span class="mpre"> [] </span><a href="#loc_624_16_624_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_624_16_624_19&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre"> </span><a href="#loc_624_33_624_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_624_33_624_34&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)

        </span><a name="loc_628_9_628_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_628_9_628_14&#39;)"><span class="hl_fundecl"><span class="mpre">chunk</span></span></a><span class="mpre"> </span><a name="loc_628_15_628_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_628_15_628_18&#39;)"><span class="hl_vardecl"><span class="mpre">acc</span></span></a><span class="mpre"> _   []     = (</span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><a href="#loc_628_15_628_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_628_15_628_18&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre">,[])
        </span><a href="#loc_628_9_628_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_628_9_628_14&#39;)"><span class="hl_fundecl"><span class="mpre">chunk</span></span></a><span class="mpre"> </span><a name="loc_629_15_629_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_629_15_629_18&#39;)"><span class="hl_vardecl"><span class="mpre">acc</span></span></a><span class="mpre"> </span><a name="loc_629_19_629_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_629_19_629_22&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre"> (</span><a name="loc_629_24_629_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_629_24_629_25&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_629_26_629_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_629_26_629_28&#39;)"><span class="hl_vardecl"><span class="mpre">ss</span></span></a><span class="mpre">)
          | </span><a href="#loc_632_17_632_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_632_17_632_21&#39;)"><span class="hl_varref"><span class="mpre">len&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_629_19_629_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_629_19_629_22&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre"> = </span><a href="#loc_628_9_628_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_628_9_628_14&#39;)"><span class="hl_varref"><span class="mpre">chunk</span></span></a><span class="mpre"> (</span><a href="#loc_629_24_629_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_629_24_629_25&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_629_15_629_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_629_15_629_18&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre">) (</span><a href="#loc_629_19_629_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_629_19_629_22&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><a href="#loc_632_17_632_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_632_17_632_21&#39;)"><span class="hl_varref"><span class="mpre">len&#39;</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_629_26_629_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_629_26_629_28&#39;)"><span class="hl_varref"><span class="mpre">ss</span></span></a><span class="mpre">
          | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">  = (</span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><a href="#loc_629_15_629_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_629_15_629_18&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre">, </span><a href="#loc_629_24_629_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_629_24_629_25&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_629_26_629_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_629_26_629_28&#39;)"><span class="hl_varref"><span class="mpre">ss</span></span></a><span class="mpre">)
          where </span><a name="loc_632_17_632_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_632_17_632_21&#39;)"><span class="hl_vardecl"><span class="mpre">len&#39;</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_629_24_629_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_629_24_629_25&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- ------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * File Utilities</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">----------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Finding files</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Find a file by looking in a search path. The file path must match exactly.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_646_1_646_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_646_1_646_9&#39;)"><span class="mpre">findFile</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">]    </span><span class="hl_comment"><span class="mpre">-- ^search locations</span></span><span class="mpre">
         -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">      </span><span class="hl_comment"><span class="mpre">-- ^File Name</span></span><span class="mpre">
         -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">
</span><a name="loc_646_1_646_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_646_1_646_9&#39;)"><span class="hl_fundecl"><span class="mpre">findFile</span></span></a><span class="mpre"> </span><a name="loc_646_10_646_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_646_10_646_20&#39;)"><span class="hl_vardecl"><span class="mpre">searchPath</span></span></a><span class="mpre"> </span><a name="loc_646_21_646_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_646_21_646_29&#39;)"><span class="hl_vardecl"><span class="mpre">fileName</span></span></a><span class="mpre"> =
  </span><a href="#loc_680_1_680_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_680_1_680_14&#39;)"><span class="hl_varref"><span class="mpre">findFirstFile</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">
    [ </span><a href="#loc_649_7_649_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_649_7_649_11&#39;)"><span class="hl_varref"><span class="mpre">path</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;/&gt;</span></span><span class="mpre"> </span><a href="#loc_646_21_646_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_646_21_646_29&#39;)"><span class="hl_varref"><span class="mpre">fileName</span></span></a><span class="mpre">
    | </span><a name="loc_649_7_649_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_649_7_649_11&#39;)"><span class="hl_vardecl"><span class="mpre">path</span></span></a><span class="mpre"> &lt;- </span><a href="Data.List.html#loc_314_1_314_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_314_1_314_4&#39;)"><span class="hl_varref"><span class="mpre">nub</span></span></a><span class="mpre"> </span><a href="#loc_646_10_646_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_646_10_646_20&#39;)"><span class="hl_varref"><span class="mpre">searchPath</span></span></a><span class="mpre">]
  </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">maybe</span></span><span class="mpre"> (</span><a href="#loc_251_1_251_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_251_1_251_4&#39;)"><span class="hl_varref"><span class="mpre">die</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_646_21_646_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_646_21_646_29&#39;)"><span class="hl_varref"><span class="mpre">fileName</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot; doesn&#39;t exist&quot;</span></span><span class="mpre">) </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Find a file by looking in a search path with one of a list of possible</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- file extensions. The file base name should be given and it will be tried</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- with each of the extensions in each element of the search path.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_660_1_660_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_660_1_660_22&#39;)"><span class="mpre">findFileWithExtension</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">]
                      -&gt; [</span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">]
                      -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">
                      -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">)
</span><a name="loc_660_1_660_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_660_1_660_22&#39;)"><span class="hl_fundecl"><span class="mpre">findFileWithExtension</span></span></a><span class="mpre"> </span><a name="loc_660_23_660_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_660_23_660_33&#39;)"><span class="hl_vardecl"><span class="mpre">extensions</span></span></a><span class="mpre"> </span><a name="loc_660_34_660_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_660_34_660_44&#39;)"><span class="hl_vardecl"><span class="mpre">searchPath</span></span></a><span class="mpre"> </span><a name="loc_660_45_660_53" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_660_45_660_53&#39;)"><span class="hl_vardecl"><span class="mpre">baseName</span></span></a><span class="mpre"> =
  </span><a href="#loc_680_1_680_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_680_1_680_14&#39;)"><span class="hl_varref"><span class="mpre">findFirstFile</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">
    [ </span><a href="#loc_663_7_663_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_663_7_663_11&#39;)"><span class="hl_varref"><span class="mpre">path</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;/&gt;</span></span><span class="mpre"> </span><a href="#loc_660_45_660_53" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_660_45_660_53&#39;)"><span class="hl_varref"><span class="mpre">baseName</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;.&gt;</span></span><span class="mpre"> </span><a href="#loc_664_7_664_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_664_7_664_10&#39;)"><span class="hl_varref"><span class="mpre">ext</span></span></a><span class="mpre">
    | </span><a name="loc_663_7_663_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_663_7_663_11&#39;)"><span class="hl_vardecl"><span class="mpre">path</span></span></a><span class="mpre"> &lt;- </span><a href="Data.List.html#loc_314_1_314_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_314_1_314_4&#39;)"><span class="hl_varref"><span class="mpre">nub</span></span></a><span class="mpre"> </span><a href="#loc_660_34_660_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_660_34_660_44&#39;)"><span class="hl_varref"><span class="mpre">searchPath</span></span></a><span class="mpre">
    , </span><a name="loc_664_7_664_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_664_7_664_10&#39;)"><span class="hl_vardecl"><span class="mpre">ext</span></span></a><span class="mpre"> &lt;- </span><a href="Data.List.html#loc_314_1_314_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_314_1_314_4&#39;)"><span class="hl_varref"><span class="mpre">nub</span></span></a><span class="mpre"> </span><a href="#loc_660_23_660_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_660_23_660_33&#39;)"><span class="hl_varref"><span class="mpre">extensions</span></span></a><span class="mpre"> ]

</span><span class="hl_comment"><span class="mpre">-- | Like &#39;findFileWithExtension&#39; but returns which element of the search path</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the file was found in, and the file path relative to that base directory.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_673_1_673_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_673_1_673_23&#39;)"><span class="mpre">findFileWithExtension&#39;</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">]
                       -&gt; [</span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">]
                       -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">
                       -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">))
</span><a name="loc_673_1_673_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_673_1_673_23&#39;)"><span class="hl_fundecl"><span class="mpre">findFileWithExtension&#39;</span></span></a><span class="mpre"> </span><a name="loc_673_24_673_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_673_24_673_34&#39;)"><span class="hl_vardecl"><span class="mpre">extensions</span></span></a><span class="mpre"> </span><a name="loc_673_35_673_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_673_35_673_45&#39;)"><span class="hl_vardecl"><span class="mpre">searchPath</span></span></a><span class="mpre"> </span><a name="loc_673_46_673_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_673_46_673_54&#39;)"><span class="hl_vardecl"><span class="mpre">baseName</span></span></a><span class="mpre"> =
  </span><a href="#loc_680_1_680_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_680_1_680_14&#39;)"><span class="hl_varref"><span class="mpre">findFirstFile</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">uncurry</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">(&lt;/&gt;)</span></span><span class="mpre">)
    [ (</span><a href="#loc_676_7_676_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_676_7_676_11&#39;)"><span class="hl_varref"><span class="mpre">path</span></span></a><span class="mpre">, </span><a href="#loc_673_46_673_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_673_46_673_54&#39;)"><span class="hl_varref"><span class="mpre">baseName</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;.&gt;</span></span><span class="mpre"> </span><a href="#loc_677_7_677_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_677_7_677_10&#39;)"><span class="hl_varref"><span class="mpre">ext</span></span></a><span class="mpre">)
    | </span><a name="loc_676_7_676_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_676_7_676_11&#39;)"><span class="hl_vardecl"><span class="mpre">path</span></span></a><span class="mpre"> &lt;- </span><a href="Data.List.html#loc_314_1_314_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_314_1_314_4&#39;)"><span class="hl_varref"><span class="mpre">nub</span></span></a><span class="mpre"> </span><a href="#loc_673_35_673_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_673_35_673_45&#39;)"><span class="hl_varref"><span class="mpre">searchPath</span></span></a><span class="mpre">
    , </span><a name="loc_677_7_677_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_677_7_677_10&#39;)"><span class="hl_vardecl"><span class="mpre">ext</span></span></a><span class="mpre"> &lt;- </span><a href="Data.List.html#loc_314_1_314_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_314_1_314_4&#39;)"><span class="hl_varref"><span class="mpre">nub</span></span></a><span class="mpre"> </span><a href="#loc_673_24_673_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_673_24_673_34&#39;)"><span class="hl_varref"><span class="mpre">extensions</span></span></a><span class="mpre"> ]

</span><a href="#loc_680_1_680_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_680_1_680_14&#39;)"><span class="mpre">findFirstFile</span></a><span class="mpre"> :: (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">) -&gt; [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
</span><a name="loc_680_1_680_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_680_1_680_14&#39;)"><span class="hl_fundecl"><span class="mpre">findFirstFile</span></span></a><span class="mpre"> </span><a name="loc_680_15_680_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_680_15_680_19&#39;)"><span class="hl_vardecl"><span class="mpre">file</span></span></a><span class="mpre"> = </span><a href="#loc_681_9_681_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_681_9_681_18&#39;)"><span class="hl_varref"><span class="mpre">findFirst</span></span></a><span class="mpre">
  where </span><a name="loc_681_9_681_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_681_9_681_18&#39;)"><span class="hl_fundecl"><span class="mpre">findFirst</span></span></a><span class="mpre"> []     = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
        </span><a href="#loc_681_9_681_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_681_9_681_18&#39;)"><span class="hl_fundecl"><span class="mpre">findFirst</span></span></a><span class="mpre"> (</span><a name="loc_682_20_682_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_682_20_682_21&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_682_22_682_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_682_22_682_24&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) = do </span><a name="loc_682_31_682_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_682_31_682_37&#39;)"><span class="hl_vardecl"><span class="mpre">exists</span></span></a><span class="mpre"> &lt;- </span><a href="System.Directory.html#loc_726_1_726_14" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Directory.html#loc_726_1_726_14&#39;)"><span class="hl_varref"><span class="mpre">doesFileExist</span></span></a><span class="mpre"> (</span><a href="#loc_680_15_680_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_680_15_680_19&#39;)"><span class="hl_varref"><span class="mpre">file</span></span></a><span class="mpre"> </span><a href="#loc_682_20_682_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_682_20_682_21&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)
                              if </span><a href="#loc_682_31_682_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_682_31_682_37&#39;)"><span class="hl_varref"><span class="mpre">exists</span></span></a><span class="mpre">
                                then </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="#loc_682_20_682_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_682_20_682_21&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)
                                else </span><a href="#loc_681_9_681_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_681_9_681_18&#39;)"><span class="hl_varref"><span class="mpre">findFirst</span></span></a><span class="mpre"> </span><a href="#loc_682_22_682_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_682_22_682_24&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Finds the files corresponding to a list of Haskell module names.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- As &#39;findModuleFile&#39; but for a list of module names.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_695_1_695_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_695_1_695_16&#39;)"><span class="mpre">findModuleFiles</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">]   </span><span class="hl_comment"><span class="mpre">-- ^ build prefix (location of objects)</span></span><span class="mpre">
                -&gt; [</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">]     </span><span class="hl_comment"><span class="mpre">-- ^ search suffixes</span></span><span class="mpre">
                -&gt; [</span><a href="Distribution.ModuleName.html#loc_67_9_67_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.ModuleName.html#loc_67_9_67_19&#39;)"><span class="hl_tyconref"><span class="mpre">ModuleName</span></span></a><span class="mpre">] </span><span class="hl_comment"><span class="mpre">-- ^ modules</span></span><span class="mpre">
                -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> [(</span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">)]
</span><a name="loc_695_1_695_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_695_1_695_16&#39;)"><span class="hl_fundecl"><span class="mpre">findModuleFiles</span></span></a><span class="mpre"> </span><a name="loc_695_17_695_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_695_17_695_27&#39;)"><span class="hl_vardecl"><span class="mpre">searchPath</span></span></a><span class="mpre"> </span><a name="loc_695_28_695_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_695_28_695_38&#39;)"><span class="hl_vardecl"><span class="mpre">extensions</span></span></a><span class="mpre"> </span><a name="loc_695_39_695_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_695_39_695_50&#39;)"><span class="hl_vardecl"><span class="mpre">moduleNames</span></span></a><span class="mpre"> =
  </span><span class="hl_varref"><span class="mpre">mapM</span></span><span class="mpre"> (</span><a href="#loc_707_1_707_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_707_1_707_15&#39;)"><span class="hl_varref"><span class="mpre">findModuleFile</span></span></a><span class="mpre"> </span><a href="#loc_695_17_695_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_695_17_695_27&#39;)"><span class="hl_varref"><span class="mpre">searchPath</span></span></a><span class="mpre"> </span><a href="#loc_695_28_695_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_695_28_695_38&#39;)"><span class="hl_varref"><span class="mpre">extensions</span></span></a><span class="mpre">) </span><a href="#loc_695_39_695_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_695_39_695_50&#39;)"><span class="hl_varref"><span class="mpre">moduleNames</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Find the file corresponding to a Haskell module name.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This is similar to &#39;findFileWithExtension&#39;&#39; but specialised to a module</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- name. The function fails if the file corresponding to the module is missing.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_707_1_707_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_707_1_707_15&#39;)"><span class="mpre">findModuleFile</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">]  </span><span class="hl_comment"><span class="mpre">-- ^ build prefix (location of objects)</span></span><span class="mpre">
               -&gt; [</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">]    </span><span class="hl_comment"><span class="mpre">-- ^ search suffixes</span></span><span class="mpre">
               -&gt; </span><a href="Distribution.ModuleName.html#loc_67_9_67_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.ModuleName.html#loc_67_9_67_19&#39;)"><span class="hl_tyconref"><span class="mpre">ModuleName</span></span></a><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- ^ module</span></span><span class="mpre">
               -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">)
</span><a name="loc_707_1_707_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_707_1_707_15&#39;)"><span class="hl_fundecl"><span class="mpre">findModuleFile</span></span></a><span class="mpre"> </span><a name="loc_707_16_707_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_707_16_707_26&#39;)"><span class="hl_vardecl"><span class="mpre">searchPath</span></span></a><span class="mpre"> </span><a name="loc_707_27_707_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_707_27_707_37&#39;)"><span class="hl_vardecl"><span class="mpre">extensions</span></span></a><span class="mpre"> </span><a name="loc_707_38_707_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_707_38_707_48&#39;)"><span class="hl_vardecl"><span class="mpre">moduleName</span></span></a><span class="mpre"> =
      </span><span class="hl_varref"><span class="mpre">maybe</span></span><span class="mpre"> </span><a href="#loc_712_5_712_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_712_5_712_13&#39;)"><span class="hl_varref"><span class="mpre">notFound</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre">
  </span><span class="hl_infix"><span class="mpre">=&lt;&lt;</span></span><span class="mpre"> </span><a href="#loc_673_1_673_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_673_1_673_23&#39;)"><span class="hl_varref"><span class="mpre">findFileWithExtension&#39;</span></span></a><span class="mpre"> </span><a href="#loc_707_27_707_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_707_27_707_37&#39;)"><span class="hl_varref"><span class="mpre">extensions</span></span></a><span class="mpre"> </span><a href="#loc_707_16_707_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_707_16_707_26&#39;)"><span class="hl_varref"><span class="mpre">searchPath</span></span></a><span class="mpre">
                             (</span><a href="Distribution.ModuleName.html#loc_133_1_133_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.ModuleName.html#loc_133_1_133_11&#39;)"><span class="hl_varref"><span class="mpre">ModuleName.toFilePath</span></span></a><span class="mpre"> </span><a href="#loc_707_38_707_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_707_38_707_48&#39;)"><span class="hl_varref"><span class="mpre">moduleName</span></span></a><span class="mpre">)
  where
    </span><a name="loc_712_5_712_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_712_5_712_13&#39;)"><span class="hl_vardecl"><span class="mpre">notFound</span></span></a><span class="mpre"> = </span><a href="#loc_251_1_251_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_251_1_251_4&#39;)"><span class="hl_varref"><span class="mpre">die</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Error: Could not find module: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="Distribution.Text.html#loc_31_1_31_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Text.html#loc_31_1_31_8&#39;)"><span class="hl_varref"><span class="mpre">display</span></span></a><span class="mpre"> </span><a href="#loc_707_38_707_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_707_38_707_48&#39;)"><span class="hl_varref"><span class="mpre">moduleName</span></span></a><span class="mpre">
                  </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot; with any suffix: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_707_27_707_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_707_27_707_37&#39;)"><span class="hl_varref"><span class="mpre">extensions</span></span></a><span class="mpre">
                  </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot; in the search path: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_707_16_707_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_707_16_707_26&#39;)"><span class="hl_varref"><span class="mpre">searchPath</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | List all the files in a directory and all subdirectories.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The order places files in sub-directories after all the files in their</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- parent directories. The list is generated lazily so is not well defined if</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the source directory structure changes before the list is used.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_723_1_723_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_723_1_723_30&#39;)"><span class="mpre">getDirectoryContentsRecursive</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">]
</span><a name="loc_723_1_723_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_723_1_723_30&#39;)"><span class="hl_fundecl"><span class="mpre">getDirectoryContentsRecursive</span></span></a><span class="mpre"> </span><a name="loc_723_31_723_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_723_31_723_37&#39;)"><span class="hl_vardecl"><span class="mpre">topdir</span></span></a><span class="mpre"> = </span><a href="#loc_726_5_726_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_726_5_726_23&#39;)"><span class="hl_varref"><span class="mpre">recurseDirectories</span></span></a><span class="mpre"> [</span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">]
  where
    </span><a href="#loc_726_5_726_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_726_5_726_23&#39;)"><span class="mpre">recurseDirectories</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">]
    </span><a name="loc_726_5_726_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_726_5_726_23&#39;)"><span class="hl_fundecl"><span class="mpre">recurseDirectories</span></span></a><span class="mpre"> []         = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> []
    </span><a href="#loc_726_5_726_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_726_5_726_23&#39;)"><span class="hl_fundecl"><span class="mpre">recurseDirectories</span></span></a><span class="mpre"> (</span><a name="loc_727_25_727_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_727_25_727_28&#39;)"><span class="hl_vardecl"><span class="mpre">dir</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_727_29_727_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_727_29_727_33&#39;)"><span class="hl_vardecl"><span class="mpre">dirs</span></span></a><span class="mpre">) = </span><a href="GHC.IO.html#loc_213_1_213_19" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_213_1_213_19&#39;)"><span class="hl_varref"><span class="mpre">unsafeInterleaveIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
      (</span><a name="loc_728_8_728_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_728_8_728_13&#39;)"><span class="hl_vardecl"><span class="mpre">files</span></span></a><span class="mpre">, </span><a name="loc_728_15_728_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_728_15_728_20&#39;)"><span class="hl_vardecl"><span class="mpre">dirs&#39;</span></span></a><span class="mpre">) &lt;- </span><a href="#loc_733_9_733_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_733_9_733_16&#39;)"><span class="hl_varref"><span class="mpre">collect</span></span></a><span class="mpre"> [] [] </span><span class="hl_infix"><span class="mpre">=&lt;&lt;</span></span><span class="mpre"> </span><a href="System.Directory.html#loc_628_1_628_21" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Directory.html#loc_628_1_628_21&#39;)"><span class="hl_varref"><span class="mpre">getDirectoryContents</span></span></a><span class="mpre"> (</span><a href="#loc_723_31_723_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_723_31_723_37&#39;)"><span class="hl_varref"><span class="mpre">topdir</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;/&gt;</span></span><span class="mpre"> </span><a href="#loc_727_25_727_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_727_25_727_28&#39;)"><span class="hl_varref"><span class="mpre">dir</span></span></a><span class="mpre">)
      </span><a name="loc_729_7_729_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_729_7_729_13&#39;)"><span class="hl_vardecl"><span class="mpre">files&#39;</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_726_5_726_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_726_5_726_23&#39;)"><span class="hl_varref"><span class="mpre">recurseDirectories</span></span></a><span class="mpre"> (</span><a href="#loc_728_15_728_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_728_15_728_20&#39;)"><span class="hl_varref"><span class="mpre">dirs&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_727_29_727_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_727_29_727_33&#39;)"><span class="hl_varref"><span class="mpre">dirs</span></span></a><span class="mpre">)
      </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_728_8_728_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_728_8_728_13&#39;)"><span class="hl_varref"><span class="mpre">files</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_729_7_729_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_729_7_729_13&#39;)"><span class="hl_varref"><span class="mpre">files&#39;</span></span></a><span class="mpre">)

      where
        </span><a name="loc_733_9_733_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_733_9_733_16&#39;)"><span class="hl_fundecl"><span class="mpre">collect</span></span></a><span class="mpre"> </span><a name="loc_733_17_733_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_733_17_733_22&#39;)"><span class="hl_vardecl"><span class="mpre">files</span></span></a><span class="mpre"> </span><a name="loc_733_23_733_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_733_23_733_28&#39;)"><span class="hl_vardecl"><span class="mpre">dirs&#39;</span></span></a><span class="mpre"> []              = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><a href="#loc_733_17_733_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_733_17_733_22&#39;)"><span class="hl_varref"><span class="mpre">files</span></span></a><span class="mpre">, </span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><a href="#loc_733_23_733_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_733_23_733_28&#39;)"><span class="hl_varref"><span class="mpre">dirs&#39;</span></span></a><span class="mpre">)
        </span><a href="#loc_733_9_733_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_733_9_733_16&#39;)"><span class="hl_fundecl"><span class="mpre">collect</span></span></a><span class="mpre"> </span><a name="loc_734_17_734_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_734_17_734_22&#39;)"><span class="hl_vardecl"><span class="mpre">files</span></span></a><span class="mpre"> </span><a name="loc_734_23_734_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_734_23_734_28&#39;)"><span class="hl_vardecl"><span class="mpre">dirs&#39;</span></span></a><span class="mpre"> (</span><a name="loc_734_30_734_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_734_30_734_35&#39;)"><span class="hl_vardecl"><span class="mpre">entry</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_734_36_734_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_734_36_734_43&#39;)"><span class="hl_vardecl"><span class="mpre">entries</span></span></a><span class="mpre">) | </span><a href="#loc_743_9_743_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_743_9_743_15&#39;)"><span class="hl_varref"><span class="mpre">ignore</span></span></a><span class="mpre"> </span><a href="#loc_734_30_734_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_734_30_734_35&#39;)"><span class="hl_varref"><span class="mpre">entry</span></span></a><span class="mpre">
                                            = </span><a href="#loc_733_9_733_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_733_9_733_16&#39;)"><span class="hl_varref"><span class="mpre">collect</span></span></a><span class="mpre"> </span><a href="#loc_734_17_734_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_734_17_734_22&#39;)"><span class="hl_varref"><span class="mpre">files</span></span></a><span class="mpre"> </span><a href="#loc_734_23_734_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_734_23_734_28&#39;)"><span class="hl_varref"><span class="mpre">dirs&#39;</span></span></a><span class="mpre"> </span><a href="#loc_734_36_734_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_734_36_734_43&#39;)"><span class="hl_varref"><span class="mpre">entries</span></span></a><span class="mpre">
        </span><a href="#loc_733_9_733_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_733_9_733_16&#39;)"><span class="hl_fundecl"><span class="mpre">collect</span></span></a><span class="mpre"> </span><a name="loc_736_17_736_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_736_17_736_22&#39;)"><span class="hl_vardecl"><span class="mpre">files</span></span></a><span class="mpre"> </span><a name="loc_736_23_736_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_736_23_736_28&#39;)"><span class="hl_vardecl"><span class="mpre">dirs&#39;</span></span></a><span class="mpre"> (</span><a name="loc_736_30_736_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_736_30_736_35&#39;)"><span class="hl_vardecl"><span class="mpre">entry</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_736_36_736_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_736_36_736_43&#39;)"><span class="hl_vardecl"><span class="mpre">entries</span></span></a><span class="mpre">) = do
          let </span><a name="loc_737_15_737_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_737_15_737_23&#39;)"><span class="hl_vardecl"><span class="mpre">dirEntry</span></span></a><span class="mpre"> = </span><a href="#loc_727_25_727_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_727_25_727_28&#39;)"><span class="hl_varref"><span class="mpre">dir</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;/&gt;</span></span><span class="mpre"> </span><a href="#loc_736_30_736_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_736_30_736_35&#39;)"><span class="hl_varref"><span class="mpre">entry</span></span></a><span class="mpre">
          </span><a name="loc_738_11_738_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_738_11_738_22&#39;)"><span class="hl_vardecl"><span class="mpre">isDirectory</span></span></a><span class="mpre"> &lt;- </span><a href="System.Directory.html#loc_717_1_717_19" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Directory.html#loc_717_1_717_19&#39;)"><span class="hl_varref"><span class="mpre">doesDirectoryExist</span></span></a><span class="mpre"> (</span><a href="#loc_723_31_723_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_723_31_723_37&#39;)"><span class="hl_varref"><span class="mpre">topdir</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;/&gt;</span></span><span class="mpre"> </span><a href="#loc_737_15_737_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_737_15_737_23&#39;)"><span class="hl_varref"><span class="mpre">dirEntry</span></span></a><span class="mpre">)
          if </span><a href="#loc_738_11_738_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_738_11_738_22&#39;)"><span class="hl_varref"><span class="mpre">isDirectory</span></span></a><span class="mpre">
            then </span><a href="#loc_733_9_733_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_733_9_733_16&#39;)"><span class="hl_varref"><span class="mpre">collect</span></span></a><span class="mpre"> </span><a href="#loc_736_17_736_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_736_17_736_22&#39;)"><span class="hl_varref"><span class="mpre">files</span></span></a><span class="mpre"> (</span><a href="#loc_737_15_737_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_737_15_737_23&#39;)"><span class="hl_varref"><span class="mpre">dirEntry</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_736_23_736_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_736_23_736_28&#39;)"><span class="hl_varref"><span class="mpre">dirs&#39;</span></span></a><span class="mpre">) </span><a href="#loc_736_36_736_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_736_36_736_43&#39;)"><span class="hl_varref"><span class="mpre">entries</span></span></a><span class="mpre">
            else </span><a href="#loc_733_9_733_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_733_9_733_16&#39;)"><span class="hl_varref"><span class="mpre">collect</span></span></a><span class="mpre"> (</span><a href="#loc_737_15_737_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_737_15_737_23&#39;)"><span class="hl_varref"><span class="mpre">dirEntry</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_736_17_736_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_736_17_736_22&#39;)"><span class="hl_varref"><span class="mpre">files</span></span></a><span class="mpre">) </span><a href="#loc_736_23_736_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_736_23_736_28&#39;)"><span class="hl_varref"><span class="mpre">dirs&#39;</span></span></a><span class="mpre"> </span><a href="#loc_736_36_736_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_736_36_736_43&#39;)"><span class="hl_varref"><span class="mpre">entries</span></span></a><span class="mpre">

        </span><a name="loc_743_9_743_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_743_9_743_15&#39;)"><span class="hl_fundecl"><span class="mpre">ignore</span></span></a><span class="mpre"> [</span><span class="hl_char"><span class="mpre">&#39;.&#39;</span></span><span class="mpre">]      = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
        </span><a href="#loc_743_9_743_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_743_9_743_15&#39;)"><span class="hl_fundecl"><span class="mpre">ignore</span></span></a><span class="mpre"> [</span><span class="hl_char"><span class="mpre">&#39;.&#39;</span></span><span class="mpre">, </span><span class="hl_char"><span class="mpre">&#39;.&#39;</span></span><span class="mpre">] = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
        </span><a href="#loc_743_9_743_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_743_9_743_15&#39;)"><span class="hl_fundecl"><span class="mpre">ignore</span></span></a><span class="mpre"> _          = </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Environment variables</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Is this directory in the system search path?</span></span><span class="mpre">
</span><a href="#loc_752_1_752_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_752_1_752_15&#39;)"><span class="mpre">isInSearchPath</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_752_1_752_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_752_1_752_15&#39;)"><span class="hl_fundecl"><span class="mpre">isInSearchPath</span></span></a><span class="mpre"> </span><a name="loc_752_16_752_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_752_16_752_20&#39;)"><span class="hl_vardecl"><span class="mpre">path</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">elem</span></span><span class="mpre"> </span><a href="#loc_752_16_752_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_752_16_752_20&#39;)"><span class="hl_varref"><span class="mpre">path</span></span></a><span class="mpre">) </span><span class="hl_varref"><span class="mpre">getSearchPath</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">----------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- File globbing</span></span><span class="mpre">

data </span><a name="loc_757_6_757_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_757_6_757_14&#39;)"><span class="hl_tycondecl"><span class="mpre">FileGlob</span></span></a><span class="mpre">
   </span><span class="hl_comment"><span class="mpre">-- | No glob at all, just an ordinary file</span></span><span class="mpre">
   = </span><a name="loc_759_6_759_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_759_6_759_12&#39;)"><span class="hl_condecl"><span class="mpre">NoGlob</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">

   </span><span class="hl_comment"><span class="mpre">-- | dir prefix and extension, like @\&quot;foo\/bar\/\*.baz\&quot;@ corresponds to</span></span><span class="mpre">
   </span><span class="hl_comment"><span class="mpre">--    @FileGlob \&quot;foo\/bar\&quot; \&quot;.baz\&quot;@</span></span><span class="mpre">
   | </span><a name="loc_763_6_763_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_763_6_763_14&#39;)"><span class="hl_condecl"><span class="mpre">FileGlob</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">

</span><a href="#loc_766_1_766_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_766_1_766_14&#39;)"><span class="mpre">parseFileGlob</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><a href="#loc_757_6_757_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_757_6_757_14&#39;)"><span class="hl_tyconref"><span class="mpre">FileGlob</span></span></a><span class="mpre">
</span><a name="loc_766_1_766_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_766_1_766_14&#39;)"><span class="hl_fundecl"><span class="mpre">parseFileGlob</span></span></a><span class="mpre"> </span><a name="loc_766_15_766_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_766_15_766_23&#39;)"><span class="hl_vardecl"><span class="mpre">filepath</span></span></a><span class="mpre"> = case </span><span class="hl_varref"><span class="mpre">splitExtensions</span></span><span class="mpre"> </span><a href="#loc_766_15_766_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_766_15_766_23&#39;)"><span class="hl_varref"><span class="mpre">filepath</span></span></a><span class="mpre"> of
  (</span><a name="loc_767_4_767_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_767_4_767_13&#39;)"><span class="hl_vardecl"><span class="mpre">filepath&#39;</span></span></a><span class="mpre">, </span><a name="loc_767_15_767_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_767_15_767_18&#39;)"><span class="hl_vardecl"><span class="mpre">ext</span></span></a><span class="mpre">) -&gt; case </span><span class="hl_varref"><span class="mpre">splitFileName</span></span><span class="mpre"> </span><a href="#loc_767_4_767_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_767_4_767_13&#39;)"><span class="hl_varref"><span class="mpre">filepath&#39;</span></span></a><span class="mpre"> of
    (</span><a name="loc_768_6_768_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_768_6_768_9&#39;)"><span class="hl_vardecl"><span class="mpre">dir</span></span></a><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;*&quot;</span></span><span class="mpre">) | </span><span class="hl_char"><span class="mpre">&#39;*&#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`elem`</span></span><span class="mpre"> </span><a href="#loc_768_6_768_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_768_6_768_9&#39;)"><span class="hl_varref"><span class="mpre">dir</span></span></a><span class="mpre">
              </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;*&#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`elem`</span></span><span class="mpre"> </span><a href="#loc_767_15_767_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_767_15_767_18&#39;)"><span class="hl_varref"><span class="mpre">ext</span></span></a><span class="mpre">
              </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_767_15_767_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_767_15_767_18&#39;)"><span class="hl_varref"><span class="mpre">ext</span></span></a><span class="mpre">            -&gt; </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
               | </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_768_6_768_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_768_6_768_9&#39;)"><span class="hl_varref"><span class="mpre">dir</span></span></a><span class="mpre">            -&gt; </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><a href="#loc_763_6_763_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_763_6_763_14&#39;)"><span class="hl_conref"><span class="mpre">FileGlob</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;.&quot;</span></span><span class="mpre"> </span><a href="#loc_767_15_767_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_767_15_767_18&#39;)"><span class="hl_varref"><span class="mpre">ext</span></span></a><span class="mpre">)
               | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">           -&gt; </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><a href="#loc_763_6_763_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_763_6_763_14&#39;)"><span class="hl_conref"><span class="mpre">FileGlob</span></span></a><span class="mpre"> </span><a href="#loc_768_6_768_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_768_6_768_9&#39;)"><span class="hl_varref"><span class="mpre">dir</span></span></a><span class="mpre"> </span><a href="#loc_767_15_767_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_767_15_767_18&#39;)"><span class="hl_varref"><span class="mpre">ext</span></span></a><span class="mpre">)
    _          | </span><span class="hl_char"><span class="mpre">&#39;*&#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`elem`</span></span><span class="mpre"> </span><a href="#loc_766_15_766_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_766_15_766_23&#39;)"><span class="hl_varref"><span class="mpre">filepath</span></span></a><span class="mpre"> -&gt; </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
               | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">           -&gt; </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><a href="#loc_759_6_759_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_759_6_759_12&#39;)"><span class="hl_conref"><span class="mpre">NoGlob</span></span></a><span class="mpre"> </span><a href="#loc_766_15_766_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_766_15_766_23&#39;)"><span class="hl_varref"><span class="mpre">filepath</span></span></a><span class="mpre">)

</span><a href="#loc_777_1_777_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_777_1_777_14&#39;)"><span class="mpre">matchFileGlob</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">]
</span><a name="loc_777_1_777_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_777_1_777_14&#39;)"><span class="hl_vardecl"><span class="mpre">matchFileGlob</span></span></a><span class="mpre"> = </span><a href="#loc_780_1_780_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_780_1_780_17&#39;)"><span class="hl_varref"><span class="mpre">matchDirFileGlob</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;.&quot;</span></span><span class="mpre">

</span><a href="#loc_780_1_780_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_780_1_780_17&#39;)"><span class="mpre">matchDirFileGlob</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">]
</span><a name="loc_780_1_780_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_780_1_780_17&#39;)"><span class="hl_fundecl"><span class="mpre">matchDirFileGlob</span></span></a><span class="mpre"> </span><a name="loc_780_18_780_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_780_18_780_21&#39;)"><span class="hl_vardecl"><span class="mpre">dir</span></span></a><span class="mpre"> </span><a name="loc_780_22_780_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_780_22_780_30&#39;)"><span class="hl_vardecl"><span class="mpre">filepath</span></span></a><span class="mpre"> = case </span><a href="#loc_766_1_766_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_766_1_766_14&#39;)"><span class="hl_varref"><span class="mpre">parseFileGlob</span></span></a><span class="mpre"> </span><a href="#loc_780_22_780_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_780_22_780_30&#39;)"><span class="hl_varref"><span class="mpre">filepath</span></span></a><span class="mpre"> of
  </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt; </span><a href="#loc_251_1_251_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_251_1_251_4&#39;)"><span class="hl_varref"><span class="mpre">die</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;invalid file glob &#39;&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_780_22_780_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_780_22_780_30&#39;)"><span class="hl_varref"><span class="mpre">filepath</span></span></a><span class="mpre">
                </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&#39;. Wildcards &#39;*&#39; are only allowed in place of the file&quot;</span></span><span class="mpre">
                </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot; name, not in the directory name or file extension.&quot;</span></span><span class="mpre">
                </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot; If a wildcard is used it must be with an file extension.&quot;</span></span><span class="mpre">
  </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><a href="#loc_759_6_759_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_759_6_759_12&#39;)"><span class="hl_conref"><span class="mpre">NoGlob</span></span></a><span class="mpre"> </span><a name="loc_785_16_785_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_785_16_785_25&#39;)"><span class="hl_vardecl"><span class="mpre">filepath&#39;</span></span></a><span class="mpre">) -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> [</span><a href="#loc_785_16_785_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_785_16_785_25&#39;)"><span class="hl_varref"><span class="mpre">filepath&#39;</span></span></a><span class="mpre">]
  </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><a href="#loc_763_6_763_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_763_6_763_14&#39;)"><span class="hl_conref"><span class="mpre">FileGlob</span></span></a><span class="mpre"> </span><a name="loc_786_18_786_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_786_18_786_22&#39;)"><span class="hl_vardecl"><span class="mpre">dir&#39;</span></span></a><span class="mpre"> </span><a name="loc_786_23_786_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_786_23_786_26&#39;)"><span class="hl_vardecl"><span class="mpre">ext</span></span></a><span class="mpre">) -&gt; do
    </span><a name="loc_787_5_787_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_787_5_787_10&#39;)"><span class="hl_vardecl"><span class="mpre">files</span></span></a><span class="mpre"> &lt;- </span><a href="System.Directory.html#loc_628_1_628_21" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Directory.html#loc_628_1_628_21&#39;)"><span class="hl_varref"><span class="mpre">getDirectoryContents</span></span></a><span class="mpre"> (</span><a href="#loc_780_18_780_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_780_18_780_21&#39;)"><span class="hl_varref"><span class="mpre">dir</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;/&gt;</span></span><span class="mpre"> </span><a href="#loc_786_18_786_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_786_18_786_22&#39;)"><span class="hl_varref"><span class="mpre">dir&#39;</span></span></a><span class="mpre">)
    case   [ </span><a href="#loc_786_18_786_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_786_18_786_22&#39;)"><span class="hl_varref"><span class="mpre">dir&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;/&gt;</span></span><span class="mpre"> </span><a href="#loc_789_14_789_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_789_14_789_18&#39;)"><span class="hl_varref"><span class="mpre">file</span></span></a><span class="mpre">
           | </span><a name="loc_789_14_789_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_789_14_789_18&#39;)"><span class="hl_vardecl"><span class="mpre">file</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_787_5_787_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_787_5_787_10&#39;)"><span class="hl_varref"><span class="mpre">files</span></span></a><span class="mpre">
           , let (</span><a name="loc_790_19_790_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_790_19_790_23&#39;)"><span class="hl_vardecl"><span class="mpre">name</span></span></a><span class="mpre">, </span><a name="loc_790_25_790_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_790_25_790_29&#39;)"><span class="hl_vardecl"><span class="mpre">ext&#39;</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">splitExtensions</span></span><span class="mpre"> </span><a href="#loc_789_14_789_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_789_14_789_18&#39;)"><span class="hl_varref"><span class="mpre">file</span></span></a><span class="mpre">
           , </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_790_19_790_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_790_19_790_23&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_790_25_790_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_790_25_790_29&#39;)"><span class="hl_varref"><span class="mpre">ext&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_786_23_786_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_786_23_786_26&#39;)"><span class="hl_varref"><span class="mpre">ext</span></span></a><span class="mpre"> ] of
      []      -&gt; </span><a href="#loc_251_1_251_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_251_1_251_4&#39;)"><span class="hl_varref"><span class="mpre">die</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;filepath wildcard &#39;&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_780_22_780_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_780_22_780_30&#39;)"><span class="hl_varref"><span class="mpre">filepath</span></span></a><span class="mpre">
                    </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&#39; does not match any files.&quot;</span></span><span class="mpre">
      </span><a name="loc_794_7_794_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_794_7_794_14&#39;)"><span class="hl_vardecl"><span class="mpre">matches</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_794_7_794_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_794_7_794_14&#39;)"><span class="hl_varref"><span class="mpre">matches</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">--------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Modification time</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Compare the modification times of two files to see if the first is newer</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- than the second. The first file must exist but the second need not.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The expected use case is when the second file is generated using the first.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- In this use case, if the result is True then the second file is out of date.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_805_1_805_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_805_1_805_15&#39;)"><span class="mpre">moreRecentFile</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_805_1_805_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_805_1_805_15&#39;)"><span class="hl_fundecl"><span class="mpre">moreRecentFile</span></span></a><span class="mpre"> </span><a name="loc_805_16_805_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_805_16_805_17&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> </span><a name="loc_805_18_805_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_805_18_805_19&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> = do
  </span><a name="loc_806_3_806_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_806_3_806_9&#39;)"><span class="hl_vardecl"><span class="mpre">exists</span></span></a><span class="mpre"> &lt;- </span><a href="System.Directory.html#loc_726_1_726_14" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Directory.html#loc_726_1_726_14&#39;)"><span class="hl_varref"><span class="mpre">doesFileExist</span></span></a><span class="mpre"> </span><a href="#loc_805_18_805_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_805_18_805_19&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">
  if </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> </span><a href="#loc_806_3_806_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_806_3_806_9&#39;)"><span class="hl_varref"><span class="mpre">exists</span></span></a><span class="mpre">
    then </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
    else do </span><a name="loc_809_13_809_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_809_13_809_15&#39;)"><span class="hl_vardecl"><span class="mpre">tb</span></span></a><span class="mpre"> &lt;- </span><a href="System.Directory.html#loc_743_1_743_20" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Directory.html#loc_743_1_743_20&#39;)"><span class="hl_varref"><span class="mpre">getModificationTime</span></span></a><span class="mpre"> </span><a href="#loc_805_18_805_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_805_18_805_19&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">
            </span><a name="loc_810_13_810_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_810_13_810_15&#39;)"><span class="hl_vardecl"><span class="mpre">ta</span></span></a><span class="mpre"> &lt;- </span><a href="System.Directory.html#loc_743_1_743_20" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Directory.html#loc_743_1_743_20&#39;)"><span class="hl_varref"><span class="mpre">getModificationTime</span></span></a><span class="mpre"> </span><a href="#loc_805_16_805_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_805_16_805_17&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">
            </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_810_13_810_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_810_13_810_15&#39;)"><span class="hl_varref"><span class="mpre">ta</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><a href="#loc_809_13_809_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_809_13_809_15&#39;)"><span class="hl_varref"><span class="mpre">tb</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">----------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copying and installing files and dirs</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Same as &#39;createDirectoryIfMissing&#39; but logs at higher verbosity levels.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_822_1_822_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_822_1_822_32&#39;)"><span class="mpre">createDirectoryIfMissingVerbose</span></a><span class="mpre"> :: </span><a href="Distribution.Verbosity.html#loc_58_6_58_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Verbosity.html#loc_58_6_58_15&#39;)"><span class="hl_tyconref"><span class="mpre">Verbosity</span></span></a><span class="mpre">
                                -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">     </span><span class="hl_comment"><span class="mpre">-- ^ Create its parents too?</span></span><span class="mpre">
                                -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">
                                -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_822_1_822_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_822_1_822_32&#39;)"><span class="hl_fundecl"><span class="mpre">createDirectoryIfMissingVerbose</span></span></a><span class="mpre"> </span><a name="loc_822_33_822_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_822_33_822_42&#39;)"><span class="hl_vardecl"><span class="mpre">verbosity</span></span></a><span class="mpre"> </span><a name="loc_822_43_822_57" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_822_43_822_57&#39;)"><span class="hl_vardecl"><span class="mpre">create_parents</span></span></a><span class="mpre"> </span><a name="loc_822_58_822_63" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_822_58_822_63&#39;)"><span class="hl_vardecl"><span class="mpre">path0</span></span></a><span class="mpre">
  | </span><a href="#loc_822_43_822_57" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_822_43_822_57&#39;)"><span class="hl_varref"><span class="mpre">create_parents</span></span></a><span class="mpre"> = </span><a href="#loc_828_5_828_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_828_5_828_15&#39;)"><span class="hl_varref"><span class="mpre">createDirs</span></span></a><span class="mpre"> (</span><a href="#loc_826_5_826_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_826_5_826_12&#39;)"><span class="hl_varref"><span class="mpre">parents</span></span></a><span class="mpre"> </span><a href="#loc_822_58_822_63" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_822_58_822_63&#39;)"><span class="hl_varref"><span class="mpre">path0</span></span></a><span class="mpre">)
  | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">      = </span><a href="#loc_828_5_828_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_828_5_828_15&#39;)"><span class="hl_varref"><span class="mpre">createDirs</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">take</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> (</span><a href="#loc_826_5_826_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_826_5_826_12&#39;)"><span class="hl_varref"><span class="mpre">parents</span></span></a><span class="mpre"> </span><a href="#loc_822_58_822_63" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_822_58_822_63&#39;)"><span class="hl_varref"><span class="mpre">path0</span></span></a><span class="mpre">))
  where
    </span><a name="loc_826_5_826_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_826_5_826_12&#39;)"><span class="hl_vardecl"><span class="mpre">parents</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">scanl1</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">(&lt;/&gt;)</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">splitDirectories</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">normalise</span></span><span class="mpre">

    </span><a name="loc_828_5_828_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_828_5_828_15&#39;)"><span class="hl_fundecl"><span class="mpre">createDirs</span></span></a><span class="mpre"> []         = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">
    </span><a href="#loc_828_5_828_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_828_5_828_15&#39;)"><span class="hl_fundecl"><span class="mpre">createDirs</span></span></a><span class="mpre"> (</span><a name="loc_829_17_829_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_829_17_829_20&#39;)"><span class="hl_vardecl"><span class="mpre">dir</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">[])   = </span><a href="#loc_836_5_836_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_836_5_836_14&#39;)"><span class="hl_varref"><span class="mpre">createDir</span></span></a><span class="mpre"> </span><a href="#loc_829_17_829_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_829_17_829_20&#39;)"><span class="hl_varref"><span class="mpre">dir</span></span></a><span class="mpre"> </span><a href="GHC.IO.html#loc_304_1_304_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_304_1_304_8&#39;)"><span class="hl_varref"><span class="mpre">throwIO</span></span></a><span class="mpre">
    </span><a href="#loc_828_5_828_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_828_5_828_15&#39;)"><span class="hl_fundecl"><span class="mpre">createDirs</span></span></a><span class="mpre"> (</span><a name="loc_830_17_830_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_830_17_830_20&#39;)"><span class="hl_vardecl"><span class="mpre">dir</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_830_21_830_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_830_21_830_25&#39;)"><span class="hl_vardecl"><span class="mpre">dirs</span></span></a><span class="mpre">) =
      </span><a href="#loc_836_5_836_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_836_5_836_14&#39;)"><span class="hl_varref"><span class="mpre">createDir</span></span></a><span class="mpre"> </span><a href="#loc_830_17_830_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_830_17_830_20&#39;)"><span class="hl_varref"><span class="mpre">dir</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \_ -&gt; do
        </span><a href="#loc_828_5_828_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_828_5_828_15&#39;)"><span class="hl_varref"><span class="mpre">createDirs</span></span></a><span class="mpre"> </span><a href="#loc_830_21_830_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_830_21_830_25&#39;)"><span class="hl_varref"><span class="mpre">dirs</span></span></a><span class="mpre">
        </span><a href="#loc_836_5_836_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_836_5_836_14&#39;)"><span class="hl_varref"><span class="mpre">createDir</span></span></a><span class="mpre"> </span><a href="#loc_830_17_830_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_830_17_830_20&#39;)"><span class="hl_varref"><span class="mpre">dir</span></span></a><span class="mpre"> </span><a href="GHC.IO.html#loc_304_1_304_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_304_1_304_8&#39;)"><span class="hl_varref"><span class="mpre">throwIO</span></span></a><span class="mpre">

    </span><a href="#loc_836_5_836_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_836_5_836_14&#39;)"><span class="mpre">createDir</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; (</span><a href="GHC.IO.Exception.html#loc_238_6_238_17" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Exception.html#loc_238_6_238_17&#39;)"><span class="hl_tyconref"><span class="mpre">IOException</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
    </span><a name="loc_836_5_836_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_836_5_836_14&#39;)"><span class="hl_fundecl"><span class="mpre">createDir</span></span></a><span class="mpre"> </span><a name="loc_836_15_836_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_836_15_836_18&#39;)"><span class="hl_vardecl"><span class="mpre">dir</span></span></a><span class="mpre"> </span><a name="loc_836_19_836_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_836_19_836_34&#39;)"><span class="hl_vardecl"><span class="mpre">notExistHandler</span></span></a><span class="mpre"> = do
      </span><a name="loc_837_7_837_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_837_7_837_8&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> &lt;- </span><a href="Distribution.Compat.Exception.html#loc_11_1_11_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Compat.Exception.html#loc_11_1_11_6&#39;)"><span class="hl_varref"><span class="mpre">tryIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_857_1_857_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_857_1_857_23&#39;)"><span class="hl_varref"><span class="mpre">createDirectoryVerbose</span></span></a><span class="mpre"> </span><a href="#loc_822_33_822_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_822_33_822_42&#39;)"><span class="hl_varref"><span class="mpre">verbosity</span></span></a><span class="mpre"> </span><a href="#loc_836_15_836_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_836_15_836_18&#39;)"><span class="hl_varref"><span class="mpre">dir</span></span></a><span class="mpre">
      case (</span><a href="#loc_837_7_837_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_837_7_837_8&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><a href="GHC.IO.Exception.html#loc_238_6_238_17" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Exception.html#loc_238_6_238_17&#39;)"><span class="hl_tyconref"><span class="mpre">IOException</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">) of
        </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">                   -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">
        </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre">  </span><a name="loc_840_15_840_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_840_15_840_16&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre">
          | </span><a href="System.IO.Error.html#loc_135_1_135_20" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Error.html#loc_135_1_135_20&#39;)"><span class="hl_varref"><span class="mpre">isDoesNotExistError</span></span></a><span class="mpre">  </span><a href="#loc_840_15_840_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_840_15_840_16&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_836_19_836_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_836_19_836_34&#39;)"><span class="hl_varref"><span class="mpre">notExistHandler</span></span></a><span class="mpre"> </span><a href="#loc_840_15_840_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_840_15_840_16&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">
          </span><span class="hl_comment"><span class="mpre">-- createDirectory (and indeed POSIX mkdir) does not distinguish</span></span><span class="mpre">
          </span><span class="hl_comment"><span class="mpre">-- between a dir already existing and a file already existing. So we</span></span><span class="mpre">
          </span><span class="hl_comment"><span class="mpre">-- check for it here. Unfortunately there is a slight race condition</span></span><span class="mpre">
          </span><span class="hl_comment"><span class="mpre">-- here, but we think it is benign. It could report an exeption in</span></span><span class="mpre">
          </span><span class="hl_comment"><span class="mpre">-- the case that the dir did exist but another process deletes the</span></span><span class="mpre">
          </span><span class="hl_comment"><span class="mpre">-- directory and creates a file in its place before we can check</span></span><span class="mpre">
          </span><span class="hl_comment"><span class="mpre">-- that the directory did indeed exist.</span></span><span class="mpre">
          | </span><a href="System.IO.Error.html#loc_130_1_130_21" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Error.html#loc_130_1_130_21&#39;)"><span class="hl_varref"><span class="mpre">isAlreadyExistsError</span></span></a><span class="mpre"> </span><a href="#loc_840_15_840_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_840_15_840_16&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre"> -&gt; (do
              </span><a name="loc_850_15_850_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_850_15_850_20&#39;)"><span class="hl_vardecl"><span class="mpre">isDir</span></span></a><span class="mpre"> &lt;- </span><a href="System.Directory.html#loc_717_1_717_19" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Directory.html#loc_717_1_717_19&#39;)"><span class="hl_varref"><span class="mpre">doesDirectoryExist</span></span></a><span class="mpre"> </span><a href="#loc_836_15_836_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_836_15_836_18&#39;)"><span class="hl_varref"><span class="mpre">dir</span></span></a><span class="mpre">
              if </span><a href="#loc_850_15_850_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_850_15_850_20&#39;)"><span class="hl_varref"><span class="mpre">isDir</span></span></a><span class="mpre"> then </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">
                       else </span><a href="GHC.IO.html#loc_304_1_304_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_304_1_304_8&#39;)"><span class="hl_varref"><span class="mpre">throwIO</span></span></a><span class="mpre"> </span><a href="#loc_840_15_840_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_840_15_840_16&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">
              ) </span><a href="Distribution.Compat.Exception.html#loc_14_1_14_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Compat.Exception.html#loc_14_1_14_8&#39;)"><span class="hl_infix"><span class="mpre">`catchIO`</span></span></a><span class="mpre"> ((\_ -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">) :: </span><a href="GHC.IO.Exception.html#loc_238_6_238_17" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Exception.html#loc_238_6_238_17&#39;)"><span class="hl_tyconref"><span class="mpre">IOException</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">)
          | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">              -&gt; </span><a href="GHC.IO.html#loc_304_1_304_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_304_1_304_8&#39;)"><span class="hl_varref"><span class="mpre">throwIO</span></span></a><span class="mpre"> </span><a href="#loc_840_15_840_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_840_15_840_16&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">

</span><a href="#loc_857_1_857_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_857_1_857_23&#39;)"><span class="mpre">createDirectoryVerbose</span></a><span class="mpre"> :: </span><a href="Distribution.Verbosity.html#loc_58_6_58_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Verbosity.html#loc_58_6_58_15&#39;)"><span class="hl_tyconref"><span class="mpre">Verbosity</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_857_1_857_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_857_1_857_23&#39;)"><span class="hl_fundecl"><span class="mpre">createDirectoryVerbose</span></span></a><span class="mpre"> </span><a name="loc_857_24_857_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_857_24_857_33&#39;)"><span class="hl_vardecl"><span class="mpre">verbosity</span></span></a><span class="mpre"> </span><a name="loc_857_34_857_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_857_34_857_37&#39;)"><span class="hl_vardecl"><span class="mpre">dir</span></span></a><span class="mpre"> = do
  </span><a href="#loc_305_1_305_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_305_1_305_5&#39;)"><span class="hl_varref"><span class="mpre">info</span></span></a><span class="mpre"> </span><a href="#loc_857_24_857_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_857_24_857_33&#39;)"><span class="hl_varref"><span class="mpre">verbosity</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;creating &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_857_34_857_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_857_34_857_37&#39;)"><span class="hl_varref"><span class="mpre">dir</span></span></a><span class="mpre">
  </span><a href="System.Directory.html#loc_258_1_258_16" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Directory.html#loc_258_1_258_16&#39;)"><span class="hl_varref"><span class="mpre">createDirectory</span></span></a><span class="mpre"> </span><a href="#loc_857_34_857_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_857_34_857_37&#39;)"><span class="hl_varref"><span class="mpre">dir</span></span></a><span class="mpre">
  </span><a href="Distribution.Compat.CopyFile.html#loc_60_1_60_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Compat.CopyFile.html#loc_60_1_60_15&#39;)"><span class="hl_varref"><span class="mpre">setDirOrdinary</span></span></a><span class="mpre"> </span><a href="#loc_857_34_857_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_857_34_857_37&#39;)"><span class="hl_varref"><span class="mpre">dir</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Copies a file without copying file permissions. The target file is created</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- with default permissions. Any existing target file is replaced.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- At higher verbosity levels it logs an info message.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_868_1_868_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_868_1_868_16&#39;)"><span class="mpre">copyFileVerbose</span></a><span class="mpre"> :: </span><a href="Distribution.Verbosity.html#loc_58_6_58_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Verbosity.html#loc_58_6_58_15&#39;)"><span class="hl_tyconref"><span class="mpre">Verbosity</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_868_1_868_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_868_1_868_16&#39;)"><span class="hl_fundecl"><span class="mpre">copyFileVerbose</span></span></a><span class="mpre"> </span><a name="loc_868_17_868_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_868_17_868_26&#39;)"><span class="hl_vardecl"><span class="mpre">verbosity</span></span></a><span class="mpre"> </span><a name="loc_868_27_868_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_868_27_868_30&#39;)"><span class="hl_vardecl"><span class="mpre">src</span></span></a><span class="mpre"> </span><a name="loc_868_31_868_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_868_31_868_35&#39;)"><span class="hl_vardecl"><span class="mpre">dest</span></span></a><span class="mpre"> = do
  </span><a href="#loc_305_1_305_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_305_1_305_5&#39;)"><span class="hl_varref"><span class="mpre">info</span></span></a><span class="mpre"> </span><a href="#loc_868_17_868_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_868_17_868_26&#39;)"><span class="hl_varref"><span class="mpre">verbosity</span></span></a><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;copy &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_868_27_868_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_868_27_868_30&#39;)"><span class="hl_varref"><span class="mpre">src</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot; to &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_868_31_868_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_868_31_868_35&#39;)"><span class="hl_varref"><span class="mpre">dest</span></span></a><span class="mpre">)
  </span><a href="Distribution.Compat.CopyFile.html#loc_63_1_63_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Compat.CopyFile.html#loc_63_1_63_9&#39;)"><span class="hl_varref"><span class="mpre">copyFile</span></span></a><span class="mpre"> </span><a href="#loc_868_27_868_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_868_27_868_30&#39;)"><span class="hl_varref"><span class="mpre">src</span></span></a><span class="mpre"> </span><a href="#loc_868_31_868_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_868_31_868_35&#39;)"><span class="hl_varref"><span class="mpre">dest</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Install an ordinary file. This is like a file copy but the permissions</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- are set appropriately for an installed file. On Unix it is \&quot;-rw-r--r--\&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- while on Windows it uses the default permissions for the target directory.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_877_1_877_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_877_1_877_20&#39;)"><span class="mpre">installOrdinaryFile</span></a><span class="mpre"> :: </span><a href="Distribution.Verbosity.html#loc_58_6_58_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Verbosity.html#loc_58_6_58_15&#39;)"><span class="hl_tyconref"><span class="mpre">Verbosity</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_877_1_877_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_877_1_877_20&#39;)"><span class="hl_fundecl"><span class="mpre">installOrdinaryFile</span></span></a><span class="mpre"> </span><a name="loc_877_21_877_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_877_21_877_30&#39;)"><span class="hl_vardecl"><span class="mpre">verbosity</span></span></a><span class="mpre"> </span><a name="loc_877_31_877_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_877_31_877_34&#39;)"><span class="hl_vardecl"><span class="mpre">src</span></span></a><span class="mpre"> </span><a name="loc_877_35_877_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_877_35_877_39&#39;)"><span class="hl_vardecl"><span class="mpre">dest</span></span></a><span class="mpre"> = do
  </span><a href="#loc_305_1_305_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_305_1_305_5&#39;)"><span class="hl_varref"><span class="mpre">info</span></span></a><span class="mpre"> </span><a href="#loc_877_21_877_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_877_21_877_30&#39;)"><span class="hl_varref"><span class="mpre">verbosity</span></span></a><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;Installing &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_877_31_877_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_877_31_877_34&#39;)"><span class="hl_varref"><span class="mpre">src</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot; to &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_877_35_877_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_877_35_877_39&#39;)"><span class="hl_varref"><span class="mpre">dest</span></span></a><span class="mpre">)
  </span><a href="Distribution.Compat.CopyFile.html#loc_43_1_43_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Compat.CopyFile.html#loc_43_1_43_17&#39;)"><span class="hl_varref"><span class="mpre">copyOrdinaryFile</span></span></a><span class="mpre"> </span><a href="#loc_877_31_877_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_877_31_877_34&#39;)"><span class="hl_varref"><span class="mpre">src</span></span></a><span class="mpre"> </span><a href="#loc_877_35_877_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_877_35_877_39&#39;)"><span class="hl_varref"><span class="mpre">dest</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Install an executable file. This is like a file copy but the permissions</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- are set appropriately for an installed file. On Unix it is \&quot;-rwxr-xr-x\&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- while on Windows it uses the default permissions for the target directory.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_886_1_886_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_886_1_886_22&#39;)"><span class="mpre">installExecutableFile</span></a><span class="mpre"> :: </span><a href="Distribution.Verbosity.html#loc_58_6_58_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Verbosity.html#loc_58_6_58_15&#39;)"><span class="hl_tyconref"><span class="mpre">Verbosity</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_886_1_886_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_886_1_886_22&#39;)"><span class="hl_fundecl"><span class="mpre">installExecutableFile</span></span></a><span class="mpre"> </span><a name="loc_886_23_886_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_886_23_886_32&#39;)"><span class="hl_vardecl"><span class="mpre">verbosity</span></span></a><span class="mpre"> </span><a name="loc_886_33_886_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_886_33_886_36&#39;)"><span class="hl_vardecl"><span class="mpre">src</span></span></a><span class="mpre"> </span><a name="loc_886_37_886_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_886_37_886_41&#39;)"><span class="hl_vardecl"><span class="mpre">dest</span></span></a><span class="mpre"> = do
  </span><a href="#loc_305_1_305_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_305_1_305_5&#39;)"><span class="hl_varref"><span class="mpre">info</span></span></a><span class="mpre"> </span><a href="#loc_886_23_886_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_886_23_886_32&#39;)"><span class="hl_varref"><span class="mpre">verbosity</span></span></a><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;Installing executable &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_886_33_886_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_886_33_886_36&#39;)"><span class="hl_varref"><span class="mpre">src</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot; to &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_886_37_886_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_886_37_886_41&#39;)"><span class="hl_varref"><span class="mpre">dest</span></span></a><span class="mpre">)
  </span><a href="Distribution.Compat.CopyFile.html#loc_44_1_44_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Compat.CopyFile.html#loc_44_1_44_19&#39;)"><span class="hl_varref"><span class="mpre">copyExecutableFile</span></span></a><span class="mpre"> </span><a href="#loc_886_33_886_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_886_33_886_36&#39;)"><span class="hl_varref"><span class="mpre">src</span></span></a><span class="mpre"> </span><a href="#loc_886_37_886_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_886_37_886_41&#39;)"><span class="hl_varref"><span class="mpre">dest</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Install a file that may or not be executable, preserving permissions.</span></span><span class="mpre">
</span><a href="#loc_892_1_892_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_892_1_892_27&#39;)"><span class="mpre">installMaybeExecutableFile</span></a><span class="mpre"> :: </span><a href="Distribution.Verbosity.html#loc_58_6_58_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Verbosity.html#loc_58_6_58_15&#39;)"><span class="hl_tyconref"><span class="mpre">Verbosity</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_892_1_892_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_892_1_892_27&#39;)"><span class="hl_fundecl"><span class="mpre">installMaybeExecutableFile</span></span></a><span class="mpre"> </span><a name="loc_892_28_892_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_892_28_892_37&#39;)"><span class="hl_vardecl"><span class="mpre">verbosity</span></span></a><span class="mpre"> </span><a name="loc_892_38_892_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_892_38_892_41&#39;)"><span class="hl_vardecl"><span class="mpre">src</span></span></a><span class="mpre"> </span><a name="loc_892_42_892_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_892_42_892_46&#39;)"><span class="hl_vardecl"><span class="mpre">dest</span></span></a><span class="mpre"> = do
  </span><a name="loc_893_3_893_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_893_3_893_8&#39;)"><span class="hl_vardecl"><span class="mpre">perms</span></span></a><span class="mpre"> &lt;- </span><a href="System.Directory.html#loc_153_1_153_15" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Directory.html#loc_153_1_153_15&#39;)"><span class="hl_varref"><span class="mpre">getPermissions</span></span></a><span class="mpre"> </span><a href="#loc_892_38_892_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_892_38_892_41&#39;)"><span class="hl_varref"><span class="mpre">src</span></span></a><span class="mpre">
  if (</span><a href="System.Directory.html#loc_137_5_137_15" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Directory.html#loc_137_5_137_15&#39;)"><span class="hl_varref"><span class="mpre">executable</span></span></a><span class="mpre"> </span><a href="#loc_893_3_893_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_893_3_893_8&#39;)"><span class="hl_varref"><span class="mpre">perms</span></span></a><span class="mpre">) </span><span class="hl_comment"><span class="mpre">--only checks user x bit</span></span><span class="mpre">
    then </span><a href="#loc_886_1_886_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_886_1_886_22&#39;)"><span class="hl_varref"><span class="mpre">installExecutableFile</span></span></a><span class="mpre"> </span><a href="#loc_892_28_892_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_892_28_892_37&#39;)"><span class="hl_varref"><span class="mpre">verbosity</span></span></a><span class="mpre"> </span><a href="#loc_892_38_892_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_892_38_892_41&#39;)"><span class="hl_varref"><span class="mpre">src</span></span></a><span class="mpre"> </span><a href="#loc_892_42_892_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_892_42_892_46&#39;)"><span class="hl_varref"><span class="mpre">dest</span></span></a><span class="mpre">
    else </span><a href="#loc_877_1_877_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_877_1_877_20&#39;)"><span class="hl_varref"><span class="mpre">installOrdinaryFile</span></span></a><span class="mpre">   </span><a href="#loc_892_28_892_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_892_28_892_37&#39;)"><span class="hl_varref"><span class="mpre">verbosity</span></span></a><span class="mpre"> </span><a href="#loc_892_38_892_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_892_38_892_41&#39;)"><span class="hl_varref"><span class="mpre">src</span></span></a><span class="mpre"> </span><a href="#loc_892_42_892_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_892_42_892_46&#39;)"><span class="hl_varref"><span class="mpre">dest</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Given a relative path to a file, copy it to the given directory, preserving</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the relative path and creating the parent directories if needed.</span></span><span class="mpre">
</span><a href="#loc_901_1_901_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_901_1_901_11&#39;)"><span class="mpre">copyFileTo</span></a><span class="mpre"> :: </span><a href="Distribution.Verbosity.html#loc_58_6_58_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Verbosity.html#loc_58_6_58_15&#39;)"><span class="hl_tyconref"><span class="mpre">Verbosity</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_901_1_901_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_901_1_901_11&#39;)"><span class="hl_fundecl"><span class="mpre">copyFileTo</span></span></a><span class="mpre"> </span><a name="loc_901_12_901_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_901_12_901_21&#39;)"><span class="hl_vardecl"><span class="mpre">verbosity</span></span></a><span class="mpre"> </span><a name="loc_901_22_901_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_901_22_901_25&#39;)"><span class="hl_vardecl"><span class="mpre">dir</span></span></a><span class="mpre"> </span><a name="loc_901_26_901_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_901_26_901_30&#39;)"><span class="hl_vardecl"><span class="mpre">file</span></span></a><span class="mpre"> = do
  let </span><a name="loc_902_7_902_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_902_7_902_17&#39;)"><span class="hl_vardecl"><span class="mpre">targetFile</span></span></a><span class="mpre"> = </span><a href="#loc_901_22_901_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_901_22_901_25&#39;)"><span class="hl_varref"><span class="mpre">dir</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;/&gt;</span></span><span class="mpre"> </span><a href="#loc_901_26_901_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_901_26_901_30&#39;)"><span class="hl_varref"><span class="mpre">file</span></span></a><span class="mpre">
  </span><a href="#loc_822_1_822_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_822_1_822_32&#39;)"><span class="hl_varref"><span class="mpre">createDirectoryIfMissingVerbose</span></span></a><span class="mpre"> </span><a href="#loc_901_12_901_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_901_12_901_21&#39;)"><span class="hl_varref"><span class="mpre">verbosity</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">takeDirectory</span></span><span class="mpre"> </span><a href="#loc_902_7_902_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_902_7_902_17&#39;)"><span class="hl_varref"><span class="mpre">targetFile</span></span></a><span class="mpre">)
  </span><a href="#loc_877_1_877_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_877_1_877_20&#39;)"><span class="hl_varref"><span class="mpre">installOrdinaryFile</span></span></a><span class="mpre"> </span><a href="#loc_901_12_901_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_901_12_901_21&#39;)"><span class="hl_varref"><span class="mpre">verbosity</span></span></a><span class="mpre"> </span><a href="#loc_901_26_901_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_901_26_901_30&#39;)"><span class="hl_varref"><span class="mpre">file</span></span></a><span class="mpre"> </span><a href="#loc_902_7_902_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_902_7_902_17&#39;)"><span class="hl_varref"><span class="mpre">targetFile</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Common implementation of &#39;copyFiles&#39;, &#39;installOrdinaryFiles&#39;,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;installExecutableFiles&#39; and &#39;installMaybeExecutableFiles&#39;.</span></span><span class="mpre">
</span><a href="#loc_910_1_910_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_910_1_910_14&#39;)"><span class="mpre">copyFilesWith</span></a><span class="mpre"> :: (</span><a href="Distribution.Verbosity.html#loc_58_6_58_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Verbosity.html#loc_58_6_58_15&#39;)"><span class="hl_tyconref"><span class="mpre">Verbosity</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">)
              -&gt; </span><a href="Distribution.Verbosity.html#loc_58_6_58_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Verbosity.html#loc_58_6_58_15&#39;)"><span class="hl_tyconref"><span class="mpre">Verbosity</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; [(</span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">)] -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_910_1_910_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_910_1_910_14&#39;)"><span class="hl_fundecl"><span class="mpre">copyFilesWith</span></span></a><span class="mpre"> </span><a name="loc_910_15_910_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_910_15_910_21&#39;)"><span class="hl_vardecl"><span class="mpre">doCopy</span></span></a><span class="mpre"> </span><a name="loc_910_22_910_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_910_22_910_31&#39;)"><span class="hl_vardecl"><span class="mpre">verbosity</span></span></a><span class="mpre"> </span><a name="loc_910_32_910_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_910_32_910_41&#39;)"><span class="hl_vardecl"><span class="mpre">targetDir</span></span></a><span class="mpre"> </span><a name="loc_910_42_910_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_910_42_910_50&#39;)"><span class="hl_vardecl"><span class="mpre">srcFiles</span></span></a><span class="mpre"> = do

  </span><span class="hl_comment"><span class="mpre">-- Create parent directories for everything</span></span><span class="mpre">
  let </span><a name="loc_913_7_913_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_913_7_913_11&#39;)"><span class="hl_vardecl"><span class="mpre">dirs</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><a href="#loc_910_32_910_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_910_32_910_41&#39;)"><span class="hl_varref"><span class="mpre">targetDir</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;/&gt;</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Data.List.html#loc_314_1_314_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_314_1_314_4&#39;)"><span class="hl_varref"><span class="mpre">nub</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">takeDirectory</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">snd</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_910_42_910_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_910_42_910_50&#39;)"><span class="hl_varref"><span class="mpre">srcFiles</span></span></a><span class="mpre">
  </span><span class="hl_varref"><span class="mpre">mapM_</span></span><span class="mpre"> (</span><a href="#loc_822_1_822_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_822_1_822_32&#39;)"><span class="hl_varref"><span class="mpre">createDirectoryIfMissingVerbose</span></span></a><span class="mpre"> </span><a href="#loc_910_22_910_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_910_22_910_31&#39;)"><span class="hl_varref"><span class="mpre">verbosity</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">) </span><a href="#loc_913_7_913_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_913_7_913_11&#39;)"><span class="hl_varref"><span class="mpre">dirs</span></span></a><span class="mpre">

  </span><span class="hl_comment"><span class="mpre">-- Copy all the files</span></span><span class="mpre">
  </span><span class="hl_varref"><span class="mpre">sequence_</span></span><span class="mpre"> [ let </span><a name="loc_917_19_917_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_917_19_917_22&#39;)"><span class="hl_vardecl"><span class="mpre">src</span></span></a><span class="mpre">  = </span><a href="#loc_920_16_920_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_920_16_920_23&#39;)"><span class="hl_varref"><span class="mpre">srcBase</span></span></a><span class="mpre">   </span><span class="hl_infix"><span class="mpre">&lt;/&gt;</span></span><span class="mpre"> </span><a href="#loc_920_25_920_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_920_25_920_32&#39;)"><span class="hl_varref"><span class="mpre">srcFile</span></span></a><span class="mpre">
                  </span><a name="loc_918_19_918_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_918_19_918_23&#39;)"><span class="hl_vardecl"><span class="mpre">dest</span></span></a><span class="mpre"> = </span><a href="#loc_910_32_910_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_910_32_910_41&#39;)"><span class="hl_varref"><span class="mpre">targetDir</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;/&gt;</span></span><span class="mpre"> </span><a href="#loc_920_25_920_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_920_25_920_32&#39;)"><span class="hl_varref"><span class="mpre">srcFile</span></span></a><span class="mpre">
               in </span><a href="#loc_910_15_910_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_910_15_910_21&#39;)"><span class="hl_varref"><span class="mpre">doCopy</span></span></a><span class="mpre"> </span><a href="#loc_910_22_910_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_910_22_910_31&#39;)"><span class="hl_varref"><span class="mpre">verbosity</span></span></a><span class="mpre"> </span><a href="#loc_917_19_917_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_917_19_917_22&#39;)"><span class="hl_varref"><span class="mpre">src</span></span></a><span class="mpre"> </span><a href="#loc_918_19_918_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_918_19_918_23&#39;)"><span class="hl_varref"><span class="mpre">dest</span></span></a><span class="mpre">
            | (</span><a name="loc_920_16_920_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_920_16_920_23&#39;)"><span class="hl_vardecl"><span class="mpre">srcBase</span></span></a><span class="mpre">, </span><a name="loc_920_25_920_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_920_25_920_32&#39;)"><span class="hl_vardecl"><span class="mpre">srcFile</span></span></a><span class="mpre">) &lt;- </span><a href="#loc_910_42_910_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_910_42_910_50&#39;)"><span class="hl_varref"><span class="mpre">srcFiles</span></span></a><span class="mpre"> ]

</span><span class="hl_comment"><span class="mpre">-- | Copies a bunch of files to a target directory, preserving the directory</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- structure in the target location. The target directories are created if they</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- do not exist.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The files are identified by a pair of base directory and a path relative to</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- that base. It is only the relative part that is preserved in the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- destination.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- For example:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; copyFiles normal &quot;dist/src&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;    [(&quot;&quot;, &quot;src/Foo.hs&quot;), (&quot;dist/build/&quot;, &quot;src/Bar.hs&quot;)]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This would copy \&quot;src\/Foo.hs\&quot; to \&quot;dist\/src\/src\/Foo.hs\&quot; and</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- copy \&quot;dist\/build\/src\/Bar.hs\&quot; to \&quot;dist\/src\/src\/Bar.hs\&quot;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This operation is not atomic. Any IO failure during the copy (including any</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- missing source files) leaves the target in an unknown state so it is best to</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- use it with a freshly created directory so that it can be simply deleted if</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- anything goes wrong.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_944_1_944_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_944_1_944_10&#39;)"><span class="mpre">copyFiles</span></a><span class="mpre"> :: </span><a href="Distribution.Verbosity.html#loc_58_6_58_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Verbosity.html#loc_58_6_58_15&#39;)"><span class="hl_tyconref"><span class="mpre">Verbosity</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; [(</span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">)] -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_944_1_944_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_944_1_944_10&#39;)"><span class="hl_vardecl"><span class="mpre">copyFiles</span></span></a><span class="mpre"> = </span><a href="#loc_910_1_910_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_910_1_910_14&#39;)"><span class="hl_varref"><span class="mpre">copyFilesWith</span></span></a><span class="mpre"> </span><a href="#loc_868_1_868_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_868_1_868_16&#39;)"><span class="hl_varref"><span class="mpre">copyFileVerbose</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | This is like &#39;copyFiles&#39; but uses &#39;installOrdinaryFile&#39;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_949_1_949_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_949_1_949_21&#39;)"><span class="mpre">installOrdinaryFiles</span></a><span class="mpre"> :: </span><a href="Distribution.Verbosity.html#loc_58_6_58_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Verbosity.html#loc_58_6_58_15&#39;)"><span class="hl_tyconref"><span class="mpre">Verbosity</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; [(</span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">)] -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_949_1_949_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_949_1_949_21&#39;)"><span class="hl_vardecl"><span class="mpre">installOrdinaryFiles</span></span></a><span class="mpre"> = </span><a href="#loc_910_1_910_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_910_1_910_14&#39;)"><span class="hl_varref"><span class="mpre">copyFilesWith</span></span></a><span class="mpre"> </span><a href="#loc_877_1_877_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_877_1_877_20&#39;)"><span class="hl_varref"><span class="mpre">installOrdinaryFile</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | This is like &#39;copyFiles&#39; but uses &#39;installExecutableFile&#39;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_955_1_955_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_955_1_955_23&#39;)"><span class="mpre">installExecutableFiles</span></a><span class="mpre"> :: </span><a href="Distribution.Verbosity.html#loc_58_6_58_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Verbosity.html#loc_58_6_58_15&#39;)"><span class="hl_tyconref"><span class="mpre">Verbosity</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; [(</span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">)]
                          -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_955_1_955_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_955_1_955_23&#39;)"><span class="hl_vardecl"><span class="mpre">installExecutableFiles</span></span></a><span class="mpre"> = </span><a href="#loc_910_1_910_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_910_1_910_14&#39;)"><span class="hl_varref"><span class="mpre">copyFilesWith</span></span></a><span class="mpre"> </span><a href="#loc_886_1_886_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_886_1_886_22&#39;)"><span class="hl_varref"><span class="mpre">installExecutableFile</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | This is like &#39;copyFiles&#39; but uses &#39;installMaybeExecutableFile&#39;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_961_1_961_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_961_1_961_28&#39;)"><span class="mpre">installMaybeExecutableFiles</span></a><span class="mpre"> :: </span><a href="Distribution.Verbosity.html#loc_58_6_58_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Verbosity.html#loc_58_6_58_15&#39;)"><span class="hl_tyconref"><span class="mpre">Verbosity</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; [(</span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">)]
                               -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_961_1_961_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_961_1_961_28&#39;)"><span class="hl_vardecl"><span class="mpre">installMaybeExecutableFiles</span></span></a><span class="mpre"> = </span><a href="#loc_910_1_910_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_910_1_910_14&#39;)"><span class="hl_varref"><span class="mpre">copyFilesWith</span></span></a><span class="mpre"> </span><a href="#loc_892_1_892_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_892_1_892_27&#39;)"><span class="hl_varref"><span class="mpre">installMaybeExecutableFile</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | This installs all the files in a directory to a target location,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- preserving the directory layout. All the files are assumed to be ordinary</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- rather than executable files.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_968_1_968_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_968_1_968_25&#39;)"><span class="mpre">installDirectoryContents</span></a><span class="mpre"> :: </span><a href="Distribution.Verbosity.html#loc_58_6_58_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Verbosity.html#loc_58_6_58_15&#39;)"><span class="hl_tyconref"><span class="mpre">Verbosity</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_968_1_968_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_968_1_968_25&#39;)"><span class="hl_fundecl"><span class="mpre">installDirectoryContents</span></span></a><span class="mpre"> </span><a name="loc_968_26_968_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_968_26_968_35&#39;)"><span class="hl_vardecl"><span class="mpre">verbosity</span></span></a><span class="mpre"> </span><a name="loc_968_36_968_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_968_36_968_42&#39;)"><span class="hl_vardecl"><span class="mpre">srcDir</span></span></a><span class="mpre"> </span><a name="loc_968_43_968_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_968_43_968_50&#39;)"><span class="hl_vardecl"><span class="mpre">destDir</span></span></a><span class="mpre"> = do
  </span><a href="#loc_305_1_305_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_305_1_305_5&#39;)"><span class="hl_varref"><span class="mpre">info</span></span></a><span class="mpre"> </span><a href="#loc_968_26_968_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_968_26_968_35&#39;)"><span class="hl_varref"><span class="mpre">verbosity</span></span></a><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;copy directory &#39;&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_968_36_968_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_968_36_968_42&#39;)"><span class="hl_varref"><span class="mpre">srcDir</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&#39; to &#39;&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_968_43_968_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_968_43_968_50&#39;)"><span class="hl_varref"><span class="mpre">destDir</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&#39;.&quot;</span></span><span class="mpre">)
  </span><a name="loc_970_3_970_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_970_3_970_11&#39;)"><span class="hl_vardecl"><span class="mpre">srcFiles</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_723_1_723_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_723_1_723_30&#39;)"><span class="hl_varref"><span class="mpre">getDirectoryContentsRecursive</span></span></a><span class="mpre"> </span><a href="#loc_968_36_968_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_968_36_968_42&#39;)"><span class="hl_varref"><span class="mpre">srcDir</span></span></a><span class="mpre">
  </span><a href="#loc_949_1_949_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_949_1_949_21&#39;)"><span class="hl_varref"><span class="mpre">installOrdinaryFiles</span></span></a><span class="mpre"> </span><a href="#loc_968_26_968_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_968_26_968_35&#39;)"><span class="hl_varref"><span class="mpre">verbosity</span></span></a><span class="mpre"> </span><a href="#loc_968_43_968_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_968_43_968_50&#39;)"><span class="hl_varref"><span class="mpre">destDir</span></span></a><span class="mpre"> [ (</span><a href="#loc_968_36_968_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_968_36_968_42&#39;)"><span class="hl_varref"><span class="mpre">srcDir</span></span></a><span class="mpre">, </span><a href="#loc_971_58_971_59" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_971_58_971_59&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">) | </span><a name="loc_971_58_971_59" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_971_58_971_59&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_970_3_970_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_970_3_970_11&#39;)"><span class="hl_varref"><span class="mpre">srcFiles</span></span></a><span class="mpre"> ]

</span><span class="hl_comment"><span class="mpre">---------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Deprecated file copy functions</span></span><span class="mpre">

</span><span class="warning" data-warning="DeclDeprPragmaDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Simple/Utils.hs&quot;, srcSpanStartLine = 976, srcSpanStartColumn = 1, srcSpanEndLine = 977, srcSpanEndColumn = 70}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Simple/Utils.hs&quot;, srcSpanStartLine = 976, srcSpanStartColumn = 1, srcSpanEndLine = 976, srcSpanEndColumn = 15},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/S"><span class="mpre">{-# DEPRECATED smartCopySources
      &quot;Use findModuleFiles and copyFiles or installOrdinaryFiles&quot; #-}</span></span><span class="mpre">
</span><a href="#loc_980_1_980_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_980_1_980_17&#39;)"><span class="mpre">smartCopySources</span></a><span class="mpre"> :: </span><a href="Distribution.Verbosity.html#loc_58_6_58_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Verbosity.html#loc_58_6_58_15&#39;)"><span class="hl_tyconref"><span class="mpre">Verbosity</span></span></a><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">
                 -&gt; [</span><a href="Distribution.ModuleName.html#loc_67_9_67_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.ModuleName.html#loc_67_9_67_19&#39;)"><span class="hl_tyconref"><span class="mpre">ModuleName</span></span></a><span class="mpre">] -&gt; [</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_980_1_980_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_980_1_980_17&#39;)"><span class="hl_fundecl"><span class="mpre">smartCopySources</span></span></a><span class="mpre"> </span><a name="loc_980_18_980_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_980_18_980_27&#39;)"><span class="hl_vardecl"><span class="mpre">verbosity</span></span></a><span class="mpre"> </span><a name="loc_980_28_980_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_980_28_980_38&#39;)"><span class="hl_vardecl"><span class="mpre">searchPath</span></span></a><span class="mpre"> </span><a name="loc_980_39_980_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_980_39_980_48&#39;)"><span class="hl_vardecl"><span class="mpre">targetDir</span></span></a><span class="mpre"> </span><a name="loc_980_49_980_60" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_980_49_980_60&#39;)"><span class="hl_vardecl"><span class="mpre">moduleNames</span></span></a><span class="mpre"> </span><a name="loc_980_61_980_71" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_980_61_980_71&#39;)"><span class="hl_vardecl"><span class="mpre">extensions</span></span></a><span class="mpre"> =
      </span><a href="#loc_695_1_695_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_695_1_695_16&#39;)"><span class="hl_varref"><span class="mpre">findModuleFiles</span></span></a><span class="mpre"> </span><a href="#loc_980_28_980_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_980_28_980_38&#39;)"><span class="hl_varref"><span class="mpre">searchPath</span></span></a><span class="mpre"> </span><a href="#loc_980_61_980_71" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_980_61_980_71&#39;)"><span class="hl_varref"><span class="mpre">extensions</span></span></a><span class="mpre"> </span><a href="#loc_980_49_980_60" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_980_49_980_60&#39;)"><span class="hl_varref"><span class="mpre">moduleNames</span></span></a><span class="mpre">
  </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="#loc_944_1_944_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_944_1_944_10&#39;)"><span class="hl_varref"><span class="mpre">copyFiles</span></span></a><span class="mpre"> </span><a href="#loc_980_18_980_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_980_18_980_27&#39;)"><span class="hl_varref"><span class="mpre">verbosity</span></span></a><span class="mpre"> </span><a href="#loc_980_39_980_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_980_39_980_48&#39;)"><span class="hl_varref"><span class="mpre">targetDir</span></span></a><span class="mpre">

</span><span class="warning" data-warning="DeclDeprPragmaDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Simple/Utils.hs&quot;, srcSpanStartLine = 984, srcSpanStartColumn = 1, srcSpanEndLine = 985, srcSpanEndColumn = 63}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Simple/Utils.hs&quot;, srcSpanStartLine = 984, srcSpanStartColumn = 1, srcSpanEndLine = 984, srcSpanEndColumn = 15},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/S"><span class="mpre">{-# DEPRECATED copyDirectoryRecursiveVerbose
      &quot;You probably want installDirectoryContents instead&quot; #-}</span></span><span class="mpre">
</span><a href="#loc_987_1_987_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_987_1_987_30&#39;)"><span class="mpre">copyDirectoryRecursiveVerbose</span></a><span class="mpre"> :: </span><a href="Distribution.Verbosity.html#loc_58_6_58_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Verbosity.html#loc_58_6_58_15&#39;)"><span class="hl_tyconref"><span class="mpre">Verbosity</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_987_1_987_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_987_1_987_30&#39;)"><span class="hl_fundecl"><span class="mpre">copyDirectoryRecursiveVerbose</span></span></a><span class="mpre"> </span><a name="loc_987_31_987_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_987_31_987_40&#39;)"><span class="hl_vardecl"><span class="mpre">verbosity</span></span></a><span class="mpre"> </span><a name="loc_987_41_987_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_987_41_987_47&#39;)"><span class="hl_vardecl"><span class="mpre">srcDir</span></span></a><span class="mpre"> </span><a name="loc_987_48_987_55" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_987_48_987_55&#39;)"><span class="hl_vardecl"><span class="mpre">destDir</span></span></a><span class="mpre"> = do
  </span><a href="#loc_305_1_305_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_305_1_305_5&#39;)"><span class="hl_varref"><span class="mpre">info</span></span></a><span class="mpre"> </span><a href="#loc_987_31_987_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_987_31_987_40&#39;)"><span class="hl_varref"><span class="mpre">verbosity</span></span></a><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;copy directory &#39;&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_987_41_987_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_987_41_987_47&#39;)"><span class="hl_varref"><span class="mpre">srcDir</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&#39; to &#39;&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_987_48_987_55" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_987_48_987_55&#39;)"><span class="hl_varref"><span class="mpre">destDir</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&#39;.&quot;</span></span><span class="mpre">)
  </span><a name="loc_989_3_989_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_989_3_989_11&#39;)"><span class="hl_vardecl"><span class="mpre">srcFiles</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_723_1_723_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_723_1_723_30&#39;)"><span class="hl_varref"><span class="mpre">getDirectoryContentsRecursive</span></span></a><span class="mpre"> </span><a href="#loc_987_41_987_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_987_41_987_47&#39;)"><span class="hl_varref"><span class="mpre">srcDir</span></span></a><span class="mpre">
  </span><a href="#loc_944_1_944_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_944_1_944_10&#39;)"><span class="hl_varref"><span class="mpre">copyFiles</span></span></a><span class="mpre"> </span><a href="#loc_987_31_987_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_987_31_987_40&#39;)"><span class="hl_varref"><span class="mpre">verbosity</span></span></a><span class="mpre"> </span><a href="#loc_987_48_987_55" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_987_48_987_55&#39;)"><span class="hl_varref"><span class="mpre">destDir</span></span></a><span class="mpre"> [ (</span><a href="#loc_987_41_987_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_987_41_987_47&#39;)"><span class="hl_varref"><span class="mpre">srcDir</span></span></a><span class="mpre">, </span><a href="#loc_990_47_990_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_990_47_990_48&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">) | </span><a name="loc_990_47_990_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_990_47_990_48&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_989_3_989_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_989_3_989_11&#39;)"><span class="hl_varref"><span class="mpre">srcFiles</span></span></a><span class="mpre"> ]

</span><span class="hl_comment"><span class="mpre">---------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Temporary files and dirs</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Advanced options for &#39;withTempFile&#39; and &#39;withTempDirectory&#39;.</span></span><span class="mpre">
data </span><a name="loc_996_6_996_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_996_6_996_21&#39;)"><span class="hl_tycondecl"><span class="mpre">TempFileOptions</span></span></a><span class="mpre"> = </span><span class="hl_condecl"><span class="mpre">TempFileOptions</span></span><span class="mpre"> {
  </span><a name="loc_997_3_997_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_997_3_997_19&#39;)"><span class="hl_fielddecl"><span class="mpre">optKeepTempFiles</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- ^ Keep temporary files?</span></span><span class="mpre">
  }

</span><a href="#loc_1001_1_1001_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1001_1_1001_23&#39;)"><span class="mpre">defaultTempFileOptions</span></a><span class="mpre"> :: </span><a href="#loc_996_6_996_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_996_6_996_21&#39;)"><span class="hl_tyconref"><span class="mpre">TempFileOptions</span></span></a><span class="mpre">
</span><a name="loc_1001_1_1001_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1001_1_1001_23&#39;)"><span class="hl_vardecl"><span class="mpre">defaultTempFileOptions</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Simple/Utils.hs&quot;, srcSpanStartLine = 1001, srcSpanStartColumn = 26, srcSpanEndLine = 1001, srcSpanEndColumn = 70}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Simple/Utils.hs&quot;, srcSpanStartLine = 1001, srcSpanStartColumn = 42, srcSpanEndLine = 1001, srcSpanEndColumn = 43},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/"><span class="mpre">TempFileOptions { optKeepTempFiles = False }</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Use a temporary filename that doesn&#39;t already exist.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_1008_1_1008_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1008_1_1008_13&#39;)"><span class="mpre">withTempFile</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">    </span><span class="hl_comment"><span class="mpre">-- ^ Temp dir to create the file in</span></span><span class="mpre">
                -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">   </span><span class="hl_comment"><span class="mpre">-- ^ File name template. See &#39;openTempFile&#39;.</span></span><span class="mpre">
                -&gt; (</span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><a href="GHC.IO.Handle.Types.html#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Types.html#loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Handle</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_1008_1_1008_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1008_1_1008_13&#39;)"><span class="hl_fundecl"><span class="mpre">withTempFile</span></span></a><span class="mpre"> </span><a name="loc_1008_14_1008_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1008_14_1008_20&#39;)"><span class="hl_vardecl"><span class="mpre">tmpDir</span></span></a><span class="mpre"> </span><a name="loc_1008_21_1008_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1008_21_1008_29&#39;)"><span class="hl_vardecl"><span class="mpre">template</span></span></a><span class="mpre"> </span><a name="loc_1008_30_1008_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1008_30_1008_36&#39;)"><span class="hl_vardecl"><span class="mpre">action</span></span></a><span class="mpre"> =
  </span><a href="#loc_1017_1_1017_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1017_1_1017_15&#39;)"><span class="hl_varref"><span class="mpre">withTempFileEx</span></span></a><span class="mpre"> </span><a href="#loc_1001_1_1001_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1001_1_1001_23&#39;)"><span class="hl_varref"><span class="mpre">defaultTempFileOptions</span></span></a><span class="mpre"> </span><a href="#loc_1008_14_1008_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1008_14_1008_20&#39;)"><span class="hl_varref"><span class="mpre">tmpDir</span></span></a><span class="mpre"> </span><a href="#loc_1008_21_1008_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1008_21_1008_29&#39;)"><span class="hl_varref"><span class="mpre">template</span></span></a><span class="mpre"> </span><a href="#loc_1008_30_1008_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1008_30_1008_36&#39;)"><span class="hl_varref"><span class="mpre">action</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | A version of &#39;withTempFile&#39; that additionally takes a &#39;TempFileOptions&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- argument.</span></span><span class="mpre">
</span><a href="#loc_1017_1_1017_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1017_1_1017_15&#39;)"><span class="mpre">withTempFileEx</span></a><span class="mpre"> :: </span><a href="#loc_996_6_996_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_996_6_996_21&#39;)"><span class="hl_tyconref"><span class="mpre">TempFileOptions</span></span></a><span class="mpre">
                 -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ Temp dir to create the file in</span></span><span class="mpre">
                 -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">   </span><span class="hl_comment"><span class="mpre">-- ^ File name template. See &#39;openTempFile&#39;.</span></span><span class="mpre">
                 -&gt; (</span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><a href="GHC.IO.Handle.Types.html#loc_100_6_100_12" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Types.html#loc_100_6_100_12&#39;)"><span class="hl_tyconref"><span class="mpre">Handle</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_1017_1_1017_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1017_1_1017_15&#39;)"><span class="hl_fundecl"><span class="mpre">withTempFileEx</span></span></a><span class="mpre"> </span><a name="loc_1017_16_1017_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1017_16_1017_20&#39;)"><span class="hl_vardecl"><span class="mpre">opts</span></span></a><span class="mpre"> </span><a name="loc_1017_21_1017_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1017_21_1017_27&#39;)"><span class="hl_vardecl"><span class="mpre">tmpDir</span></span></a><span class="mpre"> </span><a name="loc_1017_28_1017_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1017_28_1017_36&#39;)"><span class="hl_vardecl"><span class="mpre">template</span></span></a><span class="mpre"> </span><a name="loc_1017_37_1017_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1017_37_1017_43&#39;)"><span class="hl_vardecl"><span class="mpre">action</span></span></a><span class="mpre"> =
  </span><a href="Control.Exception.Base.html#loc_259_1_259_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Exception.Base.html#loc_259_1_259_8&#39;)"><span class="hl_varref"><span class="mpre">Exception.bracket</span></span></a><span class="mpre">
    (</span><span class="hl_varref"><span class="mpre">openTempFile</span></span><span class="mpre"> </span><a href="#loc_1017_21_1017_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1017_21_1017_27&#39;)"><span class="hl_varref"><span class="mpre">tmpDir</span></span></a><span class="mpre"> </span><a href="#loc_1017_28_1017_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1017_28_1017_36&#39;)"><span class="hl_varref"><span class="mpre">template</span></span></a><span class="mpre">)
    (\(</span><a name="loc_1020_8_1020_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1020_8_1020_12&#39;)"><span class="hl_vardecl"><span class="mpre">name</span></span></a><span class="mpre">, </span><a name="loc_1020_14_1020_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1020_14_1020_20&#39;)"><span class="hl_vardecl"><span class="mpre">handle</span></span></a><span class="mpre">) -&gt; do </span><a href="GHC.IO.Handle.html#loc_86_1_86_7" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.html#loc_86_1_86_7&#39;)"><span class="hl_varref"><span class="mpre">hClose</span></span></a><span class="mpre"> </span><a href="#loc_1020_14_1020_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1020_14_1020_20&#39;)"><span class="hl_varref"><span class="mpre">handle</span></span></a><span class="mpre">
                           </span><a href="Control.Monad.html#loc_270_1_270_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_270_1_270_7&#39;)"><span class="hl_varref"><span class="mpre">unless</span></span></a><span class="mpre"> (</span><a href="#loc_997_3_997_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_997_3_997_19&#39;)"><span class="hl_varref"><span class="mpre">optKeepTempFiles</span></span></a><span class="mpre"> </span><a href="#loc_1017_16_1017_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1017_16_1017_20&#39;)"><span class="hl_varref"><span class="mpre">opts</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="System.Directory.html#loc_400_1_400_11" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Directory.html#loc_400_1_400_11&#39;)"><span class="hl_varref"><span class="mpre">removeFile</span></span></a><span class="mpre"> </span><a href="#loc_1020_8_1020_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1020_8_1020_12&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre">)
    (</span><span class="hl_varref"><span class="mpre">uncurry</span></span><span class="mpre"> </span><a href="#loc_1017_37_1017_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1017_37_1017_43&#39;)"><span class="hl_varref"><span class="mpre">action</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Create and use a temporary directory.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Creates a new temporary directory inside the given directory, making use</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- of the template. The temp directory is deleted after use. For example:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; withTempDirectory verbosity &quot;src&quot; &quot;sdist.&quot; $ \tmpDir -&gt; do ...</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The @tmpDir@ will be a new subdirectory of the given directory, e.g.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @src/sdist.342@.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_1036_1_1036_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1036_1_1036_18&#39;)"><span class="mpre">withTempDirectory</span></a><span class="mpre"> :: </span><a href="Distribution.Verbosity.html#loc_58_6_58_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Verbosity.html#loc_58_6_58_15&#39;)"><span class="hl_tyconref"><span class="mpre">Verbosity</span></span></a><span class="mpre">
                     -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_1036_1_1036_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1036_1_1036_18&#39;)"><span class="hl_fundecl"><span class="mpre">withTempDirectory</span></span></a><span class="mpre"> </span><a name="loc_1036_19_1036_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1036_19_1036_28&#39;)"><span class="hl_vardecl"><span class="mpre">verbosity</span></span></a><span class="mpre"> </span><a name="loc_1036_29_1036_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1036_29_1036_38&#39;)"><span class="hl_vardecl"><span class="mpre">targetDir</span></span></a><span class="mpre"> </span><a name="loc_1036_39_1036_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1036_39_1036_47&#39;)"><span class="hl_vardecl"><span class="mpre">template</span></span></a><span class="mpre"> =
  </span><a href="#loc_1044_1_1044_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1044_1_1044_20&#39;)"><span class="hl_varref"><span class="mpre">withTempDirectoryEx</span></span></a><span class="mpre"> </span><a href="#loc_1036_19_1036_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1036_19_1036_28&#39;)"><span class="hl_varref"><span class="mpre">verbosity</span></span></a><span class="mpre"> </span><a href="#loc_1001_1_1001_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1001_1_1001_23&#39;)"><span class="hl_varref"><span class="mpre">defaultTempFileOptions</span></span></a><span class="mpre"> </span><a href="#loc_1036_29_1036_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1036_29_1036_38&#39;)"><span class="hl_varref"><span class="mpre">targetDir</span></span></a><span class="mpre"> </span><a href="#loc_1036_39_1036_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1036_39_1036_47&#39;)"><span class="hl_varref"><span class="mpre">template</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | A version of &#39;withTempDirectory&#39; that additionally takes a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;TempFileOptions&#39; argument.</span></span><span class="mpre">
</span><a href="#loc_1044_1_1044_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1044_1_1044_20&#39;)"><span class="mpre">withTempDirectoryEx</span></a><span class="mpre"> :: </span><a href="Distribution.Verbosity.html#loc_58_6_58_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Verbosity.html#loc_58_6_58_15&#39;)"><span class="hl_tyconref"><span class="mpre">Verbosity</span></span></a><span class="mpre">
                       -&gt; </span><a href="#loc_996_6_996_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_996_6_996_21&#39;)"><span class="hl_tyconref"><span class="mpre">TempFileOptions</span></span></a><span class="mpre">
                       -&gt; </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_1044_1_1044_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1044_1_1044_20&#39;)"><span class="hl_fundecl"><span class="mpre">withTempDirectoryEx</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">_verbosity</span></span><span class="mpre"> </span><a name="loc_1044_32_1044_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1044_32_1044_36&#39;)"><span class="hl_vardecl"><span class="mpre">opts</span></span></a><span class="mpre"> </span><a name="loc_1044_37_1044_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1044_37_1044_46&#39;)"><span class="hl_vardecl"><span class="mpre">targetDir</span></span></a><span class="mpre"> </span><a name="loc_1044_47_1044_55" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1044_47_1044_55&#39;)"><span class="hl_vardecl"><span class="mpre">template</span></span></a><span class="mpre"> =
  </span><a href="Control.Exception.Base.html#loc_259_1_259_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Exception.Base.html#loc_259_1_259_8&#39;)"><span class="hl_varref"><span class="mpre">Exception.bracket</span></span></a><span class="mpre">
    (</span><a href="Distribution.Compat.TempFile.html#loc_110_1_110_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Compat.TempFile.html#loc_110_1_110_20&#39;)"><span class="hl_varref"><span class="mpre">createTempDirectory</span></span></a><span class="mpre"> </span><a href="#loc_1044_37_1044_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1044_37_1044_46&#39;)"><span class="hl_varref"><span class="mpre">targetDir</span></span></a><span class="mpre"> </span><a href="#loc_1044_47_1044_55" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1044_47_1044_55&#39;)"><span class="hl_varref"><span class="mpre">template</span></span></a><span class="mpre">)
    (</span><a href="Control.Monad.html#loc_270_1_270_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_270_1_270_7&#39;)"><span class="hl_varref"><span class="mpre">unless</span></span></a><span class="mpre"> (</span><a href="#loc_997_3_997_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_997_3_997_19&#39;)"><span class="hl_varref"><span class="mpre">optKeepTempFiles</span></span></a><span class="mpre"> </span><a href="#loc_1044_32_1044_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1044_32_1044_36&#39;)"><span class="hl_varref"><span class="mpre">opts</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="System.Directory.html#loc_351_1_351_25" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Directory.html#loc_351_1_351_25&#39;)"><span class="hl_varref"><span class="mpre">removeDirectoryRecursive</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-----------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Safely reading and writing files</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Gets the contents of a file, but guarantee that it gets closed.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The file is read lazily but if it is not fully consumed by the action then</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the remaining input is truncated and the file is closed.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_1058_1_1058_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1058_1_1058_17&#39;)"><span class="mpre">withFileContents</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_1058_1_1058_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1058_1_1058_17&#39;)"><span class="hl_fundecl"><span class="mpre">withFileContents</span></span></a><span class="mpre"> </span><a name="loc_1058_18_1058_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1058_18_1058_22&#39;)"><span class="hl_vardecl"><span class="mpre">name</span></span></a><span class="mpre"> </span><a name="loc_1058_23_1058_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1058_23_1058_29&#39;)"><span class="hl_vardecl"><span class="mpre">action</span></span></a><span class="mpre"> =
  </span><a href="Control.Exception.Base.html#loc_259_1_259_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Exception.Base.html#loc_259_1_259_8&#39;)"><span class="hl_varref"><span class="mpre">Exception.bracket</span></span></a><span class="mpre"> (</span><a href="GHC.IO.Handle.FD.html#loc_150_1_150_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.FD.html#loc_150_1_150_9&#39;)"><span class="hl_varref"><span class="mpre">openFile</span></span></a><span class="mpre"> </span><a href="#loc_1058_18_1058_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1058_18_1058_22&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre"> </span><a href="GHC.IO.IOMode.html#loc_28_21_28_29" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.IOMode.html#loc_28_21_28_29&#39;)"><span class="hl_conref"><span class="mpre">ReadMode</span></span></a><span class="mpre">) </span><a href="GHC.IO.Handle.html#loc_86_1_86_7" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.html#loc_86_1_86_7&#39;)"><span class="hl_varref"><span class="mpre">hClose</span></span></a><span class="mpre">
                    (\</span><a name="loc_1060_23_1060_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1060_23_1060_26&#39;)"><span class="hl_vardecl"><span class="mpre">hnd</span></span></a><span class="mpre"> -&gt; </span><a href="GHC.IO.Handle.Text.html#loc_379_1_379_13" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Text.html#loc_379_1_379_13&#39;)"><span class="hl_varref"><span class="mpre">hGetContents</span></span></a><span class="mpre"> </span><a href="#loc_1060_23_1060_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1060_23_1060_26&#39;)"><span class="hl_varref"><span class="mpre">hnd</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="#loc_1058_23_1058_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1058_23_1058_29&#39;)"><span class="hl_varref"><span class="mpre">action</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Writes a file atomically.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The file is either written sucessfully or an IO exception is raised and</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the original file is left unchanged.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- On windows it is not possible to delete a file that is open by a process.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This case will give an IO exception but the atomic property is not affected.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_1071_1_1071_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1071_1_1071_16&#39;)"><span class="mpre">writeFileAtomic</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">BS.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_1071_1_1071_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1071_1_1071_16&#39;)"><span class="hl_fundecl"><span class="mpre">writeFileAtomic</span></span></a><span class="mpre"> </span><a name="loc_1071_17_1071_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1071_17_1071_27&#39;)"><span class="hl_vardecl"><span class="mpre">targetPath</span></span></a><span class="mpre"> </span><a name="loc_1071_28_1071_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1071_28_1071_35&#39;)"><span class="hl_vardecl"><span class="mpre">content</span></span></a><span class="mpre"> = do
  let (</span><a name="loc_1072_8_1072_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1072_8_1072_17&#39;)"><span class="hl_vardecl"><span class="mpre">targetDir</span></span></a><span class="mpre">, </span><a name="loc_1072_19_1072_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1072_19_1072_29&#39;)"><span class="hl_vardecl"><span class="mpre">targetFile</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">splitFileName</span></span><span class="mpre"> </span><a href="#loc_1071_17_1071_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1071_17_1071_27&#39;)"><span class="hl_varref"><span class="mpre">targetPath</span></span></a><span class="mpre">
  </span><a href="Control.Exception.Base.html#loc_291_1_291_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Exception.Base.html#loc_291_1_291_15&#39;)"><span class="hl_varref"><span class="mpre">Exception.bracketOnError</span></span></a><span class="mpre">
    (</span><a href="System.IO.html#loc_450_1_450_19" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.html#loc_450_1_450_19&#39;)"><span class="hl_varref"><span class="mpre">openBinaryTempFile</span></span></a><span class="mpre"> </span><a href="#loc_1072_8_1072_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1072_8_1072_17&#39;)"><span class="hl_varref"><span class="mpre">targetDir</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_1072_19_1072_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1072_19_1072_29&#39;)"><span class="hl_varref"><span class="mpre">targetFile</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;.&gt;</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;tmp&quot;</span></span><span class="mpre">)
    (\(</span><a name="loc_1075_8_1075_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1075_8_1075_15&#39;)"><span class="hl_vardecl"><span class="mpre">tmpPath</span></span></a><span class="mpre">, </span><a name="loc_1075_17_1075_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1075_17_1075_23&#39;)"><span class="hl_vardecl"><span class="mpre">handle</span></span></a><span class="mpre">) -&gt; </span><a href="GHC.IO.Handle.html#loc_86_1_86_7" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.html#loc_86_1_86_7&#39;)"><span class="hl_varref"><span class="mpre">hClose</span></span></a><span class="mpre"> </span><a href="#loc_1075_17_1075_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1075_17_1075_23&#39;)"><span class="hl_varref"><span class="mpre">handle</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="System.Directory.html#loc_400_1_400_11" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Directory.html#loc_400_1_400_11&#39;)"><span class="hl_varref"><span class="mpre">removeFile</span></span></a><span class="mpre"> </span><a href="#loc_1075_8_1075_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1075_8_1075_15&#39;)"><span class="hl_varref"><span class="mpre">tmpPath</span></span></a><span class="mpre">)
    (\(</span><a name="loc_1076_8_1076_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1076_8_1076_15&#39;)"><span class="hl_vardecl"><span class="mpre">tmpPath</span></span></a><span class="mpre">, </span><a name="loc_1076_17_1076_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1076_17_1076_23&#39;)"><span class="hl_vardecl"><span class="mpre">handle</span></span></a><span class="mpre">) -&gt; do
        </span><span class="hl_varref"><span class="mpre">BS.hPut</span></span><span class="mpre"> </span><a href="#loc_1076_17_1076_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1076_17_1076_23&#39;)"><span class="hl_varref"><span class="mpre">handle</span></span></a><span class="mpre"> </span><a href="#loc_1071_28_1071_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1071_28_1071_35&#39;)"><span class="hl_varref"><span class="mpre">content</span></span></a><span class="mpre">
        </span><a href="GHC.IO.Handle.html#loc_86_1_86_7" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.html#loc_86_1_86_7&#39;)"><span class="hl_varref"><span class="mpre">hClose</span></span></a><span class="mpre"> </span><a href="#loc_1076_17_1076_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1076_17_1076_23&#39;)"><span class="hl_varref"><span class="mpre">handle</span></span></a><span class="mpre">
        </span><a href="System.Directory.html#loc_510_1_510_11" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Directory.html#loc_510_1_510_11&#39;)"><span class="hl_varref"><span class="mpre">renameFile</span></span></a><span class="mpre"> </span><a href="#loc_1076_8_1076_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1076_8_1076_15&#39;)"><span class="hl_varref"><span class="mpre">tmpPath</span></span></a><span class="mpre"> </span><a href="#loc_1071_17_1071_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1071_17_1071_27&#39;)"><span class="hl_varref"><span class="mpre">targetPath</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Write a file but only if it would have new content. If we would be writing</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the same as the existing content then leave the file as is so that we do not</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- update the file&#39;s modification time.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_1086_1_1086_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1086_1_1086_12&#39;)"><span class="mpre">rewriteFile</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_1086_1_1086_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1086_1_1086_12&#39;)"><span class="hl_fundecl"><span class="mpre">rewriteFile</span></span></a><span class="mpre"> </span><a name="loc_1086_13_1086_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1086_13_1086_17&#39;)"><span class="hl_vardecl"><span class="mpre">path</span></span></a><span class="mpre"> </span><a name="loc_1086_18_1086_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1086_18_1086_28&#39;)"><span class="hl_vardecl"><span class="mpre">newContent</span></span></a><span class="mpre"> =
  </span><span class="hl_varref"><span class="mpre">flip</span></span><span class="mpre"> </span><a href="Distribution.Compat.Exception.html#loc_14_1_14_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Compat.Exception.html#loc_14_1_14_8&#39;)"><span class="hl_varref"><span class="mpre">catchIO</span></span></a><span class="mpre"> </span><a href="#loc_1093_5_1093_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1093_5_1093_18&#39;)"><span class="hl_varref"><span class="mpre">mightNotExist</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
    </span><a name="loc_1088_5_1088_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1088_5_1088_20&#39;)"><span class="hl_vardecl"><span class="mpre">existingContent</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">readFile</span></span><span class="mpre"> </span><a href="#loc_1086_13_1086_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1086_13_1086_17&#39;)"><span class="hl_varref"><span class="mpre">path</span></span></a><span class="mpre">
    _ &lt;- </span><a href="GHC.IO.html#loc_480_1_480_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_480_1_480_9&#39;)"><span class="hl_varref"><span class="mpre">evaluate</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_1088_5_1088_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1088_5_1088_20&#39;)"><span class="hl_varref"><span class="mpre">existingContent</span></span></a><span class="mpre">)
    </span><a href="Control.Monad.html#loc_270_1_270_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_270_1_270_7&#39;)"><span class="hl_varref"><span class="mpre">unless</span></span></a><span class="mpre"> (</span><a href="#loc_1088_5_1088_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1088_5_1088_20&#39;)"><span class="hl_varref"><span class="mpre">existingContent</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_1086_18_1086_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1086_18_1086_28&#39;)"><span class="hl_varref"><span class="mpre">newContent</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
      </span><a href="#loc_1071_1_1071_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1071_1_1071_16&#39;)"><span class="hl_varref"><span class="mpre">writeFileAtomic</span></span></a><span class="mpre"> </span><a href="#loc_1086_13_1086_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1086_13_1086_17&#39;)"><span class="hl_varref"><span class="mpre">path</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">BS.Char8.pack</span></span><span class="mpre"> </span><a href="#loc_1086_18_1086_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1086_18_1086_28&#39;)"><span class="hl_varref"><span class="mpre">newContent</span></span></a><span class="mpre">)
  where
    </span><a name="loc_1093_5_1093_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1093_5_1093_18&#39;)"><span class="hl_fundecl"><span class="mpre">mightNotExist</span></span></a><span class="mpre"> </span><a name="loc_1093_19_1093_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1093_19_1093_20&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre"> | </span><a href="System.IO.Error.html#loc_135_1_135_20" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Error.html#loc_135_1_135_20&#39;)"><span class="hl_varref"><span class="mpre">isDoesNotExistError</span></span></a><span class="mpre"> </span><a href="#loc_1093_19_1093_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1093_19_1093_20&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre"> = </span><a href="#loc_1071_1_1071_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1071_1_1071_16&#39;)"><span class="hl_varref"><span class="mpre">writeFileAtomic</span></span></a><span class="mpre"> </span><a href="#loc_1086_13_1086_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1086_13_1086_17&#39;)"><span class="hl_varref"><span class="mpre">path</span></span></a><span class="mpre">
                                              (</span><span class="hl_varref"><span class="mpre">BS.Char8.pack</span></span><span class="mpre"> </span><a href="#loc_1086_18_1086_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1086_18_1086_28&#39;)"><span class="hl_varref"><span class="mpre">newContent</span></span></a><span class="mpre">)
                    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">             = </span><span class="hl_varref"><span class="mpre">ioError</span></span><span class="mpre"> </span><a href="#loc_1093_19_1093_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1093_19_1093_20&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The path name that represents the current directory.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- In Unix, it&#39;s @\&quot;.\&quot;@, but this is system-specific.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- (E.g. AmigaOS uses the empty string @\&quot;\&quot;@ for the current directory.)</span></span><span class="mpre">
</span><a href="#loc_1101_1_1101_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1101_1_1101_11&#39;)"><span class="mpre">currentDir</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">
</span><a name="loc_1101_1_1101_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1101_1_1101_11&#39;)"><span class="hl_vardecl"><span class="mpre">currentDir</span></span></a><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;.&quot;</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- ------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * Finding the description file</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Package description file (/pkgname/@.cabal@)</span></span><span class="mpre">
</span><a href="#loc_1109_1_1109_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1109_1_1109_19&#39;)"><span class="mpre">defaultPackageDesc</span></a><span class="mpre"> :: </span><a href="Distribution.Verbosity.html#loc_58_6_58_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Distribution.Verbosity.html#loc_58_6_58_15&#39;)"><span class="hl_tyconref"><span class="mpre">Verbosity</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">
</span><a name="loc_1109_1_1109_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1109_1_1109_19&#39;)"><span class="hl_fundecl"><span class="mpre">defaultPackageDesc</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">_verbosity</span></span><span class="mpre"> = </span><a href="#loc_1115_1_1115_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1115_1_1115_16&#39;)"><span class="hl_varref"><span class="mpre">findPackageDesc</span></span></a><span class="mpre"> </span><a href="#loc_1101_1_1101_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1101_1_1101_11&#39;)"><span class="hl_varref"><span class="mpre">currentDir</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Find a package description file in the given directory.  Looks for</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @.cabal@ files.</span></span><span class="mpre">
</span><a href="#loc_1115_1_1115_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1115_1_1115_16&#39;)"><span class="mpre">findPackageDesc</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">    </span><span class="hl_comment"><span class="mpre">-- ^Where to look</span></span><span class="mpre">
                -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^&lt;pkgname&gt;.cabal</span></span><span class="mpre">
</span><a name="loc_1115_1_1115_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1115_1_1115_16&#39;)"><span class="hl_fundecl"><span class="mpre">findPackageDesc</span></span></a><span class="mpre"> </span><a name="loc_1115_17_1115_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1115_17_1115_20&#39;)"><span class="hl_vardecl"><span class="mpre">dir</span></span></a><span class="mpre">
 = do </span><a name="loc_1116_7_1116_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1116_7_1116_12&#39;)"><span class="hl_vardecl"><span class="mpre">files</span></span></a><span class="mpre"> &lt;- </span><a href="System.Directory.html#loc_628_1_628_21" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Directory.html#loc_628_1_628_21&#39;)"><span class="hl_varref"><span class="mpre">getDirectoryContents</span></span></a><span class="mpre"> </span><a href="#loc_1115_17_1115_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1115_17_1115_20&#39;)"><span class="hl_varref"><span class="mpre">dir</span></span></a><span class="mpre">
      </span><span class="hl_comment"><span class="mpre">-- to make sure we do not mistake a ~/.cabal/ dir for a &lt;pkgname&gt;.cabal</span></span><span class="mpre">
      </span><span class="hl_comment"><span class="mpre">-- file we filter to exclude dirs and null base file names:</span></span><span class="mpre">
      </span><a name="loc_1119_7_1119_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1119_7_1119_17&#39;)"><span class="hl_vardecl"><span class="mpre">cabalFiles</span></span></a><span class="mpre"> &lt;- </span><a href="Control.Monad.html#loc_154_1_154_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_154_1_154_8&#39;)"><span class="hl_varref"><span class="mpre">filterM</span></span></a><span class="mpre"> </span><a href="System.Directory.html#loc_726_1_726_14" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Directory.html#loc_726_1_726_14&#39;)"><span class="hl_varref"><span class="mpre">doesFileExist</span></span></a><span class="mpre">
                       [ </span><a href="#loc_1115_17_1115_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1115_17_1115_20&#39;)"><span class="hl_varref"><span class="mpre">dir</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;/&gt;</span></span><span class="mpre"> </span><a href="#loc_1121_26_1121_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1121_26_1121_30&#39;)"><span class="hl_varref"><span class="mpre">file</span></span></a><span class="mpre">
                       | </span><a name="loc_1121_26_1121_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1121_26_1121_30&#39;)"><span class="hl_vardecl"><span class="mpre">file</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_1116_7_1116_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1116_7_1116_12&#39;)"><span class="hl_varref"><span class="mpre">files</span></span></a><span class="mpre">
                       , let (</span><a name="loc_1122_31_1122_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1122_31_1122_35&#39;)"><span class="hl_vardecl"><span class="mpre">name</span></span></a><span class="mpre">, </span><a name="loc_1122_37_1122_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1122_37_1122_40&#39;)"><span class="hl_vardecl"><span class="mpre">ext</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">splitExtension</span></span><span class="mpre"> </span><a href="#loc_1121_26_1121_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1121_26_1121_30&#39;)"><span class="hl_varref"><span class="mpre">file</span></span></a><span class="mpre">
                       , </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_1122_31_1122_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1122_31_1122_35&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_1122_37_1122_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1122_37_1122_40&#39;)"><span class="hl_varref"><span class="mpre">ext</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;.cabal&quot;</span></span><span class="mpre"> ]
      case </span><a href="#loc_1119_7_1119_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1119_7_1119_17&#39;)"><span class="hl_varref"><span class="mpre">cabalFiles</span></span></a><span class="mpre"> of
        []          -&gt; </span><a href="#loc_1131_5_1131_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1131_5_1131_11&#39;)"><span class="hl_varref"><span class="mpre">noDesc</span></span></a><span class="mpre">
        [</span><a name="loc_1126_10_1126_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1126_10_1126_19&#39;)"><span class="hl_vardecl"><span class="mpre">cabalFile</span></span></a><span class="mpre">] -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_1126_10_1126_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1126_10_1126_19&#39;)"><span class="hl_varref"><span class="mpre">cabalFile</span></span></a><span class="mpre">
        </span><a name="loc_1127_9_1127_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1127_9_1127_17&#39;)"><span class="hl_vardecl"><span class="mpre">multiple</span></span></a><span class="mpre">    -&gt; </span><a href="#loc_1135_5_1135_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1135_5_1135_14&#39;)"><span class="hl_varref"><span class="mpre">multiDesc</span></span></a><span class="mpre"> </span><a href="#loc_1127_9_1127_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1127_9_1127_17&#39;)"><span class="hl_varref"><span class="mpre">multiple</span></span></a><span class="mpre">

  where
    </span><a href="#loc_1131_5_1131_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1131_5_1131_11&#39;)"><span class="mpre">noDesc</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
    </span><a name="loc_1131_5_1131_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1131_5_1131_11&#39;)"><span class="hl_vardecl"><span class="mpre">noDesc</span></span></a><span class="mpre"> = </span><a href="#loc_251_1_251_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_251_1_251_4&#39;)"><span class="hl_varref"><span class="mpre">die</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;No cabal file found.\n&quot;</span></span><span class="mpre">
                </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Please create a package description file &lt;pkgname&gt;.cabal&quot;</span></span><span class="mpre">

    </span><a href="#loc_1135_5_1135_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1135_5_1135_14&#39;)"><span class="mpre">multiDesc</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
    </span><a name="loc_1135_5_1135_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1135_5_1135_14&#39;)"><span class="hl_fundecl"><span class="mpre">multiDesc</span></span></a><span class="mpre"> </span><a name="loc_1135_15_1135_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1135_15_1135_16&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> = </span><a href="#loc_251_1_251_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_251_1_251_4&#39;)"><span class="hl_varref"><span class="mpre">die</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Multiple cabal files found.\n&quot;</span></span><span class="mpre">
                    </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Please use only one of: &quot;</span></span><span class="mpre">
                    </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="Data.List.html#loc_443_1_443_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_443_1_443_12&#39;)"><span class="hl_varref"><span class="mpre">intercalate</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;, &quot;</span></span><span class="mpre"> </span><a href="#loc_1135_15_1135_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1135_15_1135_16&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Optional auxiliary package information file (/pkgname/@.buildinfo@)</span></span><span class="mpre">
</span><a href="#loc_1141_1_1141_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1141_1_1141_25&#39;)"><span class="mpre">defaultHookedPackageDesc</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">)
</span><a name="loc_1141_1_1141_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1141_1_1141_25&#39;)"><span class="hl_vardecl"><span class="mpre">defaultHookedPackageDesc</span></span></a><span class="mpre"> = </span><a href="#loc_1148_1_1148_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1148_1_1148_22&#39;)"><span class="hl_varref"><span class="mpre">findHookedPackageDesc</span></span></a><span class="mpre"> </span><a href="#loc_1101_1_1101_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1101_1_1101_11&#39;)"><span class="hl_varref"><span class="mpre">currentDir</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Find auxiliary package information in the given directory.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Looks for @.buildinfo@ files.</span></span><span class="mpre">
</span><a href="#loc_1148_1_1148_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1148_1_1148_22&#39;)"><span class="mpre">findHookedPackageDesc</span></a><span class="mpre">
    :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">                 </span><span class="hl_comment"><span class="mpre">-- ^Directory to search</span></span><span class="mpre">
    -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre">)      </span><span class="hl_comment"><span class="mpre">-- ^/dir/@\/@/pkgname/@.buildinfo@, if present</span></span><span class="mpre">
</span><a name="loc_1148_1_1148_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1148_1_1148_22&#39;)"><span class="hl_fundecl"><span class="mpre">findHookedPackageDesc</span></span></a><span class="mpre"> </span><a name="loc_1148_23_1148_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1148_23_1148_26&#39;)"><span class="hl_vardecl"><span class="mpre">dir</span></span></a><span class="mpre"> = do
    </span><a name="loc_1149_5_1149_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1149_5_1149_10&#39;)"><span class="hl_vardecl"><span class="mpre">files</span></span></a><span class="mpre"> &lt;- </span><a href="System.Directory.html#loc_628_1_628_21" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Directory.html#loc_628_1_628_21&#39;)"><span class="hl_varref"><span class="mpre">getDirectoryContents</span></span></a><span class="mpre"> </span><a href="#loc_1148_23_1148_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1148_23_1148_26&#39;)"><span class="hl_varref"><span class="mpre">dir</span></span></a><span class="mpre">
    </span><a name="loc_1150_5_1150_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1150_5_1150_19&#39;)"><span class="hl_vardecl"><span class="mpre">buildInfoFiles</span></span></a><span class="mpre"> &lt;- </span><a href="Control.Monad.html#loc_154_1_154_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_154_1_154_8&#39;)"><span class="hl_varref"><span class="mpre">filterM</span></span></a><span class="mpre"> </span><a href="System.Directory.html#loc_726_1_726_14" onmouseover="nemnem.highlightLocalToRemote(&#39;System.Directory.html#loc_726_1_726_14&#39;)"><span class="hl_varref"><span class="mpre">doesFileExist</span></span></a><span class="mpre">
                        [ </span><a href="#loc_1148_23_1148_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1148_23_1148_26&#39;)"><span class="hl_varref"><span class="mpre">dir</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;/&gt;</span></span><span class="mpre"> </span><a href="#loc_1152_27_1152_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1152_27_1152_31&#39;)"><span class="hl_varref"><span class="mpre">file</span></span></a><span class="mpre">
                        | </span><a name="loc_1152_27_1152_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1152_27_1152_31&#39;)"><span class="hl_vardecl"><span class="mpre">file</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_1149_5_1149_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1149_5_1149_10&#39;)"><span class="hl_varref"><span class="mpre">files</span></span></a><span class="mpre">
                        , let (</span><a name="loc_1153_32_1153_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1153_32_1153_36&#39;)"><span class="hl_vardecl"><span class="mpre">name</span></span></a><span class="mpre">, </span><a name="loc_1153_38_1153_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1153_38_1153_41&#39;)"><span class="hl_vardecl"><span class="mpre">ext</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">splitExtension</span></span><span class="mpre"> </span><a href="#loc_1152_27_1152_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1152_27_1152_31&#39;)"><span class="hl_varref"><span class="mpre">file</span></span></a><span class="mpre">
                        , </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_1153_32_1153_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1153_32_1153_36&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_1153_38_1153_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1153_38_1153_41&#39;)"><span class="hl_varref"><span class="mpre">ext</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_1161_1_1161_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1161_1_1161_13&#39;)"><span class="hl_varref"><span class="mpre">buildInfoExt</span></span></a><span class="mpre"> ]
    case </span><a href="#loc_1150_5_1150_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1150_5_1150_19&#39;)"><span class="hl_varref"><span class="mpre">buildInfoFiles</span></span></a><span class="mpre"> of
        [] -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
        [</span><a name="loc_1157_10_1157_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1157_10_1157_11&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">] -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="#loc_1157_10_1157_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1157_10_1157_11&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">)
        _ -&gt; </span><a href="#loc_251_1_251_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_251_1_251_4&#39;)"><span class="hl_varref"><span class="mpre">die</span></span></a><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;Multiple files with extension &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_1161_1_1161_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1161_1_1161_13&#39;)"><span class="hl_varref"><span class="mpre">buildInfoExt</span></span></a><span class="mpre">)

</span><a href="#loc_1161_1_1161_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1161_1_1161_13&#39;)"><span class="mpre">buildInfoExt</span></a><span class="mpre">  :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_1161_1_1161_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1161_1_1161_13&#39;)"><span class="hl_vardecl"><span class="mpre">buildInfoExt</span></span></a><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;.buildinfo&quot;</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- ------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * Unicode stuff</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- This is a modification of the UTF8 code from gtk2hs and the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- utf8-string package.</span></span><span class="mpre">

</span><a href="#loc_1171_1_1171_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1171_1_1171_9&#39;)"><span class="mpre">fromUTF8</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_1171_1_1171_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1171_1_1171_9&#39;)"><span class="hl_fundecl"><span class="mpre">fromUTF8</span></span></a><span class="mpre"> []     = []
</span><a href="#loc_1171_1_1171_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1171_1_1171_9&#39;)"><span class="hl_fundecl"><span class="mpre">fromUTF8</span></span></a><span class="mpre"> (</span><a name="loc_1172_11_1172_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1172_11_1172_12&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_1172_13_1172_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1172_13_1172_15&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre">)
  | </span><a href="#loc_1172_11_1172_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1172_11_1172_12&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;\x7F&#39;</span></span><span class="mpre"> = </span><a href="#loc_1172_11_1172_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1172_11_1172_12&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_1171_1_1171_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1171_1_1171_9&#39;)"><span class="hl_varref"><span class="mpre">fromUTF8</span></span></a><span class="mpre"> </span><a href="#loc_1172_13_1172_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1172_13_1172_15&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">
  | </span><a href="#loc_1172_11_1172_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1172_11_1172_12&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;\xBF&#39;</span></span><span class="mpre"> = </span><a href="#loc_1209_5_1209_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1209_5_1209_20&#39;)"><span class="hl_varref"><span class="mpre">replacementChar</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_1171_1_1171_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1171_1_1171_9&#39;)"><span class="hl_varref"><span class="mpre">fromUTF8</span></span></a><span class="mpre"> </span><a href="#loc_1172_13_1172_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1172_13_1172_15&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">
  | </span><a href="#loc_1172_11_1172_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1172_11_1172_12&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;\xDF&#39;</span></span><span class="mpre"> = </span><a href="#loc_1182_5_1182_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1182_5_1182_13&#39;)"><span class="hl_varref"><span class="mpre">twoBytes</span></span></a><span class="mpre"> </span><a href="#loc_1172_11_1172_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1172_11_1172_12&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><a href="#loc_1172_13_1172_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1172_13_1172_15&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">
  | </span><a href="#loc_1172_11_1172_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1172_11_1172_12&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;\xEF&#39;</span></span><span class="mpre"> = </span><a href="#loc_1192_5_1192_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1192_5_1192_14&#39;)"><span class="hl_varref"><span class="mpre">moreBytes</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x800</span></span><span class="mpre">     </span><a href="#loc_1172_13_1172_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1172_13_1172_15&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">ord</span></span><span class="mpre"> </span><a href="#loc_1172_11_1172_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1172_11_1172_12&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xF</span></span><span class="mpre">)
  | </span><a href="#loc_1172_11_1172_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1172_11_1172_12&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;\xF7&#39;</span></span><span class="mpre"> = </span><a href="#loc_1192_5_1192_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1192_5_1192_14&#39;)"><span class="hl_varref"><span class="mpre">moreBytes</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x10000</span></span><span class="mpre">   </span><a href="#loc_1172_13_1172_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1172_13_1172_15&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">ord</span></span><span class="mpre"> </span><a href="#loc_1172_11_1172_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1172_11_1172_12&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x7</span></span><span class="mpre">)
  | </span><a href="#loc_1172_11_1172_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1172_11_1172_12&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;\xFB&#39;</span></span><span class="mpre"> = </span><a href="#loc_1192_5_1192_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1192_5_1192_14&#39;)"><span class="hl_varref"><span class="mpre">moreBytes</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x200000</span></span><span class="mpre">  </span><a href="#loc_1172_13_1172_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1172_13_1172_15&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">ord</span></span><span class="mpre"> </span><a href="#loc_1172_11_1172_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1172_11_1172_12&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x3</span></span><span class="mpre">)
  | </span><a href="#loc_1172_11_1172_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1172_11_1172_12&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;\xFD&#39;</span></span><span class="mpre"> = </span><a href="#loc_1192_5_1192_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1192_5_1192_14&#39;)"><span class="hl_varref"><span class="mpre">moreBytes</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x4000000</span></span><span class="mpre"> </span><a href="#loc_1172_13_1172_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1172_13_1172_15&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">ord</span></span><span class="mpre"> </span><a href="#loc_1172_11_1172_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1172_11_1172_12&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x1</span></span><span class="mpre">)
  | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">   = </span><a href="#loc_1209_5_1209_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1209_5_1209_20&#39;)"><span class="hl_varref"><span class="mpre">replacementChar</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_1171_1_1171_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1171_1_1171_9&#39;)"><span class="hl_varref"><span class="mpre">fromUTF8</span></span></a><span class="mpre"> </span><a href="#loc_1172_13_1172_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1172_13_1172_15&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">
  where
    </span><a name="loc_1182_5_1182_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1182_5_1182_13&#39;)"><span class="hl_fundecl"><span class="mpre">twoBytes</span></span></a><span class="mpre"> </span><a name="loc_1182_14_1182_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1182_14_1182_16&#39;)"><span class="hl_vardecl"><span class="mpre">c0</span></span></a><span class="mpre"> (</span><a name="loc_1182_18_1182_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1182_18_1182_20&#39;)"><span class="hl_vardecl"><span class="mpre">c1</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_1182_21_1182_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1182_21_1182_24&#39;)"><span class="hl_vardecl"><span class="mpre">cs&#39;</span></span></a><span class="mpre">)
      | </span><span class="hl_varref"><span class="mpre">ord</span></span><span class="mpre"> </span><a href="#loc_1182_18_1182_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1182_18_1182_20&#39;)"><span class="hl_varref"><span class="mpre">c1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xC0</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x80</span></span><span class="mpre">
      = let </span><a name="loc_1184_13_1184_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1184_13_1184_14&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre"> = ((</span><span class="hl_varref"><span class="mpre">ord</span></span><span class="mpre"> </span><a href="#loc_1182_14_1182_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1182_14_1182_16&#39;)"><span class="hl_varref"><span class="mpre">c0</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x1F</span></span><span class="mpre">) </span><a href="Data.Bits.html#loc_200_5_200_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_200_5_200_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftL`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre">)
             </span><span class="hl_infix"><span class="mpre">.|.</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">ord</span></span><span class="mpre"> </span><a href="#loc_1182_18_1182_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1182_18_1182_20&#39;)"><span class="hl_varref"><span class="mpre">c1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x3F</span></span><span class="mpre">)
         in if </span><a href="#loc_1184_13_1184_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1184_13_1184_14&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x80</span></span><span class="mpre">
               then  </span><a href="GHC.Char.html#loc_11_1_11_4" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Char.html#loc_11_1_11_4&#39;)"><span class="hl_varref"><span class="mpre">chr</span></span></a><span class="mpre"> </span><a href="#loc_1184_13_1184_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1184_13_1184_14&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre">           </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_1171_1_1171_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1171_1_1171_9&#39;)"><span class="hl_varref"><span class="mpre">fromUTF8</span></span></a><span class="mpre"> </span><a href="#loc_1182_21_1182_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1182_21_1182_24&#39;)"><span class="hl_varref"><span class="mpre">cs&#39;</span></span></a><span class="mpre">
               else  </span><a href="#loc_1209_5_1209_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1209_5_1209_20&#39;)"><span class="hl_varref"><span class="mpre">replacementChar</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_1171_1_1171_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1171_1_1171_9&#39;)"><span class="hl_varref"><span class="mpre">fromUTF8</span></span></a><span class="mpre"> </span><a href="#loc_1182_21_1182_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1182_21_1182_24&#39;)"><span class="hl_varref"><span class="mpre">cs&#39;</span></span></a><span class="mpre">
    </span><a href="#loc_1182_5_1182_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1182_5_1182_13&#39;)"><span class="hl_fundecl"><span class="mpre">twoBytes</span></span></a><span class="mpre"> _ </span><a name="loc_1189_16_1189_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1189_16_1189_19&#39;)"><span class="hl_vardecl"><span class="mpre">cs&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_1209_5_1209_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1209_5_1209_20&#39;)"><span class="hl_varref"><span class="mpre">replacementChar</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_1171_1_1171_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1171_1_1171_9&#39;)"><span class="hl_varref"><span class="mpre">fromUTF8</span></span></a><span class="mpre"> </span><a href="#loc_1189_16_1189_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1189_16_1189_19&#39;)"><span class="hl_varref"><span class="mpre">cs&#39;</span></span></a><span class="mpre">

    </span><a href="#loc_1192_5_1192_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1192_5_1192_14&#39;)"><span class="mpre">moreBytes</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">]
    </span><a name="loc_1192_5_1192_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1192_5_1192_14&#39;)"><span class="hl_fundecl"><span class="mpre">moreBytes</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><a name="loc_1192_17_1192_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1192_17_1192_25&#39;)"><span class="hl_vardecl"><span class="mpre">overlong</span></span></a><span class="mpre"> </span><a name="loc_1192_26_1192_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1192_26_1192_29&#39;)"><span class="hl_vardecl"><span class="mpre">cs&#39;</span></span></a><span class="mpre"> </span><a name="loc_1192_30_1192_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1192_30_1192_33&#39;)"><span class="hl_vardecl"><span class="mpre">acc</span></span></a><span class="mpre">
      | </span><a href="#loc_1192_17_1192_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1192_17_1192_25&#39;)"><span class="hl_varref"><span class="mpre">overlong</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><a href="#loc_1192_30_1192_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1192_30_1192_33&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_1192_30_1192_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1192_30_1192_33&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x10FFFF</span></span><span class="mpre">
     </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> (</span><a href="#loc_1192_30_1192_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1192_30_1192_33&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xD800</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xDFFF</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_1192_30_1192_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1192_30_1192_33&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre">)
     </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> (</span><a href="#loc_1192_30_1192_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1192_30_1192_33&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xFFFE</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xFFFF</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_1192_30_1192_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1192_30_1192_33&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre">)
      = </span><a href="GHC.Char.html#loc_11_1_11_4" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Char.html#loc_11_1_11_4&#39;)"><span class="hl_varref"><span class="mpre">chr</span></span></a><span class="mpre"> </span><a href="#loc_1192_30_1192_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1192_30_1192_33&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_1171_1_1171_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1171_1_1171_9&#39;)"><span class="hl_varref"><span class="mpre">fromUTF8</span></span></a><span class="mpre"> </span><a href="#loc_1192_26_1192_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1192_26_1192_29&#39;)"><span class="hl_varref"><span class="mpre">cs&#39;</span></span></a><span class="mpre">

      | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">
      = </span><a href="#loc_1209_5_1209_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1209_5_1209_20&#39;)"><span class="hl_varref"><span class="mpre">replacementChar</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_1171_1_1171_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1171_1_1171_9&#39;)"><span class="hl_varref"><span class="mpre">fromUTF8</span></span></a><span class="mpre"> </span><a href="#loc_1192_26_1192_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1192_26_1192_29&#39;)"><span class="hl_varref"><span class="mpre">cs&#39;</span></span></a><span class="mpre">

    </span><a href="#loc_1192_5_1192_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1192_5_1192_14&#39;)"><span class="hl_fundecl"><span class="mpre">moreBytes</span></span></a><span class="mpre"> </span><a name="loc_1201_15_1201_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1201_15_1201_24&#39;)"><span class="hl_vardecl"><span class="mpre">byteCount</span></span></a><span class="mpre"> </span><a name="loc_1201_25_1201_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1201_25_1201_33&#39;)"><span class="hl_vardecl"><span class="mpre">overlong</span></span></a><span class="mpre"> (</span><a name="loc_1201_35_1201_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1201_35_1201_37&#39;)"><span class="hl_vardecl"><span class="mpre">cn</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_1201_38_1201_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1201_38_1201_41&#39;)"><span class="hl_vardecl"><span class="mpre">cs&#39;</span></span></a><span class="mpre">) </span><a name="loc_1201_43_1201_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1201_43_1201_46&#39;)"><span class="hl_vardecl"><span class="mpre">acc</span></span></a><span class="mpre">
      | </span><span class="hl_varref"><span class="mpre">ord</span></span><span class="mpre"> </span><a href="#loc_1201_35_1201_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1201_35_1201_37&#39;)"><span class="hl_varref"><span class="mpre">cn</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xC0</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x80</span></span><span class="mpre">
      = </span><a href="#loc_1192_5_1192_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1192_5_1192_14&#39;)"><span class="hl_varref"><span class="mpre">moreBytes</span></span></a><span class="mpre"> (</span><a href="#loc_1201_15_1201_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1201_15_1201_24&#39;)"><span class="hl_varref"><span class="mpre">byteCount</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_1201_25_1201_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1201_25_1201_33&#39;)"><span class="hl_varref"><span class="mpre">overlong</span></span></a><span class="mpre"> </span><a href="#loc_1201_38_1201_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1201_38_1201_41&#39;)"><span class="hl_varref"><span class="mpre">cs&#39;</span></span></a><span class="mpre">
          ((</span><a href="#loc_1201_43_1201_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1201_43_1201_46&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_200_5_200_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_200_5_200_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftL`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.|.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">ord</span></span><span class="mpre"> </span><a href="#loc_1201_35_1201_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1201_35_1201_37&#39;)"><span class="hl_varref"><span class="mpre">cn</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x3F</span></span><span class="mpre">)

    </span><a href="#loc_1192_5_1192_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1192_5_1192_14&#39;)"><span class="hl_fundecl"><span class="mpre">moreBytes</span></span></a><span class="mpre"> _ _ </span><a name="loc_1206_19_1206_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1206_19_1206_22&#39;)"><span class="hl_vardecl"><span class="mpre">cs&#39;</span></span></a><span class="mpre"> _
      = </span><a href="#loc_1209_5_1209_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1209_5_1209_20&#39;)"><span class="hl_varref"><span class="mpre">replacementChar</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_1171_1_1171_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1171_1_1171_9&#39;)"><span class="hl_varref"><span class="mpre">fromUTF8</span></span></a><span class="mpre"> </span><a href="#loc_1206_19_1206_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1206_19_1206_22&#39;)"><span class="hl_varref"><span class="mpre">cs&#39;</span></span></a><span class="mpre">

    </span><a name="loc_1209_5_1209_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1209_5_1209_20&#39;)"><span class="hl_vardecl"><span class="mpre">replacementChar</span></span></a><span class="mpre"> = </span><span class="hl_char"><span class="mpre">&#39;\xfffd&#39;</span></span><span class="mpre">

</span><a href="#loc_1212_1_1212_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1212_1_1212_7&#39;)"><span class="mpre">toUTF8</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_1212_1_1212_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1212_1_1212_7&#39;)"><span class="hl_fundecl"><span class="mpre">toUTF8</span></span></a><span class="mpre"> []        = []
</span><a href="#loc_1212_1_1212_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1212_1_1212_7&#39;)"><span class="hl_fundecl"><span class="mpre">toUTF8</span></span></a><span class="mpre"> (</span><a name="loc_1213_9_1213_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1213_9_1213_10&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_1213_11_1213_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1213_11_1213_13&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre">)
  | </span><a href="#loc_1213_9_1213_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1213_9_1213_10&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;\x07F&#39;</span></span><span class="mpre"> = </span><a href="#loc_1213_9_1213_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1213_9_1213_10&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">
                 </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_1212_1_1212_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1212_1_1212_7&#39;)"><span class="hl_varref"><span class="mpre">toUTF8</span></span></a><span class="mpre"> </span><a href="#loc_1213_11_1213_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1213_11_1213_13&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">
  | </span><a href="#loc_1213_9_1213_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1213_9_1213_10&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;\x7FF&#39;</span></span><span class="mpre"> = </span><a href="GHC.Char.html#loc_11_1_11_4" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Char.html#loc_11_1_11_4&#39;)"><span class="hl_varref"><span class="mpre">chr</span></span></a><span class="mpre"> (</span><span class="hl_num"><span class="mpre">0xC0</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.|.</span></span><span class="mpre"> (</span><a href="#loc_1228_9_1228_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1228_9_1228_10&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_226_5_226_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_226_5_226_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftR`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre">))
                 </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="GHC.Char.html#loc_11_1_11_4" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Char.html#loc_11_1_11_4&#39;)"><span class="hl_varref"><span class="mpre">chr</span></span></a><span class="mpre"> (</span><span class="hl_num"><span class="mpre">0x80</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.|.</span></span><span class="mpre"> (</span><a href="#loc_1228_9_1228_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1228_9_1228_10&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x3F</span></span><span class="mpre">))
                 </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_1212_1_1212_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1212_1_1212_7&#39;)"><span class="hl_varref"><span class="mpre">toUTF8</span></span></a><span class="mpre"> </span><a href="#loc_1213_11_1213_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1213_11_1213_13&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">
  | </span><a href="#loc_1213_9_1213_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1213_9_1213_10&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;\xFFFF&#39;</span></span><span class="mpre">= </span><a href="GHC.Char.html#loc_11_1_11_4" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Char.html#loc_11_1_11_4&#39;)"><span class="hl_varref"><span class="mpre">chr</span></span></a><span class="mpre"> (</span><span class="hl_num"><span class="mpre">0xE0</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.|.</span></span><span class="mpre">  (</span><a href="#loc_1228_9_1228_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1228_9_1228_10&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_226_5_226_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_226_5_226_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftR`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">12</span></span><span class="mpre">))
                 </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="GHC.Char.html#loc_11_1_11_4" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Char.html#loc_11_1_11_4&#39;)"><span class="hl_varref"><span class="mpre">chr</span></span></a><span class="mpre"> (</span><span class="hl_num"><span class="mpre">0x80</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.|.</span></span><span class="mpre"> ((</span><a href="#loc_1228_9_1228_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1228_9_1228_10&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_226_5_226_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_226_5_226_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftR`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre">)  </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x3F</span></span><span class="mpre">))
                 </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="GHC.Char.html#loc_11_1_11_4" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Char.html#loc_11_1_11_4&#39;)"><span class="hl_varref"><span class="mpre">chr</span></span></a><span class="mpre"> (</span><span class="hl_num"><span class="mpre">0x80</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.|.</span></span><span class="mpre">  (</span><a href="#loc_1228_9_1228_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1228_9_1228_10&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x3F</span></span><span class="mpre">))
                 </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_1212_1_1212_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1212_1_1212_7&#39;)"><span class="hl_varref"><span class="mpre">toUTF8</span></span></a><span class="mpre"> </span><a href="#loc_1213_11_1213_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1213_11_1213_13&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">
  | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">    = </span><a href="GHC.Char.html#loc_11_1_11_4" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Char.html#loc_11_1_11_4&#39;)"><span class="hl_varref"><span class="mpre">chr</span></span></a><span class="mpre"> (</span><span class="hl_num"><span class="mpre">0xf0</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.|.</span></span><span class="mpre">  (</span><a href="#loc_1228_9_1228_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1228_9_1228_10&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_226_5_226_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_226_5_226_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftR`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">18</span></span><span class="mpre">))
                 </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="GHC.Char.html#loc_11_1_11_4" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Char.html#loc_11_1_11_4&#39;)"><span class="hl_varref"><span class="mpre">chr</span></span></a><span class="mpre"> (</span><span class="hl_num"><span class="mpre">0x80</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.|.</span></span><span class="mpre"> ((</span><a href="#loc_1228_9_1228_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1228_9_1228_10&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_226_5_226_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_226_5_226_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftR`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">12</span></span><span class="mpre">)  </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x3F</span></span><span class="mpre">))
                 </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="GHC.Char.html#loc_11_1_11_4" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Char.html#loc_11_1_11_4&#39;)"><span class="hl_varref"><span class="mpre">chr</span></span></a><span class="mpre"> (</span><span class="hl_num"><span class="mpre">0x80</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.|.</span></span><span class="mpre"> ((</span><a href="#loc_1228_9_1228_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1228_9_1228_10&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_226_5_226_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_226_5_226_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftR`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">6</span></span><span class="mpre">)  </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x3F</span></span><span class="mpre">))
                 </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="GHC.Char.html#loc_11_1_11_4" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Char.html#loc_11_1_11_4&#39;)"><span class="hl_varref"><span class="mpre">chr</span></span></a><span class="mpre"> (</span><span class="hl_num"><span class="mpre">0x80</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.|.</span></span><span class="mpre">  (</span><a href="#loc_1228_9_1228_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1228_9_1228_10&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x3F</span></span><span class="mpre">))
                 </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_1212_1_1212_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1212_1_1212_7&#39;)"><span class="hl_varref"><span class="mpre">toUTF8</span></span></a><span class="mpre"> </span><a href="#loc_1213_11_1213_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1213_11_1213_13&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">
  where </span><a name="loc_1228_9_1228_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1228_9_1228_10&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">ord</span></span><span class="mpre"> </span><a href="#loc_1213_9_1213_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1213_9_1213_10&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Ignore a Unicode byte order mark (BOM) at the beginning of the input</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_1233_1_1233_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1233_1_1233_10&#39;)"><span class="mpre">ignoreBOM</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_1233_1_1233_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1233_1_1233_10&#39;)"><span class="hl_fundecl"><span class="mpre">ignoreBOM</span></span></a><span class="mpre"> (</span><span class="hl_char"><span class="mpre">&#39;\xFEFF&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_1233_21_1233_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1233_21_1233_27&#39;)"><span class="hl_vardecl"><span class="mpre">string</span></span></a><span class="mpre">) = </span><a href="#loc_1233_21_1233_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1233_21_1233_27&#39;)"><span class="hl_varref"><span class="mpre">string</span></span></a><span class="mpre">
</span><a href="#loc_1233_1_1233_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1233_1_1233_10&#39;)"><span class="hl_fundecl"><span class="mpre">ignoreBOM</span></span></a><span class="mpre"> </span><a name="loc_1234_11_1234_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1234_11_1234_17&#39;)"><span class="hl_vardecl"><span class="mpre">string</span></span></a><span class="mpre">            = </span><a href="#loc_1234_11_1234_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1234_11_1234_17&#39;)"><span class="hl_varref"><span class="mpre">string</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Reads a UTF8 encoded text file as a Unicode String</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Reads lazily using ordinary &#39;readFile&#39;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_1241_1_1241_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1241_1_1241_13&#39;)"><span class="mpre">readUTF8File</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_1241_1_1241_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1241_1_1241_13&#39;)"><span class="hl_fundecl"><span class="mpre">readUTF8File</span></span></a><span class="mpre"> </span><a name="loc_1241_14_1241_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1241_14_1241_15&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> (</span><a href="#loc_1233_1_1233_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1233_1_1233_10&#39;)"><span class="hl_varref"><span class="mpre">ignoreBOM</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_1171_1_1171_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1171_1_1171_9&#39;)"><span class="hl_varref"><span class="mpre">fromUTF8</span></span></a><span class="mpre">)
               </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="GHC.IO.Handle.Text.html#loc_379_1_379_13" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Text.html#loc_379_1_379_13&#39;)"><span class="hl_varref"><span class="mpre">hGetContents</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">=&lt;&lt;</span></span><span class="mpre"> </span><a href="GHC.IO.Handle.FD.html#loc_177_1_177_15" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.FD.html#loc_177_1_177_15&#39;)"><span class="hl_varref"><span class="mpre">openBinaryFile</span></span></a><span class="mpre"> </span><a href="#loc_1241_14_1241_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1241_14_1241_15&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="GHC.IO.IOMode.html#loc_28_21_28_29" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.IOMode.html#loc_28_21_28_29&#39;)"><span class="hl_conref"><span class="mpre">ReadMode</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Reads a UTF8 encoded text file as a Unicode String</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Same behaviour as &#39;withFileContents&#39;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_1249_1_1249_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1249_1_1249_21&#39;)"><span class="mpre">withUTF8FileContents</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_1249_1_1249_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1249_1_1249_21&#39;)"><span class="hl_fundecl"><span class="mpre">withUTF8FileContents</span></span></a><span class="mpre"> </span><a name="loc_1249_22_1249_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1249_22_1249_26&#39;)"><span class="hl_vardecl"><span class="mpre">name</span></span></a><span class="mpre"> </span><a name="loc_1249_27_1249_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1249_27_1249_33&#39;)"><span class="hl_vardecl"><span class="mpre">action</span></span></a><span class="mpre"> =
  </span><a href="Control.Exception.Base.html#loc_259_1_259_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Exception.Base.html#loc_259_1_259_8&#39;)"><span class="hl_varref"><span class="mpre">Exception.bracket</span></span></a><span class="mpre">
    (</span><a href="GHC.IO.Handle.FD.html#loc_177_1_177_15" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.FD.html#loc_177_1_177_15&#39;)"><span class="hl_varref"><span class="mpre">openBinaryFile</span></span></a><span class="mpre"> </span><a href="#loc_1249_22_1249_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1249_22_1249_26&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre"> </span><a href="GHC.IO.IOMode.html#loc_28_21_28_29" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.IOMode.html#loc_28_21_28_29&#39;)"><span class="hl_conref"><span class="mpre">ReadMode</span></span></a><span class="mpre">)
    </span><a href="GHC.IO.Handle.html#loc_86_1_86_7" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.html#loc_86_1_86_7&#39;)"><span class="hl_varref"><span class="mpre">hClose</span></span></a><span class="mpre">
    (\</span><a name="loc_1253_7_1253_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1253_7_1253_10&#39;)"><span class="hl_vardecl"><span class="mpre">hnd</span></span></a><span class="mpre"> -&gt; </span><a href="GHC.IO.Handle.Text.html#loc_379_1_379_13" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.Text.html#loc_379_1_379_13&#39;)"><span class="hl_varref"><span class="mpre">hGetContents</span></span></a><span class="mpre"> </span><a href="#loc_1253_7_1253_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1253_7_1253_10&#39;)"><span class="hl_varref"><span class="mpre">hnd</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="#loc_1249_27_1249_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1249_27_1249_33&#39;)"><span class="hl_varref"><span class="mpre">action</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_1233_1_1233_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1233_1_1233_10&#39;)"><span class="hl_varref"><span class="mpre">ignoreBOM</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_1171_1_1171_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1171_1_1171_9&#39;)"><span class="hl_varref"><span class="mpre">fromUTF8</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Writes a Unicode String as a UTF8 encoded text file.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Uses &#39;writeFileAtomic&#39;, so provides the same guarantees.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_1260_1_1260_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1260_1_1260_14&#39;)"><span class="mpre">writeUTF8File</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_1260_1_1260_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1260_1_1260_14&#39;)"><span class="hl_fundecl"><span class="mpre">writeUTF8File</span></span></a><span class="mpre"> </span><a name="loc_1260_15_1260_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1260_15_1260_19&#39;)"><span class="hl_vardecl"><span class="mpre">path</span></span></a><span class="mpre"> = </span><a href="#loc_1071_1_1071_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1071_1_1071_16&#39;)"><span class="hl_varref"><span class="mpre">writeFileAtomic</span></span></a><span class="mpre"> </span><a href="#loc_1260_15_1260_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1260_15_1260_19&#39;)"><span class="hl_varref"><span class="mpre">path</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">BS.Char8.pack</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_1212_1_1212_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1212_1_1212_7&#39;)"><span class="hl_varref"><span class="mpre">toUTF8</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Fix different systems silly line ending conventions</span></span><span class="mpre">
</span><a href="#loc_1264_1_1264_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1264_1_1264_21&#39;)"><span class="mpre">normaliseLineEndings</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_1264_1_1264_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1264_1_1264_21&#39;)"><span class="hl_fundecl"><span class="mpre">normaliseLineEndings</span></span></a><span class="mpre"> [] = []
</span><a href="#loc_1264_1_1264_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1264_1_1264_21&#39;)"><span class="hl_fundecl"><span class="mpre">normaliseLineEndings</span></span></a><span class="mpre"> (</span><span class="hl_char"><span class="mpre">&#39;\r&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="hl_char"><span class="mpre">&#39;\n&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_1265_33_1265_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1265_33_1265_34&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">) = </span><span class="hl_char"><span class="mpre">&#39;\n&#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_1264_1_1264_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1264_1_1264_21&#39;)"><span class="hl_varref"><span class="mpre">normaliseLineEndings</span></span></a><span class="mpre"> </span><a href="#loc_1265_33_1265_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1265_33_1265_34&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- windows</span></span><span class="mpre">
</span><a href="#loc_1264_1_1264_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1264_1_1264_21&#39;)"><span class="hl_fundecl"><span class="mpre">normaliseLineEndings</span></span></a><span class="mpre"> (</span><span class="hl_char"><span class="mpre">&#39;\r&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_1266_28_1266_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1266_28_1266_29&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">)      = </span><span class="hl_char"><span class="mpre">&#39;\n&#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_1264_1_1264_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1264_1_1264_21&#39;)"><span class="hl_varref"><span class="mpre">normaliseLineEndings</span></span></a><span class="mpre"> </span><a href="#loc_1266_28_1266_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1266_28_1266_29&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- old osx</span></span><span class="mpre">
</span><a href="#loc_1264_1_1264_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1264_1_1264_21&#39;)"><span class="hl_fundecl"><span class="mpre">normaliseLineEndings</span></span></a><span class="mpre"> (  </span><a name="loc_1267_25_1267_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1267_25_1267_26&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_1267_28_1267_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1267_28_1267_29&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">)      =   </span><a href="#loc_1267_25_1267_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1267_25_1267_26&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">  </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_1264_1_1264_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1264_1_1264_21&#39;)"><span class="hl_varref"><span class="mpre">normaliseLineEndings</span></span></a><span class="mpre"> </span><a href="#loc_1267_28_1267_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1267_28_1267_29&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- ------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * Common utils</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ------------------------------------------------------------</span></span><span class="mpre">

</span><a href="#loc_1274_1_1274_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1274_1_1274_9&#39;)"><span class="mpre">equating</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Simple/Utils.hs&quot;, srcSpanStartLine = 1273, srcSpanStartColumn = 13, srcSpanEndLine = 1273, srcSpanEndColumn = 20}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Simple/Utils.hs&quot;, srcSpanStartLine = 1273, srcSpanStartColumn = 18, srcSpanEndLine = 1273, srcSpanEndColumn = 20}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/ne"><span class="mpre">Eq a =&gt;</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_1274_1_1274_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1274_1_1274_9&#39;)"><span class="hl_fundecl"><span class="mpre">equating</span></span></a><span class="mpre"> </span><a name="loc_1274_10_1274_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1274_10_1274_11&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_1274_12_1274_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1274_12_1274_13&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_1274_14_1274_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1274_14_1274_15&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> = </span><a href="#loc_1274_10_1274_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1274_10_1274_11&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_1274_12_1274_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1274_12_1274_13&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_1274_10_1274_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1274_10_1274_11&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_1274_14_1274_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1274_14_1274_15&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">

</span><a href="#loc_1277_1_1277_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1277_1_1277_10&#39;)"><span class="mpre">comparing</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Simple/Utils.hs&quot;, srcSpanStartLine = 1276, srcSpanStartColumn = 14, srcSpanEndLine = 1276, srcSpanEndColumn = 22}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/Cabal-1.18.1.3/Distribution/Simple/Utils.hs&quot;, srcSpanStartLine = 1276, srcSpanStartColumn = 20, srcSpanEndLine = 1276, srcSpanEndColumn = 22}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/ne"><span class="mpre">Ord a =&gt;</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Ordering</span></span><span class="mpre">
</span><a name="loc_1277_1_1277_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1277_1_1277_10&#39;)"><span class="hl_fundecl"><span class="mpre">comparing</span></span></a><span class="mpre"> </span><a name="loc_1277_11_1277_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1277_11_1277_12&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_1277_13_1277_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1277_13_1277_14&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_1277_15_1277_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1277_15_1277_16&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> = </span><a href="#loc_1277_11_1277_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1277_11_1277_12&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_1277_13_1277_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1277_13_1277_14&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`compare`</span></span><span class="mpre"> </span><a href="#loc_1277_11_1277_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1277_11_1277_12&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_1277_15_1277_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1277_15_1277_16&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">

</span><a href="#loc_1280_1_1280_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1280_1_1280_10&#39;)"><span class="mpre">isInfixOf</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_1280_1_1280_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1280_1_1280_10&#39;)"><span class="hl_fundecl"><span class="mpre">isInfixOf</span></span></a><span class="mpre"> </span><a name="loc_1280_11_1280_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1280_11_1280_17&#39;)"><span class="hl_vardecl"><span class="mpre">needle</span></span></a><span class="mpre"> </span><a name="loc_1280_18_1280_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1280_18_1280_26&#39;)"><span class="hl_vardecl"><span class="mpre">haystack</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">any</span></span><span class="mpre"> (</span><a href="Data.List.html#loc_286_1_286_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_286_1_286_11&#39;)"><span class="hl_varref"><span class="mpre">isPrefixOf</span></span></a><span class="mpre"> </span><a href="#loc_1280_11_1280_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1280_11_1280_17&#39;)"><span class="hl_varref"><span class="mpre">needle</span></span></a><span class="mpre">) (</span><a href="Data.List.html#loc_763_1_763_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_763_1_763_6&#39;)"><span class="hl_varref"><span class="mpre">tails</span></span></a><span class="mpre"> </span><a href="#loc_1280_18_1280_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1280_18_1280_26&#39;)"><span class="hl_varref"><span class="mpre">haystack</span></span></a><span class="mpre">)

</span><a href="#loc_1283_1_1283_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1283_1_1283_10&#39;)"><span class="mpre">lowercase</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_1283_1_1283_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1283_1_1283_10&#39;)"><span class="hl_vardecl"><span class="mpre">lowercase</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="GHC.Unicode.html#loc_143_1_143_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_143_1_143_8&#39;)"><span class="hl_varref"><span class="mpre">Char.toLower</span></span></a><span class="mpre">
</span></div></body></html>