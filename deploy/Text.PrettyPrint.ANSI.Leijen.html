<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      :  Text.PrettyPrint.ANSI.Leijen</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright   :  Daan Leijen (c) 2000, http://www.cs.uu.nl/~daan</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--                Max Bolingbroke (c) 2008, http://blog.omega-prime.co.uk</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     :  BSD-style (see the file LICENSE)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  :  batterseapower@hotmail.com</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   :  provisional</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability :  portable</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Pretty print module based on Philip Wadler&#39;s \&quot;prettier printer\&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--      \&quot;A prettier printer\&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--      Draft paper, April 1997, revised March 1998.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--      &lt;http://cm.bell-labs.com/cm/cs/who/wadler/papers/prettier/prettier.ps&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- PPrint is an implementation of the pretty printing combinators</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- described by Philip Wadler (1997). In their bare essence, the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- combinators of Wadler are not expressive enough to describe some</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- commonly occurring layouts. The PPrint library adds new primitives</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- to describe these layouts and works well in practice.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The library is based on a single way to concatenate documents,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- which is associative and has both a left and right unit.  This</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- simple design leads to an efficient and short implementation. The</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- simplicity is reflected in the predictable behaviour of the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- combinators which make them easy to use in practice.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- A thorough description of the primitive combinators and their</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- implementation can be found in Philip Wadler&#39;s paper</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- (1997). Additions and the main differences with his original paper</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- are:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * The nil document is called empty.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * The above combinator is called &#39;&lt;$&gt;&#39;. The operator &#39;&lt;/&gt;&#39; is used</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- for soft line breaks.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * There are three new primitives: &#39;align&#39;, &#39;fill&#39; and</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;fillBreak&#39;. These are very useful in practice.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * Lots of other useful combinators, like &#39;fillSep&#39; and &#39;list&#39;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * There are two renderers, &#39;renderPretty&#39; for pretty printing and</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;renderCompact&#39; for compact output. The pretty printing algorithm</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- also uses a ribbon-width now for even prettier output.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * There are two displayers, &#39;displayS&#39; for strings and &#39;displayIO&#39; for</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- file based output.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * There is a &#39;Pretty&#39; class.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * The implementation uses optimised representations and strictness</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- annotations.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Full documentation for the original wl-pprint library available at</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &lt;http://www.cs.uu.nl/~daan/download/pprint/pprint.html&gt;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The library has been extended to allow formatting text for output</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- to ANSI style consoles. New combinators allow:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * Control of foreground and background color of text</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * The abliity to make parts of the text bold or underlined</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This functionality is, as far as possible, portable across platforms</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- with their varying terminals.  However, one thing to be particularly</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- wary of is that console colors will not be displayed on Windows unless</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the &#39;Doc&#39; value is output using the &#39;putDoc&#39; function or one of it&#39;s</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- friends.  Rendering the &#39;Doc&#39; to a &#39;String&#39; and then outputing /that/</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- will only work on Unix-style operating systems.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------</span></span><span class="mpre">
module Text.PrettyPrint.ANSI.Leijen (
   </span><span class="hl_comment"><span class="mpre">-- * Documents</span></span><span class="mpre">
   Doc, putDoc, hPutDoc,

   </span><span class="hl_comment"><span class="mpre">-- * Basic combinators</span></span><span class="mpre">
   empty, char, text, (&lt;&gt;), nest, line, linebreak, group, softline,
   softbreak, hardline, flatAlt, renderSmart,

   </span><span class="hl_comment"><span class="mpre">-- * Alignment</span></span><span class="mpre">
   </span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
   </span><span class="hl_comment"><span class="mpre">-- The combinators in this section can not be described by Wadler&#39;s</span></span><span class="mpre">
   </span><span class="hl_comment"><span class="mpre">-- original combinators. They align their output relative to the</span></span><span class="mpre">
   </span><span class="hl_comment"><span class="mpre">-- current output position - in contrast to @nest@ which always</span></span><span class="mpre">
   </span><span class="hl_comment"><span class="mpre">-- aligns to the current nesting level. This deprives these</span></span><span class="mpre">
   </span><span class="hl_comment"><span class="mpre">-- combinators from being \`optimal\&#39;. In practice however they</span></span><span class="mpre">
   </span><span class="hl_comment"><span class="mpre">-- prove to be very useful. The combinators in this section should</span></span><span class="mpre">
   </span><span class="hl_comment"><span class="mpre">-- be used with care, since they are more expensive than the other</span></span><span class="mpre">
   </span><span class="hl_comment"><span class="mpre">-- combinators. For example, @align@ shouldn&#39;t be used to pretty</span></span><span class="mpre">
   </span><span class="hl_comment"><span class="mpre">-- print all top-level declarations of a language, but using @hang@</span></span><span class="mpre">
   </span><span class="hl_comment"><span class="mpre">-- for let expressions is fine.</span></span><span class="mpre">
   align, hang, indent, encloseSep, list, tupled, semiBraces,

   </span><span class="hl_comment"><span class="mpre">-- * Operators</span></span><span class="mpre">
   (&lt;+&gt;), (&lt;$&gt;), (&lt;/&gt;), (&lt;$$&gt;), (&lt;//&gt;),

   </span><span class="hl_comment"><span class="mpre">-- * List combinators</span></span><span class="mpre">
   hsep, vsep, fillSep, sep, hcat, vcat, fillCat, cat, punctuate,

   </span><span class="hl_comment"><span class="mpre">-- * Fillers</span></span><span class="mpre">
   fill, fillBreak,

   </span><span class="hl_comment"><span class="mpre">-- * Bracketing combinators</span></span><span class="mpre">
   enclose, squotes, dquotes, parens, angles, braces, brackets,

   </span><span class="hl_comment"><span class="mpre">-- * Character documents</span></span><span class="mpre">
   lparen, rparen, langle, rangle, lbrace, rbrace, lbracket, rbracket,
   squote, dquote, semi, colon, comma, space, dot, backslash, equals,
   
   </span><span class="hl_comment"><span class="mpre">-- * Colorisation combinators</span></span><span class="mpre">
   black, red, green, yellow, blue, magenta, cyan, white,
   dullblack, dullred, dullgreen, dullyellow, dullblue, dullmagenta, dullcyan, dullwhite,
   onblack, onred, ongreen, onyellow, onblue, onmagenta, oncyan, onwhite,
   ondullblack, ondullred, ondullgreen, ondullyellow, ondullblue, ondullmagenta, ondullcyan, ondullwhite,

   </span><span class="hl_comment"><span class="mpre">-- * Emboldening combinators</span></span><span class="mpre">
   bold, debold,
   
   </span><span class="hl_comment"><span class="mpre">-- * Underlining combinators</span></span><span class="mpre">
   underline, deunderline,

   </span><span class="hl_comment"><span class="mpre">-- * Removing formatting</span></span><span class="mpre">
   plain,

   </span><span class="hl_comment"><span class="mpre">-- * Primitive type documents</span></span><span class="mpre">
   string, int, integer, float, double, rational,

   </span><span class="hl_comment"><span class="mpre">-- * Pretty class</span></span><span class="mpre">
   Pretty(..),

   </span><span class="hl_comment"><span class="mpre">-- * Rendering</span></span><span class="mpre">
   SimpleDoc(..), renderPretty, renderCompact, displayS, displayIO

   </span><span class="hl_comment"><span class="mpre">-- * Undocumented</span></span><span class="mpre">
        , bool

        , column, columns, nesting, width

        ) where

import System.IO (Handle,hPutStr,hPutChar,</span><a href="GHC.IO.Handle.FD.html#loc_63_1_63_7" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.FD.html#loc_63_1_63_7&#39;)"><span class="mpre">stdout</span></a><span class="mpre">)

import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/ansi-wl-pprint-0.6.7.1/Text/PrettyPrint/ANSI/Leijen.hs&quot;, srcSpanStartLine = 147, srcSpanStartColumn = 8, srcSpanEndLine = 147, srcSpanEndColumn = 27}, srcInfoPoints = []}) &quot;System.Console.ANSI&quot;"><span class="mpre">System.Console.ANSI</span></span><span class="mpre"> (Color(..), ColorIntensity(..), ConsoleLayer(..),
                            Underlining(..), ConsoleIntensity(..),
                            SGR(..), hSetSGR, setSGRCode)

import Data.String (</span><a href="Data.String.html#loc_34_7_34_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.String.html#loc_34_7_34_15&#39;)"><span class="mpre">IsString</span></a><span class="mpre">(..))
import Data.Maybe (</span><a href="Data.Maybe.html#loc_115_1_115_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_115_1_115_10&#39;)"><span class="mpre">catMaybes</span></a><span class="mpre">)
import Data.Monoid (</span><a href="Data.Monoid.html#loc_79_7_79_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_79_7_79_13&#39;)"><span class="mpre">Monoid</span></a><span class="mpre">, </span><a href="Data.Monoid.html#loc_82_9_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_82_9_82_16&#39;)"><span class="mpre">mappend</span></a><span class="mpre">, </span><a href="Data.Monoid.html#loc_84_9_84_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_84_9_84_16&#39;)"><span class="mpre">mconcat</span></a><span class="mpre">, </span><a href="Data.Monoid.html#loc_80_9_80_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_80_9_80_15&#39;)"><span class="mpre">mempty</span></a><span class="mpre">)


</span><span class="warning" data-warning="DeclInfixDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/ansi-wl-pprint-0.6.7.1/Text/PrettyPrint/ANSI/Leijen.hs&quot;, srcSpanStartLine = 156, srcSpanStartColumn = 1, srcSpanEndLine = 156, srcSpanEndColumn = 27}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/ansi-wl-pprint-0.6.7.1/Text/PrettyPrint/ANSI/Leijen.hs&quot;, srcSpanStartLine = 156, srcSpanStartColumn = 8, srcSpanEndLine = 156, srcSpanEndColumn = 9},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/ansi-wl-pprin"><span class="mpre">infixr 5 &lt;/&gt;,&lt;//&gt;,&lt;$&gt;,&lt;$$&gt;</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclInfixDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/ansi-wl-pprint-0.6.7.1/Text/PrettyPrint/ANSI/Leijen.hs&quot;, srcSpanStartLine = 157, srcSpanStartColumn = 1, srcSpanEndLine = 157, srcSpanEndColumn = 16}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/ansi-wl-pprint-0.6.7.1/Text/PrettyPrint/ANSI/Leijen.hs&quot;, srcSpanStartLine = 157, srcSpanStartColumn = 8, srcSpanEndLine = 157, srcSpanEndColumn = 9},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/ansi-wl-pprin"><span class="mpre">infixr 6 &lt;&gt;,&lt;+&gt;</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- list, tupled and semiBraces pretty print a list of</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- documents either horizontally or vertically aligned.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | The document @(list xs)@ comma separates the documents @xs@ and</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- encloses them in square brackets. The documents are rendered</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- horizontally if that fits the page. Otherwise they are aligned</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- vertically. All comma separators are put in front of the elements.</span></span><span class="mpre">
</span><a href="#loc_171_1_171_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_1_171_5&#39;)"><span class="mpre">list</span></a><span class="mpre"> :: [</span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">] -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><a name="loc_171_1_171_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_1_171_5&#39;)"><span class="hl_vardecl"><span class="mpre">list</span></span></a><span class="mpre">            = </span><a href="#loc_212_1_212_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_1_212_11&#39;)"><span class="hl_varref"><span class="mpre">encloseSep</span></span></a><span class="mpre"> </span><a href="#loc_450_1_450_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_450_1_450_9&#39;)"><span class="hl_varref"><span class="mpre">lbracket</span></span></a><span class="mpre"> </span><a href="#loc_453_1_453_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_453_1_453_9&#39;)"><span class="hl_varref"><span class="mpre">rbracket</span></span></a><span class="mpre"> </span><a href="#loc_470_1_470_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_470_1_470_6&#39;)"><span class="hl_varref"><span class="mpre">comma</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The document @(tupled xs)@ comma separates the documents @xs@ and</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- encloses them in parenthesis. The documents are rendered</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- horizontally if that fits the page. Otherwise they are aligned</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- vertically. All comma separators are put in front of the elements.</span></span><span class="mpre">
</span><a href="#loc_178_1_178_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_1_178_7&#39;)"><span class="mpre">tupled</span></a><span class="mpre"> :: [</span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">] -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><a name="loc_178_1_178_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_1_178_7&#39;)"><span class="hl_vardecl"><span class="mpre">tupled</span></span></a><span class="mpre">          = </span><a href="#loc_212_1_212_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_1_212_11&#39;)"><span class="hl_varref"><span class="mpre">encloseSep</span></span></a><span class="mpre"> </span><a href="#loc_432_1_432_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_432_1_432_7&#39;)"><span class="hl_varref"><span class="mpre">lparen</span></span></a><span class="mpre">   </span><a href="#loc_435_1_435_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_435_1_435_7&#39;)"><span class="hl_varref"><span class="mpre">rparen</span></span></a><span class="mpre">  </span><a href="#loc_470_1_470_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_470_1_470_6&#39;)"><span class="hl_varref"><span class="mpre">comma</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | The document @(semiBraces xs)@ separates the documents @xs@ with</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- semi colons and encloses them in braces. The documents are rendered</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- horizontally if that fits the page. Otherwise they are aligned</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- vertically. All semi colons are put in front of the elements.</span></span><span class="mpre">
</span><a href="#loc_186_1_186_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_1_186_11&#39;)"><span class="mpre">semiBraces</span></a><span class="mpre"> :: [</span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">] -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><a name="loc_186_1_186_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_1_186_11&#39;)"><span class="hl_vardecl"><span class="mpre">semiBraces</span></span></a><span class="mpre">      = </span><a href="#loc_212_1_212_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_1_212_11&#39;)"><span class="hl_varref"><span class="mpre">encloseSep</span></span></a><span class="mpre"> </span><a href="#loc_444_1_444_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_444_1_444_7&#39;)"><span class="hl_varref"><span class="mpre">lbrace</span></span></a><span class="mpre">   </span><a href="#loc_447_1_447_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_447_1_447_7&#39;)"><span class="hl_varref"><span class="mpre">rbrace</span></span></a><span class="mpre">  </span><a href="#loc_464_1_464_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_464_1_464_5&#39;)"><span class="hl_varref"><span class="mpre">semi</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The document @(encloseSep l r sep xs)@ concatenates the documents</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @xs@ separated by @sep@ and encloses the resulting document by @l@</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- and @r@. The documents are rendered horizontally if that fits the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- page. Otherwise they are aligned vertically. All separators are put</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- in front of the elements. For example, the combinator &#39;list&#39; can be</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- defined with @encloseSep@:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; list xs = encloseSep lbracket rbracket comma xs</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; test    = text &quot;list&quot; &lt;+&gt; (list (map int [10,200,3000]))</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Which is layed out with a page width of 20 as:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- list [10,200,3000]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- But when the page width is 15, it is layed out as:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- list [10</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--      ,200</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--      ,3000]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><a href="#loc_212_1_212_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_1_212_11&#39;)"><span class="mpre">encloseSep</span></a><span class="mpre"> :: </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; [</span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">] -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><a name="loc_212_1_212_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_1_212_11&#39;)"><span class="hl_fundecl"><span class="mpre">encloseSep</span></span></a><span class="mpre"> </span><a name="loc_212_12_212_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_12_212_16&#39;)"><span class="hl_vardecl"><span class="mpre">left</span></span></a><span class="mpre"> </span><a name="loc_212_17_212_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_17_212_22&#39;)"><span class="hl_vardecl"><span class="mpre">right</span></span></a><span class="mpre"> </span><a name="loc_212_23_212_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_23_212_26&#39;)"><span class="hl_vardecl"><span class="mpre">sep</span></span></a><span class="mpre"> </span><a name="loc_212_27_212_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_27_212_29&#39;)"><span class="hl_vardecl"><span class="mpre">ds</span></span></a><span class="mpre">
    = case </span><a href="#loc_212_27_212_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_27_212_29&#39;)"><span class="hl_varref"><span class="mpre">ds</span></span></a><span class="mpre"> of
        []  -&gt; </span><a href="#loc_212_12_212_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_12_212_16&#39;)"><span class="hl_varref"><span class="mpre">left</span></span></a><span class="mpre"> </span><a href="#loc_349_3_349_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_3_349_5&#39;)"><span class="hl_infix"><span class="mpre">&lt;&gt;</span></span></a><span class="mpre"> </span><a href="#loc_212_17_212_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_17_212_22&#39;)"><span class="hl_varref"><span class="mpre">right</span></span></a><span class="mpre">
        [</span><a name="loc_215_10_215_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_10_215_11&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre">] -&gt; </span><a href="#loc_212_12_212_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_12_212_16&#39;)"><span class="hl_varref"><span class="mpre">left</span></span></a><span class="mpre"> </span><a href="#loc_349_3_349_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_3_349_5&#39;)"><span class="hl_infix"><span class="mpre">&lt;&gt;</span></span></a><span class="mpre"> </span><a href="#loc_215_10_215_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_10_215_11&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><a href="#loc_349_3_349_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_3_349_5&#39;)"><span class="hl_infix"><span class="mpre">&lt;&gt;</span></span></a><span class="mpre"> </span><a href="#loc_212_17_212_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_17_212_22&#39;)"><span class="hl_varref"><span class="mpre">right</span></span></a><span class="mpre">
        _   -&gt; </span><a href="#loc_707_1_707_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_707_1_707_6&#39;)"><span class="hl_varref"><span class="mpre">align</span></span></a><span class="mpre"> (</span><a href="#loc_320_1_320_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_320_1_320_4&#39;)"><span class="hl_varref"><span class="mpre">cat</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">zipWith</span></span><span class="mpre"> </span><a href="#loc_349_3_349_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_3_349_5&#39;)"><span class="hl_varref"><span class="mpre">(&lt;&gt;)</span></span></a><span class="mpre"> (</span><a href="#loc_212_12_212_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_12_212_16&#39;)"><span class="hl_varref"><span class="mpre">left</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">repeat</span></span><span class="mpre"> </span><a href="#loc_212_23_212_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_23_212_26&#39;)"><span class="hl_varref"><span class="mpre">sep</span></span></a><span class="mpre">) </span><a href="#loc_212_27_212_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_27_212_29&#39;)"><span class="hl_varref"><span class="mpre">ds</span></span></a><span class="mpre">) </span><a href="#loc_349_3_349_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_3_349_5&#39;)"><span class="hl_infix"><span class="mpre">&lt;&gt;</span></span></a><span class="mpre"> </span><a href="#loc_212_17_212_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_17_212_22&#39;)"><span class="hl_varref"><span class="mpre">right</span></span></a><span class="mpre">) 


</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- punctuate p [d1,d2,...,dn] =&gt; [d1 &lt;&gt; p,d2 &lt;&gt; p, ... ,dn]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | @(punctuate p xs)@ concatenates all documents in @xs@ with</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- document @p@ except for the last document.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; someText = map text [&quot;words&quot;,&quot;in&quot;,&quot;a&quot;,&quot;tuple&quot;]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; test     = parens (align (cat (punctuate comma someText)))</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This is layed out on a page width of 20 as:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- (words,in,a,tuple)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- But when the page width is 15, it is layed out as:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- (words,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  in,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  a,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  tuple)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- (If you want put the commas in front of their elements instead of</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- at the end, you should use &#39;tupled&#39; or, in general, &#39;encloseSep&#39;.)</span></span><span class="mpre">
</span><a href="#loc_248_1_248_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_1_248_10&#39;)"><span class="mpre">punctuate</span></a><span class="mpre"> :: </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; [</span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">] -&gt; [</span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">]
</span><a name="loc_248_1_248_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_1_248_10&#39;)"><span class="hl_fundecl"><span class="mpre">punctuate</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">p</span></span><span class="mpre"> []      = []
</span><a href="#loc_248_1_248_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_1_248_10&#39;)"><span class="hl_fundecl"><span class="mpre">punctuate</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">p</span></span><span class="mpre"> [</span><a name="loc_249_14_249_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_14_249_15&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre">]     = [</span><a href="#loc_249_14_249_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_249_14_249_15&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre">]
</span><a href="#loc_248_1_248_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_1_248_10&#39;)"><span class="hl_fundecl"><span class="mpre">punctuate</span></span></a><span class="mpre"> </span><a name="loc_250_11_250_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_11_250_12&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> (</span><a name="loc_250_14_250_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_14_250_15&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_250_16_250_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_16_250_18&#39;)"><span class="hl_vardecl"><span class="mpre">ds</span></span></a><span class="mpre">)  = (</span><a href="#loc_250_14_250_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_14_250_15&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><a href="#loc_349_3_349_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_3_349_5&#39;)"><span class="hl_infix"><span class="mpre">&lt;&gt;</span></span></a><span class="mpre"> </span><a href="#loc_250_11_250_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_11_250_12&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_248_1_248_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_1_248_10&#39;)"><span class="hl_varref"><span class="mpre">punctuate</span></span></a><span class="mpre"> </span><a href="#loc_250_11_250_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_11_250_12&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_250_16_250_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_16_250_18&#39;)"><span class="hl_varref"><span class="mpre">ds</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- high-level combinators</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | The document @(sep xs)@ concatenates all documents @xs@ either</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- horizontally with @(\&lt;+\&gt;)@, if it fits the page, or vertically with</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @(\&lt;$\&gt;)@.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; sep xs  = group (vsep xs)</span></span><span class="mpre">
</span><a href="#loc_264_1_264_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_264_1_264_4&#39;)"><span class="mpre">sep</span></a><span class="mpre"> :: [</span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">] -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><a name="loc_264_1_264_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_264_1_264_4&#39;)"><span class="hl_vardecl"><span class="mpre">sep</span></span></a><span class="mpre">             = </span><a href="#loc_853_1_853_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_853_1_853_6&#39;)"><span class="hl_varref"><span class="mpre">group</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_312_1_312_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_1_312_5&#39;)"><span class="hl_varref"><span class="mpre">vsep</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The document @(fillSep xs)@ concatenates documents @xs@</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- horizontally with @(\&lt;+\&gt;)@ as long as its fits the page, than</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- inserts a @line@ and continues doing that for all documents in</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @xs@.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; fillSep xs  = foldr (\&lt;\/\&gt;) empty xs</span></span><span class="mpre">
</span><a href="#loc_273_1_273_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_273_1_273_8&#39;)"><span class="mpre">fillSep</span></a><span class="mpre"> :: [</span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">] -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><a name="loc_273_1_273_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_273_1_273_8&#39;)"><span class="hl_vardecl"><span class="mpre">fillSep</span></span></a><span class="mpre">         = </span><a href="#loc_342_1_342_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_342_1_342_5&#39;)"><span class="hl_varref"><span class="mpre">fold</span></span></a><span class="mpre"> </span><a href="#loc_361_3_361_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_361_3_361_6&#39;)"><span class="hl_varref"><span class="mpre">(&lt;/&gt;)</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The document @(hsep xs)@ concatenates all documents @xs@</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- horizontally with @(\&lt;+\&gt;)@.</span></span><span class="mpre">
</span><a href="#loc_278_1_278_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_1_278_5&#39;)"><span class="mpre">hsep</span></a><span class="mpre"> :: [</span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">] -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><a name="loc_278_1_278_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_278_1_278_5&#39;)"><span class="hl_vardecl"><span class="mpre">hsep</span></span></a><span class="mpre">            = </span><a href="#loc_342_1_342_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_342_1_342_5&#39;)"><span class="hl_varref"><span class="mpre">fold</span></span></a><span class="mpre"> </span><a href="#loc_354_3_354_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_354_3_354_6&#39;)"><span class="hl_varref"><span class="mpre">(&lt;+&gt;)</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | The document @(vsep xs)@ concatenates all documents @xs@</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- vertically with @(\&lt;$\&gt;)@. If a &#39;group&#39; undoes the line breaks</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- inserted by @vsep@, all documents are separated with a space.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; someText = map text (words (&quot;text to lay out&quot;))</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; test     = text &quot;some&quot; &lt;+&gt; vsep someText</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This is layed out as:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- some text</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- to</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- lay</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- out</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The &#39;align&#39; combinator can be used to align the documents under</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- their first element</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; test     = text &quot;some&quot; &lt;+&gt; align (vsep someText)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Which is printed as:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- some text</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--      to</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--      lay</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--      out</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><a href="#loc_312_1_312_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_1_312_5&#39;)"><span class="mpre">vsep</span></a><span class="mpre"> :: [</span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">] -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><a name="loc_312_1_312_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_1_312_5&#39;)"><span class="hl_vardecl"><span class="mpre">vsep</span></span></a><span class="mpre">            = </span><a href="#loc_342_1_342_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_342_1_342_5&#39;)"><span class="hl_varref"><span class="mpre">fold</span></span></a><span class="mpre"> </span><a href="#loc_372_3_372_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_372_3_372_6&#39;)"><span class="hl_varref"><span class="mpre">(&lt;$&gt;)</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The document @(cat xs)@ concatenates all documents @xs@ either</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- horizontally with @(\&lt;\&gt;)@, if it fits the page, or vertically with</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @(\&lt;$$\&gt;)@.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; cat xs  = group (vcat xs)</span></span><span class="mpre">
</span><a href="#loc_320_1_320_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_320_1_320_4&#39;)"><span class="mpre">cat</span></a><span class="mpre"> :: [</span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">] -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><a name="loc_320_1_320_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_320_1_320_4&#39;)"><span class="hl_vardecl"><span class="mpre">cat</span></span></a><span class="mpre">             = </span><a href="#loc_853_1_853_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_853_1_853_6&#39;)"><span class="hl_varref"><span class="mpre">group</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_339_1_339_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_339_1_339_5&#39;)"><span class="hl_varref"><span class="mpre">vcat</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The document @(fillCat xs)@ concatenates documents @xs@</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- horizontally with @(\&lt;\&gt;)@ as long as its fits the page, than inserts</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- a @linebreak@ and continues doing that for all documents in @xs@.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; fillCat xs  = foldr (\&lt;\/\/\&gt;) empty xs</span></span><span class="mpre">
</span><a href="#loc_328_1_328_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_1_328_8&#39;)"><span class="mpre">fillCat</span></a><span class="mpre"> :: [</span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">] -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><a name="loc_328_1_328_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_1_328_8&#39;)"><span class="hl_vardecl"><span class="mpre">fillCat</span></span></a><span class="mpre">         = </span><a href="#loc_342_1_342_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_342_1_342_5&#39;)"><span class="hl_varref"><span class="mpre">fold</span></span></a><span class="mpre"> </span><a href="#loc_367_3_367_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_367_3_367_7&#39;)"><span class="hl_varref"><span class="mpre">(&lt;//&gt;)</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The document @(hcat xs)@ concatenates all documents @xs@</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- horizontally with @(\&lt;\&gt;)@.</span></span><span class="mpre">
</span><a href="#loc_333_1_333_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_333_1_333_5&#39;)"><span class="mpre">hcat</span></a><span class="mpre"> :: [</span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">] -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><a name="loc_333_1_333_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_333_1_333_5&#39;)"><span class="hl_vardecl"><span class="mpre">hcat</span></span></a><span class="mpre">            = </span><a href="#loc_342_1_342_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_342_1_342_5&#39;)"><span class="hl_varref"><span class="mpre">fold</span></span></a><span class="mpre"> </span><a href="#loc_349_3_349_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_3_349_5&#39;)"><span class="hl_varref"><span class="mpre">(&lt;&gt;)</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The document @(vcat xs)@ concatenates all documents @xs@</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- vertically with @(\&lt;$$\&gt;)@. If a &#39;group&#39; undoes the line breaks</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- inserted by @vcat@, all documents are directly concatenated.</span></span><span class="mpre">
</span><a href="#loc_339_1_339_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_339_1_339_5&#39;)"><span class="mpre">vcat</span></a><span class="mpre"> :: [</span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">] -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><a name="loc_339_1_339_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_339_1_339_5&#39;)"><span class="hl_vardecl"><span class="mpre">vcat</span></span></a><span class="mpre">            = </span><a href="#loc_342_1_342_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_342_1_342_5&#39;)"><span class="hl_varref"><span class="mpre">fold</span></span></a><span class="mpre"> </span><a href="#loc_377_3_377_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_377_3_377_7&#39;)"><span class="hl_varref"><span class="mpre">(&lt;$$&gt;)</span></span></a><span class="mpre">

</span><a href="#loc_342_1_342_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_342_1_342_5&#39;)"><span class="mpre">fold</span></a><span class="mpre"> :: (</span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">) -&gt; [</span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">] -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><a name="loc_342_1_342_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_342_1_342_5&#39;)"><span class="hl_fundecl"><span class="mpre">fold</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">f</span></span><span class="mpre"> []       = </span><a href="#loc_787_1_787_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_787_1_787_6&#39;)"><span class="hl_varref"><span class="mpre">empty</span></span></a><span class="mpre">
</span><a href="#loc_342_1_342_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_342_1_342_5&#39;)"><span class="hl_fundecl"><span class="mpre">fold</span></span></a><span class="mpre"> </span><a name="loc_343_6_343_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_343_6_343_7&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_343_8_343_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_343_8_343_10&#39;)"><span class="hl_vardecl"><span class="mpre">ds</span></span></a><span class="mpre">       = </span><span class="hl_varref"><span class="mpre">foldr1</span></span><span class="mpre"> </span><a href="#loc_343_6_343_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_343_6_343_7&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_343_8_343_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_343_8_343_10&#39;)"><span class="hl_varref"><span class="mpre">ds</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The document @(x \&lt;\&gt; y)@ concatenates document @x@ and document</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @y@. It is an associative operation having &#39;empty&#39; as a left and</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- right unit.  (infixr 6)</span></span><span class="mpre">
</span><a href="#loc_349_3_349_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_3_349_5&#39;)"><span class="mpre">(&lt;&gt;)</span></a><span class="mpre"> :: </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><a name="loc_349_1_349_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_1_349_2&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_349_3_349_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_3_349_5&#39;)"><span class="hl_fundecl"><span class="mpre">&lt;&gt;</span></span></a><span class="mpre"> </span><a name="loc_349_6_349_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_6_349_7&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">          = </span><a href="#loc_349_1_349_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_1_349_2&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_822_1_822_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_822_1_822_7&#39;)"><span class="hl_infix"><span class="mpre">`beside`</span></span></a><span class="mpre"> </span><a href="#loc_349_6_349_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_6_349_7&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The document @(x \&lt;+\&gt; y)@ concatenates document @x@ and @y@ with a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @space@ in between.  (infixr 6)</span></span><span class="mpre">
</span><a href="#loc_354_3_354_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_354_3_354_6&#39;)"><span class="mpre">(&lt;+&gt;)</span></a><span class="mpre"> :: </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><a name="loc_354_1_354_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_354_1_354_2&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_354_3_354_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_354_3_354_6&#39;)"><span class="hl_fundecl"><span class="mpre">&lt;+&gt;</span></span></a><span class="mpre"> </span><a name="loc_354_7_354_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_354_7_354_8&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">         = </span><a href="#loc_354_1_354_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_354_1_354_2&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_349_3_349_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_3_349_5&#39;)"><span class="hl_infix"><span class="mpre">&lt;&gt;</span></span></a><span class="mpre"> </span><a href="#loc_475_1_475_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_475_1_475_6&#39;)"><span class="hl_varref"><span class="mpre">space</span></span></a><span class="mpre"> </span><a href="#loc_349_3_349_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_3_349_5&#39;)"><span class="hl_infix"><span class="mpre">&lt;&gt;</span></span></a><span class="mpre"> </span><a href="#loc_354_7_354_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_354_7_354_8&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The document @(x \&lt;\/\&gt; y)@ concatenates document @x@ and @y@ with a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;softline&#39; in between. This effectively puts @x@ and @y@ either</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- next to each other (with a @space@ in between) or underneath each</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- other. (infixr 5)</span></span><span class="mpre">
</span><a href="#loc_361_3_361_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_361_3_361_6&#39;)"><span class="mpre">(&lt;/&gt;)</span></a><span class="mpre"> :: </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><a name="loc_361_1_361_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_361_1_361_2&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_361_3_361_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_361_3_361_6&#39;)"><span class="hl_fundecl"><span class="mpre">&lt;/&gt;</span></span></a><span class="mpre"> </span><a name="loc_361_7_361_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_361_7_361_8&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">         = </span><a href="#loc_361_1_361_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_361_1_361_2&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_349_3_349_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_3_349_5&#39;)"><span class="hl_infix"><span class="mpre">&lt;&gt;</span></span></a><span class="mpre"> </span><a href="#loc_384_1_384_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_384_1_384_9&#39;)"><span class="hl_varref"><span class="mpre">softline</span></span></a><span class="mpre"> </span><a href="#loc_349_3_349_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_3_349_5&#39;)"><span class="hl_infix"><span class="mpre">&lt;&gt;</span></span></a><span class="mpre"> </span><a href="#loc_361_7_361_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_361_7_361_8&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The document @(x \&lt;\/\/\&gt; y)@ concatenates document @x@ and @y@ with</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- a &#39;softbreak&#39; in between. This effectively puts @x@ and @y@ either</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- right next to each other or underneath each other. (infixr 5)</span></span><span class="mpre">
</span><a href="#loc_367_3_367_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_367_3_367_7&#39;)"><span class="mpre">(&lt;//&gt;)</span></a><span class="mpre"> :: </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><a name="loc_367_1_367_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_367_1_367_2&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_367_3_367_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_367_3_367_7&#39;)"><span class="hl_fundecl"><span class="mpre">&lt;//&gt;</span></span></a><span class="mpre"> </span><a name="loc_367_8_367_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_367_8_367_9&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">        = </span><a href="#loc_367_1_367_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_367_1_367_2&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_349_3_349_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_3_349_5&#39;)"><span class="hl_infix"><span class="mpre">&lt;&gt;</span></span></a><span class="mpre"> </span><a href="#loc_391_1_391_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_391_1_391_10&#39;)"><span class="hl_varref"><span class="mpre">softbreak</span></span></a><span class="mpre"> </span><a href="#loc_349_3_349_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_3_349_5&#39;)"><span class="hl_infix"><span class="mpre">&lt;&gt;</span></span></a><span class="mpre"> </span><a href="#loc_367_8_367_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_367_8_367_9&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The document @(x \&lt;$\&gt; y)@ concatenates document @x@ and @y@ with a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;line&#39; in between. (infixr 5)</span></span><span class="mpre">
</span><a href="#loc_372_3_372_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_372_3_372_6&#39;)"><span class="mpre">(&lt;$&gt;)</span></a><span class="mpre"> :: </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><a name="loc_372_1_372_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_372_1_372_2&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_372_3_372_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_372_3_372_6&#39;)"><span class="hl_fundecl"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a name="loc_372_7_372_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_372_7_372_8&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">         = </span><a href="#loc_372_1_372_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_372_1_372_2&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_349_3_349_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_3_349_5&#39;)"><span class="hl_infix"><span class="mpre">&lt;&gt;</span></span></a><span class="mpre"> </span><a href="#loc_808_1_808_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_808_1_808_5&#39;)"><span class="hl_varref"><span class="mpre">line</span></span></a><span class="mpre"> </span><a href="#loc_349_3_349_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_3_349_5&#39;)"><span class="hl_infix"><span class="mpre">&lt;&gt;</span></span></a><span class="mpre"> </span><a href="#loc_372_7_372_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_372_7_372_8&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The document @(x \&lt;$$\&gt; y)@ concatenates document @x@ and @y@ with</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- a @linebreak@ in between. (infixr 5)</span></span><span class="mpre">
</span><a href="#loc_377_3_377_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_377_3_377_7&#39;)"><span class="mpre">(&lt;$$&gt;)</span></a><span class="mpre"> :: </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><a name="loc_377_1_377_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_377_1_377_2&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_377_3_377_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_377_3_377_7&#39;)"><span class="hl_fundecl"><span class="mpre">&lt;$$&gt;</span></span></a><span class="mpre"> </span><a name="loc_377_8_377_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_377_8_377_9&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">        = </span><a href="#loc_377_1_377_2" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_377_1_377_2&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_349_3_349_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_3_349_5&#39;)"><span class="hl_infix"><span class="mpre">&lt;&gt;</span></span></a><span class="mpre"> </span><a href="#loc_814_1_814_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_814_1_814_10&#39;)"><span class="hl_varref"><span class="mpre">linebreak</span></span></a><span class="mpre"> </span><a href="#loc_349_3_349_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_3_349_5&#39;)"><span class="hl_infix"><span class="mpre">&lt;&gt;</span></span></a><span class="mpre"> </span><a href="#loc_377_8_377_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_377_8_377_9&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The document @softline@ behaves like &#39;space&#39; if the resulting</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- output fits the page, otherwise it behaves like &#39;line&#39;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; softline = group line</span></span><span class="mpre">
</span><a href="#loc_384_1_384_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_384_1_384_9&#39;)"><span class="mpre">softline</span></a><span class="mpre"> :: </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><a name="loc_384_1_384_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_384_1_384_9&#39;)"><span class="hl_vardecl"><span class="mpre">softline</span></span></a><span class="mpre">        = </span><a href="#loc_853_1_853_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_853_1_853_6&#39;)"><span class="hl_varref"><span class="mpre">group</span></span></a><span class="mpre"> </span><a href="#loc_808_1_808_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_808_1_808_5&#39;)"><span class="hl_varref"><span class="mpre">line</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The document @softbreak@ behaves like &#39;empty&#39; if the resulting</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- output fits the page, otherwise it behaves like &#39;line&#39;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; softbreak  = group linebreak</span></span><span class="mpre">
</span><a href="#loc_391_1_391_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_391_1_391_10&#39;)"><span class="mpre">softbreak</span></a><span class="mpre"> :: </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><a name="loc_391_1_391_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_391_1_391_10&#39;)"><span class="hl_vardecl"><span class="mpre">softbreak</span></span></a><span class="mpre">       = </span><a href="#loc_853_1_853_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_853_1_853_6&#39;)"><span class="hl_varref"><span class="mpre">group</span></span></a><span class="mpre"> </span><a href="#loc_814_1_814_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_814_1_814_10&#39;)"><span class="hl_varref"><span class="mpre">linebreak</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Document @(squotes x)@ encloses document @x@ with single quotes</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- \&quot;&#39;\&quot;.</span></span><span class="mpre">
</span><a href="#loc_396_1_396_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_396_1_396_8&#39;)"><span class="mpre">squotes</span></a><span class="mpre"> :: </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><a name="loc_396_1_396_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_396_1_396_8&#39;)"><span class="hl_vardecl"><span class="mpre">squotes</span></span></a><span class="mpre">         = </span><a href="#loc_428_1_428_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_428_1_428_8&#39;)"><span class="hl_varref"><span class="mpre">enclose</span></span></a><span class="mpre"> </span><a href="#loc_458_1_458_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_458_1_458_7&#39;)"><span class="hl_varref"><span class="mpre">squote</span></span></a><span class="mpre"> </span><a href="#loc_458_1_458_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_458_1_458_7&#39;)"><span class="hl_varref"><span class="mpre">squote</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Document @(dquotes x)@ encloses document @x@ with double quotes</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;\&quot;&#39;.</span></span><span class="mpre">
</span><a href="#loc_401_1_401_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_401_1_401_8&#39;)"><span class="mpre">dquotes</span></a><span class="mpre"> :: </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><a name="loc_401_1_401_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_401_1_401_8&#39;)"><span class="hl_vardecl"><span class="mpre">dquotes</span></span></a><span class="mpre">         = </span><a href="#loc_428_1_428_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_428_1_428_8&#39;)"><span class="hl_varref"><span class="mpre">enclose</span></span></a><span class="mpre"> </span><a href="#loc_461_1_461_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_461_1_461_7&#39;)"><span class="hl_varref"><span class="mpre">dquote</span></span></a><span class="mpre"> </span><a href="#loc_461_1_461_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_461_1_461_7&#39;)"><span class="hl_varref"><span class="mpre">dquote</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Document @(braces x)@ encloses document @x@ in braces, \&quot;{\&quot; and</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- \&quot;}\&quot;.</span></span><span class="mpre">
</span><a href="#loc_406_1_406_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_406_1_406_7&#39;)"><span class="mpre">braces</span></a><span class="mpre"> :: </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><a name="loc_406_1_406_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_406_1_406_7&#39;)"><span class="hl_vardecl"><span class="mpre">braces</span></span></a><span class="mpre">          = </span><a href="#loc_428_1_428_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_428_1_428_8&#39;)"><span class="hl_varref"><span class="mpre">enclose</span></span></a><span class="mpre"> </span><a href="#loc_444_1_444_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_444_1_444_7&#39;)"><span class="hl_varref"><span class="mpre">lbrace</span></span></a><span class="mpre"> </span><a href="#loc_447_1_447_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_447_1_447_7&#39;)"><span class="hl_varref"><span class="mpre">rbrace</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Document @(parens x)@ encloses document @x@ in parenthesis, \&quot;(\&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- and \&quot;)\&quot;.</span></span><span class="mpre">
</span><a href="#loc_411_1_411_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_411_1_411_7&#39;)"><span class="mpre">parens</span></a><span class="mpre"> :: </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><a name="loc_411_1_411_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_411_1_411_7&#39;)"><span class="hl_vardecl"><span class="mpre">parens</span></span></a><span class="mpre">          = </span><a href="#loc_428_1_428_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_428_1_428_8&#39;)"><span class="hl_varref"><span class="mpre">enclose</span></span></a><span class="mpre"> </span><a href="#loc_432_1_432_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_432_1_432_7&#39;)"><span class="hl_varref"><span class="mpre">lparen</span></span></a><span class="mpre"> </span><a href="#loc_435_1_435_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_435_1_435_7&#39;)"><span class="hl_varref"><span class="mpre">rparen</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Document @(angles x)@ encloses document @x@ in angles, \&quot;\&lt;\&quot; and</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- \&quot;\&gt;\&quot;.</span></span><span class="mpre">
</span><a href="#loc_416_1_416_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_416_1_416_7&#39;)"><span class="mpre">angles</span></a><span class="mpre"> :: </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><a name="loc_416_1_416_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_416_1_416_7&#39;)"><span class="hl_vardecl"><span class="mpre">angles</span></span></a><span class="mpre">          = </span><a href="#loc_428_1_428_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_428_1_428_8&#39;)"><span class="hl_varref"><span class="mpre">enclose</span></span></a><span class="mpre"> </span><a href="#loc_438_1_438_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_438_1_438_7&#39;)"><span class="hl_varref"><span class="mpre">langle</span></span></a><span class="mpre"> </span><a href="#loc_441_1_441_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_441_1_441_7&#39;)"><span class="hl_varref"><span class="mpre">rangle</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Document @(brackets x)@ encloses document @x@ in square brackets,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- \&quot;[\&quot; and \&quot;]\&quot;.</span></span><span class="mpre">
</span><a href="#loc_421_1_421_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_421_1_421_9&#39;)"><span class="mpre">brackets</span></a><span class="mpre"> :: </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><a name="loc_421_1_421_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_421_1_421_9&#39;)"><span class="hl_vardecl"><span class="mpre">brackets</span></span></a><span class="mpre">        = </span><a href="#loc_428_1_428_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_428_1_428_8&#39;)"><span class="hl_varref"><span class="mpre">enclose</span></span></a><span class="mpre"> </span><a href="#loc_450_1_450_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_450_1_450_9&#39;)"><span class="hl_varref"><span class="mpre">lbracket</span></span></a><span class="mpre"> </span><a href="#loc_453_1_453_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_453_1_453_9&#39;)"><span class="hl_varref"><span class="mpre">rbracket</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The document @(enclose l r x)@ encloses document @x@ between</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- documents @l@ and @r@ using @(\&lt;\&gt;)@.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; enclose l r x   = l &lt;&gt; x &lt;&gt; r</span></span><span class="mpre">
</span><a href="#loc_428_1_428_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_428_1_428_8&#39;)"><span class="mpre">enclose</span></a><span class="mpre"> :: </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><a name="loc_428_1_428_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_428_1_428_8&#39;)"><span class="hl_fundecl"><span class="mpre">enclose</span></span></a><span class="mpre"> </span><a name="loc_428_9_428_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_428_9_428_10&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> </span><a name="loc_428_11_428_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_428_11_428_12&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> </span><a name="loc_428_13_428_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_428_13_428_14&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">   = </span><a href="#loc_428_9_428_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_428_9_428_10&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><a href="#loc_349_3_349_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_3_349_5&#39;)"><span class="hl_infix"><span class="mpre">&lt;&gt;</span></span></a><span class="mpre"> </span><a href="#loc_428_13_428_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_428_13_428_14&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_349_3_349_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_3_349_5&#39;)"><span class="hl_infix"><span class="mpre">&lt;&gt;</span></span></a><span class="mpre"> </span><a href="#loc_428_11_428_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_428_11_428_12&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The document @lparen@ contains a left parenthesis, \&quot;(\&quot;.</span></span><span class="mpre">
</span><a href="#loc_432_1_432_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_432_1_432_7&#39;)"><span class="mpre">lparen</span></a><span class="mpre"> :: </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><a name="loc_432_1_432_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_432_1_432_7&#39;)"><span class="hl_vardecl"><span class="mpre">lparen</span></span></a><span class="mpre">          = </span><a href="#loc_793_1_793_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_793_1_793_5&#39;)"><span class="hl_varref"><span class="mpre">char</span></span></a><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;(&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | The document @rparen@ contains a right parenthesis, \&quot;)\&quot;.</span></span><span class="mpre">
</span><a href="#loc_435_1_435_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_435_1_435_7&#39;)"><span class="mpre">rparen</span></a><span class="mpre"> :: </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><a name="loc_435_1_435_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_435_1_435_7&#39;)"><span class="hl_vardecl"><span class="mpre">rparen</span></span></a><span class="mpre">          = </span><a href="#loc_793_1_793_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_793_1_793_5&#39;)"><span class="hl_varref"><span class="mpre">char</span></span></a><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;)&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | The document @langle@ contains a left angle, \&quot;\&lt;\&quot;.</span></span><span class="mpre">
</span><a href="#loc_438_1_438_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_438_1_438_7&#39;)"><span class="mpre">langle</span></a><span class="mpre"> :: </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><a name="loc_438_1_438_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_438_1_438_7&#39;)"><span class="hl_vardecl"><span class="mpre">langle</span></span></a><span class="mpre">          = </span><a href="#loc_793_1_793_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_793_1_793_5&#39;)"><span class="hl_varref"><span class="mpre">char</span></span></a><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;&lt;&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | The document @rangle@ contains a right angle, \&quot;&gt;\&quot;.</span></span><span class="mpre">
</span><a href="#loc_441_1_441_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_441_1_441_7&#39;)"><span class="mpre">rangle</span></a><span class="mpre"> :: </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><a name="loc_441_1_441_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_441_1_441_7&#39;)"><span class="hl_vardecl"><span class="mpre">rangle</span></span></a><span class="mpre">          = </span><a href="#loc_793_1_793_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_793_1_793_5&#39;)"><span class="hl_varref"><span class="mpre">char</span></span></a><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;&gt;&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | The document @lbrace@ contains a left brace, \&quot;{\&quot;.</span></span><span class="mpre">
</span><a href="#loc_444_1_444_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_444_1_444_7&#39;)"><span class="mpre">lbrace</span></a><span class="mpre"> :: </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><a name="loc_444_1_444_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_444_1_444_7&#39;)"><span class="hl_vardecl"><span class="mpre">lbrace</span></span></a><span class="mpre">          = </span><a href="#loc_793_1_793_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_793_1_793_5&#39;)"><span class="hl_varref"><span class="mpre">char</span></span></a><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;{&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | The document @rbrace@ contains a right brace, \&quot;}\&quot;.</span></span><span class="mpre">
</span><a href="#loc_447_1_447_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_447_1_447_7&#39;)"><span class="mpre">rbrace</span></a><span class="mpre"> :: </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><a name="loc_447_1_447_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_447_1_447_7&#39;)"><span class="hl_vardecl"><span class="mpre">rbrace</span></span></a><span class="mpre">          = </span><a href="#loc_793_1_793_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_793_1_793_5&#39;)"><span class="hl_varref"><span class="mpre">char</span></span></a><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;}&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | The document @lbracket@ contains a left square bracket, \&quot;[\&quot;.</span></span><span class="mpre">
</span><a href="#loc_450_1_450_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_450_1_450_9&#39;)"><span class="mpre">lbracket</span></a><span class="mpre"> :: </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><a name="loc_450_1_450_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_450_1_450_9&#39;)"><span class="hl_vardecl"><span class="mpre">lbracket</span></span></a><span class="mpre">        = </span><a href="#loc_793_1_793_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_793_1_793_5&#39;)"><span class="hl_varref"><span class="mpre">char</span></span></a><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;[&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | The document @rbracket@ contains a right square bracket, \&quot;]\&quot;.</span></span><span class="mpre">
</span><a href="#loc_453_1_453_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_453_1_453_9&#39;)"><span class="mpre">rbracket</span></a><span class="mpre"> :: </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><a name="loc_453_1_453_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_453_1_453_9&#39;)"><span class="hl_vardecl"><span class="mpre">rbracket</span></span></a><span class="mpre">        = </span><a href="#loc_793_1_793_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_793_1_793_5&#39;)"><span class="hl_varref"><span class="mpre">char</span></span></a><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;]&#39;</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | The document @squote@ contains a single quote, \&quot;&#39;\&quot;.</span></span><span class="mpre">
</span><a href="#loc_458_1_458_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_458_1_458_7&#39;)"><span class="mpre">squote</span></a><span class="mpre"> :: </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><a name="loc_458_1_458_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_458_1_458_7&#39;)"><span class="hl_vardecl"><span class="mpre">squote</span></span></a><span class="mpre">          = </span><a href="#loc_793_1_793_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_793_1_793_5&#39;)"><span class="hl_varref"><span class="mpre">char</span></span></a><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;\&#39;&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | The document @dquote@ contains a double quote, &#39;\&quot;&#39;.</span></span><span class="mpre">
</span><a href="#loc_461_1_461_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_461_1_461_7&#39;)"><span class="mpre">dquote</span></a><span class="mpre"> :: </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><a name="loc_461_1_461_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_461_1_461_7&#39;)"><span class="hl_vardecl"><span class="mpre">dquote</span></span></a><span class="mpre">          = </span><a href="#loc_793_1_793_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_793_1_793_5&#39;)"><span class="hl_varref"><span class="mpre">char</span></span></a><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;&quot;&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | The document @semi@ contains a semi colon, \&quot;;\&quot;.</span></span><span class="mpre">
</span><a href="#loc_464_1_464_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_464_1_464_5&#39;)"><span class="mpre">semi</span></a><span class="mpre"> :: </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><a name="loc_464_1_464_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_464_1_464_5&#39;)"><span class="hl_vardecl"><span class="mpre">semi</span></span></a><span class="mpre">            = </span><a href="#loc_793_1_793_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_793_1_793_5&#39;)"><span class="hl_varref"><span class="mpre">char</span></span></a><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;;&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | The document @colon@ contains a colon, \&quot;:\&quot;.</span></span><span class="mpre">
</span><a href="#loc_467_1_467_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_467_1_467_6&#39;)"><span class="mpre">colon</span></a><span class="mpre"> :: </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><a name="loc_467_1_467_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_467_1_467_6&#39;)"><span class="hl_vardecl"><span class="mpre">colon</span></span></a><span class="mpre">           = </span><a href="#loc_793_1_793_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_793_1_793_5&#39;)"><span class="hl_varref"><span class="mpre">char</span></span></a><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;:&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | The document @comma@ contains a comma, \&quot;,\&quot;.</span></span><span class="mpre">
</span><a href="#loc_470_1_470_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_470_1_470_6&#39;)"><span class="mpre">comma</span></a><span class="mpre"> :: </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><a name="loc_470_1_470_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_470_1_470_6&#39;)"><span class="hl_vardecl"><span class="mpre">comma</span></span></a><span class="mpre">           = </span><a href="#loc_793_1_793_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_793_1_793_5&#39;)"><span class="hl_varref"><span class="mpre">char</span></span></a><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;,&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | The document @space@ contains a single space, \&quot; \&quot;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; x &lt;+&gt; y   = x &lt;&gt; space &lt;&gt; y</span></span><span class="mpre">
</span><a href="#loc_475_1_475_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_475_1_475_6&#39;)"><span class="mpre">space</span></a><span class="mpre"> :: </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><a name="loc_475_1_475_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_475_1_475_6&#39;)"><span class="hl_vardecl"><span class="mpre">space</span></span></a><span class="mpre">           = </span><a href="#loc_793_1_793_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_793_1_793_5&#39;)"><span class="hl_varref"><span class="mpre">char</span></span></a><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39; &#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | The document @dot@ contains a single dot, \&quot;.\&quot;.</span></span><span class="mpre">
</span><a href="#loc_478_1_478_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_478_1_478_4&#39;)"><span class="mpre">dot</span></a><span class="mpre"> :: </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><a name="loc_478_1_478_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_478_1_478_4&#39;)"><span class="hl_vardecl"><span class="mpre">dot</span></span></a><span class="mpre">             = </span><a href="#loc_793_1_793_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_793_1_793_5&#39;)"><span class="hl_varref"><span class="mpre">char</span></span></a><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;.&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | The document @backslash@ contains a back slash, \&quot;\\\&quot;.</span></span><span class="mpre">
</span><a href="#loc_481_1_481_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_481_1_481_10&#39;)"><span class="mpre">backslash</span></a><span class="mpre"> :: </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><a name="loc_481_1_481_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_481_1_481_10&#39;)"><span class="hl_vardecl"><span class="mpre">backslash</span></span></a><span class="mpre">       = </span><a href="#loc_793_1_793_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_793_1_793_5&#39;)"><span class="hl_varref"><span class="mpre">char</span></span></a><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;\\&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | The document @equals@ contains an equal sign, \&quot;=\&quot;.</span></span><span class="mpre">
</span><a href="#loc_484_1_484_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_484_1_484_7&#39;)"><span class="mpre">equals</span></a><span class="mpre"> :: </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><a name="loc_484_1_484_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_484_1_484_7&#39;)"><span class="hl_vardecl"><span class="mpre">equals</span></span></a><span class="mpre">          = </span><a href="#loc_793_1_793_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_793_1_793_5&#39;)"><span class="hl_varref"><span class="mpre">char</span></span></a><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;=&#39;</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Combinators for prelude types</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- string is like &quot;text&quot; but replaces &#39;\n&#39; by &quot;line&quot;</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The document @(string s)@ concatenates all characters in @s@</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- using @line@ for newline characters and @char@ for all other</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- characters. It is used instead of &#39;text&#39; whenever the text contains</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- newline characters.</span></span><span class="mpre">
</span><a href="#loc_498_1_498_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_498_1_498_7&#39;)"><span class="mpre">string</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><a name="loc_498_1_498_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_498_1_498_7&#39;)"><span class="hl_fundecl"><span class="mpre">string</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">       = </span><a href="#loc_787_1_787_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_787_1_787_6&#39;)"><span class="hl_varref"><span class="mpre">empty</span></span></a><span class="mpre">
</span><a href="#loc_498_1_498_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_498_1_498_7&#39;)"><span class="hl_fundecl"><span class="mpre">string</span></span></a><span class="mpre"> (</span><span class="hl_char"><span class="mpre">&#39;\n&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_499_14_499_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_499_14_499_15&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">) = </span><a href="#loc_808_1_808_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_808_1_808_5&#39;)"><span class="hl_varref"><span class="mpre">line</span></span></a><span class="mpre"> </span><a href="#loc_349_3_349_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_3_349_5&#39;)"><span class="hl_infix"><span class="mpre">&lt;&gt;</span></span></a><span class="mpre"> </span><a href="#loc_498_1_498_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_498_1_498_7&#39;)"><span class="hl_varref"><span class="mpre">string</span></span></a><span class="mpre"> </span><a href="#loc_499_14_499_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_499_14_499_15&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
</span><a href="#loc_498_1_498_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_498_1_498_7&#39;)"><span class="hl_fundecl"><span class="mpre">string</span></span></a><span class="mpre"> </span><a name="loc_500_8_500_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_500_8_500_9&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">        = case (</span><span class="hl_varref"><span class="mpre">span</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">/=</span></span><span class="hl_char"><span class="mpre">&#39;\n&#39;</span></span><span class="mpre">) </span><a href="#loc_500_8_500_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_500_8_500_9&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">) of
                    (</span><a name="loc_501_22_501_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_501_22_501_24&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">,</span><a name="loc_501_25_501_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_501_25_501_27&#39;)"><span class="hl_vardecl"><span class="mpre">ys</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_801_1_801_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_801_1_801_5&#39;)"><span class="hl_varref"><span class="mpre">text</span></span></a><span class="mpre"> </span><a href="#loc_501_22_501_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_501_22_501_24&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> </span><a href="#loc_349_3_349_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_3_349_5&#39;)"><span class="hl_infix"><span class="mpre">&lt;&gt;</span></span></a><span class="mpre"> </span><a href="#loc_498_1_498_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_498_1_498_7&#39;)"><span class="hl_varref"><span class="mpre">string</span></span></a><span class="mpre"> </span><a href="#loc_501_25_501_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_501_25_501_27&#39;)"><span class="hl_varref"><span class="mpre">ys</span></span></a><span class="mpre">

</span><a href="#loc_504_1_504_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_504_1_504_5&#39;)"><span class="mpre">bool</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><a name="loc_504_1_504_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_504_1_504_5&#39;)"><span class="hl_fundecl"><span class="mpre">bool</span></span></a><span class="mpre"> </span><a name="loc_504_6_504_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_504_6_504_7&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">          = </span><a href="#loc_801_1_801_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_801_1_801_5&#39;)"><span class="hl_varref"><span class="mpre">text</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_504_6_504_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_504_6_504_7&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | The document @(int i)@ shows the literal integer @i@ using</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;text&#39;.</span></span><span class="mpre">
</span><a href="#loc_509_1_509_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_509_1_509_4&#39;)"><span class="mpre">int</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><a name="loc_509_1_509_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_509_1_509_4&#39;)"><span class="hl_fundecl"><span class="mpre">int</span></span></a><span class="mpre"> </span><a name="loc_509_5_509_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_509_5_509_6&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre">           = </span><a href="#loc_801_1_801_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_801_1_801_5&#39;)"><span class="hl_varref"><span class="mpre">text</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_509_5_509_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_509_5_509_6&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | The document @(integer i)@ shows the literal integer @i@ using</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;text&#39;.</span></span><span class="mpre">
</span><a href="#loc_514_1_514_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_514_1_514_8&#39;)"><span class="mpre">integer</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><a name="loc_514_1_514_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_514_1_514_8&#39;)"><span class="hl_fundecl"><span class="mpre">integer</span></span></a><span class="mpre"> </span><a name="loc_514_9_514_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_514_9_514_10&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre">       = </span><a href="#loc_801_1_801_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_801_1_801_5&#39;)"><span class="hl_varref"><span class="mpre">text</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_514_9_514_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_514_9_514_10&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | The document @(float f)@ shows the literal float @f@ using</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;text&#39;.</span></span><span class="mpre">
</span><a href="#loc_519_1_519_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_519_1_519_6&#39;)"><span class="mpre">float</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Float</span></span><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><a name="loc_519_1_519_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_519_1_519_6&#39;)"><span class="hl_fundecl"><span class="mpre">float</span></span></a><span class="mpre"> </span><a name="loc_519_7_519_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_519_7_519_8&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">         = </span><a href="#loc_801_1_801_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_801_1_801_5&#39;)"><span class="hl_varref"><span class="mpre">text</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_519_7_519_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_519_7_519_8&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | The document @(double d)@ shows the literal double @d@ using</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;text&#39;.</span></span><span class="mpre">
</span><a href="#loc_524_1_524_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_524_1_524_7&#39;)"><span class="mpre">double</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Double</span></span><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><a name="loc_524_1_524_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_524_1_524_7&#39;)"><span class="hl_fundecl"><span class="mpre">double</span></span></a><span class="mpre"> </span><a name="loc_524_8_524_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_524_8_524_9&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre">        = </span><a href="#loc_801_1_801_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_801_1_801_5&#39;)"><span class="hl_varref"><span class="mpre">text</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_524_8_524_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_524_8_524_9&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | The document @(rational r)@ shows the literal rational @r@ using</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;text&#39;.</span></span><span class="mpre">
</span><a href="#loc_529_1_529_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_529_1_529_9&#39;)"><span class="mpre">rational</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Rational</span></span><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><a name="loc_529_1_529_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_529_1_529_9&#39;)"><span class="hl_fundecl"><span class="mpre">rational</span></span></a><span class="mpre"> </span><a name="loc_529_10_529_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_529_10_529_11&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">      = </span><a href="#loc_801_1_801_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_801_1_801_5&#39;)"><span class="hl_varref"><span class="mpre">text</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_529_10_529_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_529_10_529_11&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">)


</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- overloading &quot;pretty&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The member @prettyList@ is only used to define the @instance Pretty</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- a =&gt; Pretty [a]@. In normal circumstances only the @pretty@ function</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- is used.</span></span><span class="mpre">
class </span><a name="loc_539_7_539_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_539_7_539_13&#39;)"><span class="hl_classdecl"><span class="mpre">Pretty</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> where
  </span><a name="loc_540_3_540_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_540_3_540_9&#39;)"><span class="mpre">pretty</span></a><span class="mpre">        :: </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
  </span><a name="loc_541_3_541_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_541_3_541_13&#39;)"><span class="mpre">prettyList</span></a><span class="mpre">    :: [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">] -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
  </span><a href="#loc_541_3_541_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_541_3_541_13&#39;)"><span class="hl_vardecl"><span class="mpre">prettyList</span></span></a><span class="mpre">    = </span><a href="#loc_171_1_171_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_1_171_5&#39;)"><span class="hl_varref"><span class="mpre">list</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="#loc_540_3_540_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_540_3_540_9&#39;)"><span class="hl_varref"><span class="mpre">pretty</span></span></a><span class="mpre">

instance </span><span class="warning" data-warning="InstDecl ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/ansi-wl-pprint-0.6.7.1/Text/PrettyPrint/ANSI/Leijen.hs&quot;, srcSpanStartLine = 544, srcSpanStartColumn = 10, srcSpanEndLine = 544, srcSpanEndColumn = 21}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/ansi-wl-pprint-0.6.7.1/Text/PrettyPrint/ANSI/Leijen.hs&quot;, srcSpanStartLine = 544, srcSpanStartColumn = 19, srcSpanEndLine = 544, srcSpanEndColumn = 21}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename ="><span class="mpre">Pretty a =&gt;</span></span><span class="mpre"> </span><a href="#loc_539_7_539_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_539_7_539_13&#39;)"><span class="hl_classref"><span class="mpre">Pretty</span></span></a><span class="mpre"> [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">] where
  </span><a href="#loc_540_3_540_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_540_3_540_9&#39;)"><span class="hl_vardecl"><span class="mpre">pretty</span></span></a><span class="mpre">        = </span><a href="#loc_541_3_541_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_541_3_541_13&#39;)"><span class="hl_varref"><span class="mpre">prettyList</span></span></a><span class="mpre">

instance </span><a href="#loc_539_7_539_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_539_7_539_13&#39;)"><span class="hl_classref"><span class="mpre">Pretty</span></span></a><span class="mpre"> </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> where
  </span><a href="#loc_540_3_540_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_540_3_540_9&#39;)"><span class="hl_vardecl"><span class="mpre">pretty</span></span></a><span class="mpre">        = </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">

instance </span><a href="#loc_539_7_539_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_539_7_539_13&#39;)"><span class="hl_classref"><span class="mpre">Pretty</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre"> where
  </span><a href="#loc_540_3_540_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_540_3_540_9&#39;)"><span class="hl_fundecl"><span class="mpre">pretty</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">     = </span><a href="#loc_801_1_801_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_801_1_801_5&#39;)"><span class="hl_varref"><span class="mpre">text</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;()&quot;</span></span><span class="mpre">

instance </span><a href="#loc_539_7_539_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_539_7_539_13&#39;)"><span class="hl_classref"><span class="mpre">Pretty</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre"> where
  </span><a href="#loc_540_3_540_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_540_3_540_9&#39;)"><span class="hl_fundecl"><span class="mpre">pretty</span></span></a><span class="mpre"> </span><a name="loc_554_10_554_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_554_10_554_11&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">      = </span><a href="#loc_504_1_504_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_504_1_504_5&#39;)"><span class="hl_varref"><span class="mpre">bool</span></span></a><span class="mpre"> </span><a href="#loc_554_10_554_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_554_10_554_11&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">

instance </span><a href="#loc_539_7_539_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_539_7_539_13&#39;)"><span class="hl_classref"><span class="mpre">Pretty</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> where
  </span><a href="#loc_540_3_540_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_540_3_540_9&#39;)"><span class="hl_fundecl"><span class="mpre">pretty</span></span></a><span class="mpre"> </span><a name="loc_557_10_557_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_557_10_557_11&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">      = </span><a href="#loc_793_1_793_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_793_1_793_5&#39;)"><span class="hl_varref"><span class="mpre">char</span></span></a><span class="mpre"> </span><a href="#loc_557_10_557_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_557_10_557_11&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">
  </span><a href="#loc_541_3_541_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_541_3_541_13&#39;)"><span class="hl_fundecl"><span class="mpre">prettyList</span></span></a><span class="mpre"> </span><a name="loc_558_14_558_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_558_14_558_15&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">  = </span><a href="#loc_498_1_498_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_498_1_498_7&#39;)"><span class="hl_varref"><span class="mpre">string</span></span></a><span class="mpre"> </span><a href="#loc_558_14_558_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_558_14_558_15&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">

instance </span><a href="#loc_539_7_539_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_539_7_539_13&#39;)"><span class="hl_classref"><span class="mpre">Pretty</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> where
  </span><a href="#loc_540_3_540_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_540_3_540_9&#39;)"><span class="hl_fundecl"><span class="mpre">pretty</span></span></a><span class="mpre"> </span><a name="loc_561_10_561_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_561_10_561_11&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre">      = </span><a href="#loc_509_1_509_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_509_1_509_4&#39;)"><span class="hl_varref"><span class="mpre">int</span></span></a><span class="mpre"> </span><a href="#loc_561_10_561_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_561_10_561_11&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">

instance </span><a href="#loc_539_7_539_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_539_7_539_13&#39;)"><span class="hl_classref"><span class="mpre">Pretty</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> where
  </span><a href="#loc_540_3_540_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_540_3_540_9&#39;)"><span class="hl_fundecl"><span class="mpre">pretty</span></span></a><span class="mpre"> </span><a name="loc_564_10_564_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_564_10_564_11&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre">      = </span><a href="#loc_514_1_514_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_514_1_514_8&#39;)"><span class="hl_varref"><span class="mpre">integer</span></span></a><span class="mpre"> </span><a href="#loc_564_10_564_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_564_10_564_11&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">

instance </span><a href="#loc_539_7_539_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_539_7_539_13&#39;)"><span class="hl_classref"><span class="mpre">Pretty</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Float</span></span><span class="mpre"> where
  </span><a href="#loc_540_3_540_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_540_3_540_9&#39;)"><span class="hl_fundecl"><span class="mpre">pretty</span></span></a><span class="mpre"> </span><a name="loc_567_10_567_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_567_10_567_11&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">      = </span><a href="#loc_519_1_519_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_519_1_519_6&#39;)"><span class="hl_varref"><span class="mpre">float</span></span></a><span class="mpre"> </span><a href="#loc_567_10_567_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_567_10_567_11&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">

instance </span><a href="#loc_539_7_539_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_539_7_539_13&#39;)"><span class="hl_classref"><span class="mpre">Pretty</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Double</span></span><span class="mpre"> where
  </span><a href="#loc_540_3_540_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_540_3_540_9&#39;)"><span class="hl_fundecl"><span class="mpre">pretty</span></span></a><span class="mpre"> </span><a name="loc_570_10_570_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_570_10_570_11&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre">      = </span><a href="#loc_524_1_524_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_524_1_524_7&#39;)"><span class="hl_varref"><span class="mpre">double</span></span></a><span class="mpre"> </span><a href="#loc_570_10_570_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_570_10_570_11&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">--instance Pretty Rational where</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  pretty r      = rational r</span></span><span class="mpre">

instance </span><span class="warning" data-warning="InstDecl ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/ansi-wl-pprint-0.6.7.1/Text/PrettyPrint/ANSI/Leijen.hs&quot;, srcSpanStartLine = 576, srcSpanStartColumn = 10, srcSpanEndLine = 576, srcSpanEndColumn = 32}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/ansi-wl-pprint-0.6.7.1/Text/PrettyPrint/ANSI/Leijen.hs&quot;, srcSpanStartLine = 576, srcSpanStartColumn = 10, srcSpanEndLine = 576, srcSpanEndColumn = 11},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/ansi-wl-ppri"><span class="mpre">(Pretty a,Pretty b) =&gt;</span></span><span class="mpre"> </span><a href="#loc_539_7_539_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_539_7_539_13&#39;)"><span class="hl_classref"><span class="mpre">Pretty</span></span></a><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) where
  </span><a href="#loc_540_3_540_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_540_3_540_9&#39;)"><span class="hl_fundecl"><span class="mpre">pretty</span></span></a><span class="mpre"> (</span><a name="loc_577_11_577_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_577_11_577_12&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">,</span><a name="loc_577_13_577_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_577_13_577_14&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">)  = </span><a href="#loc_178_1_178_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_1_178_7&#39;)"><span class="hl_varref"><span class="mpre">tupled</span></span></a><span class="mpre"> [</span><a href="#loc_540_3_540_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_540_3_540_9&#39;)"><span class="hl_varref"><span class="mpre">pretty</span></span></a><span class="mpre"> </span><a href="#loc_577_11_577_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_577_11_577_12&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">, </span><a href="#loc_540_3_540_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_540_3_540_9&#39;)"><span class="hl_varref"><span class="mpre">pretty</span></span></a><span class="mpre"> </span><a href="#loc_577_13_577_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_577_13_577_14&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">]

instance </span><span class="warning" data-warning="InstDecl ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/ansi-wl-pprint-0.6.7.1/Text/PrettyPrint/ANSI/Leijen.hs&quot;, srcSpanStartLine = 579, srcSpanStartColumn = 10, srcSpanEndLine = 579, srcSpanEndColumn = 41}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/ansi-wl-pprint-0.6.7.1/Text/PrettyPrint/ANSI/Leijen.hs&quot;, srcSpanStartLine = 579, srcSpanStartColumn = 10, srcSpanEndLine = 579, srcSpanEndColumn = 11},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/ansi-wl-ppri"><span class="mpre">(Pretty a,Pretty b,Pretty c) =&gt;</span></span><span class="mpre"> </span><a href="#loc_539_7_539_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_539_7_539_13&#39;)"><span class="hl_classref"><span class="mpre">Pretty</span></span></a><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">c</span></span><span class="mpre">) where
  </span><a href="#loc_540_3_540_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_540_3_540_9&#39;)"><span class="hl_fundecl"><span class="mpre">pretty</span></span></a><span class="mpre"> (</span><a name="loc_580_11_580_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_580_11_580_12&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">,</span><a name="loc_580_13_580_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_580_13_580_14&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">,</span><a name="loc_580_15_580_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_580_15_580_16&#39;)"><span class="hl_vardecl"><span class="mpre">z</span></span></a><span class="mpre">)= </span><a href="#loc_178_1_178_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_1_178_7&#39;)"><span class="hl_varref"><span class="mpre">tupled</span></span></a><span class="mpre"> [</span><a href="#loc_540_3_540_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_540_3_540_9&#39;)"><span class="hl_varref"><span class="mpre">pretty</span></span></a><span class="mpre"> </span><a href="#loc_580_11_580_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_580_11_580_12&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">, </span><a href="#loc_540_3_540_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_540_3_540_9&#39;)"><span class="hl_varref"><span class="mpre">pretty</span></span></a><span class="mpre"> </span><a href="#loc_580_13_580_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_580_13_580_14&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">, </span><a href="#loc_540_3_540_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_540_3_540_9&#39;)"><span class="hl_varref"><span class="mpre">pretty</span></span></a><span class="mpre"> </span><a href="#loc_580_15_580_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_580_15_580_16&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre">]

instance </span><span class="warning" data-warning="InstDecl ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/ansi-wl-pprint-0.6.7.1/Text/PrettyPrint/ANSI/Leijen.hs&quot;, srcSpanStartLine = 582, srcSpanStartColumn = 10, srcSpanEndLine = 582, srcSpanEndColumn = 21}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/ansi-wl-pprint-0.6.7.1/Text/PrettyPrint/ANSI/Leijen.hs&quot;, srcSpanStartLine = 582, srcSpanStartColumn = 19, srcSpanEndLine = 582, srcSpanEndColumn = 21}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename ="><span class="mpre">Pretty a =&gt;</span></span><span class="mpre"> </span><a href="#loc_539_7_539_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_539_7_539_13&#39;)"><span class="hl_classref"><span class="mpre">Pretty</span></span></a><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) where
  </span><a href="#loc_540_3_540_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_540_3_540_9&#39;)"><span class="hl_fundecl"><span class="mpre">pretty</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">        = </span><a href="#loc_787_1_787_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_787_1_787_6&#39;)"><span class="hl_varref"><span class="mpre">empty</span></span></a><span class="mpre">
  </span><a href="#loc_540_3_540_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_540_3_540_9&#39;)"><span class="hl_fundecl"><span class="mpre">pretty</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_584_16_584_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_584_16_584_17&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">)       = </span><a href="#loc_540_3_540_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_540_3_540_9&#39;)"><span class="hl_varref"><span class="mpre">pretty</span></span></a><span class="mpre"> </span><a href="#loc_584_16_584_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_584_16_584_17&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">



</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- semi primitive: fill and fillBreak</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The document @(fillBreak i x)@ first renders document @x@. It</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- than appends @space@s until the width is equal to @i@. If the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- width of @x@ is already larger than @i@, the nesting level is</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- increased by @i@ and a @line@ is appended. When we redefine @ptype@</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- in the previous example to use @fillBreak@, we get a useful</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- variation of the previous output:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; ptype (name,tp)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;        = fillBreak 6 (text name) &lt;+&gt; text &quot;::&quot; &lt;+&gt; text tp</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The output will now be:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- let empty  :: Doc</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--     nest   :: Int -&gt; Doc -&gt; Doc</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--     linebreak</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--            :: Doc</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><a href="#loc_611_1_611_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_611_1_611_10&#39;)"><span class="mpre">fillBreak</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><a name="loc_611_1_611_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_611_1_611_10&#39;)"><span class="hl_fundecl"><span class="mpre">fillBreak</span></span></a><span class="mpre"> </span><a name="loc_611_11_611_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_611_11_611_12&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_611_13_611_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_611_13_611_14&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">   = </span><a href="#loc_644_1_644_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_644_1_644_6&#39;)"><span class="hl_varref"><span class="mpre">width</span></span></a><span class="mpre"> </span><a href="#loc_611_13_611_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_611_13_611_14&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> (\</span><a name="loc_611_29_611_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_611_29_611_30&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> -&gt;
                  if (</span><a href="#loc_611_29_611_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_611_29_611_30&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><a href="#loc_611_11_611_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_611_11_611_12&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">) then </span><a href="#loc_838_1_838_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_838_1_838_5&#39;)"><span class="hl_varref"><span class="mpre">nest</span></span></a><span class="mpre"> </span><a href="#loc_611_11_611_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_611_11_611_12&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_814_1_814_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_814_1_814_10&#39;)"><span class="hl_varref"><span class="mpre">linebreak</span></span></a><span class="mpre">
                             else </span><a href="#loc_801_1_801_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_801_1_801_5&#39;)"><span class="hl_varref"><span class="mpre">text</span></span></a><span class="mpre"> (</span><a href="#loc_1340_1_1340_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1340_1_1340_7&#39;)"><span class="hl_varref"><span class="mpre">spaces</span></span></a><span class="mpre"> (</span><a href="#loc_611_11_611_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_611_11_611_12&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_611_29_611_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_611_29_611_30&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">)))


</span><span class="hl_comment"><span class="mpre">-- | The document @(fill i x)@ renders document @x@. It than appends</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @space@s until the width is equal to @i@. If the width of @x@ is</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- already larger, nothing is appended. This combinator is quite</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- useful in practice to output a list of bindings. The following</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- example demonstrates this.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; types  = [(&quot;empty&quot;,&quot;Doc&quot;)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;          ,(&quot;nest&quot;,&quot;Int -&gt; Doc -&gt; Doc&quot;)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;          ,(&quot;linebreak&quot;,&quot;Doc&quot;)]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; ptype (name,tp)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;        = fill 6 (text name) &lt;+&gt; text &quot;::&quot; &lt;+&gt; text tp</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; test   = text &quot;let&quot; &lt;+&gt; align (vcat (map ptype types))</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Which is layed out as:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- let empty  :: Doc</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--     nest   :: Int -&gt; Doc -&gt; Doc</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--     linebreak :: Doc</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><a href="#loc_639_1_639_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_639_1_639_5&#39;)"><span class="mpre">fill</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><a name="loc_639_1_639_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_639_1_639_5&#39;)"><span class="hl_fundecl"><span class="mpre">fill</span></span></a><span class="mpre"> </span><a name="loc_639_6_639_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_639_6_639_7&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_639_8_639_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_639_8_639_9&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre">        = </span><a href="#loc_644_1_644_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_644_1_644_6&#39;)"><span class="hl_varref"><span class="mpre">width</span></span></a><span class="mpre"> </span><a href="#loc_639_8_639_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_639_8_639_9&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> (\</span><a name="loc_639_29_639_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_639_29_639_30&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> -&gt;
                  if (</span><a href="#loc_639_29_639_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_639_29_639_30&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><a href="#loc_639_6_639_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_639_6_639_7&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">) then </span><a href="#loc_787_1_787_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_787_1_787_6&#39;)"><span class="hl_varref"><span class="mpre">empty</span></span></a><span class="mpre">
                              else </span><a href="#loc_801_1_801_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_801_1_801_5&#39;)"><span class="hl_varref"><span class="mpre">text</span></span></a><span class="mpre"> (</span><a href="#loc_1340_1_1340_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1340_1_1340_7&#39;)"><span class="hl_varref"><span class="mpre">spaces</span></span></a><span class="mpre"> (</span><a href="#loc_639_6_639_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_639_6_639_7&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_639_29_639_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_639_29_639_30&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">)))

</span><a href="#loc_644_1_644_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_644_1_644_6&#39;)"><span class="mpre">width</span></a><span class="mpre"> :: </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><a name="loc_644_1_644_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_644_1_644_6&#39;)"><span class="hl_fundecl"><span class="mpre">width</span></span></a><span class="mpre"> </span><a name="loc_644_7_644_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_644_7_644_8&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre"> </span><a name="loc_644_9_644_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_644_9_644_10&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">       = </span><a href="#loc_841_1_841_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_841_1_841_7&#39;)"><span class="hl_varref"><span class="mpre">column</span></span></a><span class="mpre"> (\</span><a name="loc_644_28_644_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_644_28_644_30&#39;)"><span class="hl_vardecl"><span class="mpre">k1</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_644_7_644_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_644_7_644_8&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><a href="#loc_349_3_349_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_3_349_5&#39;)"><span class="hl_infix"><span class="mpre">&lt;&gt;</span></span></a><span class="mpre"> </span><a href="#loc_841_1_841_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_841_1_841_7&#39;)"><span class="hl_varref"><span class="mpre">column</span></span></a><span class="mpre"> (\</span><a name="loc_644_48_644_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_644_48_644_50&#39;)"><span class="hl_vardecl"><span class="mpre">k2</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_644_9_644_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_644_9_644_10&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_644_48_644_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_644_48_644_50&#39;)"><span class="hl_varref"><span class="mpre">k2</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_644_28_644_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_644_28_644_30&#39;)"><span class="hl_varref"><span class="mpre">k1</span></span></a><span class="mpre">)))


</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- semi primitive: Alignment and indentation</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The document @(indent i x)@ indents document @x@ with @i@ spaces.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; test  = indent 4 (fillSep (map text</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;         (words &quot;the indent combinator indents these words !&quot;)))</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Which lays out with a page width of 20 as:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--     the indent</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--     combinator</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--     indents these</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--     words !</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><a href="#loc_665_1_665_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_665_1_665_7&#39;)"><span class="mpre">indent</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><a name="loc_665_1_665_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_665_1_665_7&#39;)"><span class="hl_fundecl"><span class="mpre">indent</span></span></a><span class="mpre"> </span><a name="loc_665_8_665_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_665_8_665_9&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> </span><a name="loc_665_10_665_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_665_10_665_11&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre">      = </span><a href="#loc_687_1_687_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_687_1_687_5&#39;)"><span class="hl_varref"><span class="mpre">hang</span></span></a><span class="mpre"> </span><a href="#loc_665_8_665_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_665_8_665_9&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> (</span><a href="#loc_801_1_801_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_801_1_801_5&#39;)"><span class="hl_varref"><span class="mpre">text</span></span></a><span class="mpre"> (</span><a href="#loc_1340_1_1340_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1340_1_1340_7&#39;)"><span class="hl_varref"><span class="mpre">spaces</span></span></a><span class="mpre"> </span><a href="#loc_665_8_665_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_665_8_665_9&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">) </span><a href="#loc_349_3_349_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_3_349_5&#39;)"><span class="hl_infix"><span class="mpre">&lt;&gt;</span></span></a><span class="mpre"> </span><a href="#loc_665_10_665_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_665_10_665_11&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | The hang combinator implements hanging indentation. The document</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @(hang i x)@ renders document @x@ with a nesting level set to the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- current column plus @i@. The following example uses hanging</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- indentation for some text:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; test  = hang 4 (fillSep (map text</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;         (words &quot;the hang combinator indents these words !&quot;)))</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Which lays out on a page with a width of 20 characters as:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the hang combinator</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--     indents these</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--     words !</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The @hang@ combinator is implemented as:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; hang i x  = align (nest i x)</span></span><span class="mpre">
</span><a href="#loc_687_1_687_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_687_1_687_5&#39;)"><span class="mpre">hang</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><a name="loc_687_1_687_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_687_1_687_5&#39;)"><span class="hl_fundecl"><span class="mpre">hang</span></span></a><span class="mpre"> </span><a name="loc_687_6_687_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_687_6_687_7&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> </span><a name="loc_687_8_687_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_687_8_687_9&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre">        = </span><a href="#loc_707_1_707_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_707_1_707_6&#39;)"><span class="hl_varref"><span class="mpre">align</span></span></a><span class="mpre"> (</span><a href="#loc_838_1_838_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_838_1_838_5&#39;)"><span class="hl_varref"><span class="mpre">nest</span></span></a><span class="mpre"> </span><a href="#loc_687_6_687_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_687_6_687_7&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><a href="#loc_687_8_687_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_687_8_687_9&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | The document @(align x)@ renders document @x@ with the nesting</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- level set to the current column. It is used for example to</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- implement &#39;hang&#39;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- As an example, we will put a document right above another one,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- regardless of the current nesting level:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; x $$ y  = align (x &lt;$&gt; y)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; test    = text &quot;hi&quot; &lt;+&gt; (text &quot;nice&quot; $$ text &quot;world&quot;)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- which will be layed out as:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- hi nice</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--    world</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><a href="#loc_707_1_707_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_707_1_707_6&#39;)"><span class="mpre">align</span></a><span class="mpre"> :: </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><a name="loc_707_1_707_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_707_1_707_6&#39;)"><span class="hl_fundecl"><span class="mpre">align</span></span></a><span class="mpre"> </span><a name="loc_707_7_707_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_707_7_707_8&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre">         = </span><a href="#loc_841_1_841_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_841_1_841_7&#39;)"><span class="hl_varref"><span class="mpre">column</span></span></a><span class="mpre"> (\</span><a name="loc_707_28_707_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_707_28_707_29&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> -&gt;
                  </span><a href="#loc_842_1_842_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_842_1_842_8&#39;)"><span class="hl_varref"><span class="mpre">nesting</span></span></a><span class="mpre"> (\</span><a name="loc_708_29_708_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_708_29_708_30&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_838_1_838_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_838_1_838_5&#39;)"><span class="hl_varref"><span class="mpre">nest</span></span></a><span class="mpre"> (</span><a href="#loc_707_28_707_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_707_28_707_29&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_708_29_708_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_708_29_708_30&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">) </span><a href="#loc_707_7_707_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_707_7_707_8&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre">))   </span><span class="hl_comment"><span class="mpre">--nesting might be negative :-)</span></span><span class="mpre">



</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Primitives</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The abstract data type @Doc@ represents pretty documents.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @Doc@ is an instance of the &#39;Show&#39; class. @(show doc)@ pretty</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- prints document @doc@ with a page width of 100 characters and a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ribbon width of 40 characters.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; show (text &quot;hello&quot; &lt;$&gt; text &quot;world&quot;)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Which would return the string \&quot;hello\\nworld\&quot;, i.e.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- hello</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- world</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
data </span><a name="loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tycondecl"><span class="mpre">Doc</span></span></a><span class="mpre">        = </span><a name="loc_730_19_730_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_19_730_23&#39;)"><span class="hl_condecl"><span class="mpre">Fail</span></span></a><span class="mpre">
                | </span><a name="loc_731_19_731_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_731_19_731_24&#39;)"><span class="hl_condecl"><span class="mpre">Empty</span></span></a><span class="mpre">
                | </span><a name="loc_732_19_732_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_732_19_732_23&#39;)"><span class="hl_condecl"><span class="mpre">Char</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">             </span><span class="hl_comment"><span class="mpre">-- invariant: char is not &#39;\n&#39;</span></span><span class="mpre">
                | </span><a name="loc_733_19_733_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_733_19_733_23&#39;)"><span class="hl_condecl"><span class="mpre">Text</span></span></a><span class="mpre"> !</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">      </span><span class="hl_comment"><span class="mpre">-- invariant: text doesn&#39;t contain &#39;\n&#39;</span></span><span class="mpre">
                | </span><a name="loc_734_19_734_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_734_19_734_23&#39;)"><span class="hl_condecl"><span class="mpre">Line</span></span></a><span class="mpre">
                | </span><a name="loc_735_19_735_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_735_19_735_26&#39;)"><span class="hl_condecl"><span class="mpre">FlatAlt</span></span></a><span class="mpre"> </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">       </span><span class="hl_comment"><span class="mpre">-- Render the first doc, but when</span></span><span class="mpre">
                                        </span><span class="hl_comment"><span class="mpre">-- flattened, render the second.</span></span><span class="mpre">
                | </span><a name="loc_737_19_737_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_737_19_737_22&#39;)"><span class="hl_condecl"><span class="mpre">Cat</span></span></a><span class="mpre"> </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
                | </span><a name="loc_738_19_738_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_738_19_738_23&#39;)"><span class="hl_condecl"><span class="mpre">Nest</span></span></a><span class="mpre"> !</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
                | </span><a name="loc_739_19_739_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_739_19_739_24&#39;)"><span class="hl_condecl"><span class="mpre">Union</span></span></a><span class="mpre"> </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">         </span><span class="hl_comment"><span class="mpre">-- invariant: first lines of first doc longer than the first lines of the second doc</span></span><span class="mpre">
                | </span><a name="loc_740_19_740_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_740_19_740_25&#39;)"><span class="hl_condecl"><span class="mpre">Column</span></span></a><span class="mpre">  (</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">)
                | </span><a name="loc_741_19_741_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_741_19_741_26&#39;)"><span class="hl_condecl"><span class="mpre">Columns</span></span></a><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">)
                | </span><a name="loc_742_19_742_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_742_19_742_26&#39;)"><span class="hl_condecl"><span class="mpre">Nesting</span></span></a><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">)
                | </span><a name="loc_743_19_743_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_743_19_743_24&#39;)"><span class="hl_condecl"><span class="mpre">Color</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ConsoleLayer</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ColorIntensity</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- Introduces coloring /around/ the embedded document</span></span><span class="mpre">
                        </span><span class="hl_tyconref"><span class="mpre">Color</span></span><span class="mpre"> </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
                | </span><a name="loc_745_19_745_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_745_19_745_28&#39;)"><span class="hl_condecl"><span class="mpre">Intensify</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ConsoleIntensity</span></span><span class="mpre"> </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
                | </span><a name="loc_746_19_746_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_746_19_746_28&#39;)"><span class="hl_condecl"><span class="mpre">Italicize</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre"> </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
                | </span><a name="loc_747_19_747_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_747_19_747_28&#39;)"><span class="hl_condecl"><span class="mpre">Underline</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Underlining</span></span><span class="mpre"> </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
                | </span><a name="loc_748_19_748_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_748_19_748_32&#39;)"><span class="hl_condecl"><span class="mpre">RestoreFormat</span></span></a><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">ColorIntensity</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Color</span></span><span class="mpre">))  </span><span class="hl_comment"><span class="mpre">-- Only used during the rendered phase, to signal a SGR should be issued to restore the terminal formatting.</span></span><span class="mpre">
                                (</span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">ColorIntensity</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Color</span></span><span class="mpre">))  </span><span class="hl_comment"><span class="mpre">-- These are the colors to revert the current forecolor/backcolor to (i.e. those from before the start of the Color block).</span></span><span class="mpre">
                                (</span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ConsoleIntensity</span></span><span class="mpre">)         </span><span class="hl_comment"><span class="mpre">-- Intensity to revert to.</span></span><span class="mpre">
                                (</span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">)                     </span><span class="hl_comment"><span class="mpre">-- Italicization to revert to.</span></span><span class="mpre">
                                (</span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Underlining</span></span><span class="mpre">)              </span><span class="hl_comment"><span class="mpre">-- Underlining to revert to.</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | The data type @SimpleDoc@ represents rendered documents and is</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- used by the display functions.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The @Int@ in @SText@ contains the length of the string. The @Int@</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- in @SLine@ contains the indentation for that line. The library</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- provides two default display functions &#39;displayS&#39; and</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;displayIO&#39;. You can provide your own display function by writing a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- function from a @SimpleDoc@ to your own output format.</span></span><span class="mpre">
data </span><a name="loc_763_6_763_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_763_6_763_15&#39;)"><span class="hl_tycondecl"><span class="mpre">SimpleDoc</span></span></a><span class="mpre">  = </span><a name="loc_763_19_763_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_763_19_763_24&#39;)"><span class="hl_condecl"><span class="mpre">SFail</span></span></a><span class="mpre">
                | </span><a name="loc_764_19_764_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_764_19_764_25&#39;)"><span class="hl_condecl"><span class="mpre">SEmpty</span></span></a><span class="mpre">
                | </span><a name="loc_765_19_765_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_765_19_765_24&#39;)"><span class="hl_condecl"><span class="mpre">SChar</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> </span><a href="#loc_763_6_763_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_763_6_763_15&#39;)"><span class="hl_tyconref"><span class="mpre">SimpleDoc</span></span></a><span class="mpre">
                | </span><a name="loc_766_19_766_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_766_19_766_24&#39;)"><span class="hl_condecl"><span class="mpre">SText</span></span></a><span class="mpre"> !</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> </span><a href="#loc_763_6_763_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_763_6_763_15&#39;)"><span class="hl_tyconref"><span class="mpre">SimpleDoc</span></span></a><span class="mpre">
                | </span><a name="loc_767_19_767_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_767_19_767_24&#39;)"><span class="hl_condecl"><span class="mpre">SLine</span></span></a><span class="mpre"> !</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> </span><a href="#loc_763_6_763_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_763_6_763_15&#39;)"><span class="hl_tyconref"><span class="mpre">SimpleDoc</span></span></a><span class="mpre">
                | </span><a name="loc_768_19_768_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_768_19_768_23&#39;)"><span class="hl_condecl"><span class="mpre">SSGR</span></span></a><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">SGR</span></span><span class="mpre">] </span><a href="#loc_763_6_763_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_763_6_763_15&#39;)"><span class="hl_tyconref"><span class="mpre">SimpleDoc</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- MCB: Not in the wl-pprint package that we forked from. I added this when the &quot;pretty&quot; package</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- from base gained a Monoid instance (&lt;http://hackage.haskell.org/trac/ghc/ticket/4378&gt;):</span></span><span class="mpre">
instance </span><a href="Data.Monoid.html#loc_79_7_79_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_79_7_79_13&#39;)"><span class="hl_classref"><span class="mpre">Monoid</span></span></a><span class="mpre"> </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> where
    </span><a href="Data.Monoid.html#loc_80_9_80_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_80_9_80_15&#39;)"><span class="hl_vardecl"><span class="mpre">mempty</span></span></a><span class="mpre"> = </span><a href="#loc_787_1_787_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_787_1_787_6&#39;)"><span class="hl_varref"><span class="mpre">empty</span></span></a><span class="mpre">
    </span><a href="Data.Monoid.html#loc_82_9_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_82_9_82_16&#39;)"><span class="hl_vardecl"><span class="mpre">mappend</span></span></a><span class="mpre"> = </span><a href="#loc_349_3_349_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_349_3_349_5&#39;)"><span class="hl_varref"><span class="mpre">(&lt;&gt;)</span></span></a><span class="mpre">
    </span><a href="Data.Monoid.html#loc_84_9_84_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_84_9_84_16&#39;)"><span class="hl_vardecl"><span class="mpre">mconcat</span></span></a><span class="mpre"> = </span><a href="#loc_333_1_333_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_333_1_333_5&#39;)"><span class="hl_varref"><span class="mpre">hcat</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- MCB: also added when &quot;pretty&quot; got the corresponding instances:</span></span><span class="mpre">
instance </span><a href="Data.String.html#loc_34_7_34_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.String.html#loc_34_7_34_15&#39;)"><span class="hl_classref"><span class="mpre">IsString</span></span></a><span class="mpre"> </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> where
    </span><a href="Data.String.html#loc_35_5_35_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.String.html#loc_35_5_35_15&#39;)"><span class="hl_vardecl"><span class="mpre">fromString</span></span></a><span class="mpre"> = </span><a href="#loc_801_1_801_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_801_1_801_5&#39;)"><span class="hl_varref"><span class="mpre">text</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | The empty document is, indeed, empty. Although @empty@ has no</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- content, it does have a \&#39;height\&#39; of 1 and behaves exactly like</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @(text \&quot;\&quot;)@ (and is therefore not a unit of @\&lt;$\&gt;@).</span></span><span class="mpre">
</span><a href="#loc_787_1_787_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_787_1_787_6&#39;)"><span class="mpre">empty</span></a><span class="mpre"> :: </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><a name="loc_787_1_787_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_787_1_787_6&#39;)"><span class="hl_vardecl"><span class="mpre">empty</span></span></a><span class="mpre">           = </span><a href="#loc_731_19_731_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_731_19_731_24&#39;)"><span class="hl_conref"><span class="mpre">Empty</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The document @(char c)@ contains the literal character @c@. The</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- character shouldn&#39;t be a newline (@&#39;\n&#39;@), the function &#39;line&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- should be used for line breaks.</span></span><span class="mpre">
</span><a href="#loc_793_1_793_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_793_1_793_5&#39;)"><span class="mpre">char</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><a name="loc_793_1_793_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_793_1_793_5&#39;)"><span class="hl_fundecl"><span class="mpre">char</span></span></a><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;\n&#39;</span></span><span class="mpre">       = </span><a href="#loc_808_1_808_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_808_1_808_5&#39;)"><span class="hl_varref"><span class="mpre">line</span></span></a><span class="mpre">
</span><a href="#loc_793_1_793_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_793_1_793_5&#39;)"><span class="hl_fundecl"><span class="mpre">char</span></span></a><span class="mpre"> </span><a name="loc_794_6_794_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_794_6_794_7&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">          = </span><a href="#loc_732_19_732_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_732_19_732_23&#39;)"><span class="hl_conref"><span class="mpre">Char</span></span></a><span class="mpre"> </span><a href="#loc_794_6_794_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_794_6_794_7&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The document @(text s)@ contains the literal string @s@. The</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- string shouldn&#39;t contain any newline (@&#39;\n&#39;@) characters. If the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- string contains newline characters, the function &#39;string&#39; should be</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- used.</span></span><span class="mpre">
</span><a href="#loc_801_1_801_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_801_1_801_5&#39;)"><span class="mpre">text</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><a name="loc_801_1_801_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_801_1_801_5&#39;)"><span class="hl_fundecl"><span class="mpre">text</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">         = </span><a href="#loc_731_19_731_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_731_19_731_24&#39;)"><span class="hl_conref"><span class="mpre">Empty</span></span></a><span class="mpre">
</span><a href="#loc_801_1_801_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_801_1_801_5&#39;)"><span class="hl_fundecl"><span class="mpre">text</span></span></a><span class="mpre"> </span><a name="loc_802_6_802_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_802_6_802_7&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">          = </span><a href="#loc_733_19_733_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_733_19_733_23&#39;)"><span class="hl_conref"><span class="mpre">Text</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_802_6_802_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_802_6_802_7&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">) </span><a href="#loc_802_6_802_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_802_6_802_7&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The @line@ document advances to the next line and indents to the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- current nesting level. Document @line@ behaves like @(text \&quot; \&quot;)@</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- if the line break is undone by &#39;group&#39;.</span></span><span class="mpre">
</span><a href="#loc_808_1_808_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_808_1_808_5&#39;)"><span class="mpre">line</span></a><span class="mpre"> :: </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><a name="loc_808_1_808_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_808_1_808_5&#39;)"><span class="hl_vardecl"><span class="mpre">line</span></span></a><span class="mpre">            = </span><a href="#loc_735_19_735_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_735_19_735_26&#39;)"><span class="hl_conref"><span class="mpre">FlatAlt</span></span></a><span class="mpre"> </span><a href="#loc_734_19_734_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_734_19_734_23&#39;)"><span class="hl_conref"><span class="mpre">Line</span></span></a><span class="mpre"> </span><a href="#loc_475_1_475_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_475_1_475_6&#39;)"><span class="hl_varref"><span class="mpre">space</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The @linebreak@ document advances to the next line and indents to</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the current nesting level. Document @linebreak@ behaves like</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;empty&#39; if the line break is undone by &#39;group&#39;.</span></span><span class="mpre">
</span><a href="#loc_814_1_814_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_814_1_814_10&#39;)"><span class="mpre">linebreak</span></a><span class="mpre"> :: </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><a name="loc_814_1_814_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_814_1_814_10&#39;)"><span class="hl_vardecl"><span class="mpre">linebreak</span></span></a><span class="mpre">       = </span><a href="#loc_735_19_735_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_735_19_735_26&#39;)"><span class="hl_conref"><span class="mpre">FlatAlt</span></span></a><span class="mpre"> </span><a href="#loc_734_19_734_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_734_19_734_23&#39;)"><span class="hl_conref"><span class="mpre">Line</span></span></a><span class="mpre"> </span><a href="#loc_787_1_787_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_787_1_787_6&#39;)"><span class="hl_varref"><span class="mpre">empty</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | A linebreak that will never be flattened; it is guaranteed to render</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- as a newline.</span></span><span class="mpre">
</span><a href="#loc_819_1_819_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_819_1_819_9&#39;)"><span class="mpre">hardline</span></a><span class="mpre"> :: </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><a name="loc_819_1_819_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_819_1_819_9&#39;)"><span class="hl_vardecl"><span class="mpre">hardline</span></span></a><span class="mpre"> = </span><a href="#loc_734_19_734_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_734_19_734_23&#39;)"><span class="hl_conref"><span class="mpre">Line</span></span></a><span class="mpre">

</span><a href="#loc_822_1_822_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_822_1_822_7&#39;)"><span class="mpre">beside</span></a><span class="mpre"> :: </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><a name="loc_822_1_822_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_822_1_822_7&#39;)"><span class="hl_fundecl"><span class="mpre">beside</span></span></a><span class="mpre"> </span><a name="loc_822_8_822_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_822_8_822_9&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_822_10_822_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_822_10_822_11&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">      = </span><a href="#loc_737_19_737_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_737_19_737_22&#39;)"><span class="hl_conref"><span class="mpre">Cat</span></span></a><span class="mpre"> </span><a href="#loc_822_8_822_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_822_8_822_9&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_822_10_822_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_822_10_822_11&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The document @(nest i x)@ renders document @x@ with the current</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- indentation level increased by i (See also &#39;hang&#39;, &#39;align&#39; and</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;indent&#39;).</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; nest 2 (text &quot;hello&quot; &lt;$&gt; text &quot;world&quot;) &lt;$&gt; text &quot;!&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- outputs as:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- hello</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   world</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- !</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><a href="#loc_838_1_838_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_838_1_838_5&#39;)"><span class="mpre">nest</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><a name="loc_838_1_838_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_838_1_838_5&#39;)"><span class="hl_fundecl"><span class="mpre">nest</span></span></a><span class="mpre"> </span><a name="loc_838_6_838_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_838_6_838_7&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> </span><a name="loc_838_8_838_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_838_8_838_9&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">        = </span><a href="#loc_738_19_738_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_738_19_738_23&#39;)"><span class="hl_conref"><span class="mpre">Nest</span></span></a><span class="mpre"> </span><a href="#loc_838_6_838_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_838_6_838_7&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><a href="#loc_838_8_838_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_838_8_838_9&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">

</span><a href="#loc_841_1_841_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_841_1_841_7&#39;)"><span class="mpre">column</span></a><span class="mpre">, </span><a href="#loc_842_1_842_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_842_1_842_8&#39;)"><span class="mpre">nesting</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><a name="loc_841_1_841_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_841_1_841_7&#39;)"><span class="hl_fundecl"><span class="mpre">column</span></span></a><span class="mpre"> </span><a name="loc_841_8_841_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_841_8_841_9&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">        = </span><a href="#loc_740_19_740_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_740_19_740_25&#39;)"><span class="hl_conref"><span class="mpre">Column</span></span></a><span class="mpre"> </span><a href="#loc_841_8_841_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_841_8_841_9&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">
</span><a name="loc_842_1_842_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_842_1_842_8&#39;)"><span class="hl_fundecl"><span class="mpre">nesting</span></span></a><span class="mpre"> </span><a name="loc_842_9_842_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_842_9_842_10&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">       = </span><a href="#loc_742_19_742_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_742_19_742_26&#39;)"><span class="hl_conref"><span class="mpre">Nesting</span></span></a><span class="mpre"> </span><a href="#loc_842_9_842_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_842_9_842_10&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">

</span><a href="#loc_845_1_845_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_845_1_845_8&#39;)"><span class="mpre">columns</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><a name="loc_845_1_845_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_845_1_845_8&#39;)"><span class="hl_fundecl"><span class="mpre">columns</span></span></a><span class="mpre"> </span><a name="loc_845_9_845_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_845_9_845_10&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">       = </span><a href="#loc_741_19_741_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_741_19_741_26&#39;)"><span class="hl_conref"><span class="mpre">Columns</span></span></a><span class="mpre"> </span><a href="#loc_845_9_845_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_845_9_845_10&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The @group@ combinator is used to specify alternative</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- layouts. The document @(group x)@ undoes all line breaks in</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- document @x@. The resulting line is added to the current line if</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- that fits the page. Otherwise, the document @x@ is rendered without</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- any changes.</span></span><span class="mpre">
</span><a href="#loc_853_1_853_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_853_1_853_6&#39;)"><span class="mpre">group</span></a><span class="mpre"> :: </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><a name="loc_853_1_853_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_853_1_853_6&#39;)"><span class="hl_fundecl"><span class="mpre">group</span></span></a><span class="mpre"> </span><a name="loc_853_7_853_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_853_7_853_8&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">         = </span><a href="#loc_739_19_739_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_739_19_739_24&#39;)"><span class="hl_conref"><span class="mpre">Union</span></span></a><span class="mpre"> (</span><a href="#loc_861_1_861_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_861_1_861_8&#39;)"><span class="hl_varref"><span class="mpre">flatten</span></span></a><span class="mpre"> </span><a href="#loc_853_7_853_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_853_7_853_8&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">) </span><a href="#loc_853_7_853_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_853_7_853_8&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | A document that is normally rendered as the first argument, but</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- when flattened, is rendered as the second document.</span></span><span class="mpre">
</span><a href="#loc_858_1_858_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_858_1_858_8&#39;)"><span class="mpre">flatAlt</span></a><span class="mpre"> :: </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><a name="loc_858_1_858_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_858_1_858_8&#39;)"><span class="hl_vardecl"><span class="mpre">flatAlt</span></span></a><span class="mpre"> = </span><a href="#loc_735_19_735_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_735_19_735_26&#39;)"><span class="hl_conref"><span class="mpre">FlatAlt</span></span></a><span class="mpre">

</span><a href="#loc_861_1_861_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_861_1_861_8&#39;)"><span class="mpre">flatten</span></a><span class="mpre"> :: </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><a name="loc_861_1_861_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_861_1_861_8&#39;)"><span class="hl_fundecl"><span class="mpre">flatten</span></span></a><span class="mpre"> (</span><a href="#loc_735_19_735_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_735_19_735_26&#39;)"><span class="hl_conref"><span class="mpre">FlatAlt</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">x</span></span><span class="mpre"> </span><a name="loc_861_20_861_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_861_20_861_21&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">)    = </span><a href="#loc_861_20_861_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_861_20_861_21&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">
</span><a href="#loc_861_1_861_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_861_1_861_8&#39;)"><span class="hl_fundecl"><span class="mpre">flatten</span></span></a><span class="mpre"> (</span><a href="#loc_737_19_737_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_737_19_737_22&#39;)"><span class="hl_conref"><span class="mpre">Cat</span></span></a><span class="mpre"> </span><a name="loc_862_14_862_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_862_14_862_15&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_862_16_862_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_862_16_862_17&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">)        = </span><a href="#loc_737_19_737_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_737_19_737_22&#39;)"><span class="hl_conref"><span class="mpre">Cat</span></span></a><span class="mpre"> (</span><a href="#loc_861_1_861_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_861_1_861_8&#39;)"><span class="hl_varref"><span class="mpre">flatten</span></span></a><span class="mpre"> </span><a href="#loc_862_14_862_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_862_14_862_15&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">) (</span><a href="#loc_861_1_861_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_861_1_861_8&#39;)"><span class="hl_varref"><span class="mpre">flatten</span></span></a><span class="mpre"> </span><a href="#loc_862_16_862_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_862_16_862_17&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">)
</span><a href="#loc_861_1_861_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_861_1_861_8&#39;)"><span class="hl_fundecl"><span class="mpre">flatten</span></span></a><span class="mpre"> (</span><a href="#loc_738_19_738_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_738_19_738_23&#39;)"><span class="hl_conref"><span class="mpre">Nest</span></span></a><span class="mpre"> </span><a name="loc_863_15_863_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_863_15_863_16&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> </span><a name="loc_863_17_863_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_863_17_863_18&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">)       = </span><a href="#loc_738_19_738_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_738_19_738_23&#39;)"><span class="hl_conref"><span class="mpre">Nest</span></span></a><span class="mpre"> </span><a href="#loc_863_15_863_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_863_15_863_16&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> (</span><a href="#loc_861_1_861_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_861_1_861_8&#39;)"><span class="hl_varref"><span class="mpre">flatten</span></span></a><span class="mpre"> </span><a href="#loc_863_17_863_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_863_17_863_18&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)
</span><a href="#loc_861_1_861_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_861_1_861_8&#39;)"><span class="hl_fundecl"><span class="mpre">flatten</span></span></a><span class="mpre">  </span><a href="#loc_734_19_734_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_734_19_734_23&#39;)"><span class="hl_conref"><span class="mpre">Line</span></span></a><span class="mpre">            = </span><a href="#loc_730_19_730_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_19_730_23&#39;)"><span class="hl_conref"><span class="mpre">Fail</span></span></a><span class="mpre">
</span><a href="#loc_861_1_861_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_861_1_861_8&#39;)"><span class="hl_fundecl"><span class="mpre">flatten</span></span></a><span class="mpre"> (</span><a href="#loc_739_19_739_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_739_19_739_24&#39;)"><span class="hl_conref"><span class="mpre">Union</span></span></a><span class="mpre"> </span><a name="loc_865_16_865_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_865_16_865_17&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">y</span></span><span class="mpre">)      = </span><a href="#loc_861_1_861_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_861_1_861_8&#39;)"><span class="hl_varref"><span class="mpre">flatten</span></span></a><span class="mpre"> </span><a href="#loc_865_16_865_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_865_16_865_17&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
</span><a href="#loc_861_1_861_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_861_1_861_8&#39;)"><span class="hl_fundecl"><span class="mpre">flatten</span></span></a><span class="mpre"> (</span><a href="#loc_740_19_740_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_740_19_740_25&#39;)"><span class="hl_conref"><span class="mpre">Column</span></span></a><span class="mpre"> </span><a name="loc_866_17_866_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_866_17_866_18&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">)       = </span><a href="#loc_740_19_740_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_740_19_740_25&#39;)"><span class="hl_conref"><span class="mpre">Column</span></span></a><span class="mpre"> (</span><a href="#loc_861_1_861_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_861_1_861_8&#39;)"><span class="hl_varref"><span class="mpre">flatten</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_866_17_866_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_866_17_866_18&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">)
</span><a href="#loc_861_1_861_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_861_1_861_8&#39;)"><span class="hl_fundecl"><span class="mpre">flatten</span></span></a><span class="mpre"> (</span><a href="#loc_741_19_741_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_741_19_741_26&#39;)"><span class="hl_conref"><span class="mpre">Columns</span></span></a><span class="mpre"> </span><a name="loc_867_18_867_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_867_18_867_19&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">)      = </span><a href="#loc_741_19_741_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_741_19_741_26&#39;)"><span class="hl_conref"><span class="mpre">Columns</span></span></a><span class="mpre"> (</span><a href="#loc_861_1_861_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_861_1_861_8&#39;)"><span class="hl_varref"><span class="mpre">flatten</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_867_18_867_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_867_18_867_19&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">)
</span><a href="#loc_861_1_861_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_861_1_861_8&#39;)"><span class="hl_fundecl"><span class="mpre">flatten</span></span></a><span class="mpre"> (</span><a href="#loc_742_19_742_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_742_19_742_26&#39;)"><span class="hl_conref"><span class="mpre">Nesting</span></span></a><span class="mpre"> </span><a name="loc_868_18_868_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_868_18_868_19&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">)      = </span><a href="#loc_742_19_742_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_742_19_742_26&#39;)"><span class="hl_conref"><span class="mpre">Nesting</span></span></a><span class="mpre"> (</span><a href="#loc_861_1_861_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_861_1_861_8&#39;)"><span class="hl_varref"><span class="mpre">flatten</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_868_18_868_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_868_18_868_19&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">)
</span><a href="#loc_861_1_861_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_861_1_861_8&#39;)"><span class="hl_fundecl"><span class="mpre">flatten</span></span></a><span class="mpre"> (</span><a href="#loc_743_19_743_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_743_19_743_24&#39;)"><span class="hl_conref"><span class="mpre">Color</span></span></a><span class="mpre"> </span><a name="loc_869_16_869_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_869_16_869_17&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> </span><a name="loc_869_18_869_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_869_18_869_19&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> </span><a name="loc_869_20_869_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_869_20_869_21&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> </span><a name="loc_869_22_869_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_869_22_869_23&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">)  = </span><a href="#loc_743_19_743_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_743_19_743_24&#39;)"><span class="hl_conref"><span class="mpre">Color</span></span></a><span class="mpre"> </span><a href="#loc_869_16_869_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_869_16_869_17&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><a href="#loc_869_18_869_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_869_18_869_19&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><a href="#loc_869_20_869_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_869_20_869_21&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> (</span><a href="#loc_861_1_861_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_861_1_861_8&#39;)"><span class="hl_varref"><span class="mpre">flatten</span></span></a><span class="mpre"> </span><a href="#loc_869_22_869_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_869_22_869_23&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)
</span><a href="#loc_861_1_861_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_861_1_861_8&#39;)"><span class="hl_fundecl"><span class="mpre">flatten</span></span></a><span class="mpre"> (</span><a href="#loc_745_19_745_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_745_19_745_28&#39;)"><span class="hl_conref"><span class="mpre">Intensify</span></span></a><span class="mpre"> </span><a name="loc_870_20_870_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_870_20_870_21&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> </span><a name="loc_870_22_870_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_870_22_870_23&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">)  = </span><a href="#loc_745_19_745_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_745_19_745_28&#39;)"><span class="hl_conref"><span class="mpre">Intensify</span></span></a><span class="mpre"> </span><a href="#loc_870_20_870_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_870_20_870_21&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> (</span><a href="#loc_861_1_861_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_861_1_861_8&#39;)"><span class="hl_varref"><span class="mpre">flatten</span></span></a><span class="mpre"> </span><a href="#loc_870_22_870_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_870_22_870_23&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)
</span><a href="#loc_861_1_861_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_861_1_861_8&#39;)"><span class="hl_fundecl"><span class="mpre">flatten</span></span></a><span class="mpre"> (</span><a href="#loc_746_19_746_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_746_19_746_28&#39;)"><span class="hl_conref"><span class="mpre">Italicize</span></span></a><span class="mpre"> </span><a name="loc_871_20_871_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_871_20_871_21&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> </span><a name="loc_871_22_871_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_871_22_871_23&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">)  = </span><a href="#loc_746_19_746_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_746_19_746_28&#39;)"><span class="hl_conref"><span class="mpre">Italicize</span></span></a><span class="mpre"> </span><a href="#loc_871_20_871_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_871_20_871_21&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> (</span><a href="#loc_861_1_861_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_861_1_861_8&#39;)"><span class="hl_varref"><span class="mpre">flatten</span></span></a><span class="mpre"> </span><a href="#loc_871_22_871_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_871_22_871_23&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)
</span><a href="#loc_861_1_861_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_861_1_861_8&#39;)"><span class="hl_fundecl"><span class="mpre">flatten</span></span></a><span class="mpre"> (</span><a href="#loc_747_19_747_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_747_19_747_28&#39;)"><span class="hl_conref"><span class="mpre">Underline</span></span></a><span class="mpre"> </span><a name="loc_872_20_872_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_872_20_872_21&#39;)"><span class="hl_vardecl"><span class="mpre">u</span></span></a><span class="mpre"> </span><a name="loc_872_22_872_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_872_22_872_23&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">)  = </span><a href="#loc_747_19_747_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_747_19_747_28&#39;)"><span class="hl_conref"><span class="mpre">Underline</span></span></a><span class="mpre"> </span><a href="#loc_872_20_872_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_872_20_872_21&#39;)"><span class="hl_varref"><span class="mpre">u</span></span></a><span class="mpre"> (</span><a href="#loc_861_1_861_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_861_1_861_8&#39;)"><span class="hl_varref"><span class="mpre">flatten</span></span></a><span class="mpre"> </span><a href="#loc_872_22_872_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_872_22_872_23&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)
</span><a href="#loc_861_1_861_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_861_1_861_8&#39;)"><span class="hl_fundecl"><span class="mpre">flatten</span></span></a><span class="mpre"> </span><a name="loc_873_9_873_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_873_9_873_14&#39;)"><span class="hl_vardecl"><span class="mpre">other</span></span></a><span class="mpre">            = </span><a href="#loc_873_9_873_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_873_9_873_14&#39;)"><span class="hl_varref"><span class="mpre">other</span></span></a><span class="mpre">                     </span><span class="hl_comment"><span class="mpre">--Empty,Char,Text,RestoreFormat</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Colors</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Displays a document with the black forecolor</span></span><span class="mpre">
</span><a href="#loc_912_2_912_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_912_2_912_7&#39;)"><span class="mpre">black</span></a><span class="mpre"> :: </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Displays a document with the red forecolor</span></span><span class="mpre">
</span><a href="#loc_913_2_913_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_913_2_913_5&#39;)"><span class="mpre">red</span></a><span class="mpre"> :: </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Displays a document with the green forecolor</span></span><span class="mpre">
</span><a href="#loc_914_2_914_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_914_2_914_7&#39;)"><span class="mpre">green</span></a><span class="mpre"> :: </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Displays a document with the yellow forecolor</span></span><span class="mpre">
</span><a href="#loc_915_2_915_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_915_2_915_8&#39;)"><span class="mpre">yellow</span></a><span class="mpre"> :: </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Displays a document with the blue forecolor</span></span><span class="mpre">
</span><a href="#loc_916_2_916_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_916_2_916_6&#39;)"><span class="mpre">blue</span></a><span class="mpre"> :: </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Displays a document with the magenta forecolor</span></span><span class="mpre">
</span><a href="#loc_917_2_917_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_917_2_917_9&#39;)"><span class="mpre">magenta</span></a><span class="mpre"> :: </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Displays a document with the cyan forecolor</span></span><span class="mpre">
</span><a href="#loc_918_2_918_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_918_2_918_6&#39;)"><span class="mpre">cyan</span></a><span class="mpre"> :: </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Displays a document with the white forecolor</span></span><span class="mpre">
</span><a href="#loc_919_2_919_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_919_2_919_7&#39;)"><span class="mpre">white</span></a><span class="mpre"> :: </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Displays a document with the dull black forecolor</span></span><span class="mpre">
</span><a href="#loc_912_9_912_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_912_9_912_18&#39;)"><span class="mpre">dullblack</span></a><span class="mpre"> :: </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Displays a document with the dull red forecolor</span></span><span class="mpre">
</span><a href="#loc_913_7_913_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_913_7_913_14&#39;)"><span class="mpre">dullred</span></a><span class="mpre"> :: </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Displays a document with the dull green forecolor</span></span><span class="mpre">
</span><a href="#loc_914_9_914_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_914_9_914_18&#39;)"><span class="mpre">dullgreen</span></a><span class="mpre"> :: </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Displays a document with the dull yellow forecolor</span></span><span class="mpre">
</span><a href="#loc_915_10_915_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_915_10_915_20&#39;)"><span class="mpre">dullyellow</span></a><span class="mpre"> :: </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Displays a document with the dull blue forecolor</span></span><span class="mpre">
</span><a href="#loc_916_8_916_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_916_8_916_16&#39;)"><span class="mpre">dullblue</span></a><span class="mpre"> :: </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Displays a document with the dull magenta forecolor</span></span><span class="mpre">
</span><a href="#loc_917_11_917_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_917_11_917_22&#39;)"><span class="mpre">dullmagenta</span></a><span class="mpre"> :: </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Displays a document with the dull cyan forecolor</span></span><span class="mpre">
</span><a href="#loc_918_8_918_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_918_8_918_16&#39;)"><span class="mpre">dullcyan</span></a><span class="mpre"> :: </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Displays a document with the dull white forecolor</span></span><span class="mpre">
</span><a href="#loc_919_9_919_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_919_9_919_18&#39;)"><span class="mpre">dullwhite</span></a><span class="mpre"> :: </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
(</span><a name="loc_912_2_912_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_912_2_912_7&#39;)"><span class="hl_vardecl"><span class="mpre">black</span></span></a><span class="mpre">, </span><a name="loc_912_9_912_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_912_9_912_18&#39;)"><span class="hl_vardecl"><span class="mpre">dullblack</span></span></a><span class="mpre">)     = </span><a href="#loc_929_1_929_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_929_1_929_15&#39;)"><span class="hl_varref"><span class="mpre">colorFunctions</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Black</span></span><span class="mpre">
(</span><a name="loc_913_2_913_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_913_2_913_5&#39;)"><span class="hl_vardecl"><span class="mpre">red</span></span></a><span class="mpre">, </span><a name="loc_913_7_913_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_913_7_913_14&#39;)"><span class="hl_vardecl"><span class="mpre">dullred</span></span></a><span class="mpre">)         = </span><a href="#loc_929_1_929_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_929_1_929_15&#39;)"><span class="hl_varref"><span class="mpre">colorFunctions</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Red</span></span><span class="mpre">
(</span><a name="loc_914_2_914_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_914_2_914_7&#39;)"><span class="hl_vardecl"><span class="mpre">green</span></span></a><span class="mpre">, </span><a name="loc_914_9_914_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_914_9_914_18&#39;)"><span class="hl_vardecl"><span class="mpre">dullgreen</span></span></a><span class="mpre">)     = </span><a href="#loc_929_1_929_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_929_1_929_15&#39;)"><span class="hl_varref"><span class="mpre">colorFunctions</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Green</span></span><span class="mpre">
(</span><a name="loc_915_2_915_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_915_2_915_8&#39;)"><span class="hl_vardecl"><span class="mpre">yellow</span></span></a><span class="mpre">, </span><a name="loc_915_10_915_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_915_10_915_20&#39;)"><span class="hl_vardecl"><span class="mpre">dullyellow</span></span></a><span class="mpre">)   = </span><a href="#loc_929_1_929_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_929_1_929_15&#39;)"><span class="hl_varref"><span class="mpre">colorFunctions</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Yellow</span></span><span class="mpre">
(</span><a name="loc_916_2_916_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_916_2_916_6&#39;)"><span class="hl_vardecl"><span class="mpre">blue</span></span></a><span class="mpre">, </span><a name="loc_916_8_916_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_916_8_916_16&#39;)"><span class="hl_vardecl"><span class="mpre">dullblue</span></span></a><span class="mpre">)       = </span><a href="#loc_929_1_929_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_929_1_929_15&#39;)"><span class="hl_varref"><span class="mpre">colorFunctions</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Blue</span></span><span class="mpre">
(</span><a name="loc_917_2_917_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_917_2_917_9&#39;)"><span class="hl_vardecl"><span class="mpre">magenta</span></span></a><span class="mpre">, </span><a name="loc_917_11_917_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_917_11_917_22&#39;)"><span class="hl_vardecl"><span class="mpre">dullmagenta</span></span></a><span class="mpre">) = </span><a href="#loc_929_1_929_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_929_1_929_15&#39;)"><span class="hl_varref"><span class="mpre">colorFunctions</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Magenta</span></span><span class="mpre">
(</span><a name="loc_918_2_918_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_918_2_918_6&#39;)"><span class="hl_vardecl"><span class="mpre">cyan</span></span></a><span class="mpre">, </span><a name="loc_918_8_918_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_918_8_918_16&#39;)"><span class="hl_vardecl"><span class="mpre">dullcyan</span></span></a><span class="mpre">)       = </span><a href="#loc_929_1_929_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_929_1_929_15&#39;)"><span class="hl_varref"><span class="mpre">colorFunctions</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Cyan</span></span><span class="mpre">
(</span><a name="loc_919_2_919_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_919_2_919_7&#39;)"><span class="hl_vardecl"><span class="mpre">white</span></span></a><span class="mpre">, </span><a name="loc_919_9_919_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_919_9_919_18&#39;)"><span class="hl_vardecl"><span class="mpre">dullwhite</span></span></a><span class="mpre">)     = </span><a href="#loc_929_1_929_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_929_1_929_15&#39;)"><span class="hl_varref"><span class="mpre">colorFunctions</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">White</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Displays a document with a forecolor given in the first parameter</span></span><span class="mpre">
</span><a href="#loc_925_1_925_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_925_1_925_6&#39;)"><span class="mpre">color</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Color</span></span><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Displays a document with a dull forecolor given in the first parameter</span></span><span class="mpre">
</span><a href="#loc_926_1_926_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_926_1_926_10&#39;)"><span class="mpre">dullcolor</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Color</span></span><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><a name="loc_925_1_925_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_925_1_925_6&#39;)"><span class="hl_vardecl"><span class="mpre">color</span></span></a><span class="mpre">     = </span><a href="#loc_743_19_743_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_743_19_743_24&#39;)"><span class="hl_conref"><span class="mpre">Color</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Foreground</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Vivid</span></span><span class="mpre">
</span><a name="loc_926_1_926_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_926_1_926_10&#39;)"><span class="hl_vardecl"><span class="mpre">dullcolor</span></span></a><span class="mpre"> = </span><a href="#loc_743_19_743_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_743_19_743_24&#39;)"><span class="hl_conref"><span class="mpre">Color</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Foreground</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Dull</span></span><span class="mpre">

</span><a href="#loc_929_1_929_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_929_1_929_15&#39;)"><span class="mpre">colorFunctions</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Color</span></span><span class="mpre"> -&gt; (</span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">, </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">)
</span><a name="loc_929_1_929_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_929_1_929_15&#39;)"><span class="hl_fundecl"><span class="mpre">colorFunctions</span></span></a><span class="mpre"> </span><a name="loc_929_16_929_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_929_16_929_20&#39;)"><span class="hl_vardecl"><span class="mpre">what</span></span></a><span class="mpre"> = (</span><a href="#loc_925_1_925_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_925_1_925_6&#39;)"><span class="hl_varref"><span class="mpre">color</span></span></a><span class="mpre"> </span><a href="#loc_929_16_929_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_929_16_929_20&#39;)"><span class="hl_varref"><span class="mpre">what</span></span></a><span class="mpre">, </span><a href="#loc_926_1_926_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_926_1_926_10&#39;)"><span class="hl_varref"><span class="mpre">dullcolor</span></span></a><span class="mpre"> </span><a href="#loc_929_16_929_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_929_16_929_20&#39;)"><span class="hl_varref"><span class="mpre">what</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Displays a document with the black backcolor</span></span><span class="mpre">
</span><a href="#loc_963_2_963_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_963_2_963_9&#39;)"><span class="mpre">onblack</span></a><span class="mpre"> :: </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Displays a document with the red backcolor</span></span><span class="mpre">
</span><a href="#loc_964_2_964_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_964_2_964_7&#39;)"><span class="mpre">onred</span></a><span class="mpre"> :: </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Displays a document with the green backcolor</span></span><span class="mpre">
</span><a href="#loc_965_2_965_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_965_2_965_9&#39;)"><span class="mpre">ongreen</span></a><span class="mpre"> :: </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Displays a document with the yellow backcolor</span></span><span class="mpre">
</span><a href="#loc_966_2_966_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_966_2_966_10&#39;)"><span class="mpre">onyellow</span></a><span class="mpre"> :: </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Displays a document with the blue backcolor</span></span><span class="mpre">
</span><a href="#loc_967_2_967_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_967_2_967_8&#39;)"><span class="mpre">onblue</span></a><span class="mpre"> :: </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Displays a document with the magenta backcolor</span></span><span class="mpre">
</span><a href="#loc_968_2_968_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_968_2_968_11&#39;)"><span class="mpre">onmagenta</span></a><span class="mpre"> :: </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Displays a document with the cyan backcolor</span></span><span class="mpre">
</span><a href="#loc_969_2_969_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_969_2_969_8&#39;)"><span class="mpre">oncyan</span></a><span class="mpre"> :: </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Displays a document with the white backcolor</span></span><span class="mpre">
</span><a href="#loc_970_2_970_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_970_2_970_9&#39;)"><span class="mpre">onwhite</span></a><span class="mpre"> :: </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Displays a document with the dull block backcolor</span></span><span class="mpre">
</span><a href="#loc_963_11_963_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_963_11_963_22&#39;)"><span class="mpre">ondullblack</span></a><span class="mpre"> :: </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Displays a document with the dull red backcolor</span></span><span class="mpre">
</span><a href="#loc_964_9_964_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_964_9_964_18&#39;)"><span class="mpre">ondullred</span></a><span class="mpre"> :: </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Displays a document with the dull green backcolor</span></span><span class="mpre">
</span><a href="#loc_965_11_965_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_965_11_965_22&#39;)"><span class="mpre">ondullgreen</span></a><span class="mpre"> :: </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Displays a document with the dull yellow backcolor</span></span><span class="mpre">
</span><a href="#loc_966_12_966_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_966_12_966_24&#39;)"><span class="mpre">ondullyellow</span></a><span class="mpre"> :: </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Displays a document with the dull blue backcolor</span></span><span class="mpre">
</span><a href="#loc_967_10_967_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_967_10_967_20&#39;)"><span class="mpre">ondullblue</span></a><span class="mpre"> :: </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Displays a document with the dull magenta backcolor</span></span><span class="mpre">
</span><a href="#loc_968_13_968_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_968_13_968_26&#39;)"><span class="mpre">ondullmagenta</span></a><span class="mpre"> :: </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Displays a document with the dull cyan backcolor</span></span><span class="mpre">
</span><a href="#loc_969_10_969_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_969_10_969_20&#39;)"><span class="mpre">ondullcyan</span></a><span class="mpre"> :: </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Displays a document with the dull white backcolor</span></span><span class="mpre">
</span><a href="#loc_970_11_970_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_970_11_970_22&#39;)"><span class="mpre">ondullwhite</span></a><span class="mpre"> :: </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
(</span><a name="loc_963_2_963_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_963_2_963_9&#39;)"><span class="hl_vardecl"><span class="mpre">onblack</span></span></a><span class="mpre">, </span><a name="loc_963_11_963_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_963_11_963_22&#39;)"><span class="hl_vardecl"><span class="mpre">ondullblack</span></span></a><span class="mpre">)     = </span><a href="#loc_980_1_980_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_980_1_980_17&#39;)"><span class="hl_varref"><span class="mpre">oncolorFunctions</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Black</span></span><span class="mpre">
(</span><a name="loc_964_2_964_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_964_2_964_7&#39;)"><span class="hl_vardecl"><span class="mpre">onred</span></span></a><span class="mpre">, </span><a name="loc_964_9_964_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_964_9_964_18&#39;)"><span class="hl_vardecl"><span class="mpre">ondullred</span></span></a><span class="mpre">)         = </span><a href="#loc_980_1_980_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_980_1_980_17&#39;)"><span class="hl_varref"><span class="mpre">oncolorFunctions</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Red</span></span><span class="mpre">
(</span><a name="loc_965_2_965_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_965_2_965_9&#39;)"><span class="hl_vardecl"><span class="mpre">ongreen</span></span></a><span class="mpre">, </span><a name="loc_965_11_965_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_965_11_965_22&#39;)"><span class="hl_vardecl"><span class="mpre">ondullgreen</span></span></a><span class="mpre">)     = </span><a href="#loc_980_1_980_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_980_1_980_17&#39;)"><span class="hl_varref"><span class="mpre">oncolorFunctions</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Green</span></span><span class="mpre">
(</span><a name="loc_966_2_966_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_966_2_966_10&#39;)"><span class="hl_vardecl"><span class="mpre">onyellow</span></span></a><span class="mpre">, </span><a name="loc_966_12_966_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_966_12_966_24&#39;)"><span class="hl_vardecl"><span class="mpre">ondullyellow</span></span></a><span class="mpre">)   = </span><a href="#loc_980_1_980_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_980_1_980_17&#39;)"><span class="hl_varref"><span class="mpre">oncolorFunctions</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Yellow</span></span><span class="mpre">
(</span><a name="loc_967_2_967_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_967_2_967_8&#39;)"><span class="hl_vardecl"><span class="mpre">onblue</span></span></a><span class="mpre">, </span><a name="loc_967_10_967_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_967_10_967_20&#39;)"><span class="hl_vardecl"><span class="mpre">ondullblue</span></span></a><span class="mpre">)       = </span><a href="#loc_980_1_980_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_980_1_980_17&#39;)"><span class="hl_varref"><span class="mpre">oncolorFunctions</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Blue</span></span><span class="mpre">
(</span><a name="loc_968_2_968_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_968_2_968_11&#39;)"><span class="hl_vardecl"><span class="mpre">onmagenta</span></span></a><span class="mpre">, </span><a name="loc_968_13_968_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_968_13_968_26&#39;)"><span class="hl_vardecl"><span class="mpre">ondullmagenta</span></span></a><span class="mpre">) = </span><a href="#loc_980_1_980_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_980_1_980_17&#39;)"><span class="hl_varref"><span class="mpre">oncolorFunctions</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Magenta</span></span><span class="mpre">
(</span><a name="loc_969_2_969_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_969_2_969_8&#39;)"><span class="hl_vardecl"><span class="mpre">oncyan</span></span></a><span class="mpre">, </span><a name="loc_969_10_969_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_969_10_969_20&#39;)"><span class="hl_vardecl"><span class="mpre">ondullcyan</span></span></a><span class="mpre">)       = </span><a href="#loc_980_1_980_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_980_1_980_17&#39;)"><span class="hl_varref"><span class="mpre">oncolorFunctions</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Cyan</span></span><span class="mpre">
(</span><a name="loc_970_2_970_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_970_2_970_9&#39;)"><span class="hl_vardecl"><span class="mpre">onwhite</span></span></a><span class="mpre">, </span><a name="loc_970_11_970_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_970_11_970_22&#39;)"><span class="hl_vardecl"><span class="mpre">ondullwhite</span></span></a><span class="mpre">)     = </span><a href="#loc_980_1_980_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_980_1_980_17&#39;)"><span class="hl_varref"><span class="mpre">oncolorFunctions</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">White</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Displays a document with a backcolor given in the first parameter</span></span><span class="mpre">
</span><a href="#loc_976_1_976_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_976_1_976_8&#39;)"><span class="mpre">oncolor</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Color</span></span><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Displays a document with a dull backcolor given in the first parameter</span></span><span class="mpre">
</span><a href="#loc_977_1_977_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_977_1_977_12&#39;)"><span class="mpre">ondullcolor</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Color</span></span><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><a name="loc_976_1_976_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_976_1_976_8&#39;)"><span class="hl_vardecl"><span class="mpre">oncolor</span></span></a><span class="mpre">     = </span><a href="#loc_743_19_743_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_743_19_743_24&#39;)"><span class="hl_conref"><span class="mpre">Color</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Background</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Vivid</span></span><span class="mpre">
</span><a name="loc_977_1_977_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_977_1_977_12&#39;)"><span class="hl_vardecl"><span class="mpre">ondullcolor</span></span></a><span class="mpre"> = </span><a href="#loc_743_19_743_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_743_19_743_24&#39;)"><span class="hl_conref"><span class="mpre">Color</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Background</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Dull</span></span><span class="mpre">

</span><a href="#loc_980_1_980_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_980_1_980_17&#39;)"><span class="mpre">oncolorFunctions</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Color</span></span><span class="mpre"> -&gt; (</span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">, </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">)
</span><a name="loc_980_1_980_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_980_1_980_17&#39;)"><span class="hl_fundecl"><span class="mpre">oncolorFunctions</span></span></a><span class="mpre"> </span><a name="loc_980_18_980_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_980_18_980_22&#39;)"><span class="hl_vardecl"><span class="mpre">what</span></span></a><span class="mpre"> = (</span><a href="#loc_976_1_976_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_976_1_976_8&#39;)"><span class="hl_varref"><span class="mpre">oncolor</span></span></a><span class="mpre"> </span><a href="#loc_980_18_980_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_980_18_980_22&#39;)"><span class="hl_varref"><span class="mpre">what</span></span></a><span class="mpre">, </span><a href="#loc_977_1_977_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_977_1_977_12&#39;)"><span class="hl_varref"><span class="mpre">ondullcolor</span></span></a><span class="mpre"> </span><a href="#loc_980_18_980_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_980_18_980_22&#39;)"><span class="hl_varref"><span class="mpre">what</span></span></a><span class="mpre">)


</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Console Intensity</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Displays a document in a heavier font weight</span></span><span class="mpre">
</span><a href="#loc_989_1_989_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_989_1_989_5&#39;)"><span class="mpre">bold</span></a><span class="mpre"> :: </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><a name="loc_989_1_989_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_989_1_989_5&#39;)"><span class="hl_vardecl"><span class="mpre">bold</span></span></a><span class="mpre"> = </span><a href="#loc_745_19_745_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_745_19_745_28&#39;)"><span class="hl_conref"><span class="mpre">Intensify</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">BoldIntensity</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Displays a document in the normal font weight</span></span><span class="mpre">
</span><a href="#loc_993_1_993_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_993_1_993_7&#39;)"><span class="mpre">debold</span></a><span class="mpre"> :: </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><a name="loc_993_1_993_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_993_1_993_7&#39;)"><span class="hl_vardecl"><span class="mpre">debold</span></span></a><span class="mpre"> = </span><a href="#loc_745_19_745_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_745_19_745_28&#39;)"><span class="hl_conref"><span class="mpre">Intensify</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">NormalIntensity</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- NB: I don&#39;t support FaintIntensity here because it is not widely supported by terminals.</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Italicization</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">{-

I&#39;m in two minds about providing these functions, since italicization is so rarely implemented.
It is especially bad because &quot;italicization&quot; may cause the meaning of colors to flip, which will
look a bit weird, to say the least...


-- | Displays a document in italics. This is not widely supported, and it&#39;s use is not recommended
italicize :: Doc -&gt; Doc
italicize = Italicize True

-- | Displays a document with no italics
deitalicize :: Doc -&gt; Doc
deitalicize = Italicize False

-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Underlining</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Displays a document with underlining</span></span><span class="mpre">
</span><a href="#loc_1025_1_1025_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1025_1_1025_10&#39;)"><span class="mpre">underline</span></a><span class="mpre"> :: </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><a name="loc_1025_1_1025_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1025_1_1025_10&#39;)"><span class="hl_vardecl"><span class="mpre">underline</span></span></a><span class="mpre"> = </span><a href="#loc_747_19_747_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_747_19_747_28&#39;)"><span class="hl_conref"><span class="mpre">Underline</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">SingleUnderline</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Displays a document with no underlining</span></span><span class="mpre">
</span><a href="#loc_1029_1_1029_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1029_1_1029_12&#39;)"><span class="mpre">deunderline</span></a><span class="mpre"> :: </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><a name="loc_1029_1_1029_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1029_1_1029_12&#39;)"><span class="hl_vardecl"><span class="mpre">deunderline</span></span></a><span class="mpre"> = </span><a href="#loc_747_19_747_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_747_19_747_28&#39;)"><span class="hl_conref"><span class="mpre">Underline</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">NoUnderline</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- NB: I don&#39;t support DoubleUnderline here because it is not widely supported by terminals.</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Removing formatting</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Removes all colorisation, emboldening and underlining from a document</span></span><span class="mpre">
</span><a href="#loc_1039_1_1039_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1039_1_1039_6&#39;)"><span class="mpre">plain</span></a><span class="mpre"> :: </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre">
</span><a name="loc_1039_1_1039_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1039_1_1039_6&#39;)"><span class="hl_fundecl"><span class="mpre">plain</span></span></a><span class="mpre"> </span><a href="#loc_730_19_730_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_19_730_23&#39;)"><span class="hl_conref"><span class="mpre">Fail</span></span></a><span class="mpre">            = </span><a href="#loc_730_19_730_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_19_730_23&#39;)"><span class="hl_conref"><span class="mpre">Fail</span></span></a><span class="mpre">
</span><a href="#loc_1039_1_1039_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1039_1_1039_6&#39;)"><span class="hl_fundecl"><span class="mpre">plain</span></span></a><span class="mpre"> </span><a name="loc_1040_7_1040_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1040_7_1040_8&#39;)"><span class="hl_specname"><span class="mpre">e</span></span></a><span class="mpre">@</span><a href="#loc_731_19_731_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_731_19_731_24&#39;)"><span class="hl_conref"><span class="mpre">Empty</span></span></a><span class="mpre">         = </span><a href="#loc_1040_7_1040_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1040_7_1040_8&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">
</span><a href="#loc_1039_1_1039_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1039_1_1039_6&#39;)"><span class="hl_fundecl"><span class="mpre">plain</span></span></a><span class="mpre"> </span><a name="loc_1041_7_1041_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1041_7_1041_8&#39;)"><span class="hl_specname"><span class="mpre">c</span></span></a><span class="mpre">@(</span><a href="#loc_732_19_732_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_732_19_732_23&#39;)"><span class="hl_conref"><span class="mpre">Char</span></span></a><span class="mpre"> _)      = </span><a href="#loc_1041_7_1041_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1041_7_1041_8&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">
</span><a href="#loc_1039_1_1039_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1039_1_1039_6&#39;)"><span class="hl_fundecl"><span class="mpre">plain</span></span></a><span class="mpre"> </span><a name="loc_1042_7_1042_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1042_7_1042_8&#39;)"><span class="hl_specname"><span class="mpre">t</span></span></a><span class="mpre">@(</span><a href="#loc_733_19_733_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_733_19_733_23&#39;)"><span class="hl_conref"><span class="mpre">Text</span></span></a><span class="mpre"> _ _)    = </span><a href="#loc_1042_7_1042_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1042_7_1042_8&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">
</span><a href="#loc_1039_1_1039_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1039_1_1039_6&#39;)"><span class="hl_fundecl"><span class="mpre">plain</span></span></a><span class="mpre"> </span><a name="loc_1043_7_1043_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1043_7_1043_8&#39;)"><span class="hl_specname"><span class="mpre">l</span></span></a><span class="mpre">@</span><a href="#loc_734_19_734_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_734_19_734_23&#39;)"><span class="hl_conref"><span class="mpre">Line</span></span></a><span class="mpre">          = </span><a href="#loc_1043_7_1043_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1043_7_1043_8&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">
</span><a href="#loc_1039_1_1039_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1039_1_1039_6&#39;)"><span class="hl_fundecl"><span class="mpre">plain</span></span></a><span class="mpre"> (</span><a href="#loc_735_19_735_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_735_19_735_26&#39;)"><span class="hl_conref"><span class="mpre">FlatAlt</span></span></a><span class="mpre"> </span><a name="loc_1044_16_1044_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1044_16_1044_17&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_1044_18_1044_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1044_18_1044_19&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">)   = </span><a href="#loc_735_19_735_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_735_19_735_26&#39;)"><span class="hl_conref"><span class="mpre">FlatAlt</span></span></a><span class="mpre"> (</span><a href="#loc_1039_1_1039_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1039_1_1039_6&#39;)"><span class="hl_varref"><span class="mpre">plain</span></span></a><span class="mpre"> </span><a href="#loc_1044_16_1044_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1044_16_1044_17&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">) (</span><a href="#loc_1039_1_1039_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1039_1_1039_6&#39;)"><span class="hl_varref"><span class="mpre">plain</span></span></a><span class="mpre"> </span><a href="#loc_1044_18_1044_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1044_18_1044_19&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">)
</span><a href="#loc_1039_1_1039_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1039_1_1039_6&#39;)"><span class="hl_fundecl"><span class="mpre">plain</span></span></a><span class="mpre"> (</span><a href="#loc_737_19_737_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_737_19_737_22&#39;)"><span class="hl_conref"><span class="mpre">Cat</span></span></a><span class="mpre"> </span><a name="loc_1045_12_1045_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1045_12_1045_13&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_1045_14_1045_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1045_14_1045_15&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">)       = </span><a href="#loc_737_19_737_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_737_19_737_22&#39;)"><span class="hl_conref"><span class="mpre">Cat</span></span></a><span class="mpre"> (</span><a href="#loc_1039_1_1039_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1039_1_1039_6&#39;)"><span class="hl_varref"><span class="mpre">plain</span></span></a><span class="mpre"> </span><a href="#loc_1045_12_1045_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1045_12_1045_13&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">) (</span><a href="#loc_1039_1_1039_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1039_1_1039_6&#39;)"><span class="hl_varref"><span class="mpre">plain</span></span></a><span class="mpre"> </span><a href="#loc_1045_14_1045_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1045_14_1045_15&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">)
</span><a href="#loc_1039_1_1039_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1039_1_1039_6&#39;)"><span class="hl_fundecl"><span class="mpre">plain</span></span></a><span class="mpre"> (</span><a href="#loc_738_19_738_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_738_19_738_23&#39;)"><span class="hl_conref"><span class="mpre">Nest</span></span></a><span class="mpre"> </span><a name="loc_1046_13_1046_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1046_13_1046_14&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> </span><a name="loc_1046_15_1046_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1046_15_1046_16&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">)      = </span><a href="#loc_738_19_738_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_738_19_738_23&#39;)"><span class="hl_conref"><span class="mpre">Nest</span></span></a><span class="mpre"> </span><a href="#loc_1046_13_1046_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1046_13_1046_14&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> (</span><a href="#loc_1039_1_1039_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1039_1_1039_6&#39;)"><span class="hl_varref"><span class="mpre">plain</span></span></a><span class="mpre"> </span><a href="#loc_1046_15_1046_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1046_15_1046_16&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)
</span><a href="#loc_1039_1_1039_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1039_1_1039_6&#39;)"><span class="hl_fundecl"><span class="mpre">plain</span></span></a><span class="mpre"> (</span><a href="#loc_739_19_739_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_739_19_739_24&#39;)"><span class="hl_conref"><span class="mpre">Union</span></span></a><span class="mpre"> </span><a name="loc_1047_14_1047_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1047_14_1047_15&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_1047_16_1047_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1047_16_1047_17&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">)     = </span><a href="#loc_739_19_739_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_739_19_739_24&#39;)"><span class="hl_conref"><span class="mpre">Union</span></span></a><span class="mpre"> (</span><a href="#loc_1039_1_1039_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1039_1_1039_6&#39;)"><span class="hl_varref"><span class="mpre">plain</span></span></a><span class="mpre"> </span><a href="#loc_1047_14_1047_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1047_14_1047_15&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">) (</span><a href="#loc_1039_1_1039_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1039_1_1039_6&#39;)"><span class="hl_varref"><span class="mpre">plain</span></span></a><span class="mpre"> </span><a href="#loc_1047_16_1047_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1047_16_1047_17&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">)
</span><a href="#loc_1039_1_1039_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1039_1_1039_6&#39;)"><span class="hl_fundecl"><span class="mpre">plain</span></span></a><span class="mpre"> (</span><a href="#loc_740_19_740_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_740_19_740_25&#39;)"><span class="hl_conref"><span class="mpre">Column</span></span></a><span class="mpre"> </span><a name="loc_1048_15_1048_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1048_15_1048_16&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">)      = </span><a href="#loc_740_19_740_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_740_19_740_25&#39;)"><span class="hl_conref"><span class="mpre">Column</span></span></a><span class="mpre"> (</span><a href="#loc_1039_1_1039_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1039_1_1039_6&#39;)"><span class="hl_varref"><span class="mpre">plain</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_1048_15_1048_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1048_15_1048_16&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">)
</span><a href="#loc_1039_1_1039_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1039_1_1039_6&#39;)"><span class="hl_fundecl"><span class="mpre">plain</span></span></a><span class="mpre"> (</span><a href="#loc_741_19_741_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_741_19_741_26&#39;)"><span class="hl_conref"><span class="mpre">Columns</span></span></a><span class="mpre"> </span><a name="loc_1049_16_1049_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1049_16_1049_17&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">)     = </span><a href="#loc_741_19_741_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_741_19_741_26&#39;)"><span class="hl_conref"><span class="mpre">Columns</span></span></a><span class="mpre"> (</span><a href="#loc_1039_1_1039_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1039_1_1039_6&#39;)"><span class="hl_varref"><span class="mpre">plain</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_1049_16_1049_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1049_16_1049_17&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">)
</span><a href="#loc_1039_1_1039_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1039_1_1039_6&#39;)"><span class="hl_fundecl"><span class="mpre">plain</span></span></a><span class="mpre"> (</span><a href="#loc_742_19_742_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_742_19_742_26&#39;)"><span class="hl_conref"><span class="mpre">Nesting</span></span></a><span class="mpre"> </span><a name="loc_1050_16_1050_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1050_16_1050_17&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">)     = </span><a href="#loc_742_19_742_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_742_19_742_26&#39;)"><span class="hl_conref"><span class="mpre">Nesting</span></span></a><span class="mpre"> (</span><a href="#loc_1039_1_1039_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1039_1_1039_6&#39;)"><span class="hl_varref"><span class="mpre">plain</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_1050_16_1050_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1050_16_1050_17&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">)
</span><a href="#loc_1039_1_1039_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1039_1_1039_6&#39;)"><span class="hl_fundecl"><span class="mpre">plain</span></span></a><span class="mpre"> (</span><a href="#loc_743_19_743_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_743_19_743_24&#39;)"><span class="hl_conref"><span class="mpre">Color</span></span></a><span class="mpre"> _ _ _ </span><a name="loc_1051_20_1051_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1051_20_1051_21&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">) = </span><a href="#loc_1039_1_1039_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1039_1_1039_6&#39;)"><span class="hl_varref"><span class="mpre">plain</span></span></a><span class="mpre"> </span><a href="#loc_1051_20_1051_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1051_20_1051_21&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
</span><a href="#loc_1039_1_1039_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1039_1_1039_6&#39;)"><span class="hl_fundecl"><span class="mpre">plain</span></span></a><span class="mpre"> (</span><a href="#loc_745_19_745_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_745_19_745_28&#39;)"><span class="hl_conref"><span class="mpre">Intensify</span></span></a><span class="mpre"> _ </span><a name="loc_1052_20_1052_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1052_20_1052_21&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">) = </span><a href="#loc_1039_1_1039_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1039_1_1039_6&#39;)"><span class="hl_varref"><span class="mpre">plain</span></span></a><span class="mpre"> </span><a href="#loc_1052_20_1052_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1052_20_1052_21&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
</span><a href="#loc_1039_1_1039_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1039_1_1039_6&#39;)"><span class="hl_fundecl"><span class="mpre">plain</span></span></a><span class="mpre"> (</span><a href="#loc_746_19_746_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_746_19_746_28&#39;)"><span class="hl_conref"><span class="mpre">Italicize</span></span></a><span class="mpre"> _ </span><a name="loc_1053_20_1053_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1053_20_1053_21&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">) = </span><a href="#loc_1039_1_1039_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1039_1_1039_6&#39;)"><span class="hl_varref"><span class="mpre">plain</span></span></a><span class="mpre"> </span><a href="#loc_1053_20_1053_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1053_20_1053_21&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
</span><a href="#loc_1039_1_1039_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1039_1_1039_6&#39;)"><span class="hl_fundecl"><span class="mpre">plain</span></span></a><span class="mpre"> (</span><a href="#loc_747_19_747_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_747_19_747_28&#39;)"><span class="hl_conref"><span class="mpre">Underline</span></span></a><span class="mpre"> _ </span><a name="loc_1054_20_1054_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1054_20_1054_21&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">) = </span><a href="#loc_1039_1_1039_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1039_1_1039_6&#39;)"><span class="hl_varref"><span class="mpre">plain</span></span></a><span class="mpre"> </span><a href="#loc_1054_20_1054_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1054_20_1054_21&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
</span><a href="#loc_1039_1_1039_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1039_1_1039_6&#39;)"><span class="hl_fundecl"><span class="mpre">plain</span></span></a><span class="mpre"> (</span><a href="#loc_748_19_748_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_748_19_748_32&#39;)"><span class="hl_conref"><span class="mpre">RestoreFormat</span></span></a><span class="mpre"> _ _ _ _ _) = </span><a href="#loc_731_19_731_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_731_19_731_24&#39;)"><span class="hl_conref"><span class="mpre">Empty</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Renderers</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- renderPretty: the default pretty printing algorithm</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- list of indentation/document pairs; saves an indirection over [(Int,Doc)]</span></span><span class="mpre">
data </span><a name="loc_1066_6_1066_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1066_6_1066_10&#39;)"><span class="hl_tycondecl"><span class="mpre">Docs</span></span></a><span class="mpre">   = </span><a name="loc_1066_15_1066_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1066_15_1066_18&#39;)"><span class="hl_condecl"><span class="mpre">Nil</span></span></a><span class="mpre">
            | </span><a name="loc_1067_15_1067_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1067_15_1067_19&#39;)"><span class="hl_condecl"><span class="mpre">Cons</span></span></a><span class="mpre"> !</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> </span><a href="#loc_1066_6_1066_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1066_6_1066_10&#39;)"><span class="hl_tyconref"><span class="mpre">Docs</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | This is the default pretty printer which is used by &#39;show&#39;,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;putDoc&#39; and &#39;hPutDoc&#39;. @(renderPretty ribbonfrac width x)@ renders</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- document @x@ with a page width of @width@ and a ribbon width of</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @(ribbonfrac * width)@ characters. The ribbon width is the maximal</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- amount of non-indentation characters on a line. The parameter</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @ribbonfrac@ should be between @0.0@ and @1.0@. If it is lower or</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- higher, the ribbon width will be 0 or @width@ respectively.</span></span><span class="mpre">
</span><a href="#loc_1078_1_1078_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1078_1_1078_13&#39;)"><span class="mpre">renderPretty</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Float</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_763_6_763_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_763_6_763_15&#39;)"><span class="hl_tyconref"><span class="mpre">SimpleDoc</span></span></a><span class="mpre">
</span><a name="loc_1078_1_1078_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1078_1_1078_13&#39;)"><span class="hl_vardecl"><span class="mpre">renderPretty</span></span></a><span class="mpre"> = </span><a href="#loc_1118_1_1118_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1118_1_1118_11&#39;)"><span class="hl_varref"><span class="mpre">renderFits</span></span></a><span class="mpre"> </span><a href="#loc_1185_1_1185_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1185_1_1185_6&#39;)"><span class="hl_varref"><span class="mpre">fits1</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | A slightly smarter rendering algorithm with more lookahead. It provides</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- provide earlier breaking on deeply nested structures</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- For example, consider this python-ish pseudocode:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @fun(fun(fun(fun(fun([abcdefg, abcdefg])))))@</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- If we put a softbreak (+ nesting 2) after each open parenthesis, and align</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the elements of the list to match the opening brackets, this will render with</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @renderPretty@ and a page width of 20 as:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- fun(fun(fun(fun(fun([</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--                     | abcdef,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--                     | abcdef,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--                     ]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   )))))             |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Where the 20c. boundary has been marked with |.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Because @renderPretty@ only uses one-line lookahead, it sees that the first</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- line fits, and is stuck putting the second and third lines after the 20-c</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- mark. In contrast, @renderSmart@ will continue to check that the potential</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- document up to the end of the indentation level. Thus, it will format the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- document as:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- fun(                |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   fun(              |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--     fun(            |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--       fun(          |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--         fun([       |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--               abcdef,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--               abcdef,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--             ]       |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   )))))             |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Which fits within the 20c. boundary.</span></span><span class="mpre">
</span><a href="#loc_1114_1_1114_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1114_1_1114_12&#39;)"><span class="mpre">renderSmart</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Float</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_763_6_763_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_763_6_763_15&#39;)"><span class="hl_tyconref"><span class="mpre">SimpleDoc</span></span></a><span class="mpre">
</span><a name="loc_1114_1_1114_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1114_1_1114_12&#39;)"><span class="hl_vardecl"><span class="mpre">renderSmart</span></span></a><span class="mpre"> = </span><a href="#loc_1118_1_1118_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1118_1_1118_11&#39;)"><span class="hl_varref"><span class="mpre">renderFits</span></span></a><span class="mpre"> </span><a href="#loc_1204_1_1204_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1204_1_1204_6&#39;)"><span class="hl_varref"><span class="mpre">fitsR</span></span></a><span class="mpre">

</span><a href="#loc_1118_1_1118_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1118_1_1118_11&#39;)"><span class="mpre">renderFits</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><a href="#loc_763_6_763_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_763_6_763_15&#39;)"><span class="hl_tyconref"><span class="mpre">SimpleDoc</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">)
           -&gt; </span><span class="hl_tyconref"><span class="mpre">Float</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_763_6_763_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_763_6_763_15&#39;)"><span class="hl_tyconref"><span class="mpre">SimpleDoc</span></span></a><span class="mpre">
</span><a name="loc_1118_1_1118_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1118_1_1118_11&#39;)"><span class="hl_fundecl"><span class="mpre">renderFits</span></span></a><span class="mpre"> </span><a name="loc_1118_12_1118_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1118_12_1118_16&#39;)"><span class="hl_vardecl"><span class="mpre">fits</span></span></a><span class="mpre"> </span><a name="loc_1118_17_1118_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1118_17_1118_22&#39;)"><span class="hl_vardecl"><span class="mpre">rfrac</span></span></a><span class="mpre"> </span><a name="loc_1118_23_1118_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1118_23_1118_24&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> </span><a name="loc_1118_25_1118_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1118_25_1118_26&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- I used to do a @SSGR [Reset]@ here, but if you do that it will result</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- in any rendered @Doc@ containing at least some ANSI control codes. This</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- may be undesirable if you want to render to non-ANSI devices by simply</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- not making use of the ANSI color combinators I provide.</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- What I &quot;really&quot; want to do here is do an initial Reset iff there is some</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- ANSI color within the Doc, but that&#39;s a bit fiddly. I&#39;ll fix it if someone</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- complains!</span></span><span class="mpre">
    = </span><a href="#loc_1135_7_1135_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1135_7_1135_11&#39;)"><span class="hl_varref"><span class="mpre">best</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> (</span><a href="#loc_1067_15_1067_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1067_15_1067_19&#39;)"><span class="hl_conref"><span class="mpre">Cons</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a href="#loc_1118_25_1118_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1118_25_1118_26&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_1066_15_1066_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1066_15_1066_18&#39;)"><span class="hl_conref"><span class="mpre">Nil</span></span></a><span class="mpre">)
    where
      </span><span class="hl_comment"><span class="mpre">-- r :: the ribbon width in characters</span></span><span class="mpre">
      </span><a name="loc_1130_7_1130_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1130_7_1130_8&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">  = </span><span class="hl_varref"><span class="mpre">max</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">min</span></span><span class="mpre"> </span><a href="#loc_1118_23_1118_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1118_23_1118_24&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">round</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_1118_23_1118_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1118_23_1118_24&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><a href="#loc_1118_17_1118_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1118_17_1118_22&#39;)"><span class="hl_varref"><span class="mpre">rfrac</span></span></a><span class="mpre">)))

      </span><span class="hl_comment"><span class="mpre">-- best :: n = indentation of current line</span></span><span class="mpre">
      </span><span class="hl_comment"><span class="mpre">--         k = current column</span></span><span class="mpre">
      </span><span class="hl_comment"><span class="mpre">--        (ie. (k &gt;= n) &amp;&amp; (k - n == count of inserted characters)</span></span><span class="mpre">
      </span><a name="loc_1135_7_1135_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1135_7_1135_11&#39;)"><span class="hl_fundecl"><span class="mpre">best</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">n</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">k</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">mb_fc</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">mb_bc</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">mb_in</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">mb_it</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">mb_un</span></span><span class="mpre"> </span><a href="#loc_1066_15_1066_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1066_15_1066_18&#39;)"><span class="hl_conref"><span class="mpre">Nil</span></span></a><span class="mpre"> = </span><a href="#loc_764_19_764_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_764_19_764_25&#39;)"><span class="hl_conref"><span class="mpre">SEmpty</span></span></a><span class="mpre">
      </span><a href="#loc_1135_7_1135_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1135_7_1135_11&#39;)"><span class="hl_fundecl"><span class="mpre">best</span></span></a><span class="mpre"> </span><a name="loc_1136_12_1136_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_12_1136_13&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_1136_14_1136_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_14_1136_15&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> </span><a name="loc_1136_16_1136_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_16_1136_21&#39;)"><span class="hl_vardecl"><span class="mpre">mb_fc</span></span></a><span class="mpre"> </span><a name="loc_1136_22_1136_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_22_1136_27&#39;)"><span class="hl_vardecl"><span class="mpre">mb_bc</span></span></a><span class="mpre"> </span><a name="loc_1136_28_1136_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_28_1136_33&#39;)"><span class="hl_vardecl"><span class="mpre">mb_in</span></span></a><span class="mpre"> </span><a name="loc_1136_34_1136_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_34_1136_39&#39;)"><span class="hl_vardecl"><span class="mpre">mb_it</span></span></a><span class="mpre"> </span><a name="loc_1136_40_1136_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_40_1136_45&#39;)"><span class="hl_vardecl"><span class="mpre">mb_un</span></span></a><span class="mpre"> (</span><a href="#loc_1067_15_1067_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1067_15_1067_19&#39;)"><span class="hl_conref"><span class="mpre">Cons</span></span></a><span class="mpre"> </span><a name="loc_1136_52_1136_53" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_52_1136_53&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> </span><a name="loc_1136_54_1136_55" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_54_1136_55&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre"> </span><a name="loc_1136_56_1136_58" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_56_1136_58&#39;)"><span class="hl_vardecl"><span class="mpre">ds</span></span></a><span class="mpre">)
        = case </span><a href="#loc_1136_54_1136_55" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_54_1136_55&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> of
            </span><a href="#loc_730_19_730_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_19_730_23&#39;)"><span class="hl_conref"><span class="mpre">Fail</span></span></a><span class="mpre">          -&gt; </span><a href="#loc_763_19_763_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_763_19_763_24&#39;)"><span class="hl_conref"><span class="mpre">SFail</span></span></a><span class="mpre">
            </span><a href="#loc_731_19_731_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_731_19_731_24&#39;)"><span class="hl_conref"><span class="mpre">Empty</span></span></a><span class="mpre">         -&gt; </span><a href="#loc_1171_11_1171_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1171_11_1171_23&#39;)"><span class="hl_varref"><span class="mpre">best_typical</span></span></a><span class="mpre"> </span><a href="#loc_1136_12_1136_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_12_1136_13&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_1136_14_1136_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_14_1136_15&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_1136_56_1136_58" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_56_1136_58&#39;)"><span class="hl_varref"><span class="mpre">ds</span></span></a><span class="mpre">
            </span><a href="#loc_732_19_732_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_732_19_732_23&#39;)"><span class="hl_conref"><span class="mpre">Char</span></span></a><span class="mpre"> </span><a name="loc_1140_18_1140_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1140_18_1140_19&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">        -&gt; let </span><a name="loc_1140_34_1140_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1140_34_1140_36&#39;)"><span class="hl_vardecl"><span class="mpre">k&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_1136_14_1136_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_14_1136_15&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> in </span><span class="hl_varref"><span class="mpre">seq</span></span><span class="mpre"> </span><a href="#loc_1140_34_1140_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1140_34_1140_36&#39;)"><span class="hl_varref"><span class="mpre">k&#39;</span></span></a><span class="mpre"> (</span><a href="#loc_765_19_765_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_765_19_765_24&#39;)"><span class="hl_conref"><span class="mpre">SChar</span></span></a><span class="mpre"> </span><a href="#loc_1140_18_1140_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1140_18_1140_19&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> (</span><a href="#loc_1171_11_1171_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1171_11_1171_23&#39;)"><span class="hl_varref"><span class="mpre">best_typical</span></span></a><span class="mpre"> </span><a href="#loc_1136_12_1136_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_12_1136_13&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_1140_34_1140_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1140_34_1140_36&#39;)"><span class="hl_varref"><span class="mpre">k&#39;</span></span></a><span class="mpre"> </span><a href="#loc_1136_56_1136_58" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_56_1136_58&#39;)"><span class="hl_varref"><span class="mpre">ds</span></span></a><span class="mpre">))
            </span><a href="#loc_733_19_733_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_733_19_733_23&#39;)"><span class="hl_conref"><span class="mpre">Text</span></span></a><span class="mpre"> </span><a name="loc_1141_18_1141_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1141_18_1141_19&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> </span><a name="loc_1141_20_1141_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1141_20_1141_21&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">      -&gt; let </span><a name="loc_1141_34_1141_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1141_34_1141_36&#39;)"><span class="hl_vardecl"><span class="mpre">k&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_1136_14_1136_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_14_1136_15&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><a href="#loc_1141_18_1141_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1141_18_1141_19&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> in </span><span class="hl_varref"><span class="mpre">seq</span></span><span class="mpre"> </span><a href="#loc_1141_34_1141_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1141_34_1141_36&#39;)"><span class="hl_varref"><span class="mpre">k&#39;</span></span></a><span class="mpre"> (</span><a href="#loc_766_19_766_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_766_19_766_24&#39;)"><span class="hl_conref"><span class="mpre">SText</span></span></a><span class="mpre"> </span><a href="#loc_1141_18_1141_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1141_18_1141_19&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><a href="#loc_1141_20_1141_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1141_20_1141_21&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> (</span><a href="#loc_1171_11_1171_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1171_11_1171_23&#39;)"><span class="hl_varref"><span class="mpre">best_typical</span></span></a><span class="mpre"> </span><a href="#loc_1136_12_1136_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_12_1136_13&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_1141_34_1141_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1141_34_1141_36&#39;)"><span class="hl_varref"><span class="mpre">k&#39;</span></span></a><span class="mpre"> </span><a href="#loc_1136_56_1136_58" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_56_1136_58&#39;)"><span class="hl_varref"><span class="mpre">ds</span></span></a><span class="mpre">))
            </span><a href="#loc_734_19_734_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_734_19_734_23&#39;)"><span class="hl_conref"><span class="mpre">Line</span></span></a><span class="mpre">          -&gt; </span><a href="#loc_767_19_767_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_767_19_767_24&#39;)"><span class="hl_conref"><span class="mpre">SLine</span></span></a><span class="mpre"> </span><a href="#loc_1136_52_1136_53" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_52_1136_53&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> (</span><a href="#loc_1171_11_1171_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1171_11_1171_23&#39;)"><span class="hl_varref"><span class="mpre">best_typical</span></span></a><span class="mpre"> </span><a href="#loc_1136_52_1136_53" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_52_1136_53&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><a href="#loc_1136_52_1136_53" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_52_1136_53&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><a href="#loc_1136_56_1136_58" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_56_1136_58&#39;)"><span class="hl_varref"><span class="mpre">ds</span></span></a><span class="mpre">)
            </span><a href="#loc_735_19_735_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_735_19_735_26&#39;)"><span class="hl_conref"><span class="mpre">FlatAlt</span></span></a><span class="mpre"> </span><a name="loc_1143_21_1143_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1143_21_1143_22&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> _   -&gt; </span><a href="#loc_1171_11_1171_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1171_11_1171_23&#39;)"><span class="hl_varref"><span class="mpre">best_typical</span></span></a><span class="mpre"> </span><a href="#loc_1136_12_1136_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_12_1136_13&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_1136_14_1136_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_14_1136_15&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> (</span><a href="#loc_1067_15_1067_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1067_15_1067_19&#39;)"><span class="hl_conref"><span class="mpre">Cons</span></span></a><span class="mpre"> </span><a href="#loc_1136_52_1136_53" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_52_1136_53&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><a href="#loc_1143_21_1143_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1143_21_1143_22&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_1136_56_1136_58" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_56_1136_58&#39;)"><span class="hl_varref"><span class="mpre">ds</span></span></a><span class="mpre">)
            </span><a href="#loc_737_19_737_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_737_19_737_22&#39;)"><span class="hl_conref"><span class="mpre">Cat</span></span></a><span class="mpre"> </span><a name="loc_1144_17_1144_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1144_17_1144_18&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_1144_19_1144_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1144_19_1144_20&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">       -&gt; </span><a href="#loc_1171_11_1171_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1171_11_1171_23&#39;)"><span class="hl_varref"><span class="mpre">best_typical</span></span></a><span class="mpre"> </span><a href="#loc_1136_12_1136_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_12_1136_13&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_1136_14_1136_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_14_1136_15&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> (</span><a href="#loc_1067_15_1067_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1067_15_1067_19&#39;)"><span class="hl_conref"><span class="mpre">Cons</span></span></a><span class="mpre"> </span><a href="#loc_1136_52_1136_53" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_52_1136_53&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><a href="#loc_1144_17_1144_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1144_17_1144_18&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> (</span><a href="#loc_1067_15_1067_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1067_15_1067_19&#39;)"><span class="hl_conref"><span class="mpre">Cons</span></span></a><span class="mpre"> </span><a href="#loc_1136_52_1136_53" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_52_1136_53&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><a href="#loc_1144_19_1144_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1144_19_1144_20&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><a href="#loc_1136_56_1136_58" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_56_1136_58&#39;)"><span class="hl_varref"><span class="mpre">ds</span></span></a><span class="mpre">))
            </span><a href="#loc_738_19_738_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_738_19_738_23&#39;)"><span class="hl_conref"><span class="mpre">Nest</span></span></a><span class="mpre"> </span><a name="loc_1145_18_1145_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1145_18_1145_19&#39;)"><span class="hl_vardecl"><span class="mpre">j</span></span></a><span class="mpre"> </span><a name="loc_1145_20_1145_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1145_20_1145_21&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">      -&gt; let </span><a name="loc_1145_34_1145_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1145_34_1145_36&#39;)"><span class="hl_vardecl"><span class="mpre">i&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_1136_52_1136_53" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_52_1136_53&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><a href="#loc_1145_18_1145_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1145_18_1145_19&#39;)"><span class="hl_varref"><span class="mpre">j</span></span></a><span class="mpre"> in </span><span class="hl_varref"><span class="mpre">seq</span></span><span class="mpre"> </span><a href="#loc_1145_34_1145_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1145_34_1145_36&#39;)"><span class="hl_varref"><span class="mpre">i&#39;</span></span></a><span class="mpre"> (</span><a href="#loc_1171_11_1171_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1171_11_1171_23&#39;)"><span class="hl_varref"><span class="mpre">best_typical</span></span></a><span class="mpre"> </span><a href="#loc_1136_12_1136_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_12_1136_13&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_1136_14_1136_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_14_1136_15&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> (</span><a href="#loc_1067_15_1067_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1067_15_1067_19&#39;)"><span class="hl_conref"><span class="mpre">Cons</span></span></a><span class="mpre"> </span><a href="#loc_1145_34_1145_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1145_34_1145_36&#39;)"><span class="hl_varref"><span class="mpre">i&#39;</span></span></a><span class="mpre"> </span><a href="#loc_1145_20_1145_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1145_20_1145_21&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_1136_56_1136_58" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_56_1136_58&#39;)"><span class="hl_varref"><span class="mpre">ds</span></span></a><span class="mpre">))
            </span><a href="#loc_739_19_739_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_739_19_739_24&#39;)"><span class="hl_conref"><span class="mpre">Union</span></span></a><span class="mpre"> </span><a name="loc_1146_19_1146_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1146_19_1146_20&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_1146_21_1146_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1146_21_1146_22&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">     -&gt; </span><a href="#loc_1178_7_1178_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1178_7_1178_13&#39;)"><span class="hl_varref"><span class="mpre">nicest</span></span></a><span class="mpre"> </span><a href="#loc_1136_12_1136_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_12_1136_13&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_1136_14_1136_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_14_1136_15&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> (</span><a href="#loc_1171_11_1171_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1171_11_1171_23&#39;)"><span class="hl_varref"><span class="mpre">best_typical</span></span></a><span class="mpre"> </span><a href="#loc_1136_12_1136_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_12_1136_13&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_1136_14_1136_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_14_1136_15&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> (</span><a href="#loc_1067_15_1067_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1067_15_1067_19&#39;)"><span class="hl_conref"><span class="mpre">Cons</span></span></a><span class="mpre"> </span><a href="#loc_1136_52_1136_53" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_52_1136_53&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><a href="#loc_1146_19_1146_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1146_19_1146_20&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_1136_56_1136_58" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_56_1136_58&#39;)"><span class="hl_varref"><span class="mpre">ds</span></span></a><span class="mpre">))
                                        (</span><a href="#loc_1171_11_1171_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1171_11_1171_23&#39;)"><span class="hl_varref"><span class="mpre">best_typical</span></span></a><span class="mpre"> </span><a href="#loc_1136_12_1136_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_12_1136_13&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_1136_14_1136_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_14_1136_15&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> (</span><a href="#loc_1067_15_1067_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1067_15_1067_19&#39;)"><span class="hl_conref"><span class="mpre">Cons</span></span></a><span class="mpre"> </span><a href="#loc_1136_52_1136_53" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_52_1136_53&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><a href="#loc_1146_21_1146_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1146_21_1146_22&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><a href="#loc_1136_56_1136_58" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_56_1136_58&#39;)"><span class="hl_varref"><span class="mpre">ds</span></span></a><span class="mpre">))
            </span><a href="#loc_740_19_740_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_740_19_740_25&#39;)"><span class="hl_conref"><span class="mpre">Column</span></span></a><span class="mpre"> </span><a name="loc_1148_20_1148_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1148_20_1148_21&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">      -&gt; </span><a href="#loc_1171_11_1171_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1171_11_1171_23&#39;)"><span class="hl_varref"><span class="mpre">best_typical</span></span></a><span class="mpre"> </span><a href="#loc_1136_12_1136_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_12_1136_13&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_1136_14_1136_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_14_1136_15&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> (</span><a href="#loc_1067_15_1067_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1067_15_1067_19&#39;)"><span class="hl_conref"><span class="mpre">Cons</span></span></a><span class="mpre"> </span><a href="#loc_1136_52_1136_53" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_52_1136_53&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> (</span><a href="#loc_1148_20_1148_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1148_20_1148_21&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_1136_14_1136_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_14_1136_15&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">) </span><a href="#loc_1136_56_1136_58" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_56_1136_58&#39;)"><span class="hl_varref"><span class="mpre">ds</span></span></a><span class="mpre">)
            </span><a href="#loc_741_19_741_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_741_19_741_26&#39;)"><span class="hl_conref"><span class="mpre">Columns</span></span></a><span class="mpre"> </span><a name="loc_1149_21_1149_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1149_21_1149_22&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">     -&gt; </span><a href="#loc_1171_11_1171_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1171_11_1171_23&#39;)"><span class="hl_varref"><span class="mpre">best_typical</span></span></a><span class="mpre"> </span><a href="#loc_1136_12_1136_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_12_1136_13&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_1136_14_1136_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_14_1136_15&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> (</span><a href="#loc_1067_15_1067_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1067_15_1067_19&#39;)"><span class="hl_conref"><span class="mpre">Cons</span></span></a><span class="mpre"> </span><a href="#loc_1136_52_1136_53" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_52_1136_53&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> (</span><a href="#loc_1149_21_1149_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1149_21_1149_22&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="#loc_1118_23_1118_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1118_23_1118_24&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">)) </span><a href="#loc_1136_56_1136_58" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_56_1136_58&#39;)"><span class="hl_varref"><span class="mpre">ds</span></span></a><span class="mpre">)
            </span><a href="#loc_742_19_742_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_742_19_742_26&#39;)"><span class="hl_conref"><span class="mpre">Nesting</span></span></a><span class="mpre"> </span><a name="loc_1150_21_1150_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1150_21_1150_22&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">     -&gt; </span><a href="#loc_1171_11_1171_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1171_11_1171_23&#39;)"><span class="hl_varref"><span class="mpre">best_typical</span></span></a><span class="mpre"> </span><a href="#loc_1136_12_1136_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_12_1136_13&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_1136_14_1136_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_14_1136_15&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> (</span><a href="#loc_1067_15_1067_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1067_15_1067_19&#39;)"><span class="hl_conref"><span class="mpre">Cons</span></span></a><span class="mpre"> </span><a href="#loc_1136_52_1136_53" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_52_1136_53&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> (</span><a href="#loc_1150_21_1150_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1150_21_1150_22&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_1136_52_1136_53" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_52_1136_53&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">) </span><a href="#loc_1136_56_1136_58" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_56_1136_58&#39;)"><span class="hl_varref"><span class="mpre">ds</span></span></a><span class="mpre">)
            </span><a href="#loc_743_19_743_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_743_19_743_24&#39;)"><span class="hl_conref"><span class="mpre">Color</span></span></a><span class="mpre"> </span><a name="loc_1151_19_1151_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1151_19_1151_20&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> </span><a name="loc_1151_21_1151_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1151_21_1151_22&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> </span><a name="loc_1151_23_1151_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1151_23_1151_24&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> </span><a name="loc_1151_25_1151_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1151_25_1151_26&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_768_19_768_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_768_19_768_23&#39;)"><span class="hl_conref"><span class="mpre">SSGR</span></span></a><span class="mpre"> [</span><span class="hl_conref"><span class="mpre">SetColor</span></span><span class="mpre"> </span><a href="#loc_1151_19_1151_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1151_19_1151_20&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><a href="#loc_1151_21_1151_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1151_21_1151_22&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> </span><a href="#loc_1151_23_1151_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1151_23_1151_24&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">] (</span><a href="#loc_1135_7_1135_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1135_7_1135_11&#39;)"><span class="hl_varref"><span class="mpre">best</span></span></a><span class="mpre"> </span><a href="#loc_1136_12_1136_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_12_1136_13&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_1136_14_1136_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_14_1136_15&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_1153_17_1153_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1153_17_1153_23&#39;)"><span class="hl_varref"><span class="mpre">mb_fc&#39;</span></span></a><span class="mpre"> </span><a href="#loc_1154_17_1154_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1154_17_1154_23&#39;)"><span class="hl_varref"><span class="mpre">mb_bc&#39;</span></span></a><span class="mpre"> </span><a href="#loc_1136_28_1136_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_28_1136_33&#39;)"><span class="hl_varref"><span class="mpre">mb_in</span></span></a><span class="mpre"> </span><a href="#loc_1136_34_1136_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_34_1136_39&#39;)"><span class="hl_varref"><span class="mpre">mb_it</span></span></a><span class="mpre"> </span><a href="#loc_1136_40_1136_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_40_1136_45&#39;)"><span class="hl_varref"><span class="mpre">mb_un</span></span></a><span class="mpre"> (</span><a href="#loc_1067_15_1067_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1067_15_1067_19&#39;)"><span class="hl_conref"><span class="mpre">Cons</span></span></a><span class="mpre"> </span><a href="#loc_1136_52_1136_53" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_52_1136_53&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><a href="#loc_1151_25_1151_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1151_25_1151_26&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_1172_11_1172_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1172_11_1172_21&#39;)"><span class="hl_varref"><span class="mpre">ds_restore</span></span></a><span class="mpre">))
              where
                </span><a name="loc_1153_17_1153_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1153_17_1153_23&#39;)"><span class="hl_vardecl"><span class="mpre">mb_fc&#39;</span></span></a><span class="mpre"> = case </span><a href="#loc_1151_19_1151_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1151_19_1151_20&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> of { </span><span class="hl_conref"><span class="mpre">Background</span></span><span class="mpre"> -&gt; </span><a href="#loc_1136_16_1136_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_16_1136_21&#39;)"><span class="hl_varref"><span class="mpre">mb_fc</span></span></a><span class="mpre">; </span><span class="hl_conref"><span class="mpre">Foreground</span></span><span class="mpre"> -&gt; </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><a href="#loc_1151_21_1151_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1151_21_1151_22&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">, </span><a href="#loc_1151_23_1151_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1151_23_1151_24&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">) }
                </span><a name="loc_1154_17_1154_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1154_17_1154_23&#39;)"><span class="hl_vardecl"><span class="mpre">mb_bc&#39;</span></span></a><span class="mpre"> = case </span><a href="#loc_1151_19_1151_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1151_19_1151_20&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> of { </span><span class="hl_conref"><span class="mpre">Background</span></span><span class="mpre"> -&gt; </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><a href="#loc_1151_21_1151_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1151_21_1151_22&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">, </span><a href="#loc_1151_23_1151_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1151_23_1151_24&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">); </span><span class="hl_conref"><span class="mpre">Foreground</span></span><span class="mpre"> -&gt; </span><a href="#loc_1136_22_1136_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_22_1136_27&#39;)"><span class="hl_varref"><span class="mpre">mb_bc</span></span></a><span class="mpre"> }
            </span><a href="#loc_745_19_745_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_745_19_745_28&#39;)"><span class="hl_conref"><span class="mpre">Intensify</span></span></a><span class="mpre"> </span><a name="loc_1155_23_1155_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1155_23_1155_24&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> </span><a name="loc_1155_25_1155_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1155_25_1155_26&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_768_19_768_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_768_19_768_23&#39;)"><span class="hl_conref"><span class="mpre">SSGR</span></span></a><span class="mpre"> [</span><span class="hl_conref"><span class="mpre">SetConsoleIntensity</span></span><span class="mpre"> </span><a href="#loc_1155_23_1155_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1155_23_1155_24&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">] (</span><a href="#loc_1135_7_1135_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1135_7_1135_11&#39;)"><span class="hl_varref"><span class="mpre">best</span></span></a><span class="mpre"> </span><a href="#loc_1136_12_1136_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_12_1136_13&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_1136_14_1136_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_14_1136_15&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_1136_16_1136_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_16_1136_21&#39;)"><span class="hl_varref"><span class="mpre">mb_fc</span></span></a><span class="mpre"> </span><a href="#loc_1136_22_1136_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_22_1136_27&#39;)"><span class="hl_varref"><span class="mpre">mb_bc</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="#loc_1155_23_1155_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1155_23_1155_24&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">) </span><a href="#loc_1136_34_1136_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_34_1136_39&#39;)"><span class="hl_varref"><span class="mpre">mb_it</span></span></a><span class="mpre"> </span><a href="#loc_1136_40_1136_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_40_1136_45&#39;)"><span class="hl_varref"><span class="mpre">mb_un</span></span></a><span class="mpre"> (</span><a href="#loc_1067_15_1067_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1067_15_1067_19&#39;)"><span class="hl_conref"><span class="mpre">Cons</span></span></a><span class="mpre"> </span><a href="#loc_1136_52_1136_53" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_52_1136_53&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><a href="#loc_1155_25_1155_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1155_25_1155_26&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_1172_11_1172_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1172_11_1172_21&#39;)"><span class="hl_varref"><span class="mpre">ds_restore</span></span></a><span class="mpre">))
            </span><a href="#loc_746_19_746_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_746_19_746_28&#39;)"><span class="hl_conref"><span class="mpre">Italicize</span></span></a><span class="mpre"> </span><a name="loc_1156_23_1156_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1156_23_1156_24&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> </span><a name="loc_1156_25_1156_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1156_25_1156_26&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_768_19_768_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_768_19_768_23&#39;)"><span class="hl_conref"><span class="mpre">SSGR</span></span></a><span class="mpre"> [</span><span class="hl_conref"><span class="mpre">SetItalicized</span></span><span class="mpre"> </span><a href="#loc_1156_23_1156_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1156_23_1156_24&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">] (</span><a href="#loc_1135_7_1135_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1135_7_1135_11&#39;)"><span class="hl_varref"><span class="mpre">best</span></span></a><span class="mpre"> </span><a href="#loc_1136_12_1136_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_12_1136_13&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_1136_14_1136_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_14_1136_15&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_1136_16_1136_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_16_1136_21&#39;)"><span class="hl_varref"><span class="mpre">mb_fc</span></span></a><span class="mpre"> </span><a href="#loc_1136_22_1136_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_22_1136_27&#39;)"><span class="hl_varref"><span class="mpre">mb_bc</span></span></a><span class="mpre"> </span><a href="#loc_1136_28_1136_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_28_1136_33&#39;)"><span class="hl_varref"><span class="mpre">mb_in</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="#loc_1156_23_1156_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1156_23_1156_24&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">) </span><a href="#loc_1136_40_1136_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_40_1136_45&#39;)"><span class="hl_varref"><span class="mpre">mb_un</span></span></a><span class="mpre"> (</span><a href="#loc_1067_15_1067_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1067_15_1067_19&#39;)"><span class="hl_conref"><span class="mpre">Cons</span></span></a><span class="mpre"> </span><a href="#loc_1136_52_1136_53" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_52_1136_53&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><a href="#loc_1156_25_1156_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1156_25_1156_26&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_1172_11_1172_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1172_11_1172_21&#39;)"><span class="hl_varref"><span class="mpre">ds_restore</span></span></a><span class="mpre">))
            </span><a href="#loc_747_19_747_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_747_19_747_28&#39;)"><span class="hl_conref"><span class="mpre">Underline</span></span></a><span class="mpre"> </span><a name="loc_1157_23_1157_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1157_23_1157_24&#39;)"><span class="hl_vardecl"><span class="mpre">u</span></span></a><span class="mpre"> </span><a name="loc_1157_25_1157_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1157_25_1157_26&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_768_19_768_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_768_19_768_23&#39;)"><span class="hl_conref"><span class="mpre">SSGR</span></span></a><span class="mpre"> [</span><span class="hl_conref"><span class="mpre">SetUnderlining</span></span><span class="mpre"> </span><a href="#loc_1157_23_1157_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1157_23_1157_24&#39;)"><span class="hl_varref"><span class="mpre">u</span></span></a><span class="mpre">] (</span><a href="#loc_1135_7_1135_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1135_7_1135_11&#39;)"><span class="hl_varref"><span class="mpre">best</span></span></a><span class="mpre"> </span><a href="#loc_1136_12_1136_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_12_1136_13&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_1136_14_1136_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_14_1136_15&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_1136_16_1136_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_16_1136_21&#39;)"><span class="hl_varref"><span class="mpre">mb_fc</span></span></a><span class="mpre"> </span><a href="#loc_1136_22_1136_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_22_1136_27&#39;)"><span class="hl_varref"><span class="mpre">mb_bc</span></span></a><span class="mpre"> </span><a href="#loc_1136_28_1136_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_28_1136_33&#39;)"><span class="hl_varref"><span class="mpre">mb_in</span></span></a><span class="mpre"> </span><a href="#loc_1136_34_1136_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_34_1136_39&#39;)"><span class="hl_varref"><span class="mpre">mb_it</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="#loc_1157_23_1157_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1157_23_1157_24&#39;)"><span class="hl_varref"><span class="mpre">u</span></span></a><span class="mpre">) (</span><a href="#loc_1067_15_1067_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1067_15_1067_19&#39;)"><span class="hl_conref"><span class="mpre">Cons</span></span></a><span class="mpre"> </span><a href="#loc_1136_52_1136_53" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_52_1136_53&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><a href="#loc_1157_25_1157_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1157_25_1157_26&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_1172_11_1172_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1172_11_1172_21&#39;)"><span class="hl_varref"><span class="mpre">ds_restore</span></span></a><span class="mpre">))
            </span><a href="#loc_748_19_748_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_748_19_748_32&#39;)"><span class="hl_conref"><span class="mpre">RestoreFormat</span></span></a><span class="mpre"> </span><a name="loc_1158_27_1158_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1158_27_1158_33&#39;)"><span class="hl_vardecl"><span class="mpre">mb_fc&#39;</span></span></a><span class="mpre"> </span><a name="loc_1158_34_1158_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1158_34_1158_40&#39;)"><span class="hl_vardecl"><span class="mpre">mb_bc&#39;</span></span></a><span class="mpre"> </span><a name="loc_1158_41_1158_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1158_41_1158_47&#39;)"><span class="hl_vardecl"><span class="mpre">mb_in&#39;</span></span></a><span class="mpre"> </span><a name="loc_1158_48_1158_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1158_48_1158_54&#39;)"><span class="hl_vardecl"><span class="mpre">mb_it&#39;</span></span></a><span class="mpre"> </span><a name="loc_1158_55_1158_61" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1158_55_1158_61&#39;)"><span class="hl_vardecl"><span class="mpre">mb_un&#39;</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_768_19_768_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_768_19_768_23&#39;)"><span class="hl_conref"><span class="mpre">SSGR</span></span></a><span class="mpre"> </span><a href="#loc_1163_17_1163_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1163_17_1163_21&#39;)"><span class="hl_varref"><span class="mpre">sgrs</span></span></a><span class="mpre"> (</span><a href="#loc_1135_7_1135_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1135_7_1135_11&#39;)"><span class="hl_varref"><span class="mpre">best</span></span></a><span class="mpre"> </span><a href="#loc_1136_12_1136_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_12_1136_13&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_1136_14_1136_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_14_1136_15&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_1158_27_1158_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1158_27_1158_33&#39;)"><span class="hl_varref"><span class="mpre">mb_fc&#39;</span></span></a><span class="mpre"> </span><a href="#loc_1158_34_1158_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1158_34_1158_40&#39;)"><span class="hl_varref"><span class="mpre">mb_bc&#39;</span></span></a><span class="mpre"> </span><a href="#loc_1158_41_1158_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1158_41_1158_47&#39;)"><span class="hl_varref"><span class="mpre">mb_in&#39;</span></span></a><span class="mpre"> </span><a href="#loc_1158_48_1158_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1158_48_1158_54&#39;)"><span class="hl_varref"><span class="mpre">mb_it&#39;</span></span></a><span class="mpre"> </span><a href="#loc_1158_55_1158_61" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1158_55_1158_61&#39;)"><span class="hl_varref"><span class="mpre">mb_un&#39;</span></span></a><span class="mpre"> </span><a href="#loc_1136_56_1136_58" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_56_1136_58&#39;)"><span class="hl_varref"><span class="mpre">ds</span></span></a><span class="mpre">)
              where
                </span><span class="hl_comment"><span class="mpre">-- We need to be able to restore the entire SGR state, hence we carry around what we believe</span></span><span class="mpre">
                </span><span class="hl_comment"><span class="mpre">-- that state should be in all the arguments to this function. Note that in some cases we could</span></span><span class="mpre">
                </span><span class="hl_comment"><span class="mpre">-- avoid the Reset of the entire state, but not in general.</span></span><span class="mpre">
                </span><a name="loc_1163_17_1163_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1163_17_1163_21&#39;)"><span class="hl_vardecl"><span class="mpre">sgrs</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Reset</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_115_1_115_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_115_1_115_10&#39;)"><span class="hl_varref"><span class="mpre">catMaybes</span></span></a><span class="mpre"> [
                    </span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">uncurry</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">SetColor</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Foreground</span></span><span class="mpre">)) </span><a href="#loc_1158_27_1158_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1158_27_1158_33&#39;)"><span class="hl_varref"><span class="mpre">mb_fc&#39;</span></span></a><span class="mpre">,
                    </span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">uncurry</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">SetColor</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Background</span></span><span class="mpre">)) </span><a href="#loc_1158_34_1158_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1158_34_1158_40&#39;)"><span class="hl_varref"><span class="mpre">mb_bc&#39;</span></span></a><span class="mpre">,
                    </span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">SetConsoleIntensity</span></span><span class="mpre"> </span><a href="#loc_1158_41_1158_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1158_41_1158_47&#39;)"><span class="hl_varref"><span class="mpre">mb_in&#39;</span></span></a><span class="mpre">,
                    </span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">SetItalicized</span></span><span class="mpre"> </span><a href="#loc_1158_48_1158_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1158_48_1158_54&#39;)"><span class="hl_varref"><span class="mpre">mb_it&#39;</span></span></a><span class="mpre">,
                    </span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">SetUnderlining</span></span><span class="mpre"> </span><a href="#loc_1158_55_1158_61" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1158_55_1158_61&#39;)"><span class="hl_varref"><span class="mpre">mb_un&#39;</span></span></a><span class="mpre">
                  ]
        where
          </span><a name="loc_1171_11_1171_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1171_11_1171_23&#39;)"><span class="hl_fundecl"><span class="mpre">best_typical</span></span></a><span class="mpre"> </span><a name="loc_1171_24_1171_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1171_24_1171_26&#39;)"><span class="hl_vardecl"><span class="mpre">n&#39;</span></span></a><span class="mpre"> </span><a name="loc_1171_27_1171_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1171_27_1171_29&#39;)"><span class="hl_vardecl"><span class="mpre">k&#39;</span></span></a><span class="mpre"> </span><a name="loc_1171_30_1171_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1171_30_1171_33&#39;)"><span class="hl_vardecl"><span class="mpre">ds&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_1135_7_1135_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1135_7_1135_11&#39;)"><span class="hl_varref"><span class="mpre">best</span></span></a><span class="mpre"> </span><a href="#loc_1171_24_1171_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1171_24_1171_26&#39;)"><span class="hl_varref"><span class="mpre">n&#39;</span></span></a><span class="mpre"> </span><a href="#loc_1171_27_1171_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1171_27_1171_29&#39;)"><span class="hl_varref"><span class="mpre">k&#39;</span></span></a><span class="mpre"> </span><a href="#loc_1136_16_1136_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_16_1136_21&#39;)"><span class="hl_varref"><span class="mpre">mb_fc</span></span></a><span class="mpre"> </span><a href="#loc_1136_22_1136_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_22_1136_27&#39;)"><span class="hl_varref"><span class="mpre">mb_bc</span></span></a><span class="mpre"> </span><a href="#loc_1136_28_1136_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_28_1136_33&#39;)"><span class="hl_varref"><span class="mpre">mb_in</span></span></a><span class="mpre"> </span><a href="#loc_1136_34_1136_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_34_1136_39&#39;)"><span class="hl_varref"><span class="mpre">mb_it</span></span></a><span class="mpre"> </span><a href="#loc_1136_40_1136_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_40_1136_45&#39;)"><span class="hl_varref"><span class="mpre">mb_un</span></span></a><span class="mpre"> </span><a href="#loc_1171_30_1171_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1171_30_1171_33&#39;)"><span class="hl_varref"><span class="mpre">ds&#39;</span></span></a><span class="mpre">
          </span><a name="loc_1172_11_1172_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1172_11_1172_21&#39;)"><span class="hl_vardecl"><span class="mpre">ds_restore</span></span></a><span class="mpre"> = </span><a href="#loc_1067_15_1067_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1067_15_1067_19&#39;)"><span class="hl_conref"><span class="mpre">Cons</span></span></a><span class="mpre"> </span><a href="#loc_1136_52_1136_53" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_52_1136_53&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> (</span><a href="#loc_748_19_748_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_748_19_748_32&#39;)"><span class="hl_conref"><span class="mpre">RestoreFormat</span></span></a><span class="mpre"> </span><a href="#loc_1136_16_1136_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_16_1136_21&#39;)"><span class="hl_varref"><span class="mpre">mb_fc</span></span></a><span class="mpre"> </span><a href="#loc_1136_22_1136_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_22_1136_27&#39;)"><span class="hl_varref"><span class="mpre">mb_bc</span></span></a><span class="mpre"> </span><a href="#loc_1136_28_1136_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_28_1136_33&#39;)"><span class="hl_varref"><span class="mpre">mb_in</span></span></a><span class="mpre"> </span><a href="#loc_1136_34_1136_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_34_1136_39&#39;)"><span class="hl_varref"><span class="mpre">mb_it</span></span></a><span class="mpre"> </span><a href="#loc_1136_40_1136_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_40_1136_45&#39;)"><span class="hl_varref"><span class="mpre">mb_un</span></span></a><span class="mpre">) </span><a href="#loc_1136_56_1136_58" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1136_56_1136_58&#39;)"><span class="hl_varref"><span class="mpre">ds</span></span></a><span class="mpre">

      </span><span class="hl_comment"><span class="mpre">--nicest :: r = ribbon width, w = page width,</span></span><span class="mpre">
      </span><span class="hl_comment"><span class="mpre">--          n = indentation of current line, k = current column</span></span><span class="mpre">
      </span><span class="hl_comment"><span class="mpre">--          x and y, the (simple) documents to chose from.</span></span><span class="mpre">
      </span><span class="hl_comment"><span class="mpre">--          precondition: first lines of x are longer than the first lines of y.</span></span><span class="mpre">
      </span><a name="loc_1178_7_1178_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1178_7_1178_13&#39;)"><span class="hl_fundecl"><span class="mpre">nicest</span></span></a><span class="mpre"> </span><a name="loc_1178_14_1178_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1178_14_1178_15&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_1178_16_1178_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1178_16_1178_17&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> </span><a name="loc_1178_18_1178_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1178_18_1178_19&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_1178_20_1178_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1178_20_1178_21&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">    | </span><a href="#loc_1118_12_1118_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1118_12_1118_16&#39;)"><span class="hl_varref"><span class="mpre">fits</span></span></a><span class="mpre"> </span><a href="#loc_1118_23_1118_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1118_23_1118_24&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">min</span></span><span class="mpre"> </span><a href="#loc_1178_14_1178_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1178_14_1178_15&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_1178_16_1178_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1178_16_1178_17&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">) </span><a href="#loc_1181_27_1181_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1181_27_1181_32&#39;)"><span class="hl_varref"><span class="mpre">width</span></span></a><span class="mpre"> </span><a href="#loc_1178_18_1178_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1178_18_1178_19&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">  = </span><a href="#loc_1178_18_1178_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1178_18_1178_19&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
                        | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">     = </span><a href="#loc_1178_20_1178_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1178_20_1178_21&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">
                        where
                          </span><a name="loc_1181_27_1181_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1181_27_1181_32&#39;)"><span class="hl_vardecl"><span class="mpre">width</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">min</span></span><span class="mpre"> (</span><a href="#loc_1118_23_1118_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1118_23_1118_24&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_1178_16_1178_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1178_16_1178_17&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">) (</span><a href="#loc_1130_7_1130_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1130_7_1130_8&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_1178_16_1178_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1178_16_1178_17&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_1178_14_1178_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1178_14_1178_15&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- @fits1@ does 1 line lookahead.</span></span><span class="mpre">
</span><a href="#loc_1185_1_1185_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1185_1_1185_6&#39;)"><span class="mpre">fits1</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><a href="#loc_763_6_763_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_763_6_763_15&#39;)"><span class="hl_tyconref"><span class="mpre">SimpleDoc</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_1185_1_1185_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1185_1_1185_6&#39;)"><span class="hl_fundecl"><span class="mpre">fits1</span></span></a><span class="mpre"> _ _ </span><a name="loc_1185_11_1185_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1185_11_1185_12&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">x</span></span><span class="mpre">        | </span><a href="#loc_1185_11_1185_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1185_11_1185_12&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">         = </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
</span><a href="#loc_1185_1_1185_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1185_1_1185_6&#39;)"><span class="hl_fundecl"><span class="mpre">fits1</span></span></a><span class="mpre"> _ _ </span><span class="hl_vardecl"><span class="mpre">w</span></span><span class="mpre"> </span><a href="#loc_763_19_763_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_763_19_763_24&#39;)"><span class="hl_conref"><span class="mpre">SFail</span></span></a><span class="mpre">                    = </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
</span><a href="#loc_1185_1_1185_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1185_1_1185_6&#39;)"><span class="hl_fundecl"><span class="mpre">fits1</span></span></a><span class="mpre"> _ _ </span><span class="hl_vardecl"><span class="mpre">w</span></span><span class="mpre"> </span><a href="#loc_764_19_764_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_764_19_764_25&#39;)"><span class="hl_conref"><span class="mpre">SEmpty</span></span></a><span class="mpre">                   = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
</span><a href="#loc_1185_1_1185_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1185_1_1185_6&#39;)"><span class="hl_fundecl"><span class="mpre">fits1</span></span></a><span class="mpre"> </span><a name="loc_1188_7_1188_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1188_7_1188_8&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_1188_9_1188_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1188_9_1188_10&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> </span><a name="loc_1188_11_1188_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1188_11_1188_12&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> (</span><a href="#loc_765_19_765_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_765_19_765_24&#39;)"><span class="hl_conref"><span class="mpre">SChar</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">c</span></span><span class="mpre"> </span><a name="loc_1188_22_1188_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1188_22_1188_23&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">)              = </span><a href="#loc_1185_1_1185_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1185_1_1185_6&#39;)"><span class="hl_varref"><span class="mpre">fits1</span></span></a><span class="mpre"> </span><a href="#loc_1188_7_1188_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1188_7_1188_8&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_1188_9_1188_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1188_9_1188_10&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> (</span><a href="#loc_1188_11_1188_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1188_11_1188_12&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_1188_22_1188_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1188_22_1188_23&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
</span><a href="#loc_1185_1_1185_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1185_1_1185_6&#39;)"><span class="hl_fundecl"><span class="mpre">fits1</span></span></a><span class="mpre"> </span><a name="loc_1189_7_1189_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1189_7_1189_8&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_1189_9_1189_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1189_9_1189_10&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> </span><a name="loc_1189_11_1189_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1189_11_1189_12&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> (</span><a href="#loc_766_19_766_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_766_19_766_24&#39;)"><span class="hl_conref"><span class="mpre">SText</span></span></a><span class="mpre"> </span><a name="loc_1189_20_1189_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1189_20_1189_21&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">s</span></span><span class="mpre"> </span><a name="loc_1189_24_1189_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1189_24_1189_25&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">)            = </span><a href="#loc_1185_1_1185_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1185_1_1185_6&#39;)"><span class="hl_varref"><span class="mpre">fits1</span></span></a><span class="mpre"> </span><a href="#loc_1189_7_1189_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1189_7_1189_8&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_1189_9_1189_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1189_9_1189_10&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> (</span><a href="#loc_1189_11_1189_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1189_11_1189_12&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_1189_20_1189_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1189_20_1189_21&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">) </span><a href="#loc_1189_24_1189_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1189_24_1189_25&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
</span><a href="#loc_1185_1_1185_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1185_1_1185_6&#39;)"><span class="hl_fundecl"><span class="mpre">fits1</span></span></a><span class="mpre"> _ _ </span><span class="hl_vardecl"><span class="mpre">w</span></span><span class="mpre"> (</span><a href="#loc_767_19_767_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_767_19_767_24&#39;)"><span class="hl_conref"><span class="mpre">SLine</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">i</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">x</span></span><span class="mpre">)              = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
</span><a href="#loc_1185_1_1185_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1185_1_1185_6&#39;)"><span class="hl_fundecl"><span class="mpre">fits1</span></span></a><span class="mpre"> </span><a name="loc_1191_7_1191_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1191_7_1191_8&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_1191_9_1191_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1191_9_1191_10&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> </span><a name="loc_1191_11_1191_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1191_11_1191_12&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> (</span><a href="#loc_768_19_768_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_768_19_768_23&#39;)"><span class="hl_conref"><span class="mpre">SSGR</span></span></a><span class="mpre"> _ </span><a name="loc_1191_21_1191_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1191_21_1191_22&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">)               = </span><a href="#loc_1185_1_1185_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1185_1_1185_6&#39;)"><span class="hl_varref"><span class="mpre">fits1</span></span></a><span class="mpre"> </span><a href="#loc_1191_7_1191_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1191_7_1191_8&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_1191_9_1191_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1191_9_1191_10&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><a href="#loc_1191_11_1191_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1191_11_1191_12&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><a href="#loc_1191_21_1191_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1191_21_1191_22&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- @fitsR@ has a little more lookahead: assuming that nesting roughly</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- corresponds to syntactic depth, @fitsR@ checks that not only the current line</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- fits, but the entire syntactic structure being formatted at this level of</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- indentation fits. If we were to remove the second case for @SLine@, we would</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- check that not only the current structure fits, but also the rest of the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- document, which would be slightly more intelligent but would have exponential</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- runtime (and is prohibitively expensive in practice).</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- p = pagewidth</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- m = minimum nesting level to fit in</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- w = the width in which to fit the first line</span></span><span class="mpre">
</span><a href="#loc_1204_1_1204_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1204_1_1204_6&#39;)"><span class="mpre">fitsR</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><a href="#loc_763_6_763_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_763_6_763_15&#39;)"><span class="hl_tyconref"><span class="mpre">SimpleDoc</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_1204_1_1204_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1204_1_1204_6&#39;)"><span class="hl_fundecl"><span class="mpre">fitsR</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">p</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">m</span></span><span class="mpre"> </span><a name="loc_1204_11_1204_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1204_11_1204_12&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">x</span></span><span class="mpre">        | </span><a href="#loc_1204_11_1204_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1204_11_1204_12&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">         = </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
</span><a href="#loc_1204_1_1204_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1204_1_1204_6&#39;)"><span class="hl_fundecl"><span class="mpre">fitsR</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">p</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">w</span></span><span class="mpre"> </span><a href="#loc_763_19_763_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_763_19_763_24&#39;)"><span class="hl_conref"><span class="mpre">SFail</span></span></a><span class="mpre">                    = </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
</span><a href="#loc_1204_1_1204_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1204_1_1204_6&#39;)"><span class="hl_fundecl"><span class="mpre">fitsR</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">p</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">m</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">w</span></span><span class="mpre"> </span><a href="#loc_764_19_764_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_764_19_764_25&#39;)"><span class="hl_conref"><span class="mpre">SEmpty</span></span></a><span class="mpre">                   = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
</span><a href="#loc_1204_1_1204_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1204_1_1204_6&#39;)"><span class="hl_fundecl"><span class="mpre">fitsR</span></span></a><span class="mpre"> </span><a name="loc_1207_7_1207_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1207_7_1207_8&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_1207_9_1207_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1207_9_1207_10&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> </span><a name="loc_1207_11_1207_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1207_11_1207_12&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> (</span><a href="#loc_765_19_765_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_765_19_765_24&#39;)"><span class="hl_conref"><span class="mpre">SChar</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">c</span></span><span class="mpre"> </span><a name="loc_1207_22_1207_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1207_22_1207_23&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">)              = </span><a href="#loc_1204_1_1204_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1204_1_1204_6&#39;)"><span class="hl_varref"><span class="mpre">fitsR</span></span></a><span class="mpre"> </span><a href="#loc_1207_7_1207_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1207_7_1207_8&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_1207_9_1207_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1207_9_1207_10&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> (</span><a href="#loc_1207_11_1207_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1207_11_1207_12&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_1207_22_1207_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1207_22_1207_23&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
</span><a href="#loc_1204_1_1204_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1204_1_1204_6&#39;)"><span class="hl_fundecl"><span class="mpre">fitsR</span></span></a><span class="mpre"> </span><a name="loc_1208_7_1208_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1208_7_1208_8&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_1208_9_1208_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1208_9_1208_10&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> </span><a name="loc_1208_11_1208_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1208_11_1208_12&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> (</span><a href="#loc_766_19_766_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_766_19_766_24&#39;)"><span class="hl_conref"><span class="mpre">SText</span></span></a><span class="mpre"> </span><a name="loc_1208_20_1208_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1208_20_1208_21&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">s</span></span><span class="mpre"> </span><a name="loc_1208_24_1208_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1208_24_1208_25&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">)            = </span><a href="#loc_1204_1_1204_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1204_1_1204_6&#39;)"><span class="hl_varref"><span class="mpre">fitsR</span></span></a><span class="mpre"> </span><a href="#loc_1208_7_1208_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1208_7_1208_8&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_1208_9_1208_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1208_9_1208_10&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> (</span><a href="#loc_1208_11_1208_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1208_11_1208_12&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_1208_20_1208_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1208_20_1208_21&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">) </span><a href="#loc_1208_24_1208_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1208_24_1208_25&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
</span><a href="#loc_1204_1_1204_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1204_1_1204_6&#39;)"><span class="hl_fundecl"><span class="mpre">fitsR</span></span></a><span class="mpre"> </span><a name="loc_1209_7_1209_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1209_7_1209_8&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_1209_9_1209_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1209_9_1209_10&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">w</span></span><span class="mpre"> (</span><a href="#loc_767_19_767_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_767_19_767_24&#39;)"><span class="hl_conref"><span class="mpre">SLine</span></span></a><span class="mpre"> </span><a name="loc_1209_20_1209_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1209_20_1209_21&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> </span><a name="loc_1209_22_1209_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1209_22_1209_23&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">) | </span><a href="#loc_1209_9_1209_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1209_9_1209_10&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_1209_20_1209_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1209_20_1209_21&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">      = </span><a href="#loc_1204_1_1204_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1204_1_1204_6&#39;)"><span class="hl_varref"><span class="mpre">fitsR</span></span></a><span class="mpre"> </span><a href="#loc_1209_7_1209_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1209_7_1209_8&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_1209_9_1209_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1209_9_1209_10&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> (</span><a href="#loc_1209_7_1209_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1209_7_1209_8&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_1209_20_1209_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1209_20_1209_21&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">) </span><a href="#loc_1209_22_1209_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1209_22_1209_23&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
                        | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">  = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
</span><a href="#loc_1204_1_1204_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1204_1_1204_6&#39;)"><span class="hl_fundecl"><span class="mpre">fitsR</span></span></a><span class="mpre"> </span><a name="loc_1211_7_1211_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1211_7_1211_8&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_1211_9_1211_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1211_9_1211_10&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> </span><a name="loc_1211_11_1211_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1211_11_1211_12&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> (</span><a href="#loc_768_19_768_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_768_19_768_23&#39;)"><span class="hl_conref"><span class="mpre">SSGR</span></span></a><span class="mpre"> _ </span><a name="loc_1211_21_1211_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1211_21_1211_22&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">)               = </span><a href="#loc_1204_1_1204_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1204_1_1204_6&#39;)"><span class="hl_varref"><span class="mpre">fitsR</span></span></a><span class="mpre"> </span><a href="#loc_1211_7_1211_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1211_7_1211_8&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_1211_9_1211_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1211_9_1211_10&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><a href="#loc_1211_11_1211_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1211_11_1211_12&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><a href="#loc_1211_21_1211_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1211_21_1211_22&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- renderCompact: renders documents without indentation</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--  fast and fewer characters output, good for machines</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | @(renderCompact x)@ renders document @x@ without adding any</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- indentation. Since no \&#39;pretty\&#39; printing is involved, this</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- renderer is very fast. The resulting output contains fewer</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- characters than a pretty printed version and can be used for output</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- that is read by other programs.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This rendering function does not add any colorisation information.</span></span><span class="mpre">
</span><a href="#loc_1227_1_1227_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1227_1_1227_14&#39;)"><span class="mpre">renderCompact</span></a><span class="mpre"> :: </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_763_6_763_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_763_6_763_15&#39;)"><span class="hl_tyconref"><span class="mpre">SimpleDoc</span></span></a><span class="mpre">
</span><a name="loc_1227_1_1227_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1227_1_1227_14&#39;)"><span class="hl_fundecl"><span class="mpre">renderCompact</span></span></a><span class="mpre"> </span><a name="loc_1227_15_1227_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1227_15_1227_16&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">
    = </span><a href="#loc_1230_7_1230_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1230_7_1230_11&#39;)"><span class="hl_varref"><span class="mpre">scan</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> [</span><a href="#loc_1227_15_1227_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1227_15_1227_16&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">]
    where
      </span><a name="loc_1230_7_1230_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1230_7_1230_11&#39;)"><span class="hl_fundecl"><span class="mpre">scan</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">k</span></span><span class="mpre"> []     = </span><a href="#loc_764_19_764_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_764_19_764_25&#39;)"><span class="hl_conref"><span class="mpre">SEmpty</span></span></a><span class="mpre">
      </span><a href="#loc_1230_7_1230_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1230_7_1230_11&#39;)"><span class="hl_fundecl"><span class="mpre">scan</span></span></a><span class="mpre"> </span><a name="loc_1231_12_1231_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1231_12_1231_13&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> (</span><a name="loc_1231_15_1231_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1231_15_1231_16&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_1231_17_1231_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1231_17_1231_19&#39;)"><span class="hl_vardecl"><span class="mpre">ds</span></span></a><span class="mpre">) = case </span><a href="#loc_1231_15_1231_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1231_15_1231_16&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> of
                        </span><a href="#loc_730_19_730_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_19_730_23&#39;)"><span class="hl_conref"><span class="mpre">Fail</span></span></a><span class="mpre">                    -&gt; </span><a href="#loc_763_19_763_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_763_19_763_24&#39;)"><span class="hl_conref"><span class="mpre">SFail</span></span></a><span class="mpre">
                        </span><a href="#loc_731_19_731_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_731_19_731_24&#39;)"><span class="hl_conref"><span class="mpre">Empty</span></span></a><span class="mpre">                   -&gt; </span><a href="#loc_1230_7_1230_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1230_7_1230_11&#39;)"><span class="hl_varref"><span class="mpre">scan</span></span></a><span class="mpre"> </span><a href="#loc_1231_12_1231_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1231_12_1231_13&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_1231_17_1231_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1231_17_1231_19&#39;)"><span class="hl_varref"><span class="mpre">ds</span></span></a><span class="mpre">
                        </span><a href="#loc_732_19_732_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_732_19_732_23&#39;)"><span class="hl_conref"><span class="mpre">Char</span></span></a><span class="mpre"> </span><a name="loc_1234_30_1234_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1234_30_1234_31&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">                  -&gt; let </span><a name="loc_1234_56_1234_58" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1234_56_1234_58&#39;)"><span class="hl_vardecl"><span class="mpre">k&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_1231_12_1231_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1231_12_1231_13&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> in </span><span class="hl_varref"><span class="mpre">seq</span></span><span class="mpre"> </span><a href="#loc_1234_56_1234_58" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1234_56_1234_58&#39;)"><span class="hl_varref"><span class="mpre">k&#39;</span></span></a><span class="mpre"> (</span><a href="#loc_765_19_765_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_765_19_765_24&#39;)"><span class="hl_conref"><span class="mpre">SChar</span></span></a><span class="mpre"> </span><a href="#loc_1234_30_1234_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1234_30_1234_31&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> (</span><a href="#loc_1230_7_1230_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1230_7_1230_11&#39;)"><span class="hl_varref"><span class="mpre">scan</span></span></a><span class="mpre"> </span><a href="#loc_1234_56_1234_58" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1234_56_1234_58&#39;)"><span class="hl_varref"><span class="mpre">k&#39;</span></span></a><span class="mpre"> </span><a href="#loc_1231_17_1231_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1231_17_1231_19&#39;)"><span class="hl_varref"><span class="mpre">ds</span></span></a><span class="mpre">))
                        </span><a href="#loc_733_19_733_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_733_19_733_23&#39;)"><span class="hl_conref"><span class="mpre">Text</span></span></a><span class="mpre"> </span><a name="loc_1235_30_1235_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1235_30_1235_31&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> </span><a name="loc_1235_32_1235_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1235_32_1235_33&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">                -&gt; let </span><a name="loc_1235_56_1235_58" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1235_56_1235_58&#39;)"><span class="hl_vardecl"><span class="mpre">k&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_1231_12_1231_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1231_12_1231_13&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><a href="#loc_1235_30_1235_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1235_30_1235_31&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> in </span><span class="hl_varref"><span class="mpre">seq</span></span><span class="mpre"> </span><a href="#loc_1235_56_1235_58" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1235_56_1235_58&#39;)"><span class="hl_varref"><span class="mpre">k&#39;</span></span></a><span class="mpre"> (</span><a href="#loc_766_19_766_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_766_19_766_24&#39;)"><span class="hl_conref"><span class="mpre">SText</span></span></a><span class="mpre"> </span><a href="#loc_1235_30_1235_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1235_30_1235_31&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><a href="#loc_1235_32_1235_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1235_32_1235_33&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> (</span><a href="#loc_1230_7_1230_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1230_7_1230_11&#39;)"><span class="hl_varref"><span class="mpre">scan</span></span></a><span class="mpre"> </span><a href="#loc_1235_56_1235_58" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1235_56_1235_58&#39;)"><span class="hl_varref"><span class="mpre">k&#39;</span></span></a><span class="mpre"> </span><a href="#loc_1231_17_1231_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1231_17_1231_19&#39;)"><span class="hl_varref"><span class="mpre">ds</span></span></a><span class="mpre">))
                        </span><a href="#loc_735_19_735_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_735_19_735_26&#39;)"><span class="hl_conref"><span class="mpre">FlatAlt</span></span></a><span class="mpre"> </span><a name="loc_1236_33_1236_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1236_33_1236_34&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> _             -&gt; </span><a href="#loc_1230_7_1230_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1230_7_1230_11&#39;)"><span class="hl_varref"><span class="mpre">scan</span></span></a><span class="mpre"> </span><a href="#loc_1231_12_1231_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1231_12_1231_13&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> (</span><a href="#loc_1236_33_1236_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1236_33_1236_34&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_1231_17_1231_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1231_17_1231_19&#39;)"><span class="hl_varref"><span class="mpre">ds</span></span></a><span class="mpre">)
                        </span><a href="#loc_734_19_734_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_734_19_734_23&#39;)"><span class="hl_conref"><span class="mpre">Line</span></span></a><span class="mpre">                    -&gt; </span><a href="#loc_767_19_767_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_767_19_767_24&#39;)"><span class="hl_conref"><span class="mpre">SLine</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> (</span><a href="#loc_1230_7_1230_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1230_7_1230_11&#39;)"><span class="hl_varref"><span class="mpre">scan</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a href="#loc_1231_17_1231_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1231_17_1231_19&#39;)"><span class="hl_varref"><span class="mpre">ds</span></span></a><span class="mpre">)
                        </span><a href="#loc_737_19_737_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_737_19_737_22&#39;)"><span class="hl_conref"><span class="mpre">Cat</span></span></a><span class="mpre"> </span><a name="loc_1238_29_1238_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1238_29_1238_30&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_1238_31_1238_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1238_31_1238_32&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">                 -&gt; </span><a href="#loc_1230_7_1230_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1230_7_1230_11&#39;)"><span class="hl_varref"><span class="mpre">scan</span></span></a><span class="mpre"> </span><a href="#loc_1231_12_1231_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1231_12_1231_13&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> (</span><a href="#loc_1238_29_1238_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1238_29_1238_30&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_1238_31_1238_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1238_31_1238_32&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_1231_17_1231_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1231_17_1231_19&#39;)"><span class="hl_varref"><span class="mpre">ds</span></span></a><span class="mpre">)
                        </span><a href="#loc_738_19_738_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_738_19_738_23&#39;)"><span class="hl_conref"><span class="mpre">Nest</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">j</span></span><span class="mpre"> </span><a name="loc_1239_32_1239_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1239_32_1239_33&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">                -&gt; </span><a href="#loc_1230_7_1230_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1230_7_1230_11&#39;)"><span class="hl_varref"><span class="mpre">scan</span></span></a><span class="mpre"> </span><a href="#loc_1231_12_1231_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1231_12_1231_13&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> (</span><a href="#loc_1239_32_1239_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1239_32_1239_33&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_1231_17_1231_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1231_17_1231_19&#39;)"><span class="hl_varref"><span class="mpre">ds</span></span></a><span class="mpre">)
                        </span><a href="#loc_739_19_739_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_739_19_739_24&#39;)"><span class="hl_conref"><span class="mpre">Union</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">x</span></span><span class="mpre"> </span><a name="loc_1240_33_1240_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1240_33_1240_34&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">               -&gt; </span><a href="#loc_1230_7_1230_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1230_7_1230_11&#39;)"><span class="hl_varref"><span class="mpre">scan</span></span></a><span class="mpre"> </span><a href="#loc_1231_12_1231_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1231_12_1231_13&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> (</span><a href="#loc_1240_33_1240_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1240_33_1240_34&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_1231_17_1231_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1231_17_1231_19&#39;)"><span class="hl_varref"><span class="mpre">ds</span></span></a><span class="mpre">)
                        </span><a href="#loc_740_19_740_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_740_19_740_25&#39;)"><span class="hl_conref"><span class="mpre">Column</span></span></a><span class="mpre"> </span><a name="loc_1241_32_1241_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1241_32_1241_33&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">                -&gt; </span><a href="#loc_1230_7_1230_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1230_7_1230_11&#39;)"><span class="hl_varref"><span class="mpre">scan</span></span></a><span class="mpre"> </span><a href="#loc_1231_12_1231_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1231_12_1231_13&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> (</span><a href="#loc_1241_32_1241_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1241_32_1241_33&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_1231_12_1231_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1231_12_1231_13&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_1231_17_1231_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1231_17_1231_19&#39;)"><span class="hl_varref"><span class="mpre">ds</span></span></a><span class="mpre">)
                        </span><a href="#loc_741_19_741_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_741_19_741_26&#39;)"><span class="hl_conref"><span class="mpre">Columns</span></span></a><span class="mpre"> </span><a name="loc_1242_33_1242_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1242_33_1242_34&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">               -&gt; </span><a href="#loc_1230_7_1230_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1230_7_1230_11&#39;)"><span class="hl_varref"><span class="mpre">scan</span></span></a><span class="mpre"> </span><a href="#loc_1231_12_1231_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1231_12_1231_13&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> (</span><a href="#loc_1242_33_1242_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1242_33_1242_34&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_1231_17_1231_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1231_17_1231_19&#39;)"><span class="hl_varref"><span class="mpre">ds</span></span></a><span class="mpre">)
                        </span><a href="#loc_742_19_742_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_742_19_742_26&#39;)"><span class="hl_conref"><span class="mpre">Nesting</span></span></a><span class="mpre"> </span><a name="loc_1243_33_1243_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1243_33_1243_34&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">               -&gt; </span><a href="#loc_1230_7_1230_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1230_7_1230_11&#39;)"><span class="hl_varref"><span class="mpre">scan</span></span></a><span class="mpre"> </span><a href="#loc_1231_12_1231_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1231_12_1231_13&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> (</span><a href="#loc_1243_33_1243_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1243_33_1243_34&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_1231_17_1231_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1231_17_1231_19&#39;)"><span class="hl_varref"><span class="mpre">ds</span></span></a><span class="mpre">)
                        </span><a href="#loc_743_19_743_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_743_19_743_24&#39;)"><span class="hl_conref"><span class="mpre">Color</span></span></a><span class="mpre"> _ _ _ </span><a name="loc_1244_37_1244_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1244_37_1244_38&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">           -&gt; </span><a href="#loc_1230_7_1230_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1230_7_1230_11&#39;)"><span class="hl_varref"><span class="mpre">scan</span></span></a><span class="mpre"> </span><a href="#loc_1231_12_1231_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1231_12_1231_13&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> (</span><a href="#loc_1244_37_1244_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1244_37_1244_38&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_1231_17_1231_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1231_17_1231_19&#39;)"><span class="hl_varref"><span class="mpre">ds</span></span></a><span class="mpre">)
                        </span><a href="#loc_745_19_745_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_745_19_745_28&#39;)"><span class="hl_conref"><span class="mpre">Intensify</span></span></a><span class="mpre"> _ </span><a name="loc_1245_37_1245_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1245_37_1245_38&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">           -&gt; </span><a href="#loc_1230_7_1230_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1230_7_1230_11&#39;)"><span class="hl_varref"><span class="mpre">scan</span></span></a><span class="mpre"> </span><a href="#loc_1231_12_1231_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1231_12_1231_13&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> (</span><a href="#loc_1245_37_1245_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1245_37_1245_38&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_1231_17_1231_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1231_17_1231_19&#39;)"><span class="hl_varref"><span class="mpre">ds</span></span></a><span class="mpre">)
                        </span><a href="#loc_746_19_746_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_746_19_746_28&#39;)"><span class="hl_conref"><span class="mpre">Italicize</span></span></a><span class="mpre"> _ </span><a name="loc_1246_37_1246_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1246_37_1246_38&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">           -&gt; </span><a href="#loc_1230_7_1230_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1230_7_1230_11&#39;)"><span class="hl_varref"><span class="mpre">scan</span></span></a><span class="mpre"> </span><a href="#loc_1231_12_1231_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1231_12_1231_13&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> (</span><a href="#loc_1246_37_1246_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1246_37_1246_38&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_1231_17_1231_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1231_17_1231_19&#39;)"><span class="hl_varref"><span class="mpre">ds</span></span></a><span class="mpre">)
                        </span><a href="#loc_747_19_747_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_747_19_747_28&#39;)"><span class="hl_conref"><span class="mpre">Underline</span></span></a><span class="mpre"> _ </span><a name="loc_1247_37_1247_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1247_37_1247_38&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">           -&gt; </span><a href="#loc_1230_7_1230_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1230_7_1230_11&#39;)"><span class="hl_varref"><span class="mpre">scan</span></span></a><span class="mpre"> </span><a href="#loc_1231_12_1231_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1231_12_1231_13&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> (</span><a href="#loc_1247_37_1247_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1247_37_1247_38&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_1231_17_1231_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1231_17_1231_19&#39;)"><span class="hl_varref"><span class="mpre">ds</span></span></a><span class="mpre">)
                        </span><a href="#loc_748_19_748_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_748_19_748_32&#39;)"><span class="hl_conref"><span class="mpre">RestoreFormat</span></span></a><span class="mpre"> _ _ _ _ _ -&gt; </span><a href="#loc_1230_7_1230_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1230_7_1230_11&#39;)"><span class="hl_varref"><span class="mpre">scan</span></span></a><span class="mpre"> </span><a href="#loc_1231_12_1231_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1231_12_1231_13&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><a href="#loc_1231_17_1231_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1231_17_1231_19&#39;)"><span class="hl_varref"><span class="mpre">ds</span></span></a><span class="mpre">



</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Displayers:  displayS and displayIO</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | @(displayS simpleDoc)@ takes the output @simpleDoc@ from a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- rendering function and transforms it to a &#39;ShowS&#39; type (for use in</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the &#39;Show&#39; class).</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; showWidth :: Int -&gt; Doc -&gt; String</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; showWidth w x   = displayS (renderPretty 0.4 w x) &quot;&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ANSI color information will be discarded by this function unless</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- you are running on a Unix-like operating system. This is due to</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- a technical limitation in Windows ANSI support.</span></span><span class="mpre">
</span><a href="#loc_1268_1_1268_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1268_1_1268_9&#39;)"><span class="mpre">displayS</span></a><span class="mpre"> :: </span><a href="#loc_763_6_763_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_763_6_763_15&#39;)"><span class="hl_tyconref"><span class="mpre">SimpleDoc</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ShowS</span></span><span class="mpre">
</span><a name="loc_1268_1_1268_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1268_1_1268_9&#39;)"><span class="hl_fundecl"><span class="mpre">displayS</span></span></a><span class="mpre"> </span><a href="#loc_763_19_763_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_763_19_763_24&#39;)"><span class="hl_conref"><span class="mpre">SFail</span></span></a><span class="mpre">              = </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;@SFail@ can not appear uncaught in a &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">
                              </span><span class="hl_string"><span class="mpre">&quot;rendered @SimpleDoc@&quot;</span></span><span class="mpre">
</span><a href="#loc_1268_1_1268_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1268_1_1268_9&#39;)"><span class="hl_fundecl"><span class="mpre">displayS</span></span></a><span class="mpre"> </span><a href="#loc_764_19_764_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_764_19_764_25&#39;)"><span class="hl_conref"><span class="mpre">SEmpty</span></span></a><span class="mpre">             = </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">
</span><a href="#loc_1268_1_1268_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1268_1_1268_9&#39;)"><span class="hl_fundecl"><span class="mpre">displayS</span></span></a><span class="mpre"> (</span><a href="#loc_765_19_765_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_765_19_765_24&#39;)"><span class="hl_conref"><span class="mpre">SChar</span></span></a><span class="mpre"> </span><a name="loc_1271_17_1271_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1271_17_1271_18&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> </span><a name="loc_1271_19_1271_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1271_19_1271_20&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">)        = </span><span class="hl_varref"><span class="mpre">showChar</span></span><span class="mpre"> </span><a href="#loc_1271_17_1271_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1271_17_1271_18&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_1268_1_1268_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1268_1_1268_9&#39;)"><span class="hl_varref"><span class="mpre">displayS</span></span></a><span class="mpre"> </span><a href="#loc_1271_19_1271_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1271_19_1271_20&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
</span><a href="#loc_1268_1_1268_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1268_1_1268_9&#39;)"><span class="hl_fundecl"><span class="mpre">displayS</span></span></a><span class="mpre"> (</span><a href="#loc_766_19_766_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_766_19_766_24&#39;)"><span class="hl_conref"><span class="mpre">SText</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">l</span></span><span class="mpre"> </span><a name="loc_1272_19_1272_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1272_19_1272_20&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> </span><a name="loc_1272_21_1272_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1272_21_1272_22&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">)      = </span><span class="hl_varref"><span class="mpre">showString</span></span><span class="mpre"> </span><a href="#loc_1272_19_1272_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1272_19_1272_20&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_1268_1_1268_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1268_1_1268_9&#39;)"><span class="hl_varref"><span class="mpre">displayS</span></span></a><span class="mpre"> </span><a href="#loc_1272_21_1272_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1272_21_1272_22&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
</span><a href="#loc_1268_1_1268_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1268_1_1268_9&#39;)"><span class="hl_fundecl"><span class="mpre">displayS</span></span></a><span class="mpre"> (</span><a href="#loc_767_19_767_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_767_19_767_24&#39;)"><span class="hl_conref"><span class="mpre">SLine</span></span></a><span class="mpre"> </span><a name="loc_1273_17_1273_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1273_17_1273_18&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> </span><a name="loc_1273_19_1273_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1273_19_1273_20&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">)        = </span><span class="hl_varref"><span class="mpre">showString</span></span><span class="mpre"> (</span><span class="hl_char"><span class="mpre">&#39;\n&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_1344_1_1344_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1344_1_1344_12&#39;)"><span class="hl_varref"><span class="mpre">indentation</span></span></a><span class="mpre"> </span><a href="#loc_1273_17_1273_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1273_17_1273_18&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_1268_1_1268_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1268_1_1268_9&#39;)"><span class="hl_varref"><span class="mpre">displayS</span></span></a><span class="mpre"> </span><a href="#loc_1273_19_1273_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1273_19_1273_20&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
</span><a href="#loc_1268_1_1268_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1268_1_1268_9&#39;)"><span class="hl_fundecl"><span class="mpre">displayS</span></span></a><span class="mpre"> (</span><a href="#loc_768_19_768_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_768_19_768_23&#39;)"><span class="hl_conref"><span class="mpre">SSGR</span></span></a><span class="mpre"> </span><a name="loc_1274_16_1274_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1274_16_1274_17&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> </span><a name="loc_1274_18_1274_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1274_18_1274_19&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">)         = </span><span class="hl_varref"><span class="mpre">showString</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">setSGRCode</span></span><span class="mpre"> </span><a href="#loc_1274_16_1274_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1274_16_1274_17&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_1268_1_1268_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1268_1_1268_9&#39;)"><span class="hl_varref"><span class="mpre">displayS</span></span></a><span class="mpre"> </span><a href="#loc_1274_18_1274_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1274_18_1274_19&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- | @(displayIO handle simpleDoc)@ writes @simpleDoc@ to the file</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- handle @handle@. This function is used for example by &#39;hPutDoc&#39;:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; hPutDoc handle doc  = displayIO handle (renderPretty 0.4 100 doc)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Any ANSI colorisation in @simpleDoc@ will be output.</span></span><span class="mpre">
</span><a href="#loc_1284_1_1284_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1284_1_1284_10&#39;)"><span class="mpre">displayIO</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Handle</span></span><span class="mpre"> -&gt; </span><a href="#loc_763_6_763_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_763_6_763_15&#39;)"><span class="hl_tyconref"><span class="mpre">SimpleDoc</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_1284_1_1284_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1284_1_1284_10&#39;)"><span class="hl_fundecl"><span class="mpre">displayIO</span></span></a><span class="mpre"> </span><a name="loc_1284_11_1284_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1284_11_1284_17&#39;)"><span class="hl_vardecl"><span class="mpre">handle</span></span></a><span class="mpre"> </span><a name="loc_1284_18_1284_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1284_18_1284_27&#39;)"><span class="hl_vardecl"><span class="mpre">simpleDoc</span></span></a><span class="mpre">
    = </span><a href="#loc_1287_7_1287_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1287_7_1287_14&#39;)"><span class="hl_varref"><span class="mpre">display</span></span></a><span class="mpre"> </span><a href="#loc_1284_18_1284_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1284_18_1284_27&#39;)"><span class="hl_varref"><span class="mpre">simpleDoc</span></span></a><span class="mpre">
    where
      </span><a name="loc_1287_7_1287_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1287_7_1287_14&#39;)"><span class="hl_fundecl"><span class="mpre">display</span></span></a><span class="mpre"> </span><a href="#loc_763_19_763_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_763_19_763_24&#39;)"><span class="hl_conref"><span class="mpre">SFail</span></span></a><span class="mpre">         = </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;@SFail@ can not appear uncaught in a &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">
                              </span><span class="hl_string"><span class="mpre">&quot;rendered @SimpleDoc@&quot;</span></span><span class="mpre">
      </span><a href="#loc_1287_7_1287_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1287_7_1287_14&#39;)"><span class="hl_fundecl"><span class="mpre">display</span></span></a><span class="mpre"> </span><a href="#loc_764_19_764_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_764_19_764_25&#39;)"><span class="hl_conref"><span class="mpre">SEmpty</span></span></a><span class="mpre">         = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">
      </span><a href="#loc_1287_7_1287_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1287_7_1287_14&#39;)"><span class="hl_fundecl"><span class="mpre">display</span></span></a><span class="mpre"> (</span><a href="#loc_765_19_765_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_765_19_765_24&#39;)"><span class="hl_conref"><span class="mpre">SChar</span></span></a><span class="mpre"> </span><a name="loc_1290_22_1290_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1290_22_1290_23&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> </span><a name="loc_1290_24_1290_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1290_24_1290_25&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">)    = do{ </span><span class="hl_varref"><span class="mpre">hPutChar</span></span><span class="mpre"> </span><a href="#loc_1284_11_1284_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1284_11_1284_17&#39;)"><span class="hl_varref"><span class="mpre">handle</span></span></a><span class="mpre"> </span><a href="#loc_1290_22_1290_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1290_22_1290_23&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">; </span><a href="#loc_1287_7_1287_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1287_7_1287_14&#39;)"><span class="hl_varref"><span class="mpre">display</span></span></a><span class="mpre"> </span><a href="#loc_1290_24_1290_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1290_24_1290_25&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">}
      </span><a href="#loc_1287_7_1287_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1287_7_1287_14&#39;)"><span class="hl_fundecl"><span class="mpre">display</span></span></a><span class="mpre"> (</span><a href="#loc_766_19_766_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_766_19_766_24&#39;)"><span class="hl_conref"><span class="mpre">SText</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">l</span></span><span class="mpre"> </span><a name="loc_1291_24_1291_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1291_24_1291_25&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> </span><a name="loc_1291_26_1291_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1291_26_1291_27&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">)  = do{ </span><span class="hl_varref"><span class="mpre">hPutStr</span></span><span class="mpre"> </span><a href="#loc_1284_11_1284_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1284_11_1284_17&#39;)"><span class="hl_varref"><span class="mpre">handle</span></span></a><span class="mpre"> </span><a href="#loc_1291_24_1291_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1291_24_1291_25&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">; </span><a href="#loc_1287_7_1287_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1287_7_1287_14&#39;)"><span class="hl_varref"><span class="mpre">display</span></span></a><span class="mpre"> </span><a href="#loc_1291_26_1291_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1291_26_1291_27&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">}
      </span><a href="#loc_1287_7_1287_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1287_7_1287_14&#39;)"><span class="hl_fundecl"><span class="mpre">display</span></span></a><span class="mpre"> (</span><a href="#loc_767_19_767_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_767_19_767_24&#39;)"><span class="hl_conref"><span class="mpre">SLine</span></span></a><span class="mpre"> </span><a name="loc_1292_22_1292_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1292_22_1292_23&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> </span><a name="loc_1292_24_1292_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1292_24_1292_25&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">)    = do{ </span><span class="hl_varref"><span class="mpre">hPutStr</span></span><span class="mpre"> </span><a href="#loc_1284_11_1284_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1284_11_1284_17&#39;)"><span class="hl_varref"><span class="mpre">handle</span></span></a><span class="mpre"> (</span><span class="hl_char"><span class="mpre">&#39;\n&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_1344_1_1344_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1344_1_1344_12&#39;)"><span class="hl_varref"><span class="mpre">indentation</span></span></a><span class="mpre"> </span><a href="#loc_1292_22_1292_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1292_22_1292_23&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">); </span><a href="#loc_1287_7_1287_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1287_7_1287_14&#39;)"><span class="hl_varref"><span class="mpre">display</span></span></a><span class="mpre"> </span><a href="#loc_1292_24_1292_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1292_24_1292_25&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">}
      </span><a href="#loc_1287_7_1287_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1287_7_1287_14&#39;)"><span class="hl_fundecl"><span class="mpre">display</span></span></a><span class="mpre"> (</span><a href="#loc_768_19_768_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_768_19_768_23&#39;)"><span class="hl_conref"><span class="mpre">SSGR</span></span></a><span class="mpre"> </span><a name="loc_1293_21_1293_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1293_21_1293_22&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> </span><a name="loc_1293_23_1293_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1293_23_1293_24&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">)     = do{ </span><span class="hl_varref"><span class="mpre">hSetSGR</span></span><span class="mpre"> </span><a href="#loc_1284_11_1284_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1284_11_1284_17&#39;)"><span class="hl_varref"><span class="mpre">handle</span></span></a><span class="mpre"> </span><a href="#loc_1293_21_1293_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1293_21_1293_22&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">; </span><a href="#loc_1287_7_1287_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1287_7_1287_14&#39;)"><span class="hl_varref"><span class="mpre">display</span></span></a><span class="mpre"> </span><a href="#loc_1293_23_1293_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1293_23_1293_24&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">}

</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- default pretty printers: show, putDoc and hPutDoc</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------</span></span><span class="mpre">
instance </span><span class="hl_classref"><span class="mpre">Show</span></span><span class="mpre"> </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> where
  </span><span class="hl_fundecl"><span class="mpre">showsPrec</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">d</span></span><span class="mpre"> </span><a name="loc_1299_15_1299_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1299_15_1299_18&#39;)"><span class="hl_vardecl"><span class="mpre">doc</span></span></a><span class="mpre">       = </span><a href="#loc_1268_1_1268_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1268_1_1268_9&#39;)"><span class="hl_varref"><span class="mpre">displayS</span></span></a><span class="mpre"> (</span><a href="#loc_1078_1_1078_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1078_1_1078_13&#39;)"><span class="hl_varref"><span class="mpre">renderPretty</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0.4</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">80</span></span><span class="mpre"> </span><a href="#loc_1299_15_1299_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1299_15_1299_18&#39;)"><span class="hl_varref"><span class="mpre">doc</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | The action @(putDoc doc)@ pretty prints document @doc@ to the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- standard output, with a page width of 100 characters and a ribbon</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- width of 40 characters.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; main :: IO ()</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; main = do{ putDoc (text &quot;hello&quot; &lt;+&gt; text &quot;world&quot;) }</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Which would output</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- hello world</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Any ANSI colorisation in @doc@ will be output.</span></span><span class="mpre">
</span><a href="#loc_1316_1_1316_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1316_1_1316_7&#39;)"><span class="mpre">putDoc</span></a><span class="mpre"> :: </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_1316_1_1316_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1316_1_1316_7&#39;)"><span class="hl_fundecl"><span class="mpre">putDoc</span></span></a><span class="mpre"> </span><a name="loc_1316_8_1316_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1316_8_1316_11&#39;)"><span class="hl_vardecl"><span class="mpre">doc</span></span></a><span class="mpre">              = </span><a href="#loc_1330_1_1330_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1330_1_1330_8&#39;)"><span class="hl_varref"><span class="mpre">hPutDoc</span></span></a><span class="mpre"> </span><a href="GHC.IO.Handle.FD.html#loc_63_1_63_7" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Handle.FD.html#loc_63_1_63_7&#39;)"><span class="hl_varref"><span class="mpre">stdout</span></span></a><span class="mpre"> </span><a href="#loc_1316_8_1316_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1316_8_1316_11&#39;)"><span class="hl_varref"><span class="mpre">doc</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | @(hPutDoc handle doc)@ pretty prints document @doc@ to the file</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- handle @handle@ with a page width of 100 characters and a ribbon</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- width of 40 characters.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; main = do{ handle &lt;- openFile &quot;MyFile&quot; WriteMode</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;          ; hPutDoc handle (vcat (map text</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;                            [&quot;vertical&quot;,&quot;text&quot;]))</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;          ; hClose handle</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt;          }</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Any ANSI colorisation in @doc@ will be output.</span></span><span class="mpre">
</span><a href="#loc_1330_1_1330_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1330_1_1330_8&#39;)"><span class="mpre">hPutDoc</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Handle</span></span><span class="mpre"> -&gt; </span><a href="#loc_730_6_730_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_730_6_730_9&#39;)"><span class="hl_tyconref"><span class="mpre">Doc</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_1330_1_1330_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1330_1_1330_8&#39;)"><span class="hl_fundecl"><span class="mpre">hPutDoc</span></span></a><span class="mpre"> </span><a name="loc_1330_9_1330_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1330_9_1330_15&#39;)"><span class="hl_vardecl"><span class="mpre">handle</span></span></a><span class="mpre"> </span><a name="loc_1330_16_1330_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1330_16_1330_19&#39;)"><span class="hl_vardecl"><span class="mpre">doc</span></span></a><span class="mpre">  = </span><a href="#loc_1284_1_1284_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1284_1_1284_10&#39;)"><span class="hl_varref"><span class="mpre">displayIO</span></span></a><span class="mpre"> </span><a href="#loc_1330_9_1330_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1330_9_1330_15&#39;)"><span class="hl_varref"><span class="mpre">handle</span></span></a><span class="mpre"> (</span><a href="#loc_1078_1_1078_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1078_1_1078_13&#39;)"><span class="hl_varref"><span class="mpre">renderPretty</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0.4</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">80</span></span><span class="mpre"> </span><a href="#loc_1330_16_1330_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1330_16_1330_19&#39;)"><span class="hl_varref"><span class="mpre">doc</span></span></a><span class="mpre">)



</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- insert spaces</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &quot;indentation&quot; used to insert tabs but tabs seem to cause</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- more trouble than they solve :-)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------</span></span><span class="mpre">
</span><a href="#loc_1340_1_1340_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1340_1_1340_7&#39;)"><span class="mpre">spaces</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_1340_1_1340_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1340_1_1340_7&#39;)"><span class="hl_fundecl"><span class="mpre">spaces</span></span></a><span class="mpre"> </span><a name="loc_1340_8_1340_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1340_8_1340_9&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre">        | </span><a href="#loc_1340_8_1340_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1340_8_1340_9&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">    = </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">
                | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">replicate</span></span><span class="mpre"> </span><a href="#loc_1340_8_1340_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1340_8_1340_9&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39; &#39;</span></span><span class="mpre">

</span><a href="#loc_1344_1_1344_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1344_1_1344_12&#39;)"><span class="mpre">indentation</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_1344_1_1344_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1344_1_1344_12&#39;)"><span class="hl_fundecl"><span class="mpre">indentation</span></span></a><span class="mpre"> </span><a name="loc_1344_13_1344_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1344_13_1344_14&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre">   = </span><a href="#loc_1340_1_1340_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1340_1_1340_7&#39;)"><span class="hl_varref"><span class="mpre">spaces</span></span></a><span class="mpre"> </span><a href="#loc_1344_13_1344_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_1344_13_1344_14&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">--indentation n   | n &gt;= 8    = &#39;\t&#39; : indentation (n-8)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--                | otherwise = spaces n</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">--  LocalWords:  PPrint combinators Wadler Wadler&#39;s encloseSep</span></span><span class="mpre">
</span></div></body></html>