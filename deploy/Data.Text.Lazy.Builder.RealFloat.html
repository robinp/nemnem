<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE CPP, OverloadedStrings #-}
#if __GLASGOW_HASKELL__ &gt;= 702
{-# LANGUAGE Trustworthy #-}
#endif

</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module:    Data.Text.Lazy.Builder.RealFloat</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright: (c) The University of Glasgow 1994-2002</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License:   see libraries/base/LICENSE</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Write a floating point value to a &#39;Builder&#39;.</span></span><span class="mpre">

module Data.Text.Lazy.Builder.RealFloat
    (
      FPFormat(..)
    , realFloat
    , formatRealFloat
    ) where

import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/Data/Text/Lazy/Builder/RealFloat.hs&quot;, srcSpanStartLine = 20, srcSpanStartColumn = 8, srcSpanEndLine = 20, srcSpanEndColumn = 23}, srcInfoPoints = []}) &quot;Data.Array.Base&quot;"><span class="mpre">Data.Array.Base</span></span><span class="mpre"> (unsafeAt)
import Data.Array.IArray
import Data.Text.Internal.Builder.Functions (</span><a href="Data.Text.Internal.Builder.Functions.html#loc_36_1_36_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Builder.Functions.html#loc_36_1_36_5&#39;)"><span class="mpre">(&lt;&gt;)</span></a><span class="mpre">, </span><a href="Data.Text.Internal.Builder.Functions.html#loc_31_1_31_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Builder.Functions.html#loc_31_1_31_4&#39;)"><span class="mpre">i2d</span></a><span class="mpre">)
import Data.Text.Lazy.Builder.Int (</span><a href="Data.Text.Lazy.Builder.Int.html#loc_63_1_63_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Lazy.Builder.Int.html#loc_63_1_63_8&#39;)"><span class="mpre">decimal</span></a><span class="mpre">)
import Data.Text.Internal.Builder.RealFloat.Functions (</span><a href="Data.Text.Internal.Builder.RealFloat.Functions.html#loc_16_1_16_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Builder.RealFloat.Functions.html#loc_16_1_16_8&#39;)"><span class="mpre">roundTo</span></a><span class="mpre">)
import Data.Text.Lazy.Builder
import qualified Data.Text as T

</span><span class="hl_comment"><span class="mpre">-- | Control the rendering of floating point numbers.</span></span><span class="mpre">
data </span><a name="loc_29_6_29_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_6_29_14&#39;)"><span class="hl_tycondecl"><span class="mpre">FPFormat</span></span></a><span class="mpre"> = </span><a name="loc_29_17_29_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_17_29_25&#39;)"><span class="hl_condecl"><span class="mpre">Exponent</span></span></a><span class="mpre">
              </span><span class="hl_comment"><span class="mpre">-- ^ Scientific notation (e.g. @2.3e123@).</span></span><span class="mpre">
              | </span><a name="loc_31_17_31_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_17_31_22&#39;)"><span class="hl_condecl"><span class="mpre">Fixed</span></span></a><span class="mpre">
              </span><span class="hl_comment"><span class="mpre">-- ^ Standard decimal notation.</span></span><span class="mpre">
              | </span><a name="loc_33_17_33_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_17_33_24&#39;)"><span class="hl_condecl"><span class="mpre">Generic</span></span></a><span class="mpre">
              </span><span class="hl_comment"><span class="mpre">-- ^ Use decimal notation for values between @0.1@ and</span></span><span class="mpre">
              </span><span class="hl_comment"><span class="mpre">-- @9,999,999@, and scientific notation otherwise.</span></span><span class="mpre">
                </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/Data/Text/Lazy/Builder/RealFloat.hs&quot;, srcSpanStartLine = 36, srcSpanStartColumn = 17, srcSpanEndLine = 36, srcSpanEndColumn = 44}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/Data/Text/Lazy/Builder/RealFloat.hs&quot;, srcSpanStartLine = 36, srcSpanStartColumn = 17, srcSpanEndLine = 36, srcSpanEndColumn = 25},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/Data/Text/Lazy"><span class="mpre">deriving (Enum, Read, Show)</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Show a signed &#39;RealFloat&#39; value to full precision,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- using standard decimal notation for arguments whose absolute value lies</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- between @0.1@ and @9,999,999@, and scientific notation otherwise.</span></span><span class="mpre">
</span><a href="#loc_44_1_44_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_1_44_10&#39;)"><span class="mpre">realFloat</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxParen (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/Data/Text/Lazy/Builder/RealFloat.hs&quot;, srcSpanStartLine = 41, srcSpanStartColumn = 14, srcSpanEndLine = 41, srcSpanEndColumn = 30}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/Data/Text/Lazy/Builder/RealFloat.hs&quot;, srcSpanStartLine = 41, srcSpanStartColumn = 14, srcSpanEndLine = 41, srcSpanEndColumn = 15},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/Data/Text/Lazy/"><span class="mpre">(RealFloat a) =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="Data.Text.Internal.Builder.html#loc_86_9_86_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Builder.html#loc_86_9_86_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre">
</span><span class="warning" data-warning="DeclSpecSig (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/Data/Text/Lazy/Builder/RealFloat.hs&quot;, srcSpanStartLine = 42, srcSpanStartColumn = 1, srcSpanEndLine = 42, srcSpanEndColumn = 49}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/Data/Text/Lazy/Builder/RealFloat.hs&quot;, srcSpanStartLine = 42, srcSpanStartColumn = 1, srcSpanEndLine = 42, srcSpanEndColumn = 15},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/Data/Text/Lazy/Bu"><span class="mpre">{-# SPECIALIZE realFloat :: Float -&gt; Builder #-}</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclSpecSig (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/Data/Text/Lazy/Builder/RealFloat.hs&quot;, srcSpanStartLine = 43, srcSpanStartColumn = 1, srcSpanEndLine = 43, srcSpanEndColumn = 50}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/Data/Text/Lazy/Builder/RealFloat.hs&quot;, srcSpanStartLine = 43, srcSpanStartColumn = 1, srcSpanEndLine = 43, srcSpanEndColumn = 15},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/Data/Text/Lazy/Bu"><span class="mpre">{-# SPECIALIZE realFloat :: Double -&gt; Builder #-}</span></span><span class="mpre">
</span><a name="loc_44_1_44_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_1_44_10&#39;)"><span class="hl_fundecl"><span class="mpre">realFloat</span></span></a><span class="mpre"> </span><a name="loc_44_11_44_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_11_44_12&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="#loc_53_1_53_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_1_53_16&#39;)"><span class="hl_varref"><span class="mpre">formatRealFloat</span></span></a><span class="mpre"> </span><a href="#loc_33_17_33_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_17_33_24&#39;)"><span class="hl_conref"><span class="mpre">Generic</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> </span><a href="#loc_44_11_44_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_11_44_12&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">

</span><a href="#loc_53_1_53_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_1_53_16&#39;)"><span class="mpre">formatRealFloat</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxParen (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/Data/Text/Lazy/Builder/RealFloat.hs&quot;, srcSpanStartLine = 46, srcSpanStartColumn = 20, srcSpanEndLine = 46, srcSpanEndColumn = 36}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/Data/Text/Lazy/Builder/RealFloat.hs&quot;, srcSpanStartLine = 46, srcSpanStartColumn = 20, srcSpanEndLine = 46, srcSpanEndColumn = 21},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/Data/Text/Lazy/"><span class="mpre">(RealFloat a) =&gt;</span></span><span class="mpre">
                   </span><a href="#loc_29_6_29_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_6_29_14&#39;)"><span class="hl_tyconref"><span class="mpre">FPFormat</span></span></a><span class="mpre">
                -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- ^ Number of decimal places to render.</span></span><span class="mpre">
                -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
                -&gt; </span><a href="Data.Text.Internal.Builder.html#loc_86_9_86_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Builder.html#loc_86_9_86_16&#39;)"><span class="hl_tyconref"><span class="mpre">Builder</span></span></a><span class="mpre">
</span><span class="warning" data-warning="DeclSpecSig (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/Data/Text/Lazy/Builder/RealFloat.hs&quot;, srcSpanStartLine = 51, srcSpanStartColumn = 1, srcSpanEndLine = 51, srcSpanEndColumn = 80}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/Data/Text/Lazy/Builder/RealFloat.hs&quot;, srcSpanStartLine = 51, srcSpanStartColumn = 1, srcSpanEndLine = 51, srcSpanEndColumn = 15},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/Data/Text/Lazy/Bu"><span class="mpre">{-# SPECIALIZE formatRealFloat :: FPFormat -&gt; Maybe Int -&gt; Float -&gt; Builder #-}</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclSpecSig (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/Data/Text/Lazy/Builder/RealFloat.hs&quot;, srcSpanStartLine = 52, srcSpanStartColumn = 1, srcSpanEndLine = 52, srcSpanEndColumn = 81}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/Data/Text/Lazy/Builder/RealFloat.hs&quot;, srcSpanStartLine = 52, srcSpanStartColumn = 1, srcSpanEndLine = 52, srcSpanEndColumn = 15},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/Data/Text/Lazy/Bu"><span class="mpre">{-# SPECIALIZE formatRealFloat :: FPFormat -&gt; Maybe Int -&gt; Double -&gt; Builder #-}</span></span><span class="mpre">
</span><a name="loc_53_1_53_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_1_53_16&#39;)"><span class="hl_fundecl"><span class="mpre">formatRealFloat</span></span></a><span class="mpre"> </span><a name="loc_53_17_53_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_17_53_20&#39;)"><span class="hl_vardecl"><span class="mpre">fmt</span></span></a><span class="mpre"> </span><a name="loc_53_21_53_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_21_53_25&#39;)"><span class="hl_vardecl"><span class="mpre">decs</span></span></a><span class="mpre"> </span><a name="loc_53_26_53_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_26_53_27&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">
   | </span><span class="hl_varref"><span class="mpre">isNaN</span></span><span class="mpre"> </span><a href="#loc_53_26_53_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_26_53_27&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">                   = </span><span class="hl_string"><span class="mpre">&quot;NaN&quot;</span></span><span class="mpre">
   | </span><span class="hl_varref"><span class="mpre">isInfinite</span></span><span class="mpre"> </span><a href="#loc_53_26_53_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_26_53_27&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">              = if </span><a href="#loc_53_26_53_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_26_53_27&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> then </span><span class="hl_string"><span class="mpre">&quot;-Infinity&quot;</span></span><span class="mpre"> else </span><span class="hl_string"><span class="mpre">&quot;Infinity&quot;</span></span><span class="mpre">
   | </span><a href="#loc_53_26_53_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_26_53_27&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">isNegativeZero</span></span><span class="mpre"> </span><a href="#loc_53_26_53_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_26_53_27&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="Data.Text.Internal.Builder.html#loc_130_1_130_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Builder.html#loc_130_1_130_10&#39;)"><span class="hl_varref"><span class="mpre">singleton</span></span></a><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;-&#39;</span></span><span class="mpre"> </span><a href="Data.Text.Internal.Builder.Functions.html#loc_36_1_36_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Builder.Functions.html#loc_36_1_36_5&#39;)"><span class="hl_infix"><span class="mpre">&lt;&gt;</span></span></a><span class="mpre"> </span><a href="#loc_59_3_59_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_3_59_8&#39;)"><span class="hl_varref"><span class="mpre">doFmt</span></span></a><span class="mpre"> </span><a href="#loc_53_17_53_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_17_53_20&#39;)"><span class="hl_varref"><span class="mpre">fmt</span></span></a><span class="mpre"> (</span><a href="#loc_135_1_135_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_1_135_14&#39;)"><span class="hl_varref"><span class="mpre">floatToDigits</span></span></a><span class="mpre"> (-</span><a href="#loc_53_26_53_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_26_53_27&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">))
   | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">                 = </span><a href="#loc_59_3_59_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_3_59_8&#39;)"><span class="hl_varref"><span class="mpre">doFmt</span></span></a><span class="mpre"> </span><a href="#loc_53_17_53_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_17_53_20&#39;)"><span class="hl_varref"><span class="mpre">fmt</span></span></a><span class="mpre"> (</span><a href="#loc_135_1_135_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_1_135_14&#39;)"><span class="hl_varref"><span class="mpre">floatToDigits</span></span></a><span class="mpre"> </span><a href="#loc_53_26_53_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_26_53_27&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)
 where
  </span><a name="loc_59_3_59_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_3_59_8&#39;)"><span class="hl_fundecl"><span class="mpre">doFmt</span></span></a><span class="mpre"> </span><a name="loc_59_9_59_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_9_59_15&#39;)"><span class="hl_vardecl"><span class="mpre">format</span></span></a><span class="mpre"> (</span><a name="loc_59_17_59_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_17_59_19&#39;)"><span class="hl_vardecl"><span class="mpre">is</span></span></a><span class="mpre">, </span><a name="loc_59_21_59_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_21_59_22&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre">) =
    let </span><a name="loc_60_9_60_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_9_60_11&#39;)"><span class="hl_vardecl"><span class="mpre">ds</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="Data.Text.Internal.Builder.Functions.html#loc_31_1_31_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Builder.Functions.html#loc_31_1_31_4&#39;)"><span class="hl_varref"><span class="mpre">i2d</span></span></a><span class="mpre"> </span><a href="#loc_59_17_59_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_17_59_19&#39;)"><span class="hl_varref"><span class="mpre">is</span></span></a><span class="mpre"> in
    case </span><a href="#loc_59_9_59_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_9_59_15&#39;)"><span class="hl_varref"><span class="mpre">format</span></span></a><span class="mpre"> of
     </span><a href="#loc_33_17_33_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_17_33_24&#39;)"><span class="hl_conref"><span class="mpre">Generic</span></span></a><span class="mpre"> -&gt;
      </span><a href="#loc_59_3_59_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_3_59_8&#39;)"><span class="hl_varref"><span class="mpre">doFmt</span></span></a><span class="mpre"> (if </span><a href="#loc_59_21_59_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_21_59_22&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><a href="#loc_59_21_59_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_21_59_22&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">7</span></span><span class="mpre"> then </span><a href="#loc_29_17_29_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_17_29_25&#39;)"><span class="hl_conref"><span class="mpre">Exponent</span></span></a><span class="mpre"> else </span><a href="#loc_31_17_31_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_17_31_22&#39;)"><span class="hl_conref"><span class="mpre">Fixed</span></span></a><span class="mpre">)
            (</span><a href="#loc_59_17_59_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_17_59_19&#39;)"><span class="hl_varref"><span class="mpre">is</span></span></a><span class="mpre">,</span><a href="#loc_59_21_59_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_21_59_22&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">)
     </span><a href="#loc_29_17_29_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_17_29_25&#39;)"><span class="hl_conref"><span class="mpre">Exponent</span></span></a><span class="mpre"> -&gt;
      case </span><a href="#loc_53_21_53_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_21_53_25&#39;)"><span class="hl_varref"><span class="mpre">decs</span></span></a><span class="mpre"> of
       </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt;
        let </span><a name="loc_68_13_68_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_13_68_20&#39;)"><span class="hl_vardecl"><span class="mpre">show_e&#39;</span></span></a><span class="mpre"> = </span><a href="Data.Text.Lazy.Builder.Int.html#loc_63_1_63_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Lazy.Builder.Int.html#loc_63_1_63_8&#39;)"><span class="hl_varref"><span class="mpre">decimal</span></span></a><span class="mpre"> (</span><a href="#loc_59_21_59_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_21_59_22&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) in
        case </span><a href="#loc_60_9_60_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_9_60_11&#39;)"><span class="hl_varref"><span class="mpre">ds</span></span></a><span class="mpre"> of
          </span><span class="hl_string"><span class="mpre">&quot;0&quot;</span></span><span class="mpre">     -&gt; </span><span class="hl_string"><span class="mpre">&quot;0.0e0&quot;</span></span><span class="mpre">
          [</span><a name="loc_71_12_71_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_12_71_13&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre">]     -&gt; </span><a href="Data.Text.Internal.Builder.html#loc_130_1_130_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Builder.html#loc_130_1_130_10&#39;)"><span class="hl_varref"><span class="mpre">singleton</span></span></a><span class="mpre"> </span><a href="#loc_71_12_71_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_12_71_13&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><a href="Data.Text.Internal.Builder.Functions.html#loc_36_1_36_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Builder.Functions.html#loc_36_1_36_5&#39;)"><span class="hl_infix"><span class="mpre">&lt;&gt;</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;.0e&quot;</span></span><span class="mpre"> </span><a href="Data.Text.Internal.Builder.Functions.html#loc_36_1_36_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Builder.Functions.html#loc_36_1_36_5&#39;)"><span class="hl_infix"><span class="mpre">&lt;&gt;</span></span></a><span class="mpre"> </span><a href="#loc_68_13_68_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_13_68_20&#39;)"><span class="hl_varref"><span class="mpre">show_e&#39;</span></span></a><span class="mpre">
          (</span><a name="loc_72_12_72_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_12_72_13&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_72_14_72_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_14_72_17&#39;)"><span class="hl_vardecl"><span class="mpre">ds&#39;</span></span></a><span class="mpre">) -&gt; </span><a href="Data.Text.Internal.Builder.html#loc_130_1_130_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Builder.html#loc_130_1_130_10&#39;)"><span class="hl_varref"><span class="mpre">singleton</span></span></a><span class="mpre"> </span><a href="#loc_72_12_72_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_12_72_13&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><a href="Data.Text.Internal.Builder.Functions.html#loc_36_1_36_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Builder.Functions.html#loc_36_1_36_5&#39;)"><span class="hl_infix"><span class="mpre">&lt;&gt;</span></span></a><span class="mpre"> </span><a href="Data.Text.Internal.Builder.html#loc_130_1_130_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Builder.html#loc_130_1_130_10&#39;)"><span class="hl_varref"><span class="mpre">singleton</span></span></a><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;.&#39;</span></span><span class="mpre"> </span><a href="Data.Text.Internal.Builder.Functions.html#loc_36_1_36_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Builder.Functions.html#loc_36_1_36_5&#39;)"><span class="hl_infix"><span class="mpre">&lt;&gt;</span></span></a><span class="mpre"> </span><a href="Data.Text.Internal.Builder.html#loc_182_1_182_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Builder.html#loc_182_1_182_11&#39;)"><span class="hl_varref"><span class="mpre">fromString</span></span></a><span class="mpre"> </span><a href="#loc_72_14_72_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_14_72_17&#39;)"><span class="hl_varref"><span class="mpre">ds&#39;</span></span></a><span class="mpre"> </span><a href="Data.Text.Internal.Builder.Functions.html#loc_36_1_36_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Builder.Functions.html#loc_36_1_36_5&#39;)"><span class="hl_infix"><span class="mpre">&lt;&gt;</span></span></a><span class="mpre"> </span><a href="Data.Text.Internal.Builder.html#loc_130_1_130_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Builder.html#loc_130_1_130_10&#39;)"><span class="hl_varref"><span class="mpre">singleton</span></span></a><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;e&#39;</span></span><span class="mpre"> </span><a href="Data.Text.Internal.Builder.Functions.html#loc_36_1_36_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Builder.Functions.html#loc_36_1_36_5&#39;)"><span class="hl_infix"><span class="mpre">&lt;&gt;</span></span></a><span class="mpre"> </span><a href="#loc_68_13_68_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_13_68_20&#39;)"><span class="hl_varref"><span class="mpre">show_e&#39;</span></span></a><span class="mpre">
          []      -&gt; </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;formatRealFloat/doFmt/Exponent: []&quot;</span></span><span class="mpre">
       </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_74_13_74_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_13_74_16&#39;)"><span class="hl_vardecl"><span class="mpre">dec</span></span></a><span class="mpre"> -&gt;
        let </span><a name="loc_75_13_75_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_13_75_17&#39;)"><span class="hl_vardecl"><span class="mpre">dec&#39;</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">max</span></span><span class="mpre"> </span><a href="#loc_74_13_74_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_13_74_16&#39;)"><span class="hl_varref"><span class="mpre">dec</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> in
        case </span><a href="#loc_59_17_59_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_17_59_19&#39;)"><span class="hl_varref"><span class="mpre">is</span></span></a><span class="mpre"> of
         [</span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">] -&gt; </span><span class="hl_string"><span class="mpre">&quot;0.&quot;</span></span><span class="mpre"> </span><a href="Data.Text.Internal.Builder.Functions.html#loc_36_1_36_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Builder.Functions.html#loc_36_1_36_5&#39;)"><span class="hl_infix"><span class="mpre">&lt;&gt;</span></span></a><span class="mpre"> </span><a href="Data.Text.Internal.Builder.html#loc_166_1_166_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Builder.html#loc_166_1_166_9&#39;)"><span class="hl_varref"><span class="mpre">fromText</span></span></a><span class="mpre"> (</span><a href="Data.Text.html#loc_962_1_962_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.html#loc_962_1_962_10&#39;)"><span class="hl_varref"><span class="mpre">T.replicate</span></span></a><span class="mpre"> </span><a href="#loc_75_13_75_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_13_75_17&#39;)"><span class="hl_varref"><span class="mpre">dec&#39;</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;0&quot;</span></span><span class="mpre">) </span><a href="Data.Text.Internal.Builder.Functions.html#loc_36_1_36_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Builder.Functions.html#loc_36_1_36_5&#39;)"><span class="hl_infix"><span class="mpre">&lt;&gt;</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;e0&quot;</span></span><span class="mpre">
         _ -&gt;
          let
           (</span><a name="loc_80_13_80_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_13_80_15&#39;)"><span class="hl_vardecl"><span class="mpre">ei</span></span></a><span class="mpre">,</span><a name="loc_80_16_80_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_16_80_19&#39;)"><span class="hl_vardecl"><span class="mpre">is&#39;</span></span></a><span class="mpre">) = </span><a href="Data.Text.Internal.Builder.RealFloat.Functions.html#loc_16_1_16_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Builder.RealFloat.Functions.html#loc_16_1_16_8&#39;)"><span class="hl_varref"><span class="mpre">roundTo</span></span></a><span class="mpre"> (</span><a href="#loc_75_13_75_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_13_75_17&#39;)"><span class="hl_varref"><span class="mpre">dec&#39;</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_59_17_59_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_17_59_19&#39;)"><span class="hl_varref"><span class="mpre">is</span></span></a><span class="mpre">
           (</span><a name="loc_81_13_81_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_13_81_14&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_81_15_81_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_15_81_18&#39;)"><span class="hl_vardecl"><span class="mpre">ds&#39;</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="Data.Text.Internal.Builder.Functions.html#loc_31_1_31_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Builder.Functions.html#loc_31_1_31_4&#39;)"><span class="hl_varref"><span class="mpre">i2d</span></span></a><span class="mpre"> (if </span><a href="#loc_80_13_80_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_13_80_15&#39;)"><span class="hl_varref"><span class="mpre">ei</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> then </span><span class="hl_varref"><span class="mpre">init</span></span><span class="mpre"> </span><a href="#loc_80_16_80_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_16_80_19&#39;)"><span class="hl_varref"><span class="mpre">is&#39;</span></span></a><span class="mpre"> else </span><a href="#loc_80_16_80_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_16_80_19&#39;)"><span class="hl_varref"><span class="mpre">is&#39;</span></span></a><span class="mpre">)
          in
          </span><a href="Data.Text.Internal.Builder.html#loc_130_1_130_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Builder.html#loc_130_1_130_10&#39;)"><span class="hl_varref"><span class="mpre">singleton</span></span></a><span class="mpre"> </span><a href="#loc_81_13_81_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_13_81_14&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><a href="Data.Text.Internal.Builder.Functions.html#loc_36_1_36_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Builder.Functions.html#loc_36_1_36_5&#39;)"><span class="hl_infix"><span class="mpre">&lt;&gt;</span></span></a><span class="mpre"> </span><a href="Data.Text.Internal.Builder.html#loc_130_1_130_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Builder.html#loc_130_1_130_10&#39;)"><span class="hl_varref"><span class="mpre">singleton</span></span></a><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;.&#39;</span></span><span class="mpre"> </span><a href="Data.Text.Internal.Builder.Functions.html#loc_36_1_36_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Builder.Functions.html#loc_36_1_36_5&#39;)"><span class="hl_infix"><span class="mpre">&lt;&gt;</span></span></a><span class="mpre"> </span><a href="Data.Text.Internal.Builder.html#loc_182_1_182_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Builder.html#loc_182_1_182_11&#39;)"><span class="hl_varref"><span class="mpre">fromString</span></span></a><span class="mpre"> </span><a href="#loc_81_15_81_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_15_81_18&#39;)"><span class="hl_varref"><span class="mpre">ds&#39;</span></span></a><span class="mpre"> </span><a href="Data.Text.Internal.Builder.Functions.html#loc_36_1_36_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Builder.Functions.html#loc_36_1_36_5&#39;)"><span class="hl_infix"><span class="mpre">&lt;&gt;</span></span></a><span class="mpre"> </span><a href="Data.Text.Internal.Builder.html#loc_130_1_130_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Builder.html#loc_130_1_130_10&#39;)"><span class="hl_varref"><span class="mpre">singleton</span></span></a><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;e&#39;</span></span><span class="mpre"> </span><a href="Data.Text.Internal.Builder.Functions.html#loc_36_1_36_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Builder.Functions.html#loc_36_1_36_5&#39;)"><span class="hl_infix"><span class="mpre">&lt;&gt;</span></span></a><span class="mpre"> </span><a href="Data.Text.Lazy.Builder.Int.html#loc_63_1_63_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Lazy.Builder.Int.html#loc_63_1_63_8&#39;)"><span class="hl_varref"><span class="mpre">decimal</span></span></a><span class="mpre"> (</span><a href="#loc_59_21_59_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_21_59_22&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="hl_infix"><span class="mpre">+</span></span><a href="#loc_80_13_80_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_13_80_15&#39;)"><span class="hl_varref"><span class="mpre">ei</span></span></a><span class="mpre">)
     </span><a href="#loc_31_17_31_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_17_31_22&#39;)"><span class="hl_conref"><span class="mpre">Fixed</span></span></a><span class="mpre"> -&gt;
      let
       </span><a name="loc_86_8_86_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_8_86_11&#39;)"><span class="hl_fundecl"><span class="mpre">mk0</span></span></a><span class="mpre"> </span><a name="loc_86_12_86_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_12_86_14&#39;)"><span class="hl_vardecl"><span class="mpre">ls</span></span></a><span class="mpre"> = case </span><a href="#loc_86_12_86_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_12_86_14&#39;)"><span class="hl_varref"><span class="mpre">ls</span></span></a><span class="mpre"> of { </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre"> -&gt; </span><span class="hl_string"><span class="mpre">&quot;0&quot;</span></span><span class="mpre"> ; _ -&gt; </span><a href="Data.Text.Internal.Builder.html#loc_182_1_182_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Builder.html#loc_182_1_182_11&#39;)"><span class="hl_varref"><span class="mpre">fromString</span></span></a><span class="mpre"> </span><a href="#loc_86_12_86_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_12_86_14&#39;)"><span class="hl_varref"><span class="mpre">ls</span></span></a><span class="mpre">}
      in
      case </span><a href="#loc_53_21_53_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_21_53_25&#39;)"><span class="hl_varref"><span class="mpre">decs</span></span></a><span class="mpre"> of
       </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
          | </span><a href="#loc_59_21_59_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_21_59_22&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">    -&gt; </span><span class="hl_string"><span class="mpre">&quot;0.&quot;</span></span><span class="mpre"> </span><a href="Data.Text.Internal.Builder.Functions.html#loc_36_1_36_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Builder.Functions.html#loc_36_1_36_5&#39;)"><span class="hl_infix"><span class="mpre">&lt;&gt;</span></span></a><span class="mpre"> </span><a href="Data.Text.Internal.Builder.html#loc_166_1_166_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Builder.html#loc_166_1_166_9&#39;)"><span class="hl_varref"><span class="mpre">fromText</span></span></a><span class="mpre"> (</span><a href="Data.Text.html#loc_962_1_962_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.html#loc_962_1_962_10&#39;)"><span class="hl_varref"><span class="mpre">T.replicate</span></span></a><span class="mpre"> (-</span><a href="#loc_59_21_59_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_21_59_22&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">) </span><span class="hl_string"><span class="mpre">&quot;0&quot;</span></span><span class="mpre">) </span><a href="Data.Text.Internal.Builder.Functions.html#loc_36_1_36_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Builder.Functions.html#loc_36_1_36_5&#39;)"><span class="hl_infix"><span class="mpre">&lt;&gt;</span></span></a><span class="mpre"> </span><a href="Data.Text.Internal.Builder.html#loc_182_1_182_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Builder.html#loc_182_1_182_11&#39;)"><span class="hl_varref"><span class="mpre">fromString</span></span></a><span class="mpre"> </span><a href="#loc_60_9_60_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_9_60_11&#39;)"><span class="hl_varref"><span class="mpre">ds</span></span></a><span class="mpre">
          | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> -&gt;
             let
                </span><a name="loc_93_17_93_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_17_93_18&#39;)"><span class="hl_fundecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a name="loc_93_21_93_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_21_93_22&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">    </span><a name="loc_93_26_93_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_26_93_28&#39;)"><span class="hl_vardecl"><span class="mpre">rs</span></span></a><span class="mpre">  = </span><a href="#loc_86_8_86_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_8_86_11&#39;)"><span class="hl_varref"><span class="mpre">mk0</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><a href="#loc_93_21_93_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_21_93_22&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">) </span><a href="Data.Text.Internal.Builder.Functions.html#loc_36_1_36_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Builder.Functions.html#loc_36_1_36_5&#39;)"><span class="hl_infix"><span class="mpre">&lt;&gt;</span></span></a><span class="mpre"> </span><a href="Data.Text.Internal.Builder.html#loc_130_1_130_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Builder.html#loc_130_1_130_10&#39;)"><span class="hl_varref"><span class="mpre">singleton</span></span></a><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;.&#39;</span></span><span class="mpre"> </span><a href="Data.Text.Internal.Builder.Functions.html#loc_36_1_36_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Builder.Functions.html#loc_36_1_36_5&#39;)"><span class="hl_infix"><span class="mpre">&lt;&gt;</span></span></a><span class="mpre"> </span><a href="#loc_86_8_86_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_8_86_11&#39;)"><span class="hl_varref"><span class="mpre">mk0</span></span></a><span class="mpre"> </span><a href="#loc_93_26_93_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_26_93_28&#39;)"><span class="hl_varref"><span class="mpre">rs</span></span></a><span class="mpre">
                </span><a href="#loc_93_17_93_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_17_93_18&#39;)"><span class="hl_fundecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_94_19_94_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_19_94_20&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_94_21_94_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_21_94_22&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">    </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">  = </span><a href="#loc_93_17_93_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_17_93_18&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_94_19_94_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_19_94_20&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) (</span><span class="hl_char"><span class="mpre">&#39;0&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_94_21_94_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_21_94_22&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">) </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">
                </span><a href="#loc_93_17_93_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_17_93_18&#39;)"><span class="hl_fundecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_95_19_95_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_19_95_20&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_95_21_95_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_21_95_22&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> (</span><a name="loc_95_24_95_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_24_95_25&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_95_26_95_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_26_95_28&#39;)"><span class="hl_vardecl"><span class="mpre">rs</span></span></a><span class="mpre">) = </span><a href="#loc_93_17_93_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_17_93_18&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_95_19_95_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_19_95_20&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) (</span><a href="#loc_95_24_95_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_24_95_25&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_95_21_95_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_21_95_22&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">) </span><a href="#loc_95_26_95_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_26_95_28&#39;)"><span class="hl_varref"><span class="mpre">rs</span></span></a><span class="mpre">
             in
                </span><a href="#loc_93_17_93_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_17_93_18&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_59_21_59_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_21_59_22&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre"> </span><a href="#loc_60_9_60_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_9_60_11&#39;)"><span class="hl_varref"><span class="mpre">ds</span></span></a><span class="mpre">
       </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_98_13_98_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_13_98_16&#39;)"><span class="hl_vardecl"><span class="mpre">dec</span></span></a><span class="mpre"> -&gt;
        let </span><a name="loc_99_13_99_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_13_99_17&#39;)"><span class="hl_vardecl"><span class="mpre">dec&#39;</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">max</span></span><span class="mpre"> </span><a href="#loc_98_13_98_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_13_98_16&#39;)"><span class="hl_varref"><span class="mpre">dec</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> in
        if </span><a href="#loc_59_21_59_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_21_59_22&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> then
         let
          (</span><a name="loc_102_12_102_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_12_102_14&#39;)"><span class="hl_vardecl"><span class="mpre">ei</span></span></a><span class="mpre">,</span><a name="loc_102_15_102_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_15_102_18&#39;)"><span class="hl_vardecl"><span class="mpre">is&#39;</span></span></a><span class="mpre">) = </span><a href="Data.Text.Internal.Builder.RealFloat.Functions.html#loc_16_1_16_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Builder.RealFloat.Functions.html#loc_16_1_16_8&#39;)"><span class="hl_varref"><span class="mpre">roundTo</span></span></a><span class="mpre"> (</span><a href="#loc_99_13_99_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_13_99_17&#39;)"><span class="hl_varref"><span class="mpre">dec&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_59_21_59_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_21_59_22&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">) </span><a href="#loc_59_17_59_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_17_59_19&#39;)"><span class="hl_varref"><span class="mpre">is</span></span></a><span class="mpre">
          (</span><a name="loc_103_12_103_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_12_103_14&#39;)"><span class="hl_vardecl"><span class="mpre">ls</span></span></a><span class="mpre">,</span><a name="loc_103_15_103_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_15_103_17&#39;)"><span class="hl_vardecl"><span class="mpre">rs</span></span></a><span class="mpre">)  = </span><span class="hl_varref"><span class="mpre">splitAt</span></span><span class="mpre"> (</span><a href="#loc_59_21_59_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_21_59_22&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><a href="#loc_102_12_102_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_12_102_14&#39;)"><span class="hl_varref"><span class="mpre">ei</span></span></a><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="Data.Text.Internal.Builder.Functions.html#loc_31_1_31_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Builder.Functions.html#loc_31_1_31_4&#39;)"><span class="hl_varref"><span class="mpre">i2d</span></span></a><span class="mpre"> </span><a href="#loc_102_15_102_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_15_102_18&#39;)"><span class="hl_varref"><span class="mpre">is&#39;</span></span></a><span class="mpre">)
         in
         </span><a href="#loc_86_8_86_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_8_86_11&#39;)"><span class="hl_varref"><span class="mpre">mk0</span></span></a><span class="mpre"> </span><a href="#loc_103_12_103_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_12_103_14&#39;)"><span class="hl_varref"><span class="mpre">ls</span></span></a><span class="mpre"> </span><a href="Data.Text.Internal.Builder.Functions.html#loc_36_1_36_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Builder.Functions.html#loc_36_1_36_5&#39;)"><span class="hl_infix"><span class="mpre">&lt;&gt;</span></span></a><span class="mpre"> (if </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_103_15_103_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_15_103_17&#39;)"><span class="hl_varref"><span class="mpre">rs</span></span></a><span class="mpre"> then </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre"> else </span><a href="Data.Text.Internal.Builder.html#loc_130_1_130_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Builder.html#loc_130_1_130_10&#39;)"><span class="hl_varref"><span class="mpre">singleton</span></span></a><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;.&#39;</span></span><span class="mpre"> </span><a href="Data.Text.Internal.Builder.Functions.html#loc_36_1_36_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Builder.Functions.html#loc_36_1_36_5&#39;)"><span class="hl_infix"><span class="mpre">&lt;&gt;</span></span></a><span class="mpre"> </span><a href="Data.Text.Internal.Builder.html#loc_182_1_182_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Builder.html#loc_182_1_182_11&#39;)"><span class="hl_varref"><span class="mpre">fromString</span></span></a><span class="mpre"> </span><a href="#loc_103_15_103_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_15_103_17&#39;)"><span class="hl_varref"><span class="mpre">rs</span></span></a><span class="mpre">)
        else
         let
          (</span><a name="loc_108_12_108_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_12_108_14&#39;)"><span class="hl_vardecl"><span class="mpre">ei</span></span></a><span class="mpre">,</span><a name="loc_108_15_108_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_15_108_18&#39;)"><span class="hl_vardecl"><span class="mpre">is&#39;</span></span></a><span class="mpre">) = </span><a href="Data.Text.Internal.Builder.RealFloat.Functions.html#loc_16_1_16_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Builder.RealFloat.Functions.html#loc_16_1_16_8&#39;)"><span class="hl_varref"><span class="mpre">roundTo</span></span></a><span class="mpre"> </span><a href="#loc_99_13_99_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_13_99_17&#39;)"><span class="hl_varref"><span class="mpre">dec&#39;</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">replicate</span></span><span class="mpre"> (-</span><a href="#loc_59_21_59_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_21_59_22&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">) </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_59_17_59_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_17_59_19&#39;)"><span class="hl_varref"><span class="mpre">is</span></span></a><span class="mpre">)
          </span><a name="loc_109_11_109_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_11_109_12&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_109_13_109_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_13_109_16&#39;)"><span class="hl_vardecl"><span class="mpre">ds&#39;</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="Data.Text.Internal.Builder.Functions.html#loc_31_1_31_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Builder.Functions.html#loc_31_1_31_4&#39;)"><span class="hl_varref"><span class="mpre">i2d</span></span></a><span class="mpre"> (if </span><a href="#loc_108_12_108_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_12_108_14&#39;)"><span class="hl_varref"><span class="mpre">ei</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> then </span><a href="#loc_108_15_108_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_15_108_18&#39;)"><span class="hl_varref"><span class="mpre">is&#39;</span></span></a><span class="mpre"> else </span><span class="hl_num"><span class="mpre">0</span></span><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_108_15_108_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_15_108_18&#39;)"><span class="hl_varref"><span class="mpre">is&#39;</span></span></a><span class="mpre">)
         in
         </span><a href="Data.Text.Internal.Builder.html#loc_130_1_130_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Builder.html#loc_130_1_130_10&#39;)"><span class="hl_varref"><span class="mpre">singleton</span></span></a><span class="mpre"> </span><a href="#loc_109_11_109_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_11_109_12&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><a href="Data.Text.Internal.Builder.Functions.html#loc_36_1_36_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Builder.Functions.html#loc_36_1_36_5&#39;)"><span class="hl_infix"><span class="mpre">&lt;&gt;</span></span></a><span class="mpre"> (if </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_109_13_109_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_13_109_16&#39;)"><span class="hl_varref"><span class="mpre">ds&#39;</span></span></a><span class="mpre"> then </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre"> else </span><a href="Data.Text.Internal.Builder.html#loc_130_1_130_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Builder.html#loc_130_1_130_10&#39;)"><span class="hl_varref"><span class="mpre">singleton</span></span></a><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;.&#39;</span></span><span class="mpre"> </span><a href="Data.Text.Internal.Builder.Functions.html#loc_36_1_36_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Builder.Functions.html#loc_36_1_36_5&#39;)"><span class="hl_infix"><span class="mpre">&lt;&gt;</span></span></a><span class="mpre"> </span><a href="Data.Text.Internal.Builder.html#loc_182_1_182_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Builder.html#loc_182_1_182_11&#39;)"><span class="hl_varref"><span class="mpre">fromString</span></span></a><span class="mpre"> </span><a href="#loc_109_13_109_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_13_109_16&#39;)"><span class="hl_varref"><span class="mpre">ds&#39;</span></span></a><span class="mpre">)


</span><span class="hl_comment"><span class="mpre">-- Based on &quot;Printing Floating-Point Numbers Quickly and Accurately&quot;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- by R.G. Burger and R.K. Dybvig in PLDI 96.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This version uses a much slower logarithm estimator. It should be improved.</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | &#39;floatToDigits&#39; takes a base and a non-negative &#39;RealFloat&#39; number,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- and returns a list of digits and an exponent.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- In particular, if @x&gt;=0@, and</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &gt; floatToDigits base x = ([d1,d2,...,dn], e)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- then</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--      (1) @n &gt;= 1@</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--      (2) @x = 0.d1d2...dn * (base**e)@</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--      (3) @0 &lt;= di &lt;= base-1@</span></span><span class="mpre">

</span><a href="#loc_135_1_135_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_1_135_14&#39;)"><span class="mpre">floatToDigits</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxParen (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/Data/Text/Lazy/Builder/RealFloat.hs&quot;, srcSpanStartLine = 132, srcSpanStartColumn = 18, srcSpanEndLine = 132, srcSpanEndColumn = 34}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/Data/Text/Lazy/Builder/RealFloat.hs&quot;, srcSpanStartLine = 132, srcSpanStartColumn = 18, srcSpanEndLine = 132, srcSpanEndColumn = 19},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/Data/Text/L"><span class="mpre">(RealFloat a) =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; ([</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">], </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">)
</span><span class="warning" data-warning="DeclSpecSig (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/Data/Text/Lazy/Builder/RealFloat.hs&quot;, srcSpanStartLine = 133, srcSpanStartColumn = 1, srcSpanEndLine = 133, srcSpanEndColumn = 58}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/Data/Text/Lazy/Builder/RealFloat.hs&quot;, srcSpanStartLine = 133, srcSpanStartColumn = 1, srcSpanEndLine = 133, srcSpanEndColumn = 15},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/Data/Text/Laz"><span class="mpre">{-# SPECIALIZE floatToDigits :: Float -&gt; ([Int], Int) #-}</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclSpecSig (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/Data/Text/Lazy/Builder/RealFloat.hs&quot;, srcSpanStartLine = 134, srcSpanStartColumn = 1, srcSpanEndLine = 134, srcSpanEndColumn = 59}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/Data/Text/Lazy/Builder/RealFloat.hs&quot;, srcSpanStartLine = 134, srcSpanStartColumn = 1, srcSpanEndLine = 134, srcSpanEndColumn = 15},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/Data/Text/Laz"><span class="mpre">{-# SPECIALIZE floatToDigits :: Double -&gt; ([Int], Int) #-}</span></span><span class="mpre">
</span><a name="loc_135_1_135_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_1_135_14&#39;)"><span class="hl_fundecl"><span class="mpre">floatToDigits</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> = ([</span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">], </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">)
</span><a href="#loc_135_1_135_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_1_135_14&#39;)"><span class="hl_fundecl"><span class="mpre">floatToDigits</span></span></a><span class="mpre"> </span><a name="loc_136_15_136_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_15_136_16&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> =
 let
  (</span><a name="loc_138_4_138_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_4_138_6&#39;)"><span class="hl_vardecl"><span class="mpre">f0</span></span></a><span class="mpre">, </span><a name="loc_138_8_138_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_8_138_10&#39;)"><span class="hl_vardecl"><span class="mpre">e0</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">decodeFloat</span></span><span class="mpre"> </span><a href="#loc_136_15_136_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_15_136_16&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
  (</span><a name="loc_139_4_139_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_4_139_11&#39;)"><span class="hl_vardecl"><span class="mpre">minExp0</span></span></a><span class="mpre">, _) = </span><span class="hl_varref"><span class="mpre">floatRange</span></span><span class="mpre"> </span><a href="#loc_136_15_136_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_15_136_16&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
  </span><a name="loc_140_3_140_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_3_140_4&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">floatDigits</span></span><span class="mpre"> </span><a href="#loc_136_15_136_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_15_136_16&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
  </span><a name="loc_141_3_141_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_3_141_4&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">floatRadix</span></span><span class="mpre"> </span><a href="#loc_136_15_136_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_15_136_16&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
  </span><a name="loc_142_3_142_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_3_142_9&#39;)"><span class="hl_vardecl"><span class="mpre">minExp</span></span></a><span class="mpre"> = </span><a href="#loc_139_4_139_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_4_139_11&#39;)"><span class="hl_varref"><span class="mpre">minExp0</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_140_3_140_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_3_140_4&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- the real minimum exponent</span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">-- Haskell requires that f be adjusted so denormalized numbers</span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">-- will have an impossibly low exponent.  Adjust for this.</span></span><span class="mpre">
  (</span><a name="loc_145_4_145_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_4_145_5&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">, </span><a name="loc_145_7_145_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_7_145_8&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre">) =
   let </span><a name="loc_146_8_146_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_8_146_9&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> = </span><a href="#loc_142_3_142_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_3_142_9&#39;)"><span class="hl_varref"><span class="mpre">minExp</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_138_8_138_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_8_138_10&#39;)"><span class="hl_varref"><span class="mpre">e0</span></span></a><span class="mpre"> in
   if </span><a href="#loc_146_8_146_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_8_146_9&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> then (</span><a href="#loc_138_4_138_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_4_138_6&#39;)"><span class="hl_varref"><span class="mpre">f0</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`quot`</span></span><span class="mpre"> (</span><a href="#loc_230_1_230_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_1_230_5&#39;)"><span class="hl_varref"><span class="mpre">expt</span></span></a><span class="mpre"> </span><a href="#loc_141_3_141_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_3_141_4&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> </span><a href="#loc_146_8_146_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_8_146_9&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">), </span><a href="#loc_138_8_138_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_8_138_10&#39;)"><span class="hl_varref"><span class="mpre">e0</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><a href="#loc_146_8_146_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_8_146_9&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">) else (</span><a href="#loc_138_4_138_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_4_138_6&#39;)"><span class="hl_varref"><span class="mpre">f0</span></span></a><span class="mpre">, </span><a href="#loc_138_8_138_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_8_138_10&#39;)"><span class="hl_varref"><span class="mpre">e0</span></span></a><span class="mpre">)
  (</span><a name="loc_148_4_148_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_4_148_5&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">, </span><a name="loc_148_7_148_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_7_148_8&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">, </span><a name="loc_148_10_148_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_10_148_13&#39;)"><span class="hl_vardecl"><span class="mpre">mUp</span></span></a><span class="mpre">, </span><a name="loc_148_15_148_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_15_148_18&#39;)"><span class="hl_vardecl"><span class="mpre">mDn</span></span></a><span class="mpre">) =
   if </span><a href="#loc_145_7_145_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_7_145_8&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> then
    let </span><a name="loc_150_9_150_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_9_150_11&#39;)"><span class="hl_vardecl"><span class="mpre">be</span></span></a><span class="mpre"> = </span><a href="#loc_230_1_230_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_1_230_5&#39;)"><span class="hl_varref"><span class="mpre">expt</span></span></a><span class="mpre"> </span><a href="#loc_141_3_141_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_3_141_4&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> </span><a href="#loc_145_7_145_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_7_145_8&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre"> in
    if </span><a href="#loc_145_4_145_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_4_145_5&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_230_1_230_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_1_230_5&#39;)"><span class="hl_varref"><span class="mpre">expt</span></span></a><span class="mpre"> </span><a href="#loc_141_3_141_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_3_141_4&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> (</span><a href="#loc_140_3_140_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_3_140_4&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) then
      (</span><a href="#loc_145_4_145_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_4_145_5&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="hl_infix"><span class="mpre">*</span></span><a href="#loc_150_9_150_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_9_150_11&#39;)"><span class="hl_varref"><span class="mpre">be</span></span></a><span class="hl_infix"><span class="mpre">*</span></span><a href="#loc_141_3_141_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_3_141_4&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="hl_infix"><span class="mpre">*</span></span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">2</span></span><span class="hl_infix"><span class="mpre">*</span></span><a href="#loc_141_3_141_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_3_141_4&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">, </span><a href="#loc_150_9_150_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_9_150_11&#39;)"><span class="hl_varref"><span class="mpre">be</span></span></a><span class="hl_infix"><span class="mpre">*</span></span><a href="#loc_141_3_141_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_3_141_4&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">, </span><a href="#loc_150_9_150_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_9_150_11&#39;)"><span class="hl_varref"><span class="mpre">be</span></span></a><span class="mpre">)     </span><span class="hl_comment"><span class="mpre">-- according to Burger and Dybvig</span></span><span class="mpre">
    else
      (</span><a href="#loc_145_4_145_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_4_145_5&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="hl_infix"><span class="mpre">*</span></span><a href="#loc_150_9_150_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_9_150_11&#39;)"><span class="hl_varref"><span class="mpre">be</span></span></a><span class="hl_infix"><span class="mpre">*</span></span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">, </span><a href="#loc_150_9_150_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_9_150_11&#39;)"><span class="hl_varref"><span class="mpre">be</span></span></a><span class="mpre">, </span><a href="#loc_150_9_150_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_9_150_11&#39;)"><span class="hl_varref"><span class="mpre">be</span></span></a><span class="mpre">)
   else
    if </span><a href="#loc_145_7_145_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_7_145_8&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><a href="#loc_142_3_142_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_3_142_9&#39;)"><span class="hl_varref"><span class="mpre">minExp</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_145_4_145_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_4_145_5&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_230_1_230_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_1_230_5&#39;)"><span class="hl_varref"><span class="mpre">expt</span></span></a><span class="mpre"> </span><a href="#loc_141_3_141_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_3_141_4&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> (</span><a href="#loc_140_3_140_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_3_140_4&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) then
      (</span><a href="#loc_145_4_145_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_4_145_5&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="hl_infix"><span class="mpre">*</span></span><a href="#loc_141_3_141_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_3_141_4&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="hl_infix"><span class="mpre">*</span></span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">, </span><a href="#loc_230_1_230_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_1_230_5&#39;)"><span class="hl_varref"><span class="mpre">expt</span></span></a><span class="mpre"> </span><a href="#loc_141_3_141_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_3_141_4&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> (-</span><a href="#loc_145_7_145_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_7_145_8&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)</span><span class="hl_infix"><span class="mpre">*</span></span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">, </span><a href="#loc_141_3_141_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_3_141_4&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">, </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
    else
      (</span><a href="#loc_145_4_145_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_4_145_5&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="hl_infix"><span class="mpre">*</span></span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">, </span><a href="#loc_230_1_230_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_1_230_5&#39;)"><span class="hl_varref"><span class="mpre">expt</span></span></a><span class="mpre"> </span><a href="#loc_141_3_141_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_3_141_4&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> (-</span><a href="#loc_145_7_145_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_7_145_8&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">*</span></span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
  </span><a href="#loc_161_3_161_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_3_161_4&#39;)"><span class="mpre">k</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
  </span><a name="loc_161_3_161_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_3_161_4&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> =
   let
    </span><a href="#loc_164_5_164_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_5_164_7&#39;)"><span class="mpre">k0</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
    </span><a name="loc_164_5_164_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_5_164_7&#39;)"><span class="hl_vardecl"><span class="mpre">k0</span></span></a><span class="mpre"> =
     if </span><a href="#loc_141_3_141_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_3_141_4&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre"> then
        </span><span class="hl_comment"><span class="mpre">-- logBase 10 2 is very slightly larger than 8651/28738</span></span><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">-- (about 5.3558e-10), so if log x &gt;= 0, the approximation</span></span><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">-- k1 is too small, hence we add one and need one fixup step less.</span></span><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">-- If log x &lt; 0, the approximation errs rather on the high side.</span></span><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">-- That is usually more than compensated for by ignoring the</span></span><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">-- fractional part of logBase 2 x, but when x is a power of 1/2</span></span><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">-- or slightly larger and the exponent is a multiple of the</span></span><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">-- denominator of the rational approximation to logBase 10 2,</span></span><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">-- k1 is larger than logBase 10 x. If k1 &gt; 1 + logBase 10 x,</span></span><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">-- we get a leading zero-digit we don&#39;t want.</span></span><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">-- With the approximation 3/10, this happened for</span></span><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">-- 0.5^1030, 0.5^1040, ..., 0.5^1070 and values close above.</span></span><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">-- The approximation 8651/28738 guarantees k1 &lt; 1 + logBase 10 x</span></span><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">-- for IEEE-ish floating point types with exponent fields</span></span><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">-- &lt;= 17 bits and mantissae of several thousand bits, earlier</span></span><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">-- convergents to logBase 10 2 would fail for long double.</span></span><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">-- Using quot instead of div is a little faster and requires</span></span><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">-- fewer fixup steps for negative lx.</span></span><span class="mpre">
        let </span><a name="loc_184_13_184_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_184_13_184_15&#39;)"><span class="hl_vardecl"><span class="mpre">lx</span></span></a><span class="mpre"> = </span><a href="#loc_140_3_140_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_3_140_4&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_138_8_138_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_8_138_10&#39;)"><span class="hl_varref"><span class="mpre">e0</span></span></a><span class="mpre">
            </span><a name="loc_185_13_185_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_13_185_15&#39;)"><span class="hl_vardecl"><span class="mpre">k1</span></span></a><span class="mpre"> = (</span><a href="#loc_184_13_184_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_184_13_184_15&#39;)"><span class="hl_varref"><span class="mpre">lx</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">8651</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">`quot`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">28738</span></span><span class="mpre">
        in if </span><a href="#loc_184_13_184_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_184_13_184_15&#39;)"><span class="hl_varref"><span class="mpre">lx</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> then </span><a href="#loc_185_13_185_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_13_185_15&#39;)"><span class="hl_varref"><span class="mpre">k1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> else </span><a href="#loc_185_13_185_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_13_185_15&#39;)"><span class="hl_varref"><span class="mpre">k1</span></span></a><span class="mpre">
     else
        </span><span class="hl_comment"><span class="mpre">-- f :: Integer, log :: Float -&gt; Float,</span></span><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">--               ceiling :: Float -&gt; Int</span></span><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">ceiling</span></span><span class="mpre"> ((</span><span class="hl_varref"><span class="mpre">log</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromInteger</span></span><span class="mpre"> (</span><a href="#loc_145_4_145_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_4_145_5&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) :: </span><span class="hl_tyconref"><span class="mpre">Float</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre">
                 </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_145_7_145_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_7_145_8&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">log</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromInteger</span></span><span class="mpre"> </span><a href="#loc_141_3_141_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_3_141_4&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">)) </span><span class="hl_infix"><span class="mpre">/</span></span><span class="mpre">
                   </span><span class="hl_varref"><span class="mpre">log</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre">)
</span><span class="hl_comment"><span class="mpre">--WAS:            fromInt e * log (fromInteger b))</span></span><span class="mpre">

    </span><a name="loc_195_5_195_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_5_195_10&#39;)"><span class="hl_fundecl"><span class="mpre">fixup</span></span></a><span class="mpre"> </span><a name="loc_195_11_195_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_11_195_12&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> =
      if </span><a href="#loc_195_11_195_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_11_195_12&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> then
        if </span><a href="#loc_148_4_148_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_4_148_5&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_148_10_148_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_10_148_13&#39;)"><span class="hl_varref"><span class="mpre">mUp</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><a href="#loc_230_1_230_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_1_230_5&#39;)"><span class="hl_varref"><span class="mpre">expt</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre"> </span><a href="#loc_195_11_195_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_11_195_12&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><a href="#loc_148_7_148_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_7_148_8&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> then </span><a href="#loc_195_11_195_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_11_195_12&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> else </span><a href="#loc_195_5_195_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_5_195_10&#39;)"><span class="hl_varref"><span class="mpre">fixup</span></span></a><span class="mpre"> (</span><a href="#loc_195_11_195_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_11_195_12&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
      else
        if </span><a href="#loc_230_1_230_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_1_230_5&#39;)"><span class="hl_varref"><span class="mpre">expt</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre"> (-</span><a href="#loc_195_11_195_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_11_195_12&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> (</span><a href="#loc_148_4_148_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_4_148_5&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_148_10_148_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_10_148_13&#39;)"><span class="hl_varref"><span class="mpre">mUp</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><a href="#loc_148_7_148_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_7_148_8&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> then </span><a href="#loc_195_11_195_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_11_195_12&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> else </span><a href="#loc_195_5_195_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_5_195_10&#39;)"><span class="hl_varref"><span class="mpre">fixup</span></span></a><span class="mpre"> (</span><a href="#loc_195_11_195_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_11_195_12&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
   in
   </span><a href="#loc_195_5_195_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_5_195_10&#39;)"><span class="hl_varref"><span class="mpre">fixup</span></span></a><span class="mpre"> </span><a href="#loc_164_5_164_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_5_164_7&#39;)"><span class="hl_varref"><span class="mpre">k0</span></span></a><span class="mpre">

  </span><a name="loc_203_3_203_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_3_203_6&#39;)"><span class="hl_fundecl"><span class="mpre">gen</span></span></a><span class="mpre"> </span><a name="loc_203_7_203_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_7_203_9&#39;)"><span class="hl_vardecl"><span class="mpre">ds</span></span></a><span class="mpre"> </span><a name="loc_203_10_203_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_10_203_12&#39;)"><span class="hl_vardecl"><span class="mpre">rn</span></span></a><span class="mpre"> </span><a name="loc_203_13_203_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_13_203_15&#39;)"><span class="hl_vardecl"><span class="mpre">sN</span></span></a><span class="mpre"> </span><a name="loc_203_16_203_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_16_203_20&#39;)"><span class="hl_vardecl"><span class="mpre">mUpN</span></span></a><span class="mpre"> </span><a name="loc_203_21_203_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_21_203_25&#39;)"><span class="hl_vardecl"><span class="mpre">mDnN</span></span></a><span class="mpre"> =
   let
    (</span><a name="loc_205_6_205_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_6_205_8&#39;)"><span class="hl_vardecl"><span class="mpre">dn</span></span></a><span class="mpre">, </span><a name="loc_205_10_205_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_10_205_13&#39;)"><span class="hl_vardecl"><span class="mpre">rn&#39;</span></span></a><span class="mpre">) = (</span><a href="#loc_203_10_203_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_10_203_12&#39;)"><span class="hl_varref"><span class="mpre">rn</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">`quotRem`</span></span><span class="mpre"> </span><a href="#loc_203_13_203_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_13_203_15&#39;)"><span class="hl_varref"><span class="mpre">sN</span></span></a><span class="mpre">
    </span><a name="loc_206_5_206_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_5_206_10&#39;)"><span class="hl_vardecl"><span class="mpre">mUpN&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_203_16_203_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_16_203_20&#39;)"><span class="hl_varref"><span class="mpre">mUpN</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre">
    </span><a name="loc_207_5_207_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_207_5_207_10&#39;)"><span class="hl_vardecl"><span class="mpre">mDnN&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_203_21_203_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_21_203_25&#39;)"><span class="hl_varref"><span class="mpre">mDnN</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre">
   in
   case (</span><a href="#loc_205_10_205_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_10_205_13&#39;)"><span class="hl_varref"><span class="mpre">rn&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_207_5_207_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_207_5_207_10&#39;)"><span class="hl_varref"><span class="mpre">mDnN&#39;</span></span></a><span class="mpre">, </span><a href="#loc_205_10_205_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_10_205_13&#39;)"><span class="hl_varref"><span class="mpre">rn&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_206_5_206_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_5_206_10&#39;)"><span class="hl_varref"><span class="mpre">mUpN&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><a href="#loc_203_13_203_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_13_203_15&#39;)"><span class="hl_varref"><span class="mpre">sN</span></span></a><span class="mpre">) of
    (</span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">,  </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">) -&gt; </span><a href="#loc_205_6_205_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_6_205_8&#39;)"><span class="hl_varref"><span class="mpre">dn</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_203_7_203_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_7_203_9&#39;)"><span class="hl_varref"><span class="mpre">ds</span></span></a><span class="mpre">
    (</span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">, </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">)  -&gt; </span><a href="#loc_205_6_205_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_6_205_8&#39;)"><span class="hl_varref"><span class="mpre">dn</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_203_7_203_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_7_203_9&#39;)"><span class="hl_varref"><span class="mpre">ds</span></span></a><span class="mpre">
    (</span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">,  </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">)  -&gt; if </span><a href="#loc_205_10_205_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_10_205_13&#39;)"><span class="hl_varref"><span class="mpre">rn&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_203_13_203_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_13_203_15&#39;)"><span class="hl_varref"><span class="mpre">sN</span></span></a><span class="mpre"> then </span><a href="#loc_205_6_205_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_6_205_8&#39;)"><span class="hl_varref"><span class="mpre">dn</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_203_7_203_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_7_203_9&#39;)"><span class="hl_varref"><span class="mpre">ds</span></span></a><span class="mpre"> else </span><a href="#loc_205_6_205_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_6_205_8&#39;)"><span class="hl_varref"><span class="mpre">dn</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_203_7_203_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_7_203_9&#39;)"><span class="hl_varref"><span class="mpre">ds</span></span></a><span class="mpre">
    (</span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">, </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">) -&gt; </span><a href="#loc_203_3_203_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_3_203_6&#39;)"><span class="hl_varref"><span class="mpre">gen</span></span></a><span class="mpre"> (</span><a href="#loc_205_6_205_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_6_205_8&#39;)"><span class="hl_varref"><span class="mpre">dn</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_203_7_203_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_7_203_9&#39;)"><span class="hl_varref"><span class="mpre">ds</span></span></a><span class="mpre">) </span><a href="#loc_205_10_205_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_10_205_13&#39;)"><span class="hl_varref"><span class="mpre">rn&#39;</span></span></a><span class="mpre"> </span><a href="#loc_203_13_203_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_13_203_15&#39;)"><span class="hl_varref"><span class="mpre">sN</span></span></a><span class="mpre"> </span><a href="#loc_206_5_206_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_5_206_10&#39;)"><span class="hl_varref"><span class="mpre">mUpN&#39;</span></span></a><span class="mpre"> </span><a href="#loc_207_5_207_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_207_5_207_10&#39;)"><span class="hl_varref"><span class="mpre">mDnN&#39;</span></span></a><span class="mpre">

  </span><a name="loc_215_3_215_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_3_215_6&#39;)"><span class="hl_vardecl"><span class="mpre">rds</span></span></a><span class="mpre"> =
   if </span><a href="#loc_161_3_161_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_3_161_4&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> then
      </span><a href="#loc_203_3_203_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_3_203_6&#39;)"><span class="hl_varref"><span class="mpre">gen</span></span></a><span class="mpre"> [] </span><a href="#loc_148_4_148_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_4_148_5&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> (</span><a href="#loc_148_7_148_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_7_148_8&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><a href="#loc_230_1_230_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_1_230_5&#39;)"><span class="hl_varref"><span class="mpre">expt</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre"> </span><a href="#loc_161_3_161_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_3_161_4&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">) </span><a href="#loc_148_10_148_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_10_148_13&#39;)"><span class="hl_varref"><span class="mpre">mUp</span></span></a><span class="mpre"> </span><a href="#loc_148_15_148_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_15_148_18&#39;)"><span class="hl_varref"><span class="mpre">mDn</span></span></a><span class="mpre">
   else
     let </span><a name="loc_219_10_219_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_219_10_219_12&#39;)"><span class="hl_vardecl"><span class="mpre">bk</span></span></a><span class="mpre"> = </span><a href="#loc_230_1_230_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_1_230_5&#39;)"><span class="hl_varref"><span class="mpre">expt</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre"> (-</span><a href="#loc_161_3_161_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_3_161_4&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">) in
     </span><a href="#loc_203_3_203_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_3_203_6&#39;)"><span class="hl_varref"><span class="mpre">gen</span></span></a><span class="mpre"> [] (</span><a href="#loc_148_4_148_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_4_148_5&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><a href="#loc_219_10_219_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_219_10_219_12&#39;)"><span class="hl_varref"><span class="mpre">bk</span></span></a><span class="mpre">) </span><a href="#loc_148_7_148_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_7_148_8&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> (</span><a href="#loc_148_10_148_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_10_148_13&#39;)"><span class="hl_varref"><span class="mpre">mUp</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><a href="#loc_219_10_219_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_219_10_219_12&#39;)"><span class="hl_varref"><span class="mpre">bk</span></span></a><span class="mpre">) (</span><a href="#loc_148_15_148_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_148_15_148_18&#39;)"><span class="hl_varref"><span class="mpre">mDn</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><a href="#loc_219_10_219_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_219_10_219_12&#39;)"><span class="hl_varref"><span class="mpre">bk</span></span></a><span class="mpre">)
 in
 (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><a href="#loc_215_3_215_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_3_215_6&#39;)"><span class="hl_varref"><span class="mpre">rds</span></span></a><span class="mpre">), </span><a href="#loc_161_3_161_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_3_161_4&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- Exponentiation with a cache for the most common numbers.</span></span><span class="mpre">
</span><a href="#loc_226_1_226_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_1_226_8&#39;)"><span class="mpre">minExpt</span></a><span class="mpre">, </span><a href="#loc_227_1_227_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_1_227_8&#39;)"><span class="mpre">maxExpt</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><a name="loc_226_1_226_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_1_226_8&#39;)"><span class="hl_vardecl"><span class="mpre">minExpt</span></span></a><span class="mpre"> = </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
</span><a name="loc_227_1_227_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_1_227_8&#39;)"><span class="hl_vardecl"><span class="mpre">maxExpt</span></span></a><span class="mpre"> = </span><span class="hl_num"><span class="mpre">1100</span></span><span class="mpre">

</span><a href="#loc_230_1_230_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_1_230_5&#39;)"><span class="mpre">expt</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">
</span><a name="loc_230_1_230_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_1_230_5&#39;)"><span class="hl_fundecl"><span class="mpre">expt</span></span></a><span class="mpre"> </span><a name="loc_230_6_230_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_6_230_10&#39;)"><span class="hl_vardecl"><span class="mpre">base</span></span></a><span class="mpre"> </span><a name="loc_230_11_230_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_11_230_12&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre">
    | </span><a href="#loc_230_6_230_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_6_230_10&#39;)"><span class="hl_varref"><span class="mpre">base</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_230_11_230_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_11_230_12&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><a href="#loc_226_1_226_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_1_226_8&#39;)"><span class="hl_varref"><span class="mpre">minExpt</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_230_11_230_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_11_230_12&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><a href="#loc_227_1_227_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_1_227_8&#39;)"><span class="hl_varref"><span class="mpre">maxExpt</span></span></a><span class="mpre"> = </span><a href="#loc_236_1_236_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_1_236_6&#39;)"><span class="hl_varref"><span class="mpre">expts</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`unsafeAt`</span></span><span class="mpre"> </span><a href="#loc_230_11_230_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_11_230_12&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">
    | </span><a href="#loc_230_6_230_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_6_230_10&#39;)"><span class="hl_varref"><span class="mpre">base</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_230_11_230_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_11_230_12&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><a href="#loc_239_1_239_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_1_239_10&#39;)"><span class="hl_varref"><span class="mpre">maxExpt10</span></span></a><span class="mpre">              = </span><a href="#loc_242_1_242_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_1_242_8&#39;)"><span class="hl_varref"><span class="mpre">expts10</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`unsafeAt`</span></span><span class="mpre"> </span><a href="#loc_230_11_230_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_11_230_12&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">                                 = </span><a href="#loc_230_6_230_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_6_230_10&#39;)"><span class="hl_varref"><span class="mpre">base</span></span></a><span class="hl_infix"><span class="mpre">^</span></span><a href="#loc_230_11_230_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_11_230_12&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">

</span><a href="#loc_236_1_236_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_1_236_6&#39;)"><span class="mpre">expts</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Array</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">
</span><a name="loc_236_1_236_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_1_236_6&#39;)"><span class="hl_vardecl"><span class="mpre">expts</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">array</span></span><span class="mpre"> (</span><a href="#loc_226_1_226_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_1_226_8&#39;)"><span class="hl_varref"><span class="mpre">minExpt</span></span></a><span class="mpre">,</span><a href="#loc_227_1_227_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_1_227_8&#39;)"><span class="hl_varref"><span class="mpre">maxExpt</span></span></a><span class="mpre">) [(</span><a href="#loc_236_44_236_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_44_236_45&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">,</span><span class="hl_num"><span class="mpre">2</span></span><span class="hl_infix"><span class="mpre">^</span></span><a href="#loc_236_44_236_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_44_236_45&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">) | </span><a name="loc_236_44_236_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_44_236_45&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> &lt;- </span><span class="warning" data-warning="ExpEnumFromTo (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/Data/Text/Lazy/Builder/RealFloat.hs&quot;, srcSpanStartLine = 236, srcSpanStartColumn = 49, srcSpanEndLine = 236, srcSpanEndColumn = 69}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/Data/Text/Lazy/Builder/RealFloat.hs&quot;, srcSpanStartLine = 236, srcSpanStartColumn = 49, srcSpanEndLine = 236, srcSpanEndColumn = 50},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/Data/Tex"><span class="mpre">[minExpt .. maxExpt]</span></span><span class="mpre">]

</span><a href="#loc_239_1_239_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_1_239_10&#39;)"><span class="mpre">maxExpt10</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><a name="loc_239_1_239_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_1_239_10&#39;)"><span class="hl_vardecl"><span class="mpre">maxExpt10</span></span></a><span class="mpre"> = </span><span class="hl_num"><span class="mpre">324</span></span><span class="mpre">

</span><a href="#loc_242_1_242_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_1_242_8&#39;)"><span class="mpre">expts10</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Array</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre">
</span><a name="loc_242_1_242_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_1_242_8&#39;)"><span class="hl_vardecl"><span class="mpre">expts10</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">array</span></span><span class="mpre"> (</span><a href="#loc_226_1_226_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_1_226_8&#39;)"><span class="hl_varref"><span class="mpre">minExpt</span></span></a><span class="mpre">,</span><a href="#loc_239_1_239_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_1_239_10&#39;)"><span class="hl_varref"><span class="mpre">maxExpt10</span></span></a><span class="mpre">) [(</span><a href="#loc_242_49_242_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_49_242_50&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">,</span><span class="hl_num"><span class="mpre">10</span></span><span class="hl_infix"><span class="mpre">^</span></span><a href="#loc_242_49_242_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_49_242_50&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">) | </span><a name="loc_242_49_242_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_49_242_50&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> &lt;- </span><span class="warning" data-warning="ExpEnumFromTo (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/Data/Text/Lazy/Builder/RealFloat.hs&quot;, srcSpanStartLine = 242, srcSpanStartColumn = 54, srcSpanEndLine = 242, srcSpanEndColumn = 76}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/Data/Text/Lazy/Builder/RealFloat.hs&quot;, srcSpanStartLine = 242, srcSpanStartColumn = 54, srcSpanEndLine = 242, srcSpanEndColumn = 55},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/Data/Tex"><span class="mpre">[minExpt .. maxExpt10]</span></span><span class="mpre">]
</span></div></body></html>