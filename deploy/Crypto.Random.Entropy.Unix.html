<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      : Crypto.Random.Entropy.Unix</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     : BSD-style</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  : Vincent Hanquez &lt;vincent@snarc.org&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   : experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability : Good</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
{-# LANGUAGE ScopedTypeVariables #-}
module Crypto.Random.Entropy.Unix
    ( DevRandom
    , DevURandom
    ) where

import Foreign.Ptr
import Data.Word (Word8)
import Crypto.Random.Entropy.Source
import Control.Exception as E

import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-random-0.0.7/Crypto/Random/Entropy/Unix.hs&quot;, srcSpanStartLine = 19, srcSpanStartColumn = 8, srcSpanEndLine = 19, srcSpanEndColumn = 26}, srcInfoPoints = []}) &quot;System.Posix.Types&quot;"><span class="mpre">System.Posix.Types</span></span><span class="mpre"> (Fd)
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-random-0.0.7/Crypto/Random/Entropy/Unix.hs&quot;, srcSpanStartLine = 20, srcSpanStartColumn = 8, srcSpanEndLine = 20, srcSpanEndColumn = 23}, srcInfoPoints = []}) &quot;System.Posix.IO&quot;"><span class="mpre">System.Posix.IO</span></span><span class="mpre">

</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-random-0.0.7/Crypto/Random/Entropy/Unix.hs&quot;, srcSpanStartLine = 22, srcSpanStartColumn = 1, srcSpanEndLine = 22, srcSpanEndColumn = 12}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-random-0.0.7/Crypto/Random/Entropy/Unix.hs&quot;, srcSpanStartLine = 22, srcSpanStartColumn = 1, srcSpanEndLine = 22, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-random-0.0.7/Crypto/R"><span class="mpre">type H = Fd</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-random-0.0.7/Crypto/Random/Entropy/Unix.hs&quot;, srcSpanStartLine = 23, srcSpanStartColumn = 1, srcSpanEndLine = 23, srcSpanEndColumn = 25}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-random-0.0.7/Crypto/Random/Entropy/Unix.hs&quot;, srcSpanStartLine = 23, srcSpanStartColumn = 1, srcSpanEndLine = 23, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-random-0.0.7/Crypto/R"><span class="mpre">type DeviceName = String</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Entropy device /dev/random on unix system </span></span><span class="mpre">
newtype </span><a name="loc_26_9_26_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_9_26_18&#39;)"><span class="hl_tycondecl"><span class="mpre">DevRandom</span></span></a><span class="mpre">  = </span><a name="loc_26_22_26_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_22_26_31&#39;)"><span class="hl_condecl"><span class="mpre">DevRandom</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">DeviceName</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Entropy device /dev/urandom on unix system </span></span><span class="mpre">
newtype </span><a name="loc_29_9_29_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_9_29_19&#39;)"><span class="hl_tycondecl"><span class="mpre">DevURandom</span></span></a><span class="mpre"> = </span><a name="loc_29_22_29_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_22_29_32&#39;)"><span class="hl_condecl"><span class="mpre">DevURandom</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">DeviceName</span></span><span class="mpre">

instance </span><a href="Crypto.Random.Entropy.Source.html#loc_15_7_15_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Random.Entropy.Source.html#loc_15_7_15_20&#39;)"><span class="hl_classref"><span class="mpre">EntropySource</span></span></a><span class="mpre"> </span><a href="#loc_26_9_26_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_9_26_18&#39;)"><span class="hl_tyconref"><span class="mpre">DevRandom</span></span></a><span class="mpre"> where
    </span><a href="Crypto.Random.Entropy.Source.html#loc_17_5_17_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Random.Entropy.Source.html#loc_17_5_17_16&#39;)"><span class="hl_vardecl"><span class="mpre">entropyOpen</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> </span><a href="#loc_26_22_26_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_22_26_31&#39;)"><span class="hl_conref"><span class="mpre">DevRandom</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`fmap`</span></span><span class="mpre"> </span><a href="#loc_44_1_44_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_1_44_9&#39;)"><span class="hl_varref"><span class="mpre">testOpen</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;/dev/random&quot;</span></span><span class="mpre">
    </span><a href="Crypto.Random.Entropy.Source.html#loc_20_5_20_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Random.Entropy.Source.html#loc_20_5_20_18&#39;)"><span class="hl_fundecl"><span class="mpre">entropyGather</span></span></a><span class="mpre"> (</span><a href="#loc_26_22_26_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_22_26_31&#39;)"><span class="hl_conref"><span class="mpre">DevRandom</span></span></a><span class="mpre"> </span><a name="loc_33_30_33_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_30_33_34&#39;)"><span class="hl_vardecl"><span class="mpre">name</span></span></a><span class="mpre">) </span><a name="loc_33_36_33_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_36_33_39&#39;)"><span class="hl_vardecl"><span class="mpre">ptr</span></span></a><span class="mpre"> </span><a name="loc_33_40_33_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_40_33_41&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> =
        </span><a href="#loc_56_1_56_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_1_56_8&#39;)"><span class="hl_varref"><span class="mpre">withDev</span></span></a><span class="mpre"> </span><a href="#loc_33_30_33_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_30_33_34&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_34_25_34_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_25_34_26&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_65_1_65_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_1_65_17&#39;)"><span class="hl_varref"><span class="mpre">gatherDevEntropy</span></span></a><span class="mpre"> </span><a href="#loc_34_25_34_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_25_34_26&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><a href="#loc_33_36_33_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_36_33_39&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre"> </span><a href="#loc_33_40_33_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_40_33_41&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">
    </span><a href="Crypto.Random.Entropy.Source.html#loc_22_5_22_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Random.Entropy.Source.html#loc_22_5_22_17&#39;)"><span class="hl_fundecl"><span class="mpre">entropyClose</span></span></a><span class="mpre"> (</span><a href="#loc_26_22_26_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_22_26_31&#39;)"><span class="hl_conref"><span class="mpre">DevRandom</span></span></a><span class="mpre"> _)  = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">

instance </span><a href="Crypto.Random.Entropy.Source.html#loc_15_7_15_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Random.Entropy.Source.html#loc_15_7_15_20&#39;)"><span class="hl_classref"><span class="mpre">EntropySource</span></span></a><span class="mpre"> </span><a href="#loc_29_9_29_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_9_29_19&#39;)"><span class="hl_tyconref"><span class="mpre">DevURandom</span></span></a><span class="mpre"> where
    </span><a href="Crypto.Random.Entropy.Source.html#loc_17_5_17_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Random.Entropy.Source.html#loc_17_5_17_16&#39;)"><span class="hl_vardecl"><span class="mpre">entropyOpen</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> </span><a href="#loc_29_22_29_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_22_29_32&#39;)"><span class="hl_conref"><span class="mpre">DevURandom</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`fmap`</span></span><span class="mpre"> </span><a href="#loc_44_1_44_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_1_44_9&#39;)"><span class="hl_varref"><span class="mpre">testOpen</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;/dev/urandom&quot;</span></span><span class="mpre">
    </span><a href="Crypto.Random.Entropy.Source.html#loc_20_5_20_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Random.Entropy.Source.html#loc_20_5_20_18&#39;)"><span class="hl_fundecl"><span class="mpre">entropyGather</span></span></a><span class="mpre"> (</span><a href="#loc_29_22_29_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_22_29_32&#39;)"><span class="hl_conref"><span class="mpre">DevURandom</span></span></a><span class="mpre"> </span><a name="loc_39_31_39_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_31_39_35&#39;)"><span class="hl_vardecl"><span class="mpre">name</span></span></a><span class="mpre">) </span><a name="loc_39_37_39_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_37_39_40&#39;)"><span class="hl_vardecl"><span class="mpre">ptr</span></span></a><span class="mpre"> </span><a name="loc_39_41_39_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_41_39_42&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> =
        </span><a href="#loc_56_1_56_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_1_56_8&#39;)"><span class="hl_varref"><span class="mpre">withDev</span></span></a><span class="mpre"> </span><a href="#loc_39_31_39_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_31_39_35&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_40_25_40_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_25_40_26&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_65_1_65_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_1_65_17&#39;)"><span class="hl_varref"><span class="mpre">gatherDevEntropy</span></span></a><span class="mpre"> </span><a href="#loc_40_25_40_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_25_40_26&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><a href="#loc_39_37_39_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_37_39_40&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre"> </span><a href="#loc_39_41_39_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_41_39_42&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">
    </span><a href="Crypto.Random.Entropy.Source.html#loc_22_5_22_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Random.Entropy.Source.html#loc_22_5_22_17&#39;)"><span class="hl_fundecl"><span class="mpre">entropyClose</span></span></a><span class="mpre"> (</span><a href="#loc_29_22_29_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_22_29_32&#39;)"><span class="hl_conref"><span class="mpre">DevURandom</span></span></a><span class="mpre"> _)  = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">

</span><a href="#loc_44_1_44_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_1_44_9&#39;)"><span class="mpre">testOpen</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">DeviceName</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">DeviceName</span></span><span class="mpre">)
</span><a name="loc_44_1_44_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_1_44_9&#39;)"><span class="hl_fundecl"><span class="mpre">testOpen</span></span></a><span class="mpre"> </span><a name="loc_44_10_44_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_10_44_18&#39;)"><span class="hl_vardecl"><span class="mpre">filepath</span></span></a><span class="mpre"> = do
    </span><a name="loc_45_5_45_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_5_45_6&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_51_1_51_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_1_51_8&#39;)"><span class="hl_varref"><span class="mpre">openDev</span></span></a><span class="mpre"> </span><a href="#loc_44_10_44_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_10_44_18&#39;)"><span class="hl_varref"><span class="mpre">filepath</span></span></a><span class="mpre">
    case </span><a href="#loc_45_5_45_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_5_45_6&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> of
        </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
        </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_48_14_48_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_14_48_15&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre">  -&gt; </span><a href="#loc_62_1_62_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_1_62_9&#39;)"><span class="hl_varref"><span class="mpre">closeDev</span></span></a><span class="mpre"> </span><a href="#loc_48_14_48_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_14_48_15&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="#loc_44_10_44_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_10_44_18&#39;)"><span class="hl_varref"><span class="mpre">filepath</span></span></a><span class="mpre">)

</span><a href="#loc_51_1_51_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_1_51_8&#39;)"><span class="mpre">openDev</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">H</span></span><span class="mpre">)
</span><a name="loc_51_1_51_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_1_51_8&#39;)"><span class="hl_fundecl"><span class="mpre">openDev</span></span></a><span class="mpre"> </span><a name="loc_51_9_51_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_9_51_17&#39;)"><span class="hl_vardecl"><span class="mpre">filepath</span></span></a><span class="mpre"> = (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`fmap`</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">openFd</span></span><span class="mpre"> </span><a href="#loc_51_9_51_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_9_51_17&#39;)"><span class="hl_varref"><span class="mpre">filepath</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">ReadOnly</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> </span><a href="#loc_53_9_53_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_9_53_18&#39;)"><span class="hl_varref"><span class="mpre">fileFlags</span></span></a><span class="mpre">)
    </span><a href="Control.Exception.Base.html#loc_150_1_150_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Exception.Base.html#loc_150_1_150_6&#39;)"><span class="hl_infix"><span class="mpre">`E.catch`</span></span></a><span class="mpre"> \(_ :: </span><a href="GHC.IO.Exception.html#loc_238_6_238_17" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Exception.html#loc_238_6_238_17&#39;)"><span class="hl_tyconref"><span class="mpre">IOException</span></span></a><span class="mpre">) -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
  where </span><a name="loc_53_9_53_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_9_53_18&#39;)"><span class="hl_vardecl"><span class="mpre">fileFlags</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-random-0.0.7/Crypto/Random/Entropy/Unix.hs&quot;, srcSpanStartLine = 53, srcSpanStartColumn = 21, srcSpanEndLine = 53, srcSpanEndColumn = 57}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-random-0.0.7/Crypto/Random/Entropy/Unix.hs&quot;, srcSpanStartLine = 53, srcSpanStartColumn = 38, srcSpanEndLine = 53, srcSpanEndColumn = 39},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-random-0.0.7/Cryp"><span class="mpre">defaultFileFlags { nonBlock = True }</span></span><span class="mpre">

</span><a href="#loc_56_1_56_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_1_56_8&#39;)"><span class="mpre">withDev</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">H</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_56_1_56_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_1_56_8&#39;)"><span class="hl_fundecl"><span class="mpre">withDev</span></span></a><span class="mpre"> </span><a name="loc_56_9_56_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_9_56_17&#39;)"><span class="hl_vardecl"><span class="mpre">filepath</span></span></a><span class="mpre"> </span><a name="loc_56_18_56_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_18_56_19&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><a href="#loc_51_1_51_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_1_51_8&#39;)"><span class="hl_varref"><span class="mpre">openDev</span></span></a><span class="mpre"> </span><a href="#loc_56_9_56_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_9_56_17&#39;)"><span class="hl_varref"><span class="mpre">filepath</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> \</span><a name="loc_56_44_56_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_44_56_45&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre"> -&gt;
    case </span><a href="#loc_56_44_56_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_44_56_45&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> of
        </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;device &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_56_9_56_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_9_56_17&#39;)"><span class="hl_varref"><span class="mpre">filepath</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot; cannot be grabbed&quot;</span></span><span class="mpre">)
        </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_59_14_59_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_14_59_16&#39;)"><span class="hl_vardecl"><span class="mpre">fd</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_56_18_56_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_18_56_19&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_59_14_59_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_14_59_16&#39;)"><span class="hl_varref"><span class="mpre">fd</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> \</span><a name="loc_59_30_59_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_30_59_31&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> -&gt; (</span><a href="#loc_62_1_62_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_1_62_9&#39;)"><span class="hl_varref"><span class="mpre">closeDev</span></span></a><span class="mpre"> </span><a href="#loc_59_14_59_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_14_59_16&#39;)"><span class="hl_varref"><span class="mpre">fd</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_59_30_59_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_30_59_31&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">)

</span><a href="#loc_62_1_62_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_1_62_9&#39;)"><span class="mpre">closeDev</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">H</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_62_1_62_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_1_62_9&#39;)"><span class="hl_fundecl"><span class="mpre">closeDev</span></span></a><span class="mpre"> </span><a name="loc_62_10_62_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_10_62_11&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">closeFd</span></span><span class="mpre"> </span><a href="#loc_62_10_62_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_10_62_11&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre">

</span><a href="#loc_65_1_65_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_1_65_17&#39;)"><span class="mpre">gatherDevEntropy</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">H</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><a name="loc_65_1_65_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_1_65_17&#39;)"><span class="hl_fundecl"><span class="mpre">gatherDevEntropy</span></span></a><span class="mpre"> </span><a name="loc_65_18_65_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_18_65_19&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre"> </span><a name="loc_65_20_65_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_20_65_23&#39;)"><span class="hl_vardecl"><span class="mpre">ptr</span></span></a><span class="mpre"> </span><a name="loc_65_24_65_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_24_65_26&#39;)"><span class="hl_vardecl"><span class="mpre">sz</span></span></a><span class="mpre"> =
     (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`fmap`</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fdReadBuf</span></span><span class="mpre"> </span><a href="#loc_65_18_65_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_18_65_19&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><a href="#loc_65_20_65_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_20_65_23&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_65_24_65_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_24_65_26&#39;)"><span class="hl_varref"><span class="mpre">sz</span></span></a><span class="mpre">))
    </span><a href="Control.Exception.Base.html#loc_150_1_150_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Exception.Base.html#loc_150_1_150_6&#39;)"><span class="hl_infix"><span class="mpre">`E.catch`</span></span></a><span class="mpre"> \(_ :: </span><a href="GHC.IO.Exception.html#loc_238_6_238_17" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.Exception.html#loc_238_6_238_17&#39;)"><span class="hl_tyconref"><span class="mpre">IOException</span></span></a><span class="mpre">) -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
</span></div></body></html>