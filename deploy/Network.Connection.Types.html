<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      : Network.Connection.Types</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     : BSD-style</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  : Vincent Hanquez &lt;vincent@snarc.org&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   : experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability : portable</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- connection types</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
module Network.Connection.Types
    where

import Control.Concurrent.MVar (</span><a href="GHC.MVar.html#loc_39_6_39_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.MVar.html#loc_39_6_39_10&#39;)"><span class="mpre">MVar</span></a><span class="mpre">)

import Data.Default.Class
import Data.X509.CertificateStore
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/connection-0.2.3/Network/Connection/Types.hs&quot;, srcSpanStartLine = 17, srcSpanStartColumn = 8, srcSpanEndLine = 17, srcSpanEndColumn = 23}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> (ByteString)

import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/connection-0.2.3/Network/Connection/Types.hs&quot;, srcSpanStartLine = 19, srcSpanStartColumn = 8, srcSpanEndLine = 19, srcSpanEndColumn = 19}, srcInfoPoints = []}) &quot;Network.BSD&quot;"><span class="mpre">Network.BSD</span></span><span class="mpre"> (HostName)
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/connection-0.2.3/Network/Connection/Types.hs&quot;, srcSpanStartLine = 20, srcSpanStartColumn = 8, srcSpanEndLine = 20, srcSpanEndColumn = 22}, srcInfoPoints = []}) &quot;Network.Socket&quot;"><span class="mpre">Network.Socket</span></span><span class="mpre"> (PortNumber)
import qualified Network.TLS as TLS

import System.IO (Handle)

</span><span class="hl_comment"><span class="mpre">-- | Simple backend enumeration, either using a raw connection or a tls connection.</span></span><span class="mpre">
data </span><a name="loc_26_6_26_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_6_26_23&#39;)"><span class="hl_tycondecl"><span class="mpre">ConnectionBackend</span></span></a><span class="mpre"> = </span><a name="loc_26_26_26_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_26_26_42&#39;)"><span class="hl_condecl"><span class="mpre">ConnectionStream</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Handle</span></span><span class="mpre">
                       | </span><a name="loc_27_26_27_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_26_27_39&#39;)"><span class="hl_condecl"><span class="mpre">ConnectionTLS</span></span></a><span class="mpre"> </span><a href="Network.TLS.Context.Internal.html#loc_85_6_85_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Context.Internal.html#loc_85_6_85_13&#39;)"><span class="hl_tyconref"><span class="mpre">TLS.Context</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Connection Parameters to establish a Connection.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The strict minimum is an hostname and the port.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- If you need to establish a TLS connection, you should make sure</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- connectionUseSecure is correctly set.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- If you need to connect through a SOCKS, you should make sure</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- connectionUseSocks is correctly set.</span></span><span class="mpre">
data </span><a name="loc_38_6_38_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_6_38_22&#39;)"><span class="hl_tycondecl"><span class="mpre">ConnectionParams</span></span></a><span class="mpre"> = </span><a name="loc_38_25_38_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_25_38_41&#39;)"><span class="hl_condecl"><span class="mpre">ConnectionParams</span></span></a><span class="mpre">
    { </span><a name="loc_39_7_39_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_7_39_25&#39;)"><span class="hl_fielddecl"><span class="mpre">connectionHostname</span></span></a><span class="mpre">   :: </span><span class="hl_tyconref"><span class="mpre">HostName</span></span><span class="mpre">           </span><span class="hl_comment"><span class="mpre">-- ^ host name to connect to.</span></span><span class="mpre">
    , </span><a name="loc_40_7_40_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_7_40_21&#39;)"><span class="hl_fielddecl"><span class="mpre">connectionPort</span></span></a><span class="mpre">       :: </span><span class="hl_tyconref"><span class="mpre">PortNumber</span></span><span class="mpre">         </span><span class="hl_comment"><span class="mpre">-- ^ port number to connect to.</span></span><span class="mpre">
    , </span><a name="loc_41_7_41_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_7_41_26&#39;)"><span class="hl_fielddecl"><span class="mpre">connectionUseSecure</span></span></a><span class="mpre">  :: </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><a href="#loc_65_6_65_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_6_65_17&#39;)"><span class="hl_tyconref"><span class="mpre">TLSSettings</span></span></a><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- ^ optional TLS parameters.</span></span><span class="mpre">
    , </span><a name="loc_42_7_42_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_7_42_25&#39;)"><span class="hl_fielddecl"><span class="mpre">connectionUseSocks</span></span></a><span class="mpre">   :: </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><a href="#loc_53_6_53_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_6_53_19&#39;)"><span class="hl_tyconref"><span class="mpre">ProxySettings</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ optional Proxy/Socks configuration.</span></span><span class="mpre">
    }

</span><span class="hl_comment"><span class="mpre">-- | Proxy settings for the connection.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- OtherProxy handles specific application-level proxies like HTTP proxies.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The simple SOCKS settings is just the hostname and portnumber of the SOCKS proxy server.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- That&#39;s for now the only settings in the SOCKS package,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- socks password, or any sort of other authentications is not yet implemented.</span></span><span class="mpre">
data </span><a name="loc_53_6_53_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_6_53_19&#39;)"><span class="hl_tycondecl"><span class="mpre">ProxySettings</span></span></a><span class="mpre"> =
      </span><a name="loc_54_7_54_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_7_54_25&#39;)"><span class="hl_condecl"><span class="mpre">SockSettingsSimple</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">HostName</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">PortNumber</span></span><span class="mpre">
    | </span><a name="loc_55_7_55_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_7_55_30&#39;)"><span class="hl_condecl"><span class="mpre">SockSettingsEnvironment</span></span></a><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">)
    | </span><a name="loc_56_7_56_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_7_56_17&#39;)"><span class="hl_condecl"><span class="mpre">OtherProxy</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">HostName</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">PortNumber</span></span><span class="mpre">

</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/connection-0.2.3/Network/Connection/Types.hs&quot;, srcSpanStartLine = 58, srcSpanStartColumn = 1, srcSpanEndLine = 58, srcSpanEndColumn = 34}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/connection-0.2.3/Network/Connection/Types.hs&quot;, srcSpanStartLine = 58, srcSpanStartColumn = 1, srcSpanEndLine = 58, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/connection-0.2.3/Network/Connection/Ty"><span class="mpre">type SockSettings = ProxySettings</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | TLS Settings that can be either expressed as simple settings,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- or as full blown TLS.Params settings.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Unless you need access to parameters that are not accessible through the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- simple settings, you should use TLSSettingsSimple.</span></span><span class="mpre">
data </span><a name="loc_65_6_65_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_6_65_17&#39;)"><span class="hl_tycondecl"><span class="mpre">TLSSettings</span></span></a><span class="mpre">
    = </span><a name="loc_66_7_66_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_7_66_24&#39;)"><span class="hl_condecl"><span class="mpre">TLSSettingsSimple</span></span></a><span class="mpre">
             { </span><a name="loc_67_16_67_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_16_67_51&#39;)"><span class="hl_fielddecl"><span class="mpre">settingDisableCertificateValidation</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ Disable certificate verification completely,</span></span><span class="mpre">
                                                           </span><span class="hl_comment"><span class="mpre">--   this make TLS/SSL vulnerable to a MITM attack.</span></span><span class="mpre">
                                                           </span><span class="hl_comment"><span class="mpre">--   not recommended to use, but for testing.</span></span><span class="mpre">
             , </span><a name="loc_70_16_70_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_16_70_37&#39;)"><span class="hl_fielddecl"><span class="mpre">settingDisableSession</span></span></a><span class="mpre">               :: </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ Disable session management. TLS/SSL connections</span></span><span class="mpre">
                                                           </span><span class="hl_comment"><span class="mpre">--   will always re-established their context.</span></span><span class="mpre">
                                                           </span><span class="hl_comment"><span class="mpre">--   Not Implemented Yet.</span></span><span class="mpre">
             , </span><a name="loc_73_16_73_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_16_73_36&#39;)"><span class="hl_fielddecl"><span class="mpre">settingUseServerName</span></span></a><span class="mpre">                :: </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ Use server name extension. Not Implemented Yet.</span></span><span class="mpre">
             } </span><span class="hl_comment"><span class="mpre">-- ^ Simple TLS settings. recommended to use.</span></span><span class="mpre">
    | </span><a name="loc_75_7_75_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_7_75_18&#39;)"><span class="hl_condecl"><span class="mpre">TLSSettings</span></span></a><span class="mpre"> </span><a href="Network.TLS.Parameters.html#loc_43_6_43_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Parameters.html#loc_43_6_43_18&#39;)"><span class="hl_tyconref"><span class="mpre">TLS.ClientParams</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ full blown TLS Settings directly using TLS.Params. for power users.</span></span><span class="mpre">
    </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/connection-0.2.3/Network/Connection/Types.hs&quot;, srcSpanStartLine = 76, srcSpanStartColumn = 5, srcSpanEndLine = 76, srcSpanEndColumn = 20}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/connection-0.2.3/Network/Connection/Types.hs&quot;, srcSpanStartLine = 76, srcSpanStartColumn = 5, srcSpanEndLine = 76, srcSpanEndColumn = 13},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/connection-0.2.3/Network/Connection/T"><span class="mpre">deriving (Show)</span></span><span class="mpre">

instance </span><a href="Data.Default.Class.html#loc_38_7_38_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Default.Class.html#loc_38_7_38_14&#39;)"><span class="hl_classref"><span class="mpre">Default</span></span></a><span class="mpre"> </span><a href="#loc_65_6_65_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_6_65_17&#39;)"><span class="hl_tyconref"><span class="mpre">TLSSettings</span></span></a><span class="mpre"> where
    </span><a href="Data.Default.Class.html#loc_40_5_40_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Default.Class.html#loc_40_5_40_8&#39;)"><span class="hl_vardecl"><span class="mpre">def</span></span></a><span class="mpre"> = </span><a href="#loc_66_7_66_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_7_66_24&#39;)"><span class="hl_conref"><span class="mpre">TLSSettingsSimple</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">

</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/connection-0.2.3/Network/Connection/Types.hs&quot;, srcSpanStartLine = 81, srcSpanStartColumn = 1, srcSpanEndLine = 81, srcSpanEndColumn = 43}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/connection-0.2.3/Network/Connection/Types.hs&quot;, srcSpanStartLine = 81, srcSpanStartColumn = 1, srcSpanEndLine = 81, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/connection-0.2.3/Network/Connection/Ty"><span class="mpre">type ConnectionID = (HostName, PortNumber)</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | This opaque type represent a connection to a destination.</span></span><span class="mpre">
data </span><a name="loc_84_6_84_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_6_84_16&#39;)"><span class="hl_tycondecl"><span class="mpre">Connection</span></span></a><span class="mpre"> = </span><a name="loc_84_19_84_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_19_84_29&#39;)"><span class="hl_condecl"><span class="mpre">Connection</span></span></a><span class="mpre">
    { </span><a name="loc_85_7_85_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_7_85_24&#39;)"><span class="hl_fielddecl"><span class="mpre">connectionBackend</span></span></a><span class="mpre"> :: </span><a href="GHC.MVar.html#loc_39_6_39_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.MVar.html#loc_39_6_39_10&#39;)"><span class="hl_tyconref"><span class="mpre">MVar</span></span></a><span class="mpre"> </span><a href="#loc_26_6_26_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_6_26_23&#39;)"><span class="hl_tyconref"><span class="mpre">ConnectionBackend</span></span></a><span class="mpre">
    , </span><a name="loc_86_7_86_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_7_86_23&#39;)"><span class="hl_fielddecl"><span class="mpre">connectionBuffer</span></span></a><span class="mpre">  :: </span><a href="GHC.MVar.html#loc_39_6_39_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.MVar.html#loc_39_6_39_10&#39;)"><span class="hl_tyconref"><span class="mpre">MVar</span></span></a><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">) </span><span class="hl_comment"><span class="mpre">-- ^ this is set to &#39;Nothing&#39; on EOF</span></span><span class="mpre">
    , </span><a name="loc_87_7_87_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_7_87_19&#39;)"><span class="hl_fielddecl"><span class="mpre">connectionID</span></span></a><span class="mpre">      :: </span><span class="hl_tyconref"><span class="mpre">ConnectionID</span></span><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- ^ return a simple tuple of the port and hostname that we&#39;re connected to.</span></span><span class="mpre">
    }

</span><span class="hl_comment"><span class="mpre">-- | Shared values (certificate store, sessions, ..) between connections</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- At the moment, this is only strictly needed to shared sessions and certificates</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- when using a TLS enabled connection.</span></span><span class="mpre">
data </span><a name="loc_94_6_94_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_6_94_23&#39;)"><span class="hl_tycondecl"><span class="mpre">ConnectionContext</span></span></a><span class="mpre"> = </span><a name="loc_94_26_94_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_26_94_43&#39;)"><span class="hl_condecl"><span class="mpre">ConnectionContext</span></span></a><span class="mpre">
    { </span><a name="loc_95_7_95_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_7_95_29&#39;)"><span class="hl_fielddecl"><span class="mpre">globalCertificateStore</span></span></a><span class="mpre"> :: !</span><a href="Data.X509.CertificateStore.html#loc_16_6_16_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.CertificateStore.html#loc_16_6_16_22&#39;)"><span class="hl_tyconref"><span class="mpre">CertificateStore</span></span></a><span class="mpre">
    }
</span></div></body></html>