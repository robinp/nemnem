<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-- | &quot;Text.Regex.TDFA.TDFA&quot; converts the QNFA from TNFA into the DFA.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- A DFA state corresponds to a Set of QNFA states, repesented as list</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- of Index which are used to lookup the DFA state in a lazy Trie</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- which holds all possible subsets of QNFA states.</span></span><span class="mpre">
module Text.Regex.TDFA.TDFA(patternToRegex,DFA(..),DT(..)
                            ,examineDFA,nfaToDFA,dfaMap) where

</span><span class="hl_comment"><span class="mpre">--import Control.Arrow((***))</span></span><span class="mpre">
import Control.Monad.Instances()
import Data.Monoid(</span><a href="Data.Monoid.html#loc_79_7_79_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_79_7_79_13&#39;)"><span class="mpre">Monoid</span></a><span class="mpre">(..))
import Control.Monad.State(State,</span><a href="Control.Monad.State.Class.html#loc_53_18_53_28" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.State.Class.html#loc_53_18_53_28&#39;)"><span class="mpre">MonadState</span></a><span class="mpre">(..),</span><a href="Control.Monad.Trans.State.Lazy.html#loc_116_1_116_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.Trans.State.Lazy.html#loc_116_1_116_10&#39;)"><span class="mpre">execState</span></a><span class="mpre">)
import Data.Array.IArray(Array,(!),bounds,</span><span class="hl_comment"><span class="mpre">{-assocs-}</span></span><span class="mpre">)
import Data.IntMap(IntMap)
import qualified Data.IntMap as IMap(empty,keys,delete,null,lookup,fromDistinctAscList
                                    ,member,unionWith,singleton,union
                                    ,toAscList,Key,elems,toList,insert
                                    ,insertWith,insertWithKey)
import Data.IntMap.CharMap2(</span><a href="Data.IntMap.CharMap2.html#loc_19_9_19_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.IntMap.CharMap2.html#loc_19_9_19_16&#39;)"><span class="mpre">CharMap</span></a><span class="mpre">(..))
import qualified Data.IntMap.CharMap2 as Map(</span><a href="Data.IntMap.CharMap2.html#loc_55_1_55_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.IntMap.CharMap2.html#loc_55_1_55_6&#39;)"><span class="mpre">empty</span></a><span class="mpre">)
</span><span class="hl_comment"><span class="mpre">--import Data.IntSet(IntSet)</span></span><span class="mpre">
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 21, srcSpanStartColumn = 18, srcSpanEndLine = 21, srcSpanEndColumn = 29}, srcInfoPoints = []}) &quot;Data.IntSet&quot;"><span class="mpre">Data.IntSet</span></span><span class="mpre"> as ISet(empty,singleton,null)
import Data.List(</span><a href="Data.List.html#loc_993_1_993_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_993_1_993_7&#39;)"><span class="mpre">foldl&#39;</span></a><span class="mpre">)
import qualified Data.Map (Map,empty,member,insert,elems)
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 24, srcSpanStartColumn = 8, srcSpanEndLine = 24, srcSpanEndColumn = 21}, srcInfoPoints = []}) &quot;Data.Sequence&quot;"><span class="mpre">Data.Sequence</span></span><span class="mpre"> as S((|&gt;),</span><span class="hl_comment"><span class="mpre">{-viewl,ViewL(..)-}</span></span><span class="mpre">)

import Text.Regex.TDFA.Common </span><span class="hl_comment"><span class="mpre">{- all -}</span></span><span class="mpre">
import Text.Regex.TDFA.IntArrTrieSet(</span><a href="Text.Regex.TDFA.IntArrTrieSet.html#loc_17_6_17_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.IntArrTrieSet.html#loc_17_6_17_13&#39;)"><a href="Text.Regex.TDFA.IntArrTrieSet.html#loc_17_18_17_25" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.IntArrTrieSet.html#loc_17_18_17_25&#39;)"><span class="mpre">TrieSet</span></a></a><span class="mpre">)
import qualified Text.Regex.TDFA.IntArrTrieSet as Trie(</span><a href="Text.Regex.TDFA.IntArrTrieSet.html#loc_23_1_23_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.IntArrTrieSet.html#loc_23_1_23_10&#39;)"><span class="mpre">lookupAsc</span></a><span class="mpre">,</span><a href="Text.Regex.TDFA.IntArrTrieSet.html#loc_45_1_45_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.IntArrTrieSet.html#loc_45_1_45_17&#39;)"><span class="mpre">fromSinglesMerge</span></a><span class="mpre">)
import Text.Regex.TDFA.Pattern(</span><a href="Text.Regex.TDFA.Pattern.html#loc_32_6_32_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Pattern.html#loc_32_6_32_13&#39;)"><span class="mpre">Pattern</span></a><span class="mpre">)
</span><span class="hl_comment"><span class="mpre">--import Text.Regex.TDFA.RunMutState(toInstructions)</span></span><span class="mpre">
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 31, srcSpanStartColumn = 8, srcSpanEndLine = 31, srcSpanEndColumn = 28}, srcInfoPoints = []}) &quot;Text.Regex.TDFA.TNFA&quot;"><span class="mpre">Text.Regex.TDFA.TNFA</span></span><span class="mpre">(patternToNFA)
</span><span class="hl_comment"><span class="mpre">--import Debug.Trace</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">{- By Chris Kuklewicz, 2007. BSD License, see the LICENSE file. -}</span></span><span class="mpre">

</span><a href="#loc_37_1_37_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_1_37_4&#39;)"><span class="mpre">err</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_37_1_37_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_1_37_4&#39;)"><span class="hl_fundecl"><span class="mpre">err</span></span></a><span class="mpre"> </span><a name="loc_37_5_37_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_5_37_6&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = </span><a href="Text.Regex.TDFA.Common.html#loc_29_1_29_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_29_1_29_13&#39;)"><span class="hl_varref"><span class="mpre">common_error</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Text.Regex.TDFA.TDFA&quot;</span></span><span class="mpre">  </span><a href="#loc_37_5_37_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_5_37_6&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">

</span><a href="#loc_40_1_40_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_1_40_6&#39;)"><span class="mpre">dlose</span></a><span class="mpre"> :: </span><a href="Text.Regex.TDFA.Common.html#loc_215_6_215_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_215_6_215_9&#39;)"><span class="hl_tyconref"><span class="mpre">DFA</span></span></a><span class="mpre">
</span><a name="loc_40_1_40_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_1_40_6&#39;)"><span class="hl_vardecl"><span class="mpre">dlose</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 40, srcSpanStartColumn = 9, srcSpanEndLine = 43, srcSpanEndColumn = 76}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 40, srcSpanStartColumn = 13, srcSpanEndLine = 40, srcSpanEndColumn = 14},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, "><span class="mpre">DFA { d_id = ISet.empty
            , d_dt = Simple&#39; { dt_win = IMap.empty
                             , dt_trans = Map.empty
                             , dt_other = Transition dlose dlose mempty } }</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- dumb smart constructor for tracing construction (I wanted to monitor laziness)</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_48_1_48_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_8&#39;)"><span class="mpre">makeDFA</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span><a href="#loc_48_1_48_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_8&#39;)"><span class="mpre">makeDFA</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">SetIndex</span></span><span class="mpre"> -&gt; </span><a href="Text.Regex.TDFA.Common.html#loc_221_6_221_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_221_6_221_8&#39;)"><span class="hl_tyconref"><span class="mpre">DT</span></span></a><span class="mpre"> -&gt; </span><a href="Text.Regex.TDFA.Common.html#loc_215_6_215_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_215_6_215_9&#39;)"><span class="hl_tyconref"><span class="mpre">DFA</span></span></a><span class="mpre">
</span><a name="loc_48_1_48_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_8&#39;)"><span class="hl_fundecl"><span class="mpre">makeDFA</span></span></a><span class="mpre"> </span><a name="loc_48_9_48_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_9_48_10&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> </span><a name="loc_48_11_48_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_11_48_13&#39;)"><span class="hl_vardecl"><span class="mpre">dt</span></span></a><span class="mpre"> = </span><a href="Text.Regex.TDFA.Common.html#loc_215_12_215_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_215_12_215_15&#39;)"><span class="hl_conref"><span class="mpre">DFA</span></span></a><span class="mpre"> </span><a href="#loc_48_9_48_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_9_48_10&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><a href="#loc_48_11_48_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_11_48_13&#39;)"><span class="hl_varref"><span class="mpre">dt</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- Note that no CompOption or ExecOption parameter is needed.</span></span><span class="mpre">
</span><a href="#loc_54_1_54_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_1_54_9&#39;)"><span class="mpre">nfaToDFA</span></a><span class="mpre"> :: ((</span><span class="hl_tyconref"><span class="mpre">Index</span></span><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">Array</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Index</span></span><span class="mpre"> </span><a href="Text.Regex.TDFA.Common.html#loc_166_6_166_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_166_6_166_10&#39;)"><span class="hl_tyconref"><span class="mpre">QNFA</span></span></a><span class="mpre">),</span><span class="hl_tyconref"><span class="mpre">Array</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Tag</span></span><span class="mpre"> </span><a href="Text.Regex.TDFA.Common.html#loc_109_6_109_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_109_6_109_8&#39;)"><span class="hl_tyconref"><span class="mpre">OP</span></span></a><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">Array</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">GroupIndex</span></span><span class="mpre"> [</span><a href="Text.Regex.TDFA.Common.html#loc_122_6_122_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_122_6_122_15&#39;)"><span class="hl_tyconref"><span class="mpre">GroupInfo</span></span></a><span class="mpre">])
         -&gt; </span><a href="Text.Regex.TDFA.Common.html#loc_85_6_85_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_85_6_85_16&#39;)"><span class="hl_tyconref"><span class="mpre">CompOption</span></span></a><span class="mpre"> -&gt; </span><a href="Text.Regex.TDFA.Common.html#loc_101_6_101_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_101_6_101_16&#39;)"><span class="hl_tyconref"><span class="mpre">ExecOption</span></span></a><span class="mpre">
         -&gt; </span><a href="Text.Regex.TDFA.Common.html#loc_128_6_128_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_128_6_128_11&#39;)"><span class="hl_tyconref"><span class="mpre">Regex</span></span></a><span class="mpre">
</span><a name="loc_54_1_54_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_1_54_9&#39;)"><span class="hl_fundecl"><span class="mpre">nfaToDFA</span></span></a><span class="mpre"> ((</span><a name="loc_54_12_54_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_12_54_22&#39;)"><span class="hl_vardecl"><span class="mpre">startIndex</span></span></a><span class="mpre">,</span><a name="loc_54_23_54_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_23_54_28&#39;)"><span class="hl_vardecl"><span class="mpre">aQNFA</span></span></a><span class="mpre">),</span><a name="loc_54_30_54_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_30_54_36&#39;)"><span class="hl_vardecl"><span class="mpre">aTagOp</span></span></a><span class="mpre">,</span><a name="loc_54_37_54_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_37_54_47&#39;)"><span class="hl_vardecl"><span class="mpre">aGroupInfo</span></span></a><span class="mpre">) </span><a name="loc_54_49_54_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_49_54_51&#39;)"><span class="hl_vardecl"><span class="mpre">co</span></span></a><span class="mpre"> </span><a name="loc_54_52_54_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_52_54_54&#39;)"><span class="hl_vardecl"><span class="mpre">eo</span></span></a><span class="mpre"> = </span><a href="Text.Regex.TDFA.Common.html#loc_128_14_128_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_128_14_128_19&#39;)"><span class="hl_conref"><span class="mpre">Regex</span></span></a><span class="mpre"> </span><a href="#loc_55_3_55_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_3_55_6&#39;)"><span class="hl_varref"><span class="mpre">dfa</span></span></a><span class="mpre"> </span><a href="#loc_54_12_54_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_12_54_22&#39;)"><span class="hl_varref"><span class="mpre">startIndex</span></span></a><span class="mpre"> </span><a href="#loc_56_3_56_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_3_56_14&#39;)"><span class="hl_varref"><span class="mpre">indexBounds</span></span></a><span class="mpre"> </span><a href="#loc_57_3_57_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_3_57_12&#39;)"><span class="hl_varref"><span class="mpre">tagBounds</span></span></a><span class="mpre"> </span><a href="#loc_63_3_63_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_3_63_7&#39;)"><span class="hl_varref"><span class="mpre">trie</span></span></a><span class="mpre"> </span><a href="#loc_54_30_54_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_30_54_36&#39;)"><span class="hl_varref"><span class="mpre">aTagOp</span></span></a><span class="mpre"> </span><a href="#loc_54_37_54_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_37_54_47&#39;)"><span class="hl_varref"><span class="mpre">aGroupInfo</span></span></a><span class="mpre"> </span><a href="#loc_58_3_58_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_3_58_6&#39;)"><span class="hl_varref"><span class="mpre">ifa</span></span></a><span class="mpre"> </span><a href="#loc_54_49_54_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_49_54_51&#39;)"><span class="hl_varref"><span class="mpre">co</span></span></a><span class="mpre"> </span><a href="#loc_54_52_54_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_52_54_54&#39;)"><span class="hl_varref"><span class="mpre">eo</span></span></a><span class="mpre"> where
  </span><a name="loc_55_3_55_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_3_55_6&#39;)"><span class="hl_vardecl"><span class="mpre">dfa</span></span></a><span class="mpre"> = </span><a href="#loc_60_3_60_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_3_60_15&#39;)"><span class="hl_varref"><span class="mpre">indexesToDFA</span></span></a><span class="mpre"> [</span><a href="#loc_54_12_54_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_12_54_22&#39;)"><span class="hl_varref"><span class="mpre">startIndex</span></span></a><span class="mpre">]
  </span><a name="loc_56_3_56_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_3_56_14&#39;)"><span class="hl_vardecl"><span class="mpre">indexBounds</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">bounds</span></span><span class="mpre"> </span><a href="#loc_54_23_54_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_23_54_28&#39;)"><span class="hl_varref"><span class="mpre">aQNFA</span></span></a><span class="mpre">
  </span><a name="loc_57_3_57_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_3_57_12&#39;)"><span class="hl_vardecl"><span class="mpre">tagBounds</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">bounds</span></span><span class="mpre"> </span><a href="#loc_54_30_54_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_30_54_36&#39;)"><span class="hl_varref"><span class="mpre">aTagOp</span></span></a><span class="mpre">
  </span><a name="loc_58_3_58_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_3_58_6&#39;)"><span class="hl_vardecl"><span class="mpre">ifa</span></span></a><span class="mpre"> = (</span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> (</span><a href="Text.Regex.TDFA.Common.html#loc_87_5_87_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_87_5_87_14&#39;)"><span class="hl_varref"><span class="mpre">multiline</span></span></a><span class="mpre"> </span><a href="#loc_54_49_54_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_49_54_51&#39;)"><span class="hl_varref"><span class="mpre">co</span></span></a><span class="mpre">)) </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_299_1_299_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_299_1_299_19&#39;)"><span class="hl_varref"><span class="mpre">isDFAFrontAnchored</span></span></a><span class="mpre"> </span><a href="#loc_55_3_55_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_3_55_6&#39;)"><span class="hl_varref"><span class="mpre">dfa</span></span></a><span class="mpre">

  </span><a name="loc_60_3_60_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_3_60_15&#39;)"><span class="hl_vardecl"><span class="mpre">indexesToDFA</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpSCCPragma (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 60, srcSpanStartColumn = 18, srcSpanEndLine = 60, srcSpanEndColumn = 73}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 60, srcSpanStartColumn = 26, srcSpanEndLine = 60, srcSpanEndColumn = 49},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;,"><span class="mpre">{-# SCC &quot;nfaToDFA.indexesToDFA&quot; #-} Trie.lookupAsc trie</span></span><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- Lookup in cache</span></span><span class="mpre">

  </span><a href="#loc_63_3_63_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_3_63_7&#39;)"><span class="mpre">trie</span></a><span class="mpre"> :: </span><a href="Text.Regex.TDFA.IntArrTrieSet.html#loc_17_6_17_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.IntArrTrieSet.html#loc_17_6_17_13&#39;)"><span class="hl_tyconref"><span class="mpre">TrieSet</span></span></a><span class="mpre"> </span><a href="Text.Regex.TDFA.Common.html#loc_215_6_215_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_215_6_215_9&#39;)"><span class="hl_tyconref"><span class="mpre">DFA</span></span></a><span class="mpre">
  </span><a name="loc_63_3_63_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_3_63_7&#39;)"><span class="hl_vardecl"><span class="mpre">trie</span></span></a><span class="mpre"> = </span><a href="Text.Regex.TDFA.IntArrTrieSet.html#loc_45_1_45_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.IntArrTrieSet.html#loc_45_1_45_17&#39;)"><span class="hl_varref"><span class="mpre">Trie.fromSinglesMerge</span></span></a><span class="mpre"> </span><a href="#loc_40_1_40_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_1_40_6&#39;)"><span class="hl_varref"><span class="mpre">dlose</span></span></a><span class="mpre"> </span><a href="#loc_117_3_117_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_3_117_11&#39;)"><span class="hl_varref"><span class="mpre">mergeDFA</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">bounds</span></span><span class="mpre"> </span><a href="#loc_54_23_54_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_23_54_28&#39;)"><span class="hl_varref"><span class="mpre">aQNFA</span></span></a><span class="mpre">) </span><a href="#loc_86_3_86_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_3_86_13&#39;)"><span class="hl_varref"><span class="mpre">indexToDFA</span></span></a><span class="mpre">

  </span><a href="#loc_66_3_66_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_3_66_16&#39;)"><span class="mpre">newTransition</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">DTrans</span></span><span class="mpre"> -&gt; </span><a href="Text.Regex.TDFA.Common.html#loc_216_6_216_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_216_6_216_16&#39;)"><span class="hl_tyconref"><span class="mpre">Transition</span></span></a><span class="mpre">
  </span><a name="loc_66_3_66_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_3_66_16&#39;)"><span class="hl_fundecl"><span class="mpre">newTransition</span></span></a><span class="mpre"> </span><a name="loc_66_17_66_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_17_66_23&#39;)"><span class="hl_vardecl"><span class="mpre">dtrans</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 66, srcSpanStartColumn = 26, srcSpanEndLine = 68, srcSpanEndColumn = 68}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 66, srcSpanStartColumn = 37, srcSpanEndLine = 66, srcSpanEndColumn = 38},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;,"><span class="mpre">Transition { trans_many = indexesToDFA (IMap.keys dtransWithSpawn)
                                    , trans_single = indexesToDFA (IMap.keys dtrans)
                                    , trans_how = dtransWithSpawn }</span></span><span class="mpre">
    where </span><span class="hl_vardecl"><span class="mpre">dtransWithSpawn</span></span><span class="mpre"> = </span><a href="#loc_82_3_82_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_3_82_11&#39;)"><span class="hl_varref"><span class="mpre">addSpawn</span></span></a><span class="mpre"> </span><a href="#loc_66_17_66_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_17_66_23&#39;)"><span class="hl_varref"><span class="mpre">dtrans</span></span></a><span class="mpre">

  </span><a href="#loc_72_3_72_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_3_72_17&#39;)"><span class="mpre">makeTransition</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">DTrans</span></span><span class="mpre"> -&gt; </span><a href="Text.Regex.TDFA.Common.html#loc_216_6_216_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_216_6_216_16&#39;)"><span class="hl_tyconref"><span class="mpre">Transition</span></span></a><span class="mpre">
  </span><a name="loc_72_3_72_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_3_72_17&#39;)"><span class="hl_fundecl"><span class="mpre">makeTransition</span></span></a><span class="mpre"> </span><a name="loc_72_18_72_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_18_72_24&#39;)"><span class="hl_vardecl"><span class="mpre">dtrans</span></span></a><span class="mpre"> | </span><a href="#loc_78_11_78_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_11_78_19&#39;)"><span class="hl_varref"><span class="mpre">hasSpawn</span></span></a><span class="mpre">  = </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 72, srcSpanStartColumn = 39, srcSpanEndLine = 74, srcSpanEndColumn = 72}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 72, srcSpanStartColumn = 50, srcSpanEndLine = 72, srcSpanEndColumn = 51},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;,"><span class="mpre">Transition { trans_many = indexesToDFA (IMap.keys dtrans)
                                                 , trans_single = indexesToDFA (IMap.keys (IMap.delete startIndex dtrans))
                                                 , trans_how = dtrans }</span></span><span class="mpre">
                        | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 75, srcSpanStartColumn = 39, srcSpanEndLine = 77, srcSpanEndColumn = 72}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 75, srcSpanStartColumn = 50, srcSpanEndLine = 75, srcSpanEndColumn = 51},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;,"><span class="mpre">Transition { trans_many = indexesToDFA (IMap.keys dtrans)
                                                 , trans_single = indexesToDFA (IMap.keys dtrans)
                                                 , trans_how = dtrans }</span></span><span class="mpre">
    where </span><a name="loc_78_11_78_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_11_78_19&#39;)"><span class="hl_vardecl"><span class="mpre">hasSpawn</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">maybe</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">IMap.null</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">IMap.lookup</span></span><span class="mpre"> </span><a href="#loc_54_12_54_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_12_54_22&#39;)"><span class="hl_varref"><span class="mpre">startIndex</span></span></a><span class="mpre"> </span><a href="#loc_72_18_72_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_18_72_24&#39;)"><span class="hl_varref"><span class="mpre">dtrans</span></span></a><span class="mpre">)

  </span><span class="hl_comment"><span class="mpre">-- coming from (-1) means spawn a new starting item</span></span><span class="mpre">
  </span><a href="#loc_82_3_82_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_3_82_11&#39;)"><span class="mpre">addSpawn</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">DTrans</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">DTrans</span></span><span class="mpre">
  </span><a name="loc_82_3_82_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_3_82_11&#39;)"><span class="hl_fundecl"><span class="mpre">addSpawn</span></span></a><span class="mpre"> </span><a name="loc_82_12_82_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_12_82_18&#39;)"><span class="hl_vardecl"><span class="mpre">dtrans</span></span></a><span class="mpre"> | </span><span class="hl_varref"><span class="mpre">IMap.member</span></span><span class="mpre"> </span><a href="#loc_54_12_54_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_12_54_22&#39;)"><span class="hl_varref"><span class="mpre">startIndex</span></span></a><span class="mpre"> </span><a href="#loc_82_12_82_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_12_82_18&#39;)"><span class="hl_varref"><span class="mpre">dtrans</span></span></a><span class="mpre"> = </span><a href="#loc_82_12_82_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_12_82_18&#39;)"><span class="hl_varref"><span class="mpre">dtrans</span></span></a><span class="mpre">
                  | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">IMap.insert</span></span><span class="mpre"> </span><a href="#loc_54_12_54_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_12_54_22&#39;)"><span class="hl_varref"><span class="mpre">startIndex</span></span></a><span class="mpre"> </span><a href="Data.Monoid.html#loc_80_9_80_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_80_9_80_15&#39;)"><span class="hl_varref"><span class="mpre">mempty</span></span></a><span class="mpre"> </span><a href="#loc_82_12_82_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_12_82_18&#39;)"><span class="hl_varref"><span class="mpre">dtrans</span></span></a><span class="mpre">

  </span><a href="#loc_86_3_86_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_3_86_13&#39;)"><span class="mpre">indexToDFA</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Index</span></span><span class="mpre"> -&gt; </span><a href="Text.Regex.TDFA.Common.html#loc_215_6_215_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_215_6_215_9&#39;)"><span class="hl_tyconref"><span class="mpre">DFA</span></span></a><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- used to seed the Trie from the NFA</span></span><span class="mpre">
  </span><a name="loc_86_3_86_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_3_86_13&#39;)"><span class="hl_fundecl"><span class="mpre">indexToDFA</span></span></a><span class="mpre"> </span><a name="loc_86_14_86_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_14_86_15&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpSCCPragma (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 86, srcSpanStartColumn = 18, srcSpanEndLine = 86, srcSpanEndColumn = 97}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 86, srcSpanStartColumn = 26, srcSpanEndLine = 86, srcSpanEndColumn = 47},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;,"><span class="mpre">{-# SCC &quot;nfaToDFA.indexToDFA&quot; #-} makeDFA (ISet.singleton source) (qtToDT qtIn)</span></span><span class="mpre">
    where
      (</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 88, srcSpanStartColumn = 8, srcSpanEndLine = 88, srcSpanEndColumn = 40}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 88, srcSpanStartColumn = 13, srcSpanEndLine = 88, srcSpanEndColumn = 14},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSp"><span class="mpre">QNFA {q_id = source,q_qt = qtIn}</span></span><span class="mpre">) = </span><a href="#loc_54_23_54_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_23_54_28&#39;)"><span class="hl_varref"><span class="mpre">aQNFA</span></span></a><span class="hl_infix"><span class="mpre">!</span></span><a href="#loc_86_14_86_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_14_86_15&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">
      </span><a href="#loc_90_7_90_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_7_90_13&#39;)"><span class="mpre">qtToDT</span></a><span class="mpre"> :: </span><a href="Text.Regex.TDFA.Common.html#loc_169_6_169_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_169_6_169_8&#39;)"><span class="hl_tyconref"><span class="mpre">QT</span></span></a><span class="mpre"> -&gt; </span><a href="Text.Regex.TDFA.Common.html#loc_221_6_221_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_221_6_221_8&#39;)"><span class="hl_tyconref"><span class="mpre">DT</span></span></a><span class="mpre">
      </span><a name="loc_90_7_90_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_7_90_13&#39;)"><span class="hl_fundecl"><span class="mpre">qtToDT</span></span></a><span class="mpre"> (</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 90, srcSpanStartColumn = 15, srcSpanEndLine = 90, srcSpanEndColumn = 67}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 90, srcSpanStartColumn = 23, srcSpanEndLine = 90, srcSpanEndColumn = 24},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcS"><span class="mpre">Testing {qt_test=wt, qt_dopas=dopas, qt_a=a, qt_b=b}</span></span><span class="mpre">) =
          </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 91, srcSpanStartColumn = 11, srcSpanEndLine = 94, srcSpanEndColumn = 39}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 91, srcSpanStartColumn = 20, srcSpanEndLine = 91, srcSpanEndColumn = 21},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;,"><span class="mpre">Testing&#39; { dt_test = wt
                   , dt_dopas = dopas
                   , dt_a = qtToDT a
                   , dt_b = qtToDT b }</span></span><span class="mpre">
      </span><a href="#loc_90_7_90_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_7_90_13&#39;)"><span class="hl_fundecl"><span class="mpre">qtToDT</span></span></a><span class="mpre"> (</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 95, srcSpanStartColumn = 15, srcSpanEndLine = 95, srcSpanEndColumn = 56}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 95, srcSpanStartColumn = 22, srcSpanEndLine = 95, srcSpanEndColumn = 23},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcS"><span class="mpre">Simple {qt_win=w, qt_trans=t, qt_other=o}</span></span><span class="mpre">) =
        </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 96, srcSpanStartColumn = 9, srcSpanEndLine = 99, srcSpanEndColumn = 44}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 96, srcSpanStartColumn = 17, srcSpanEndLine = 96, srcSpanEndColumn = 18},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, "><span class="mpre">Simple&#39; { dt_win = makeWinner
                , dt_trans = fmap qtransToDFA t
</span><span class="hl_comment"><span class="mpre">--                , dt_other = if IMap.null o then Just (newTransition $ IMap.singleton startIndex mempty) else Just (qtransToDFA o)}</span></span><span class="mpre">
                , dt_other = qtransToDFA o}</span></span><span class="mpre">
        where
          </span><a href="#loc_102_11_102_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_11_102_21&#39;)"><span class="mpre">makeWinner</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IntMap</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">{- Index -}</span></span><span class="mpre"> </span><a href="Text.Regex.TDFA.Common.html#loc_259_6_259_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_259_6_259_18&#39;)"><span class="hl_tyconref"><span class="mpre">Instructions</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">--  (RunState ())</span></span><span class="mpre">
          </span><a name="loc_102_11_102_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_11_102_21&#39;)"><span class="hl_vardecl"><span class="mpre">makeWinner</span></span></a><span class="mpre"> | </span><a href="Text.Regex.TDFA.Common.html#loc_70_1_70_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_70_1_70_6&#39;)"><span class="hl_varref"><span class="mpre">noWin</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">w</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">IMap.empty</span></span><span class="mpre">
                     | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">IMap.singleton</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">source</span></span><span class="mpre"> (</span><a href="#loc_220_1_220_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_220_1_220_9&#39;)"><span class="hl_varref"><span class="mpre">cleanWin</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">w</span></span><span class="mpre">)

          </span><a href="#loc_106_11_106_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_11_106_22&#39;)"><span class="mpre">qtransToDFA</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">QTrans</span></span><span class="mpre"> -&gt; </span><a href="Text.Regex.TDFA.Common.html#loc_216_6_216_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_216_6_216_16&#39;)"><span class="hl_tyconref"><span class="mpre">Transition</span></span></a><span class="mpre">
          </span><a name="loc_106_11_106_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_11_106_22&#39;)"><span class="hl_fundecl"><span class="mpre">qtransToDFA</span></span></a><span class="mpre"> </span><a name="loc_106_23_106_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_23_106_29&#39;)"><span class="hl_vardecl"><span class="mpre">qtrans</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpSCCPragma (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 106, srcSpanStartColumn = 32, srcSpanEndLine = 107, srcSpanEndColumn = 52}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 106, srcSpanStartColumn = 40, srcSpanEndLine = 106, srcSpanEndColumn = 73},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA."><span class="mpre">{-# SCC &quot;nfaToDFA.indexToDFA.qtransToDFA&quot; #-}
                               newTransition dtrans</span></span><span class="mpre">
            where
              </span><a href="#loc_110_15_110_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_15_110_21&#39;)"><span class="mpre">dtrans</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">DTrans</span></span><span class="mpre">
              </span><a name="loc_110_15_110_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_15_110_21&#39;)"><span class="hl_vardecl"><span class="mpre">dtrans</span></span></a><span class="mpre"> =</span><span class="hl_varref"><span class="mpre">IMap.fromDistinctAscList</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Text.Regex.TDFA.Common.html#loc_53_1_53_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_53_1_53_7&#39;)"><span class="hl_varref"><span class="mpre">mapSnd</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">IMap.singleton</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">source</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_112_15_112_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_15_112_19&#39;)"><span class="hl_varref"><span class="mpre">best</span></span></a><span class="mpre">
              </span><a href="#loc_112_15_112_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_15_112_19&#39;)"><span class="mpre">best</span></a><span class="mpre"> :: [(</span><span class="hl_tyconref"><span class="mpre">Index</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">{- Destination -}</span></span><span class="mpre"> ,(</span><a href="Text.Regex.TDFA.Common.html#loc_74_9_74_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_74_9_74_13&#39;)"><span class="hl_tyconref"><span class="mpre">DoPa</span></span></a><span class="mpre">,</span><a href="Text.Regex.TDFA.Common.html#loc_259_6_259_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_259_6_259_18&#39;)"><span class="hl_tyconref"><span class="mpre">Instructions</span></span></a><span class="mpre">))]
              </span><a name="loc_112_15_112_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_15_112_19&#39;)"><span class="hl_vardecl"><span class="mpre">best</span></span></a><span class="mpre"> = </span><a href="#loc_217_1_217_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_1_217_11&#39;)"><span class="hl_varref"><span class="mpre">pickQTrans</span></span></a><span class="mpre"> </span><a href="#loc_54_30_54_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_30_54_36&#39;)"><span class="hl_varref"><span class="mpre">aTagOp</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_106_23_106_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_23_106_29&#39;)"><span class="hl_varref"><span class="mpre">qtrans</span></span></a><span class="mpre">

  </span><span class="hl_comment"><span class="mpre">-- The DFA states are built up by merging the singleton ones converted from the NFA.</span></span><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">-- Thus the &quot;source&quot; indices in the DTrans should not collide.</span></span><span class="mpre">
  </span><a href="#loc_117_3_117_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_3_117_11&#39;)"><span class="mpre">mergeDFA</span></a><span class="mpre"> :: </span><a href="Text.Regex.TDFA.Common.html#loc_215_6_215_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_215_6_215_9&#39;)"><span class="hl_tyconref"><span class="mpre">DFA</span></span></a><span class="mpre"> -&gt; </span><a href="Text.Regex.TDFA.Common.html#loc_215_6_215_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_215_6_215_9&#39;)"><span class="hl_tyconref"><span class="mpre">DFA</span></span></a><span class="mpre"> -&gt; </span><a href="Text.Regex.TDFA.Common.html#loc_215_6_215_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_215_6_215_9&#39;)"><span class="hl_tyconref"><span class="mpre">DFA</span></span></a><span class="mpre">
  </span><a name="loc_117_3_117_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_3_117_11&#39;)"><span class="hl_fundecl"><span class="mpre">mergeDFA</span></span></a><span class="mpre"> </span><a name="loc_117_12_117_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_12_117_14&#39;)"><span class="hl_vardecl"><span class="mpre">d1</span></span></a><span class="mpre"> </span><a name="loc_117_15_117_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_15_117_17&#39;)"><span class="hl_vardecl"><span class="mpre">d2</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpSCCPragma (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 117, srcSpanStartColumn = 20, srcSpanEndLine = 117, srcSpanEndColumn = 64}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 117, srcSpanStartColumn = 28, srcSpanEndLine = 117, srcSpanEndColumn = 47},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA."><span class="mpre">{-# SCC &quot;nfaToDFA.mergeDFA&quot; #-} makeDFA i dt</span></span><span class="mpre">
    where
      </span><span class="hl_vardecl"><span class="mpre">i</span></span><span class="mpre"> = </span><a href="Text.Regex.TDFA.Common.html#loc_215_18_215_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_215_18_215_22&#39;)"><span class="hl_varref"><span class="mpre">d_id</span></span></a><span class="mpre"> </span><a href="#loc_117_12_117_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_12_117_14&#39;)"><span class="hl_varref"><span class="mpre">d1</span></span></a><span class="mpre"> </span><a href="Data.Monoid.html#loc_82_9_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_82_9_82_16&#39;)"><span class="hl_infix"><span class="mpre">`mappend`</span></span></a><span class="mpre"> </span><a href="Text.Regex.TDFA.Common.html#loc_215_18_215_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_215_18_215_22&#39;)"><span class="hl_varref"><span class="mpre">d_id</span></span></a><span class="mpre"> </span><a href="#loc_117_15_117_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_15_117_17&#39;)"><span class="hl_varref"><span class="mpre">d2</span></span></a><span class="mpre">
      </span><span class="hl_vardecl"><span class="mpre">dt</span></span><span class="mpre"> = </span><a href="Text.Regex.TDFA.Common.html#loc_215_36_215_40" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_215_36_215_40&#39;)"><span class="hl_varref"><span class="mpre">d_dt</span></span></a><span class="mpre"> </span><a href="#loc_117_12_117_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_12_117_14&#39;)"><span class="hl_varref"><span class="mpre">d1</span></span></a><span class="mpre"> </span><a href="#loc_122_7_122_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_7_122_14&#39;)"><span class="hl_infix"><span class="mpre">`mergeDT`</span></span></a><span class="mpre"> </span><a href="Text.Regex.TDFA.Common.html#loc_215_36_215_40" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_215_36_215_40&#39;)"><span class="hl_varref"><span class="mpre">d_dt</span></span></a><span class="mpre"> </span><a href="#loc_117_15_117_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_15_117_17&#39;)"><span class="hl_varref"><span class="mpre">d2</span></span></a><span class="mpre">
      </span><a href="#loc_122_7_122_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_7_122_14&#39;)"><span class="mpre">mergeDT</span></a><span class="mpre">,</span><a href="#loc_157_7_157_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_7_157_13&#39;)"><span class="mpre">nestDT</span></a><span class="mpre"> :: </span><a href="Text.Regex.TDFA.Common.html#loc_221_6_221_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_221_6_221_8&#39;)"><span class="hl_tyconref"><span class="mpre">DT</span></span></a><span class="mpre"> -&gt; </span><a href="Text.Regex.TDFA.Common.html#loc_221_6_221_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_221_6_221_8&#39;)"><span class="hl_tyconref"><span class="mpre">DT</span></span></a><span class="mpre"> -&gt; </span><a href="Text.Regex.TDFA.Common.html#loc_221_6_221_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_221_6_221_8&#39;)"><span class="hl_tyconref"><span class="mpre">DT</span></span></a><span class="mpre">
      </span><a name="loc_122_7_122_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_7_122_14&#39;)"><span class="hl_fundecl"><span class="mpre">mergeDT</span></span></a><span class="mpre"> (</span><a href="Text.Regex.TDFA.Common.html#loc_221_11_221_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_221_11_221_18&#39;)"><span class="hl_conref"><span class="mpre">Simple&#39;</span></span></a><span class="mpre"> </span><a name="loc_122_24_122_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_24_122_26&#39;)"><span class="hl_vardecl"><span class="mpre">w1</span></span></a><span class="mpre"> </span><a name="loc_122_27_122_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_27_122_29&#39;)"><span class="hl_vardecl"><span class="mpre">t1</span></span></a><span class="mpre"> </span><a name="loc_122_30_122_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_30_122_32&#39;)"><span class="hl_vardecl"><span class="mpre">o1</span></span></a><span class="mpre">) (</span><a href="Text.Regex.TDFA.Common.html#loc_221_11_221_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_221_11_221_18&#39;)"><span class="hl_conref"><span class="mpre">Simple&#39;</span></span></a><span class="mpre"> </span><a name="loc_122_43_122_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_43_122_45&#39;)"><span class="hl_vardecl"><span class="mpre">w2</span></span></a><span class="mpre"> </span><a name="loc_122_46_122_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_46_122_48&#39;)"><span class="hl_vardecl"><span class="mpre">t2</span></span></a><span class="mpre"> </span><a name="loc_122_49_122_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_49_122_51&#39;)"><span class="hl_vardecl"><span class="mpre">o2</span></span></a><span class="mpre">) = </span><a href="Text.Regex.TDFA.Common.html#loc_221_11_221_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_221_11_221_18&#39;)"><span class="hl_conref"><span class="mpre">Simple&#39;</span></span></a><span class="mpre"> </span><a href="#loc_124_11_124_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_11_124_12&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><a href="#loc_125_11_125_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_11_125_12&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> </span><a href="#loc_126_11_126_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_11_126_12&#39;)"><span class="hl_varref"><span class="mpre">o</span></span></a><span class="mpre">
        where
          </span><a name="loc_124_11_124_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_11_124_12&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> = </span><a href="#loc_122_24_122_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_24_122_26&#39;)"><span class="hl_varref"><span class="mpre">w1</span></span></a><span class="mpre"> </span><a href="Data.Monoid.html#loc_82_9_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_82_9_82_16&#39;)"><span class="hl_infix"><span class="mpre">`mappend`</span></span></a><span class="mpre"> </span><a href="#loc_122_43_122_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_43_122_45&#39;)"><span class="hl_varref"><span class="mpre">w2</span></span></a><span class="mpre">
          </span><a name="loc_125_11_125_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_11_125_12&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> = </span><a href="#loc_133_11_133_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_11_133_21&#39;)"><span class="hl_varref"><span class="mpre">fuseDTrans</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- t1 o1 t2 o2</span></span><span class="mpre">
          </span><a name="loc_126_11_126_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_11_126_12&#39;)"><span class="hl_vardecl"><span class="mpre">o</span></span></a><span class="mpre"> = </span><a href="#loc_129_11_129_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_11_129_22&#39;)"><span class="hl_varref"><span class="mpre">mergeDTrans</span></span></a><span class="mpre"> </span><a href="#loc_122_30_122_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_30_122_32&#39;)"><span class="hl_varref"><span class="mpre">o1</span></span></a><span class="mpre"> </span><a href="#loc_122_49_122_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_49_122_51&#39;)"><span class="hl_varref"><span class="mpre">o2</span></span></a><span class="mpre">
          </span><span class="hl_comment"><span class="mpre">-- This is very much like mergeQTrans</span></span><span class="mpre">
          </span><a href="#loc_129_11_129_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_11_129_22&#39;)"><span class="mpre">mergeDTrans</span></a><span class="mpre"> :: </span><a href="Text.Regex.TDFA.Common.html#loc_216_6_216_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_216_6_216_16&#39;)"><span class="hl_tyconref"><span class="mpre">Transition</span></span></a><span class="mpre"> -&gt; </span><a href="Text.Regex.TDFA.Common.html#loc_216_6_216_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_216_6_216_16&#39;)"><span class="hl_tyconref"><span class="mpre">Transition</span></span></a><span class="mpre"> -&gt; </span><a href="Text.Regex.TDFA.Common.html#loc_216_6_216_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_216_6_216_16&#39;)"><span class="hl_tyconref"><span class="mpre">Transition</span></span></a><span class="mpre">
          </span><a name="loc_129_11_129_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_11_129_22&#39;)"><span class="hl_fundecl"><span class="mpre">mergeDTrans</span></span></a><span class="mpre"> (</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 129, srcSpanStartColumn = 24, srcSpanEndLine = 129, srcSpanEndColumn = 50}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 129, srcSpanStartColumn = 35, srcSpanEndLine = 129, srcSpanEndColumn = 36},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, "><span class="mpre">Transition {trans_how=dt1}</span></span><span class="mpre">) (</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 129, srcSpanStartColumn = 53, srcSpanEndLine = 129, srcSpanEndColumn = 79}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 129, srcSpanStartColumn = 64, srcSpanEndLine = 129, srcSpanEndColumn = 65},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, "><span class="mpre">Transition {trans_how=dt2}</span></span><span class="mpre">) = </span><a href="#loc_72_3_72_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_3_72_17&#39;)"><span class="hl_varref"><span class="mpre">makeTransition</span></span></a><span class="mpre"> </span><a href="#loc_130_19_130_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_19_130_25&#39;)"><span class="hl_varref"><span class="mpre">dtrans</span></span></a><span class="mpre">
            where </span><a name="loc_130_19_130_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_19_130_25&#39;)"><span class="hl_vardecl"><span class="mpre">dtrans</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">IMap.unionWith</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">IMap.union</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">dt1</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">dt2</span></span><span class="mpre">
          </span><span class="hl_comment"><span class="mpre">-- This is very much like fuseQTrans</span></span><span class="mpre">
          </span><a href="#loc_133_11_133_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_11_133_21&#39;)"><span class="mpre">fuseDTrans</span></a><span class="mpre"> :: </span><a href="Data.IntMap.CharMap2.html#loc_19_9_19_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.IntMap.CharMap2.html#loc_19_9_19_16&#39;)"><span class="hl_tyconref"><span class="mpre">CharMap</span></span></a><span class="mpre"> </span><a href="Text.Regex.TDFA.Common.html#loc_216_6_216_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_216_6_216_16&#39;)"><span class="hl_tyconref"><span class="mpre">Transition</span></span></a><span class="mpre">
          </span><a name="loc_133_11_133_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_11_133_21&#39;)"><span class="hl_vardecl"><span class="mpre">fuseDTrans</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">CharMap</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">IMap.fromDistinctAscList</span></span><span class="mpre"> (</span><a href="#loc_140_15_140_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_15_140_19&#39;)"><span class="hl_varref"><span class="mpre">fuse</span></span></a><span class="mpre"> </span><a href="#loc_135_15_135_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_15_135_17&#39;)"><span class="hl_varref"><span class="mpre">l1</span></span></a><span class="mpre"> </span><a href="#loc_136_15_136_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_15_136_17&#39;)"><span class="hl_varref"><span class="mpre">l2</span></span></a><span class="mpre">))
            where
              </span><a name="loc_135_15_135_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_15_135_17&#39;)"><span class="hl_vardecl"><span class="mpre">l1</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">IMap.toAscList</span></span><span class="mpre"> (</span><a href="Data.IntMap.CharMap2.html#loc_19_30_19_39" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.IntMap.CharMap2.html#loc_19_30_19_39&#39;)"><span class="hl_varref"><span class="mpre">unCharMap</span></span></a><span class="mpre"> </span><a href="#loc_122_27_122_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_27_122_29&#39;)"><span class="hl_varref"><span class="mpre">t1</span></span></a><span class="mpre">)
              </span><a name="loc_136_15_136_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_15_136_17&#39;)"><span class="hl_vardecl"><span class="mpre">l2</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">IMap.toAscList</span></span><span class="mpre"> (</span><a href="Data.IntMap.CharMap2.html#loc_19_30_19_39" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.IntMap.CharMap2.html#loc_19_30_19_39&#39;)"><span class="hl_varref"><span class="mpre">unCharMap</span></span></a><span class="mpre"> </span><a href="#loc_122_46_122_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_46_122_48&#39;)"><span class="hl_varref"><span class="mpre">t2</span></span></a><span class="mpre">)
              </span><a href="#loc_140_15_140_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_15_140_19&#39;)"><span class="mpre">fuse</span></a><span class="mpre"> :: [(</span><span class="hl_tyconref"><span class="mpre">IMap.Key</span></span><span class="mpre">, </span><a href="Text.Regex.TDFA.Common.html#loc_216_6_216_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_216_6_216_16&#39;)"><span class="hl_tyconref"><span class="mpre">Transition</span></span></a><span class="mpre">)]
                   -&gt; [(</span><span class="hl_tyconref"><span class="mpre">IMap.Key</span></span><span class="mpre">, </span><a href="Text.Regex.TDFA.Common.html#loc_216_6_216_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_216_6_216_16&#39;)"><span class="hl_tyconref"><span class="mpre">Transition</span></span></a><span class="mpre">)]
                   -&gt; [(</span><span class="hl_tyconref"><span class="mpre">IMap.Key</span></span><span class="mpre">, </span><a href="Text.Regex.TDFA.Common.html#loc_216_6_216_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_216_6_216_16&#39;)"><span class="hl_tyconref"><span class="mpre">Transition</span></span></a><span class="mpre">)]
              </span><a name="loc_140_15_140_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_15_140_19&#39;)"><span class="hl_fundecl"><span class="mpre">fuse</span></span></a><span class="mpre"> [] </span><a name="loc_140_23_140_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_23_140_24&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> (</span><a href="#loc_129_11_129_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_11_129_22&#39;)"><span class="hl_varref"><span class="mpre">mergeDTrans</span></span></a><span class="mpre"> </span><a href="#loc_122_30_122_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_30_122_32&#39;)"><span class="hl_varref"><span class="mpre">o1</span></span></a><span class="mpre">)) </span><a href="#loc_140_23_140_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_23_140_24&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">
              </span><a href="#loc_140_15_140_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_15_140_19&#39;)"><span class="hl_fundecl"><span class="mpre">fuse</span></span></a><span class="mpre"> </span><a name="loc_141_20_141_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_20_141_21&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> [] = </span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> (</span><a href="#loc_129_11_129_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_11_129_22&#39;)"><span class="hl_varref"><span class="mpre">mergeDTrans</span></span></a><span class="mpre"> </span><a href="#loc_122_49_122_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_49_122_51&#39;)"><span class="hl_varref"><span class="mpre">o2</span></span></a><span class="mpre">)) </span><a href="#loc_141_20_141_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_20_141_21&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
              </span><a href="#loc_140_15_140_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_15_140_19&#39;)"><span class="hl_fundecl"><span class="mpre">fuse</span></span></a><span class="mpre"> </span><a name="loc_142_20_142_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_20_142_21&#39;)"><span class="hl_specname"><span class="mpre">x</span></span></a><span class="mpre">@((</span><a name="loc_142_24_142_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_24_142_26&#39;)"><span class="hl_vardecl"><span class="mpre">xc</span></span></a><span class="mpre">,</span><a name="loc_142_27_142_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_27_142_29&#39;)"><span class="hl_vardecl"><span class="mpre">xa</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_142_31_142_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_31_142_33&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) </span><a name="loc_142_35_142_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_35_142_36&#39;)"><span class="hl_specname"><span class="mpre">y</span></span></a><span class="mpre">@((</span><a name="loc_142_39_142_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_39_142_41&#39;)"><span class="hl_vardecl"><span class="mpre">yc</span></span></a><span class="mpre">,</span><a name="loc_142_42_142_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_42_142_44&#39;)"><span class="hl_vardecl"><span class="mpre">ya</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_142_46_142_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_46_142_48&#39;)"><span class="hl_vardecl"><span class="mpre">ys</span></span></a><span class="mpre">) = 
                case </span><span class="hl_varref"><span class="mpre">compare</span></span><span class="mpre"> </span><a href="#loc_142_24_142_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_24_142_26&#39;)"><span class="hl_varref"><span class="mpre">xc</span></span></a><span class="mpre"> </span><a href="#loc_142_39_142_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_39_142_41&#39;)"><span class="hl_varref"><span class="mpre">yc</span></span></a><span class="mpre"> of
                  </span><span class="hl_conref"><span class="mpre">LT</span></span><span class="mpre"> -&gt; (</span><a href="#loc_142_24_142_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_24_142_26&#39;)"><span class="hl_varref"><span class="mpre">xc</span></span></a><span class="mpre">,</span><a href="#loc_129_11_129_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_11_129_22&#39;)"><span class="hl_varref"><span class="mpre">mergeDTrans</span></span></a><span class="mpre"> </span><a href="#loc_122_49_122_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_49_122_51&#39;)"><span class="hl_varref"><span class="mpre">o2</span></span></a><span class="mpre"> </span><a href="#loc_142_27_142_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_27_142_29&#39;)"><span class="hl_varref"><span class="mpre">xa</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_140_15_140_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_15_140_19&#39;)"><span class="hl_varref"><span class="mpre">fuse</span></span></a><span class="mpre"> </span><a href="#loc_142_31_142_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_31_142_33&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> </span><a href="#loc_142_35_142_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_35_142_36&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">
                  </span><span class="hl_conref"><span class="mpre">EQ</span></span><span class="mpre"> -&gt; (</span><a href="#loc_142_24_142_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_24_142_26&#39;)"><span class="hl_varref"><span class="mpre">xc</span></span></a><span class="mpre">,</span><a href="#loc_129_11_129_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_11_129_22&#39;)"><span class="hl_varref"><span class="mpre">mergeDTrans</span></span></a><span class="mpre"> </span><a href="#loc_142_27_142_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_27_142_29&#39;)"><span class="hl_varref"><span class="mpre">xa</span></span></a><span class="mpre"> </span><a href="#loc_142_42_142_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_42_142_44&#39;)"><span class="hl_varref"><span class="mpre">ya</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_140_15_140_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_15_140_19&#39;)"><span class="hl_varref"><span class="mpre">fuse</span></span></a><span class="mpre"> </span><a href="#loc_142_31_142_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_31_142_33&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> </span><a href="#loc_142_46_142_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_46_142_48&#39;)"><span class="hl_varref"><span class="mpre">ys</span></span></a><span class="mpre">
                  </span><span class="hl_conref"><span class="mpre">GT</span></span><span class="mpre"> -&gt; (</span><a href="#loc_142_39_142_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_39_142_41&#39;)"><span class="hl_varref"><span class="mpre">yc</span></span></a><span class="mpre">,</span><a href="#loc_129_11_129_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_11_129_22&#39;)"><span class="hl_varref"><span class="mpre">mergeDTrans</span></span></a><span class="mpre"> </span><a href="#loc_122_30_122_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_30_122_32&#39;)"><span class="hl_varref"><span class="mpre">o1</span></span></a><span class="mpre"> </span><a href="#loc_142_42_142_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_42_142_44&#39;)"><span class="hl_varref"><span class="mpre">ya</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_140_15_140_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_15_140_19&#39;)"><span class="hl_varref"><span class="mpre">fuse</span></span></a><span class="mpre"> </span><a href="#loc_142_20_142_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_20_142_21&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_142_46_142_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_46_142_48&#39;)"><span class="hl_varref"><span class="mpre">ys</span></span></a><span class="mpre">
      </span><a href="#loc_122_7_122_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_7_122_14&#39;)"><span class="hl_fundecl"><span class="mpre">mergeDT</span></span></a><span class="mpre"> </span><a name="loc_147_15_147_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_15_147_18&#39;)"><span class="hl_specname"><span class="mpre">dt1</span></span></a><span class="mpre">@(</span><a href="Text.Regex.TDFA.Common.html#loc_225_11_225_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_225_11_225_19&#39;)"><span class="hl_conref"><span class="mpre">Testing&#39;</span></span></a><span class="mpre"> </span><a name="loc_147_29_147_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_29_147_32&#39;)"><span class="hl_vardecl"><span class="mpre">wt1</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">dopas1</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">a1</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">b1</span></span><span class="mpre">) </span><a name="loc_147_47_147_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_47_147_50&#39;)"><span class="hl_specname"><span class="mpre">dt2</span></span></a><span class="mpre">@(</span><a href="Text.Regex.TDFA.Common.html#loc_225_11_225_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_225_11_225_19&#39;)"><span class="hl_conref"><span class="mpre">Testing&#39;</span></span></a><span class="mpre"> </span><a name="loc_147_61_147_64" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_61_147_64&#39;)"><span class="hl_vardecl"><span class="mpre">wt2</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">dopas2</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">a2</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">b2</span></span><span class="mpre">) =
        case </span><span class="hl_varref"><span class="mpre">compare</span></span><span class="mpre"> </span><a href="#loc_147_29_147_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_29_147_32&#39;)"><span class="hl_varref"><span class="mpre">wt1</span></span></a><span class="mpre"> </span><a href="#loc_147_61_147_64" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_61_147_64&#39;)"><span class="hl_varref"><span class="mpre">wt2</span></span></a><span class="mpre"> of
          </span><span class="hl_conref"><span class="mpre">LT</span></span><span class="mpre"> -&gt; </span><a href="#loc_157_7_157_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_7_157_13&#39;)"><span class="hl_varref"><span class="mpre">nestDT</span></span></a><span class="mpre"> </span><a href="#loc_147_15_147_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_15_147_18&#39;)"><span class="hl_varref"><span class="mpre">dt1</span></span></a><span class="mpre"> </span><a href="#loc_147_47_147_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_47_147_50&#39;)"><span class="hl_varref"><span class="mpre">dt2</span></span></a><span class="mpre">
          </span><span class="hl_conref"><span class="mpre">EQ</span></span><span class="mpre"> -&gt; </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 150, srcSpanStartColumn = 17, srcSpanEndLine = 153, srcSpanEndColumn = 50}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 150, srcSpanStartColumn = 26, srcSpanEndLine = 150, srcSpanEndColumn = 27},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA."><span class="mpre">Testing&#39; { dt_test = wt1
                         , dt_dopas = dopas1 `mappend` dopas2
                         , dt_a = mergeDT a1 a2
                         , dt_b = mergeDT b1 b2 }</span></span><span class="mpre">
          </span><span class="hl_conref"><span class="mpre">GT</span></span><span class="mpre"> -&gt; </span><a href="#loc_157_7_157_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_7_157_13&#39;)"><span class="hl_varref"><span class="mpre">nestDT</span></span></a><span class="mpre"> </span><a href="#loc_147_47_147_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_47_147_50&#39;)"><span class="hl_varref"><span class="mpre">dt2</span></span></a><span class="mpre"> </span><a href="#loc_147_15_147_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_15_147_18&#39;)"><span class="hl_varref"><span class="mpre">dt1</span></span></a><span class="mpre">
      </span><a href="#loc_122_7_122_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_7_122_14&#39;)"><span class="hl_fundecl"><span class="mpre">mergeDT</span></span></a><span class="mpre"> </span><a name="loc_155_15_155_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_15_155_18&#39;)"><span class="hl_specname"><span class="mpre">dt1</span></span></a><span class="mpre">@(</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 155, srcSpanStartColumn = 20, srcSpanEndLine = 155, srcSpanEndColumn = 31}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 155, srcSpanStartColumn = 29, srcSpanEndLine = 155, srcSpanEndColumn = 30},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, "><span class="mpre">Testing&#39; {}</span></span><span class="mpre">) </span><a name="loc_155_33_155_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_33_155_36&#39;)"><span class="hl_vardecl"><span class="mpre">dt2</span></span></a><span class="mpre"> = </span><a href="#loc_157_7_157_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_7_157_13&#39;)"><span class="hl_varref"><span class="mpre">nestDT</span></span></a><span class="mpre"> </span><a href="#loc_155_15_155_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_15_155_18&#39;)"><span class="hl_varref"><span class="mpre">dt1</span></span></a><span class="mpre"> </span><a href="#loc_155_33_155_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_33_155_36&#39;)"><span class="hl_varref"><span class="mpre">dt2</span></span></a><span class="mpre">
      </span><a href="#loc_122_7_122_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_7_122_14&#39;)"><span class="hl_fundecl"><span class="mpre">mergeDT</span></span></a><span class="mpre"> </span><a name="loc_156_15_156_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_15_156_18&#39;)"><span class="hl_vardecl"><span class="mpre">dt1</span></span></a><span class="mpre"> </span><a name="loc_156_19_156_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_19_156_22&#39;)"><span class="hl_specname"><span class="mpre">dt2</span></span></a><span class="mpre">@(</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 156, srcSpanStartColumn = 24, srcSpanEndLine = 156, srcSpanEndColumn = 35}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 156, srcSpanStartColumn = 33, srcSpanEndLine = 156, srcSpanEndColumn = 34},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, "><span class="mpre">Testing&#39; {}</span></span><span class="mpre">) = </span><a href="#loc_157_7_157_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_7_157_13&#39;)"><span class="hl_varref"><span class="mpre">nestDT</span></span></a><span class="mpre"> </span><a href="#loc_156_19_156_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_19_156_22&#39;)"><span class="hl_varref"><span class="mpre">dt2</span></span></a><span class="mpre"> </span><a href="#loc_156_15_156_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_156_15_156_18&#39;)"><span class="hl_varref"><span class="mpre">dt1</span></span></a><span class="mpre">
      </span><a name="loc_157_7_157_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_7_157_13&#39;)"><span class="hl_fundecl"><span class="mpre">nestDT</span></span></a><span class="mpre"> </span><span class="hl_specname"><span class="mpre">dt1</span></span><span class="mpre">@(</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 157, srcSpanStartColumn = 19, srcSpanEndLine = 157, srcSpanEndColumn = 43}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 157, srcSpanStartColumn = 28, srcSpanEndLine = 157, srcSpanEndColumn = 29},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, "><span class="mpre">Testing&#39; {dt_a=a,dt_b=b}</span></span><span class="mpre">) </span><span class="hl_vardecl"><span class="mpre">dt2</span></span><span class="mpre"> = </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 157, srcSpanStartColumn = 51, srcSpanEndLine = 157, srcSpanEndColumn = 101}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 157, srcSpanStartColumn = 55, srcSpanEndLine = 157, srcSpanEndColumn = 56},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA"><span class="mpre">dt1 { dt_a = mergeDT a dt2, dt_b = mergeDT b dt2 }</span></span><span class="mpre">
      </span><a href="#loc_157_7_157_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_7_157_13&#39;)"><span class="hl_fundecl"><span class="mpre">nestDT</span></span></a><span class="mpre"> _ _ = </span><a href="#loc_37_1_37_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_1_37_4&#39;)"><span class="hl_varref"><span class="mpre">err</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;nestDT called on Simple -- cannot happen&quot;</span></span><span class="mpre">

</span><a href="#loc_161_1_161_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_1_161_15&#39;)"><span class="mpre">patternToRegex</span></a><span class="mpre"> :: (</span><a href="Text.Regex.TDFA.Pattern.html#loc_32_6_32_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Pattern.html#loc_32_6_32_13&#39;)"><span class="hl_tyconref"><span class="mpre">Pattern</span></span></a><span class="mpre">,(</span><span class="hl_tyconref"><span class="mpre">GroupIndex</span></span><span class="mpre">, </span><a href="Text.Regex.TDFA.Common.html#loc_74_9_74_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_74_9_74_13&#39;)"><span class="hl_tyconref"><span class="mpre">DoPa</span></span></a><span class="mpre">)) -&gt; </span><a href="Text.Regex.TDFA.Common.html#loc_85_6_85_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_85_6_85_16&#39;)"><span class="hl_tyconref"><span class="mpre">CompOption</span></span></a><span class="mpre"> -&gt; </span><a href="Text.Regex.TDFA.Common.html#loc_101_6_101_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_101_6_101_16&#39;)"><span class="hl_tyconref"><span class="mpre">ExecOption</span></span></a><span class="mpre"> -&gt; </span><a href="Text.Regex.TDFA.Common.html#loc_128_6_128_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_128_6_128_11&#39;)"><span class="hl_tyconref"><span class="mpre">Regex</span></span></a><span class="mpre">
</span><a name="loc_161_1_161_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_1_161_15&#39;)"><span class="hl_fundecl"><span class="mpre">patternToRegex</span></span></a><span class="mpre"> </span><a name="loc_161_16_161_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_16_161_23&#39;)"><span class="hl_vardecl"><span class="mpre">pattern</span></span></a><span class="mpre"> </span><a name="loc_161_24_161_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_24_161_31&#39;)"><span class="hl_vardecl"><span class="mpre">compOpt</span></span></a><span class="mpre"> </span><a name="loc_161_32_161_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_32_161_39&#39;)"><span class="hl_vardecl"><span class="mpre">execOpt</span></span></a><span class="mpre"> = </span><a href="#loc_54_1_54_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_1_54_9&#39;)"><span class="hl_varref"><span class="mpre">nfaToDFA</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">patternToNFA</span></span><span class="mpre"> </span><a href="#loc_161_24_161_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_24_161_31&#39;)"><span class="hl_varref"><span class="mpre">compOpt</span></span></a><span class="mpre"> </span><a href="#loc_161_16_161_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_16_161_23&#39;)"><span class="hl_varref"><span class="mpre">pattern</span></span></a><span class="mpre">) </span><a href="#loc_161_24_161_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_24_161_31&#39;)"><span class="hl_varref"><span class="mpre">compOpt</span></span></a><span class="mpre"> </span><a href="#loc_161_32_161_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_32_161_39&#39;)"><span class="hl_varref"><span class="mpre">execOpt</span></span></a><span class="mpre">

</span><a href="#loc_164_1_164_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_1_164_7&#39;)"><span class="mpre">dfaMap</span></a><span class="mpre"> :: </span><a href="Text.Regex.TDFA.Common.html#loc_215_6_215_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_215_6_215_9&#39;)"><span class="hl_tyconref"><span class="mpre">DFA</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Data.Map.Map</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">SetIndex</span></span><span class="mpre"> </span><a href="Text.Regex.TDFA.Common.html#loc_215_6_215_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_215_6_215_9&#39;)"><span class="hl_tyconref"><span class="mpre">DFA</span></span></a><span class="mpre">
</span><a name="loc_164_1_164_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_1_164_7&#39;)"><span class="hl_vardecl"><span class="mpre">dfaMap</span></span></a><span class="mpre"> = </span><a href="#loc_165_3_165_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_3_165_7&#39;)"><span class="hl_varref"><span class="mpre">seen</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">Data.Map.empty</span></span><span class="mpre">) where
  </span><a name="loc_165_3_165_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_3_165_7&#39;)"><span class="hl_fundecl"><span class="mpre">seen</span></span></a><span class="mpre"> </span><a name="loc_165_8_165_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_8_165_11&#39;)"><span class="hl_vardecl"><span class="mpre">old</span></span></a><span class="mpre"> </span><a name="loc_165_12_165_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_12_165_13&#39;)"><span class="hl_specname"><span class="mpre">d</span></span></a><span class="mpre">@(</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 165, srcSpanStartColumn = 15, srcSpanEndLine = 165, srcSpanEndColumn = 35}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 165, srcSpanStartColumn = 19, srcSpanEndLine = 165, srcSpanEndColumn = 20},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, "><span class="mpre">DFA {d_id=i,d_dt=dt}</span></span><span class="mpre">) =
    if </span><span class="hl_varref"><span class="mpre">i</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`Data.Map.member`</span></span><span class="mpre"> </span><a href="#loc_165_8_165_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_8_165_11&#39;)"><span class="hl_varref"><span class="mpre">old</span></span></a><span class="mpre">
      then </span><a href="#loc_165_8_165_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_8_165_11&#39;)"><span class="hl_varref"><span class="mpre">old</span></span></a><span class="mpre">
      else let </span><a name="loc_168_16_168_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_16_168_19&#39;)"><span class="hl_vardecl"><span class="mpre">new</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">Data.Map.insert</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">i</span></span><span class="mpre"> </span><a href="#loc_165_12_165_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_12_165_13&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><a href="#loc_165_8_165_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_8_165_11&#39;)"><span class="hl_varref"><span class="mpre">old</span></span></a><span class="mpre">
           in </span><a href="Data.List.html#loc_993_1_993_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_993_1_993_7&#39;)"><span class="hl_varref"><span class="mpre">foldl&#39;</span></span></a><span class="mpre"> </span><a href="#loc_165_3_165_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_3_165_7&#39;)"><span class="hl_varref"><span class="mpre">seen</span></span></a><span class="mpre"> </span><a href="#loc_168_16_168_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_16_168_19&#39;)"><span class="hl_varref"><span class="mpre">new</span></span></a><span class="mpre"> (</span><a href="#loc_173_1_173_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_1_173_10&#39;)"><span class="hl_varref"><span class="mpre">flattenDT</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">dt</span></span><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- Get all trans_many states</span></span><span class="mpre">
</span><a href="#loc_173_1_173_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_1_173_10&#39;)"><span class="mpre">flattenDT</span></a><span class="mpre"> :: </span><a href="Text.Regex.TDFA.Common.html#loc_221_6_221_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_221_6_221_8&#39;)"><span class="hl_tyconref"><span class="mpre">DT</span></span></a><span class="mpre"> -&gt; [</span><a href="Text.Regex.TDFA.Common.html#loc_215_6_215_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_215_6_215_9&#39;)"><span class="hl_tyconref"><span class="mpre">DFA</span></span></a><span class="mpre">]
</span><a name="loc_173_1_173_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_1_173_10&#39;)"><span class="hl_fundecl"><span class="mpre">flattenDT</span></span></a><span class="mpre"> (</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 173, srcSpanStartColumn = 12, srcSpanEndLine = 173, srcSpanEndColumn = 54}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 173, srcSpanStartColumn = 20, srcSpanEndLine = 173, srcSpanEndColumn = 21},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, "><span class="mpre">Simple&#39; {dt_trans=(CharMap mt),dt_other=o}</span></span><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">concatMap</span></span><span class="mpre"> (\</span><a name="loc_173_70_173_71" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_70_173_71&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre"> -&gt; [</span><a href="Text.Regex.TDFA.Common.html#loc_216_32_216_42" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_216_32_216_42&#39;)"><span class="hl_varref"><span class="mpre">trans_many</span></span></a><span class="mpre"> </span><a href="#loc_173_70_173_71" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_70_173_71&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">{-,trans_single d-}</span></span><span class="mpre">]) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">(:)</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">o</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">IMap.elems</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">mt</span></span><span class="mpre">
</span><a href="#loc_173_1_173_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_1_173_10&#39;)"><span class="hl_fundecl"><span class="mpre">flattenDT</span></span></a><span class="mpre"> (</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 174, srcSpanStartColumn = 12, srcSpanEndLine = 174, srcSpanEndColumn = 36}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 174, srcSpanStartColumn = 21, srcSpanEndLine = 174, srcSpanEndColumn = 22},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, "><span class="mpre">Testing&#39; {dt_a=a,dt_b=b}</span></span><span class="mpre">) = </span><a href="#loc_173_1_173_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_1_173_10&#39;)"><span class="hl_varref"><span class="mpre">flattenDT</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_173_1_173_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_1_173_10&#39;)"><span class="hl_varref"><span class="mpre">flattenDT</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">b</span></span><span class="mpre">

</span><a href="#loc_177_1_177_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_177_1_177_11&#39;)"><span class="mpre">examineDFA</span></a><span class="mpre"> :: </span><a href="Text.Regex.TDFA.Common.html#loc_128_6_128_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_128_6_128_11&#39;)"><span class="hl_tyconref"><span class="mpre">Regex</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_177_1_177_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_177_1_177_11&#39;)"><span class="hl_fundecl"><span class="mpre">examineDFA</span></span></a><span class="mpre"> (</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 177, srcSpanStartColumn = 13, srcSpanEndLine = 177, srcSpanEndColumn = 34}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 177, srcSpanStartColumn = 19, srcSpanEndLine = 177, srcSpanEndColumn = 20},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, "><span class="mpre">Regex {regex_dfa=dfa}</span></span><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">unlines</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">(:)</span></span><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;Number of reachable DFA states: &quot;</span></span><span class="hl_infix"><span class="mpre">++</span></span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_178_9_178_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_9_178_13&#39;)"><span class="hl_varref"><span class="mpre">dfas</span></span></a><span class="mpre">)) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_178_9_178_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_9_178_13&#39;)"><span class="hl_varref"><span class="mpre">dfas</span></span></a><span class="mpre">
  where </span><a name="loc_178_9_178_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_9_178_13&#39;)"><span class="hl_vardecl"><span class="mpre">dfas</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">Data.Map.elems</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_164_1_164_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_1_164_7&#39;)"><span class="hl_varref"><span class="mpre">dfaMap</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">dfa</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">{-

fillMap :: Tag -&gt; IntMap (Position,Bool)
fillMap tag = IMap.fromDistinctAscList [(t,(-1,True)) | t &lt;- [0..tag] ]

diffMap :: IntMap (Position,Bool) -&gt; IntMap (Position,Bool) -&gt; [(Index,(Position,Bool))]
diffMap old new = IMap.toList (IMap.differenceWith (\a b -&gt; if a==b then Nothing else Just b) old new)

examineDFA :: (DFA,Index,Array Tag OP,Array GroupIndex [GroupInfo]) -&gt; String
examineDFA (dfa,_,aTags,_) = unlines $ map (examineDFA&#39; (snd . bounds $ aTags)) (Map.elems $ dfaMap dfa)

examineDFA&#39; :: Tag -&gt; DFA -&gt; String
examineDFA&#39; maxTag = showDFA (fillMap maxTag)

{-
instance Show DFA where
  show (DFA {d_id=i,d_dt=dt}) = &quot;DFA {d_id = &quot;++show (ISet.toList i)
                            ++&quot;\n    ,d_dt = &quot;++ show dt
                            ++&quot;\n}&quot;
-}
-- instance Show DT where show = showDT

showDFA :: IntMap (Position,Bool) -&gt; DFA -&gt; String
showDFA m (DFA {d_id=i,d_dt=dt}) = &quot;DFA {d_id = &quot;++show (ISet.toList i)
                               ++&quot;\n    ,d_dt = &quot;++ showDT m dt
                               ++&quot;\n}&quot;
-}</span></span><span class="mpre">



</span><span class="hl_comment"><span class="mpre">-- pick QTrans can be told the unique source and knows all the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- destinations (hmm...along with qt_win)!  So if in ascending destination order the last source</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- is free to mutatate the old state.  If the QTrans has only one</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- entry then all we need to do is mutate that entry when making a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- transition.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><a href="#loc_217_1_217_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_1_217_11&#39;)"><span class="mpre">pickQTrans</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Array</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Tag</span></span><span class="mpre"> </span><a href="Text.Regex.TDFA.Common.html#loc_109_6_109_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_109_6_109_8&#39;)"><span class="hl_tyconref"><span class="mpre">OP</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">QTrans</span></span><span class="mpre"> -&gt; [(</span><span class="hl_comment"><span class="mpre">{-Destination-}</span></span><span class="hl_tyconref"><span class="mpre">Index</span></span><span class="mpre">,(</span><a href="Text.Regex.TDFA.Common.html#loc_74_9_74_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_74_9_74_13&#39;)"><span class="hl_tyconref"><span class="mpre">DoPa</span></span></a><span class="mpre">,</span><a href="Text.Regex.TDFA.Common.html#loc_259_6_259_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_259_6_259_18&#39;)"><span class="hl_tyconref"><span class="mpre">Instructions</span></span></a><span class="mpre">))]
</span><a name="loc_217_1_217_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_1_217_11&#39;)"><span class="hl_fundecl"><span class="mpre">pickQTrans</span></span></a><span class="mpre"> </span><a name="loc_217_12_217_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_12_217_14&#39;)"><span class="hl_vardecl"><span class="mpre">op</span></span></a><span class="mpre"> </span><a name="loc_217_15_217_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_15_217_17&#39;)"><span class="hl_vardecl"><span class="mpre">tr</span></span></a><span class="mpre"> = </span><a href="Text.Regex.TDFA.Common.html#loc_53_1_53_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_53_1_53_7&#39;)"><span class="hl_varref"><span class="mpre">mapSnd</span></span></a><span class="mpre"> (</span><a href="#loc_223_1_223_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_1_223_10&#39;)"><span class="hl_varref"><span class="mpre">bestTrans</span></span></a><span class="mpre"> </span><a href="#loc_217_12_217_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_12_217_14&#39;)"><span class="hl_varref"><span class="mpre">op</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">IMap.toList</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_217_15_217_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_15_217_17&#39;)"><span class="hl_varref"><span class="mpre">tr</span></span></a><span class="mpre">

</span><a href="#loc_220_1_220_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_220_1_220_9&#39;)"><span class="mpre">cleanWin</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">WinTags</span></span><span class="mpre"> -&gt; </span><a href="Text.Regex.TDFA.Common.html#loc_259_6_259_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_259_6_259_18&#39;)"><span class="hl_tyconref"><span class="mpre">Instructions</span></span></a><span class="mpre">
</span><a name="loc_220_1_220_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_220_1_220_9&#39;)"><span class="hl_vardecl"><span class="mpre">cleanWin</span></span></a><span class="mpre"> = </span><a href="#loc_327_1_327_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_327_1_327_15&#39;)"><span class="hl_varref"><span class="mpre">toInstructions</span></span></a><span class="mpre">

</span><a href="#loc_223_1_223_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_1_223_10&#39;)"><span class="mpre">bestTrans</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Array</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Tag</span></span><span class="mpre"> </span><a href="Text.Regex.TDFA.Common.html#loc_109_6_109_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_109_6_109_8&#39;)"><span class="hl_tyconref"><span class="mpre">OP</span></span></a><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">TagCommand</span></span><span class="mpre">] -&gt; (</span><a href="Text.Regex.TDFA.Common.html#loc_74_9_74_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_74_9_74_13&#39;)"><span class="hl_tyconref"><span class="mpre">DoPa</span></span></a><span class="mpre">,</span><a href="Text.Regex.TDFA.Common.html#loc_259_6_259_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_259_6_259_18&#39;)"><span class="hl_tyconref"><span class="mpre">Instructions</span></span></a><span class="mpre">)
</span><a name="loc_223_1_223_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_1_223_10&#39;)"><span class="hl_fundecl"><span class="mpre">bestTrans</span></span></a><span class="mpre"> _ [] = </span><a href="#loc_37_1_37_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_1_37_4&#39;)"><span class="hl_varref"><span class="mpre">err</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;bestTrans : There were no transition choose from!&quot;</span></span><span class="mpre">
</span><a href="#loc_223_1_223_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_1_223_10&#39;)"><span class="hl_fundecl"><span class="mpre">bestTrans</span></span></a><span class="mpre"> </span><a name="loc_224_11_224_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_11_224_17&#39;)"><span class="hl_vardecl"><span class="mpre">aTagOP</span></span></a><span class="mpre"> (</span><a name="loc_224_19_224_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_19_224_20&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_224_21_224_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_21_224_23&#39;)"><span class="hl_vardecl"><span class="mpre">fs</span></span></a><span class="mpre">) | </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_224_21_224_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_21_224_23&#39;)"><span class="hl_varref"><span class="mpre">fs</span></span></a><span class="mpre"> = </span><a href="#loc_231_3_231_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_3_231_12&#39;)"><span class="hl_varref"><span class="mpre">canonical</span></span></a><span class="mpre"> </span><a href="#loc_224_19_224_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_19_224_20&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">
                        | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="#loc_227_3_227_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_3_227_9&#39;)"><span class="hl_varref"><span class="mpre">answer</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- if null toDisplay then answer else trace toDisplay answer</span></span><span class="mpre">
 where
  </span><a name="loc_227_3_227_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_3_227_9&#39;)"><span class="hl_vardecl"><span class="mpre">answer</span></span></a><span class="mpre"> = </span><a href="Data.List.html#loc_993_1_993_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_993_1_993_7&#39;)"><span class="hl_varref"><span class="mpre">foldl&#39;</span></span></a><span class="mpre"> </span><a href="#loc_233_3_233_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_233_3_233_7&#39;)"><span class="hl_varref"><span class="mpre">pick</span></span></a><span class="mpre"> (</span><a href="#loc_231_3_231_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_3_231_12&#39;)"><span class="hl_varref"><span class="mpre">canonical</span></span></a><span class="mpre"> </span><a href="#loc_224_19_224_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_19_224_20&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">) </span><a href="#loc_224_21_224_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_21_224_23&#39;)"><span class="hl_varref"><span class="mpre">fs</span></span></a><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">{- toDisplay | null fs = &quot;&quot;
               | otherwise = unlines $ &quot;bestTrans&quot; : show (answer) : &quot;from among&quot; : concatMap (\x -&gt; [show x, show (toInstructions (snd x))]) (f:fs) -}</span></span><span class="mpre">
  </span><a href="#loc_231_3_231_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_3_231_12&#39;)"><span class="mpre">canonical</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">TagCommand</span></span><span class="mpre"> -&gt; (</span><a href="Text.Regex.TDFA.Common.html#loc_74_9_74_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_74_9_74_13&#39;)"><span class="hl_tyconref"><span class="mpre">DoPa</span></span></a><span class="mpre">,</span><a href="Text.Regex.TDFA.Common.html#loc_259_6_259_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_259_6_259_18&#39;)"><span class="hl_tyconref"><span class="mpre">Instructions</span></span></a><span class="mpre">)
  </span><a name="loc_231_3_231_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_3_231_12&#39;)"><span class="hl_fundecl"><span class="mpre">canonical</span></span></a><span class="mpre"> (</span><a name="loc_231_14_231_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_14_231_18&#39;)"><span class="hl_vardecl"><span class="mpre">dopa</span></span></a><span class="mpre">,</span><a name="loc_231_19_231_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_19_231_23&#39;)"><span class="hl_vardecl"><span class="mpre">spec</span></span></a><span class="mpre">) = (</span><a href="#loc_231_14_231_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_14_231_18&#39;)"><span class="hl_varref"><span class="mpre">dopa</span></span></a><span class="mpre">, </span><a href="#loc_327_1_327_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_327_1_327_15&#39;)"><span class="hl_varref"><span class="mpre">toInstructions</span></span></a><span class="mpre"> </span><a href="#loc_231_19_231_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_19_231_23&#39;)"><span class="hl_varref"><span class="mpre">spec</span></span></a><span class="mpre">)
  </span><a href="#loc_233_3_233_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_233_3_233_7&#39;)"><span class="mpre">pick</span></a><span class="mpre"> :: (</span><a href="Text.Regex.TDFA.Common.html#loc_74_9_74_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_74_9_74_13&#39;)"><span class="hl_tyconref"><span class="mpre">DoPa</span></span></a><span class="mpre">,</span><a href="Text.Regex.TDFA.Common.html#loc_259_6_259_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_259_6_259_18&#39;)"><span class="hl_tyconref"><span class="mpre">Instructions</span></span></a><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">TagCommand</span></span><span class="mpre"> -&gt; (</span><a href="Text.Regex.TDFA.Common.html#loc_74_9_74_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_74_9_74_13&#39;)"><span class="hl_tyconref"><span class="mpre">DoPa</span></span></a><span class="mpre">,</span><a href="Text.Regex.TDFA.Common.html#loc_259_6_259_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_259_6_259_18&#39;)"><span class="hl_tyconref"><span class="mpre">Instructions</span></span></a><span class="mpre">)
  </span><a name="loc_233_3_233_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_233_3_233_7&#39;)"><span class="hl_fundecl"><span class="mpre">pick</span></span></a><span class="mpre"> </span><a name="loc_233_8_233_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_233_8_233_11&#39;)"><span class="hl_specname"><span class="mpre">win</span></span></a><span class="mpre">@(</span><a name="loc_233_13_233_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_233_13_233_18&#39;)"><span class="hl_vardecl"><span class="mpre">dopa1</span></span></a><span class="mpre">,</span><a name="loc_233_19_233_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_233_19_233_23&#39;)"><span class="hl_vardecl"><span class="mpre">winI</span></span></a><span class="mpre">) (</span><a name="loc_233_26_233_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_233_26_233_31&#39;)"><span class="hl_vardecl"><span class="mpre">dopa2</span></span></a><span class="mpre">,</span><a name="loc_233_32_233_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_233_32_233_36&#39;)"><span class="hl_vardecl"><span class="mpre">spec</span></span></a><span class="mpre">) =
    let </span><a name="loc_234_9_234_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_234_9_234_14&#39;)"><span class="hl_vardecl"><span class="mpre">nextI</span></span></a><span class="mpre"> = </span><a href="#loc_327_1_327_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_327_1_327_15&#39;)"><span class="hl_varref"><span class="mpre">toInstructions</span></span></a><span class="mpre"> </span><a href="#loc_233_32_233_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_233_32_233_36&#39;)"><span class="hl_varref"><span class="mpre">spec</span></span></a><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--    in case compareWith choose winPos nextPos of -- XXX 2009: add in enterOrbit information</span></span><span class="mpre">
    in case </span><a href="#loc_287_3_287_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_287_3_287_14&#39;)"><span class="hl_varref"><span class="mpre">compareWith</span></span></a><span class="mpre"> </span><a href="#loc_259_3_259_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_259_3_259_9&#39;)"><span class="hl_varref"><span class="mpre">choose</span></span></a><span class="mpre"> (</span><a href="#loc_242_3_242_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_3_242_12&#39;)"><span class="hl_varref"><span class="mpre">toListing</span></span></a><span class="mpre"> </span><a href="#loc_233_19_233_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_233_19_233_23&#39;)"><span class="hl_varref"><span class="mpre">winI</span></span></a><span class="mpre">) (</span><a href="#loc_242_3_242_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_3_242_12&#39;)"><span class="hl_varref"><span class="mpre">toListing</span></span></a><span class="mpre"> </span><a href="#loc_234_9_234_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_234_9_234_14&#39;)"><span class="hl_varref"><span class="mpre">nextI</span></span></a><span class="mpre">) of
         </span><span class="hl_conref"><span class="mpre">GT</span></span><span class="mpre"> -&gt; </span><a href="#loc_233_8_233_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_233_8_233_11&#39;)"><span class="hl_varref"><span class="mpre">win</span></span></a><span class="mpre">
         </span><span class="hl_conref"><span class="mpre">LT</span></span><span class="mpre"> -&gt; (</span><a href="#loc_233_26_233_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_233_26_233_31&#39;)"><span class="hl_varref"><span class="mpre">dopa2</span></span></a><span class="mpre">,</span><a href="#loc_234_9_234_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_234_9_234_14&#39;)"><span class="hl_varref"><span class="mpre">nextI</span></span></a><span class="mpre">)
         </span><span class="hl_conref"><span class="mpre">EQ</span></span><span class="mpre"> -&gt; if </span><a href="#loc_233_13_233_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_233_13_233_18&#39;)"><span class="hl_varref"><span class="mpre">dopa1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><a href="#loc_233_26_233_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_233_26_233_31&#39;)"><span class="hl_varref"><span class="mpre">dopa2</span></span></a><span class="mpre"> then </span><a href="#loc_233_8_233_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_233_8_233_11&#39;)"><span class="hl_varref"><span class="mpre">win</span></span></a><span class="mpre"> else (</span><a href="#loc_233_26_233_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_233_26_233_31&#39;)"><span class="hl_varref"><span class="mpre">dopa2</span></span></a><span class="mpre">,</span><a href="#loc_234_9_234_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_234_9_234_14&#39;)"><span class="hl_varref"><span class="mpre">nextI</span></span></a><span class="mpre">) </span><span class="hl_comment"><span class="mpre">-- no deep reason not to just pick win</span></span><span class="mpre">

  </span><a href="#loc_242_3_242_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_3_242_12&#39;)"><span class="mpre">toListing</span></a><span class="mpre"> :: </span><a href="Text.Regex.TDFA.Common.html#loc_259_6_259_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_259_6_259_18&#39;)"><span class="hl_tyconref"><span class="mpre">Instructions</span></span></a><span class="mpre"> -&gt; [(</span><span class="hl_tyconref"><span class="mpre">Tag</span></span><span class="mpre">,</span><a href="Text.Regex.TDFA.Common.html#loc_263_6_263_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_263_6_263_12&#39;)"><span class="hl_tyconref"><span class="mpre">Action</span></span></a><span class="mpre">)]
  </span><a name="loc_242_3_242_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_3_242_12&#39;)"><span class="hl_fundecl"><span class="mpre">toListing</span></span></a><span class="mpre"> (</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 242, srcSpanStartColumn = 14, srcSpanEndLine = 242, srcSpanEndColumn = 45}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 242, srcSpanStartColumn = 27, srcSpanEndLine = 242, srcSpanEndColumn = 28},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, "><span class="mpre">Instructions {newPos = nextPos}</span></span><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">filter</span></span><span class="mpre"> </span><a href="#loc_243_11_243_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_243_11_243_19&#39;)"><span class="hl_varref"><span class="mpre">notReset</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">nextPos</span></span><span class="mpre">
    where </span><a name="loc_243_11_243_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_243_11_243_19&#39;)"><span class="hl_fundecl"><span class="mpre">notReset</span></span></a><span class="mpre"> (_,</span><a href="Text.Regex.TDFA.Common.html#loc_263_34_263_40" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_263_34_263_40&#39;)"><span class="hl_conref"><span class="mpre">SetVal</span></span></a><span class="mpre"> (</span><span class="warning" data-warning="PatPNeg (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 243, srcSpanStartColumn = 31, srcSpanEndLine = 243, srcSpanEndColumn = 33}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 243, srcSpanStartColumn = 31, srcSpanEndLine = 243, srcSpanEndColumn = 32}]}) (PLit (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-"><span class="mpre">-1</span></span><span class="mpre">)) = </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
          </span><a href="#loc_243_11_243_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_243_11_243_19&#39;)"><span class="hl_fundecl"><span class="mpre">notReset</span></span></a><span class="mpre"> _ = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">{-
  toListing (Instructions {newPos = nextPos}) = mergeTagOrbit nextPos (filter snd nextFlags)

  mergeTagOrbit xx [] = xx
  mergeTagOrbit [] yy = yy
  mergeTagOrbit xx@(x:xs) yy@(y:ys) = 
    case compare (fst x) (fst y) of
      GT -&gt; y : mergeTagOrbit xx ys
      LT -&gt; x : mergeTagOrbit xs yy
      EQ -&gt; x : mergeTagOrbit xs ys -- keep tag setting over orbit setting.
-}</span></span><span class="mpre">

  </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_259_3_259_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_259_3_259_9&#39;)"><span class="mpre">choose</span></a><span class="mpre"> #-}</span></span><span class="mpre">
  </span><a href="#loc_259_3_259_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_259_3_259_9&#39;)"><span class="mpre">choose</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Tag</span></span><span class="mpre">,</span><a href="Text.Regex.TDFA.Common.html#loc_263_6_263_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_263_6_263_12&#39;)"><span class="hl_tyconref"><span class="mpre">Action</span></span></a><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Tag</span></span><span class="mpre">,</span><a href="Text.Regex.TDFA.Common.html#loc_263_6_263_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_263_6_263_12&#39;)"><span class="hl_tyconref"><span class="mpre">Action</span></span></a><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">Ordering</span></span><span class="mpre">
  </span><a name="loc_259_3_259_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_259_3_259_9&#39;)"><span class="hl_fundecl"><span class="mpre">choose</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">EQ</span></span><span class="mpre">
  </span><a href="#loc_259_3_259_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_259_3_259_9&#39;)"><span class="hl_fundecl"><span class="mpre">choose</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> </span><a name="loc_260_18_260_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_260_18_260_19&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="Text.Regex.TDFA.Common.html#loc_65_1_65_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_65_1_65_10&#39;)"><span class="hl_varref"><span class="mpre">flipOrder</span></span></a><span class="mpre"> (</span><a href="#loc_259_3_259_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_259_3_259_9&#39;)"><span class="hl_varref"><span class="mpre">choose</span></span></a><span class="mpre"> </span><a href="#loc_260_18_260_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_260_18_260_19&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">)
  </span><a href="#loc_259_3_259_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_259_3_259_9&#39;)"><span class="hl_fundecl"><span class="mpre">choose</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><a name="loc_261_17_261_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_261_17_261_20&#39;)"><span class="hl_vardecl"><span class="mpre">tag</span></span></a><span class="mpre">,</span><span class="hl_vardecl"><span class="mpre">_post</span></span><span class="mpre">)) </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> =
    case </span><a href="#loc_224_11_224_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_11_224_17&#39;)"><span class="hl_varref"><span class="mpre">aTagOP</span></span></a><span class="hl_infix"><span class="mpre">!</span></span><a href="#loc_261_17_261_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_261_17_261_20&#39;)"><span class="hl_varref"><span class="mpre">tag</span></span></a><span class="mpre"> of
      </span><a href="Text.Regex.TDFA.Common.html#loc_109_11_109_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_109_11_109_19&#39;)"><span class="hl_conref"><span class="mpre">Maximize</span></span></a><span class="mpre"> -&gt; </span><span class="hl_conref"><span class="mpre">GT</span></span><span class="mpre">
      </span><a href="Text.Regex.TDFA.Common.html#loc_109_22_109_30" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_109_22_109_30&#39;)"><span class="hl_conref"><span class="mpre">Minimize</span></span></a><span class="mpre"> -&gt; </span><span class="hl_conref"><span class="mpre">LT</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- needed to choose best path inside nested * operators,</span></span><span class="mpre">
                    </span><span class="hl_comment"><span class="mpre">-- this needs a leading Minimize tag inside at least the parent * operator</span></span><span class="mpre">
      </span><a href="Text.Regex.TDFA.Common.html#loc_109_41_109_47" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_109_41_109_47&#39;)"><span class="hl_conref"><span class="mpre">Ignore</span></span></a><span class="mpre"> -&gt; </span><span class="hl_conref"><span class="mpre">GT</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- XXX this is a guess in analogy with Maximize for the end bit of a group</span></span><span class="mpre">
      </span><a href="Text.Regex.TDFA.Common.html#loc_109_33_109_38" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_109_33_109_38&#39;)"><span class="hl_conref"><span class="mpre">Orbit</span></span></a><span class="mpre"> -&gt; </span><span class="hl_conref"><span class="mpre">LT</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- trace (&quot;choose LT! Just &quot;++show tag++&quot; &lt; Nothing&quot;) LT -- 2009 XXX : comment out next line and use the Orbit instead</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--      Orbit -&gt; err $ &quot;bestTrans.choose : Very Unexpeted Orbit in Just Nothing: &quot;++show (tag,post,aTagOP,f:fs)</span></span><span class="mpre">
  </span><a href="#loc_259_3_259_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_259_3_259_9&#39;)"><span class="hl_fundecl"><span class="mpre">choose</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><a name="loc_269_17_269_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_269_17_269_20&#39;)"><span class="hl_vardecl"><span class="mpre">tag</span></span></a><span class="mpre">,</span><a name="loc_269_21_269_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_269_21_269_26&#39;)"><span class="hl_vardecl"><span class="mpre">post1</span></span></a><span class="mpre">)) (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (_,</span><a name="loc_269_38_269_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_269_38_269_43&#39;)"><span class="hl_vardecl"><span class="mpre">post2</span></span></a><span class="mpre">)) =
    case </span><a href="#loc_224_11_224_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_11_224_17&#39;)"><span class="hl_varref"><span class="mpre">aTagOP</span></span></a><span class="hl_infix"><span class="mpre">!</span></span><a href="#loc_269_17_269_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_269_17_269_20&#39;)"><span class="hl_varref"><span class="mpre">tag</span></span></a><span class="mpre"> of
      </span><a href="Text.Regex.TDFA.Common.html#loc_109_11_109_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_109_11_109_19&#39;)"><span class="hl_conref"><span class="mpre">Maximize</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_276_10_276_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_276_10_276_15&#39;)"><span class="hl_varref"><span class="mpre">order</span></span></a><span class="mpre">
      </span><a href="Text.Regex.TDFA.Common.html#loc_109_22_109_30" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_109_22_109_30&#39;)"><span class="hl_conref"><span class="mpre">Minimize</span></span></a><span class="mpre"> -&gt; </span><a href="Text.Regex.TDFA.Common.html#loc_65_1_65_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_65_1_65_10&#39;)"><span class="hl_varref"><span class="mpre">flipOrder</span></span></a><span class="mpre"> </span><a href="#loc_276_10_276_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_276_10_276_15&#39;)"><span class="hl_varref"><span class="mpre">order</span></span></a><span class="mpre">
      </span><a href="Text.Regex.TDFA.Common.html#loc_109_41_109_47" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_109_41_109_47&#39;)"><span class="hl_conref"><span class="mpre">Ignore</span></span></a><span class="mpre"> -&gt; </span><span class="hl_conref"><span class="mpre">EQ</span></span><span class="mpre">
      </span><a href="Text.Regex.TDFA.Common.html#loc_109_33_109_38" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_109_33_109_38&#39;)"><span class="hl_conref"><span class="mpre">Orbit</span></span></a><span class="mpre"> -&gt; </span><span class="hl_conref"><span class="mpre">EQ</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--      Orbit -&gt; err $ &quot;bestTrans.choose : Very Unexpeted Orbit in Just Just: &quot;++show (tag,(post1,post2),aTagOP,f:fs)</span></span><span class="mpre">
   where </span><a name="loc_276_10_276_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_276_10_276_15&#39;)"><span class="hl_vardecl"><span class="mpre">order</span></span></a><span class="mpre"> = case (</span><a href="#loc_269_21_269_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_269_21_269_26&#39;)"><span class="hl_varref"><span class="mpre">post1</span></span></a><span class="mpre">,</span><a href="#loc_269_38_269_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_269_38_269_43&#39;)"><span class="hl_varref"><span class="mpre">post2</span></span></a><span class="mpre">) of
                   (</span><a href="Text.Regex.TDFA.Common.html#loc_263_15_263_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_263_15_263_21&#39;)"><span class="hl_conref"><span class="mpre">SetPre</span></span></a><span class="mpre">,</span><a href="Text.Regex.TDFA.Common.html#loc_263_15_263_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_263_15_263_21&#39;)"><span class="hl_conref"><span class="mpre">SetPre</span></span></a><span class="mpre">) -&gt; </span><span class="hl_conref"><span class="mpre">EQ</span></span><span class="mpre">
                   (</span><a href="Text.Regex.TDFA.Common.html#loc_263_24_263_31" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_263_24_263_31&#39;)"><span class="hl_conref"><span class="mpre">SetPost</span></span></a><span class="mpre">,</span><a href="Text.Regex.TDFA.Common.html#loc_263_24_263_31" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_263_24_263_31&#39;)"><span class="hl_conref"><span class="mpre">SetPost</span></span></a><span class="mpre">) -&gt; </span><span class="hl_conref"><span class="mpre">EQ</span></span><span class="mpre">
                   (</span><a href="Text.Regex.TDFA.Common.html#loc_263_15_263_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_263_15_263_21&#39;)"><span class="hl_conref"><span class="mpre">SetPre</span></span></a><span class="mpre">,</span><a href="Text.Regex.TDFA.Common.html#loc_263_24_263_31" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_263_24_263_31&#39;)"><span class="hl_conref"><span class="mpre">SetPost</span></span></a><span class="mpre">) -&gt; </span><span class="hl_conref"><span class="mpre">LT</span></span><span class="mpre">
                   (</span><a href="Text.Regex.TDFA.Common.html#loc_263_24_263_31" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_263_24_263_31&#39;)"><span class="hl_conref"><span class="mpre">SetPost</span></span></a><span class="mpre">,</span><a href="Text.Regex.TDFA.Common.html#loc_263_15_263_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_263_15_263_21&#39;)"><span class="hl_conref"><span class="mpre">SetPre</span></span></a><span class="mpre">) -&gt; </span><span class="hl_conref"><span class="mpre">GT</span></span><span class="mpre">
                   (</span><a href="Text.Regex.TDFA.Common.html#loc_263_34_263_40" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_263_34_263_40&#39;)"><span class="hl_conref"><span class="mpre">SetVal</span></span></a><span class="mpre"> </span><a name="loc_281_28_281_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_281_28_281_30&#39;)"><span class="hl_vardecl"><span class="mpre">v1</span></span></a><span class="mpre">,</span><a href="Text.Regex.TDFA.Common.html#loc_263_34_263_40" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_263_34_263_40&#39;)"><span class="hl_conref"><span class="mpre">SetVal</span></span></a><span class="mpre"> </span><a name="loc_281_38_281_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_281_38_281_40&#39;)"><span class="hl_vardecl"><span class="mpre">v2</span></span></a><span class="mpre">) -&gt; </span><span class="hl_varref"><span class="mpre">compare</span></span><span class="mpre"> </span><a href="#loc_281_28_281_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_281_28_281_30&#39;)"><span class="hl_varref"><span class="mpre">v1</span></span></a><span class="mpre"> </span><a href="#loc_281_38_281_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_281_38_281_40&#39;)"><span class="hl_varref"><span class="mpre">v2</span></span></a><span class="mpre">
                   _ -&gt; </span><a href="#loc_37_1_37_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_1_37_4&#39;)"><span class="hl_varref"><span class="mpre">err</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;bestTrans.compareWith.choose sees incomparable &quot;</span></span><span class="hl_infix"><span class="mpre">++</span></span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> (</span><a href="#loc_269_17_269_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_269_17_269_20&#39;)"><span class="hl_varref"><span class="mpre">tag</span></span></a><span class="mpre">,</span><a href="#loc_269_21_269_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_269_21_269_26&#39;)"><span class="hl_varref"><span class="mpre">post1</span></span></a><span class="mpre">,</span><a href="#loc_269_38_269_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_269_38_269_43&#39;)"><span class="hl_varref"><span class="mpre">post2</span></span></a><span class="mpre">)


  </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_287_3_287_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_287_3_287_14&#39;)"><span class="mpre">compareWith</span></a><span class="mpre"> #-}</span></span><span class="mpre">
  </span><a href="#loc_287_3_287_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_287_3_287_14&#39;)"><span class="mpre">compareWith</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 286, srcSpanStartColumn = 18, srcSpanEndLine = 286, srcSpanEndColumn = 37}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 286, srcSpanStartColumn = 18, srcSpanEndLine = 286, srcSpanEndColumn = 19},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs"><span class="mpre">(Ord x,Monoid a) =&gt;</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">x</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">x</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">c</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; [(</span><span class="hl_tyvar"><span class="mpre">x</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">)] -&gt; [(</span><span class="hl_tyvar"><span class="mpre">x</span></span><span class="mpre">,</span><span class="hl_tyvar"><span class="mpre">c</span></span><span class="mpre">)] -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
  </span><a name="loc_287_3_287_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_287_3_287_14&#39;)"><span class="hl_fundecl"><span class="mpre">compareWith</span></span></a><span class="mpre"> </span><a name="loc_287_15_287_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_287_15_287_19&#39;)"><span class="hl_vardecl"><span class="mpre">comp</span></span></a><span class="mpre"> = </span><a href="#loc_288_5_288_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_288_5_288_7&#39;)"><span class="hl_varref"><span class="mpre">cw</span></span></a><span class="mpre"> where
    </span><a name="loc_288_5_288_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_288_5_288_7&#39;)"><span class="hl_fundecl"><span class="mpre">cw</span></span></a><span class="mpre"> [] [] = </span><a href="#loc_287_15_287_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_287_15_287_19&#39;)"><span class="hl_varref"><span class="mpre">comp</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
    </span><a href="#loc_288_5_288_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_288_5_288_7&#39;)"><span class="hl_fundecl"><span class="mpre">cw</span></span></a><span class="mpre"> </span><a name="loc_289_8_289_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_289_8_289_10&#39;)"><span class="hl_specname"><span class="mpre">xx</span></span></a><span class="mpre">@(</span><a name="loc_289_12_289_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_289_12_289_13&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_289_14_289_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_289_14_289_16&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) </span><a name="loc_289_18_289_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_289_18_289_20&#39;)"><span class="hl_specname"><span class="mpre">yy</span></span></a><span class="mpre">@(</span><a name="loc_289_22_289_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_289_22_289_23&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_289_24_289_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_289_24_289_26&#39;)"><span class="hl_vardecl"><span class="mpre">ys</span></span></a><span class="mpre">) =
      case </span><span class="hl_varref"><span class="mpre">compare</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fst</span></span><span class="mpre"> </span><a href="#loc_289_12_289_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_289_12_289_13&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">fst</span></span><span class="mpre"> </span><a href="#loc_289_22_289_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_289_22_289_23&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">) of
        </span><span class="hl_conref"><span class="mpre">GT</span></span><span class="mpre"> -&gt; </span><a href="#loc_287_15_287_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_287_15_287_19&#39;)"><span class="hl_varref"><span class="mpre">comp</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">  (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="#loc_289_22_289_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_289_22_289_23&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">) </span><a href="Data.Monoid.html#loc_82_9_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_82_9_82_16&#39;)"><span class="hl_infix"><span class="mpre">`mappend`</span></span></a><span class="mpre"> </span><a href="#loc_288_5_288_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_288_5_288_7&#39;)"><span class="hl_varref"><span class="mpre">cw</span></span></a><span class="mpre"> </span><a href="#loc_289_8_289_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_289_8_289_10&#39;)"><span class="hl_varref"><span class="mpre">xx</span></span></a><span class="mpre"> </span><a href="#loc_289_24_289_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_289_24_289_26&#39;)"><span class="hl_varref"><span class="mpre">ys</span></span></a><span class="mpre">
        </span><span class="hl_conref"><span class="mpre">EQ</span></span><span class="mpre"> -&gt; </span><a href="#loc_287_15_287_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_287_15_287_19&#39;)"><span class="hl_varref"><span class="mpre">comp</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="#loc_289_12_289_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_289_12_289_13&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">) (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="#loc_289_22_289_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_289_22_289_23&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">) </span><a href="Data.Monoid.html#loc_82_9_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_82_9_82_16&#39;)"><span class="hl_infix"><span class="mpre">`mappend`</span></span></a><span class="mpre"> </span><a href="#loc_288_5_288_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_288_5_288_7&#39;)"><span class="hl_varref"><span class="mpre">cw</span></span></a><span class="mpre"> </span><a href="#loc_289_14_289_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_289_14_289_16&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> </span><a href="#loc_289_24_289_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_289_24_289_26&#39;)"><span class="hl_varref"><span class="mpre">ys</span></span></a><span class="mpre">
        </span><span class="hl_conref"><span class="mpre">LT</span></span><span class="mpre"> -&gt; </span><a href="#loc_287_15_287_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_287_15_287_19&#39;)"><span class="hl_varref"><span class="mpre">comp</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="#loc_289_12_289_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_289_12_289_13&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">) </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">  </span><a href="Data.Monoid.html#loc_82_9_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_82_9_82_16&#39;)"><span class="hl_infix"><span class="mpre">`mappend`</span></span></a><span class="mpre"> </span><a href="#loc_288_5_288_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_288_5_288_7&#39;)"><span class="hl_varref"><span class="mpre">cw</span></span></a><span class="mpre"> </span><a href="#loc_289_14_289_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_289_14_289_16&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> </span><a href="#loc_289_18_289_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_289_18_289_20&#39;)"><span class="hl_varref"><span class="mpre">yy</span></span></a><span class="mpre">
    </span><a href="#loc_288_5_288_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_288_5_288_7&#39;)"><span class="hl_fundecl"><span class="mpre">cw</span></span></a><span class="mpre"> </span><a name="loc_294_8_294_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_294_8_294_10&#39;)"><span class="hl_vardecl"><span class="mpre">xx</span></span></a><span class="mpre"> [] = </span><span class="hl_varref"><span class="mpre">foldr</span></span><span class="mpre"> (\</span><a name="loc_294_24_294_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_294_24_294_25&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_294_26_294_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_294_26_294_30&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_287_15_287_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_287_15_287_19&#39;)"><span class="hl_varref"><span class="mpre">comp</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="#loc_294_24_294_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_294_24_294_25&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">) </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">  </span><a href="Data.Monoid.html#loc_82_9_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_82_9_82_16&#39;)"><span class="hl_infix"><span class="mpre">`mappend`</span></span></a><span class="mpre"> </span><a href="#loc_294_26_294_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_294_26_294_30&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">) </span><a href="Data.Monoid.html#loc_80_9_80_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_80_9_80_15&#39;)"><span class="hl_varref"><span class="mpre">mempty</span></span></a><span class="mpre"> </span><a href="#loc_294_8_294_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_294_8_294_10&#39;)"><span class="hl_varref"><span class="mpre">xx</span></span></a><span class="mpre">
    </span><a href="#loc_288_5_288_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_288_5_288_7&#39;)"><span class="hl_fundecl"><span class="mpre">cw</span></span></a><span class="mpre"> [] </span><a name="loc_295_11_295_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_295_11_295_13&#39;)"><span class="hl_vardecl"><span class="mpre">yy</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">foldr</span></span><span class="mpre"> (\</span><a name="loc_295_24_295_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_295_24_295_25&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> </span><a name="loc_295_26_295_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_295_26_295_30&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_287_15_287_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_287_15_287_19&#39;)"><span class="hl_varref"><span class="mpre">comp</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">  (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="#loc_295_24_295_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_295_24_295_25&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">) </span><a href="Data.Monoid.html#loc_82_9_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_82_9_82_16&#39;)"><span class="hl_infix"><span class="mpre">`mappend`</span></span></a><span class="mpre"> </span><a href="#loc_295_26_295_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_295_26_295_30&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">) </span><a href="Data.Monoid.html#loc_80_9_80_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_80_9_80_15&#39;)"><span class="hl_varref"><span class="mpre">mempty</span></span></a><span class="mpre"> </span><a href="#loc_295_11_295_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_295_11_295_13&#39;)"><span class="hl_varref"><span class="mpre">yy</span></span></a><span class="mpre">

                   
</span><a href="#loc_299_1_299_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_299_1_299_19&#39;)"><span class="mpre">isDFAFrontAnchored</span></a><span class="mpre"> :: </span><a href="Text.Regex.TDFA.Common.html#loc_215_6_215_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_215_6_215_9&#39;)"><span class="hl_tyconref"><span class="mpre">DFA</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_299_1_299_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_299_1_299_19&#39;)"><span class="hl_vardecl"><span class="mpre">isDFAFrontAnchored</span></span></a><span class="mpre"> = </span><a href="#loc_302_3_302_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_302_3_302_20&#39;)"><span class="hl_varref"><span class="mpre">isDTFrontAnchored</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Text.Regex.TDFA.Common.html#loc_215_36_215_40" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_215_36_215_40&#39;)"><span class="hl_varref"><span class="mpre">d_dt</span></span></a><span class="mpre">
 where
  </span><a href="#loc_302_3_302_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_302_3_302_20&#39;)"><span class="mpre">isDTFrontAnchored</span></a><span class="mpre"> :: </span><a href="Text.Regex.TDFA.Common.html#loc_221_6_221_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_221_6_221_8&#39;)"><span class="hl_tyconref"><span class="mpre">DT</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
  </span><a name="loc_302_3_302_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_302_3_302_20&#39;)"><span class="hl_fundecl"><span class="mpre">isDTFrontAnchored</span></span></a><span class="mpre"> (</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 302, srcSpanStartColumn = 22, srcSpanEndLine = 302, srcSpanEndColumn = 32}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 302, srcSpanStartColumn = 30, srcSpanEndLine = 302, srcSpanEndColumn = 31},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, "><span class="mpre">Simple&#39; {}</span></span><span class="mpre">) = </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
  </span><a href="#loc_302_3_302_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_302_3_302_20&#39;)"><span class="hl_fundecl"><span class="mpre">isDTFrontAnchored</span></span></a><span class="mpre"> (</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 303, srcSpanStartColumn = 22, srcSpanEndLine = 303, srcSpanEndColumn = 57}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 303, srcSpanStartColumn = 31, srcSpanEndLine = 303, srcSpanEndColumn = 32},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, "><span class="mpre">Testing&#39; {dt_test=wt,dt_a=a,dt_b=b}</span></span><span class="mpre">) | </span><span class="hl_varref"><span class="mpre">wt</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="Text.Regex.TDFA.Common.html#loc_186_18_186_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_186_18_186_26&#39;)"><span class="hl_conref"><span class="mpre">Test_BOL</span></span></a><span class="mpre"> = </span><a href="#loc_308_5_308_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_308_5_308_15&#39;)"><span class="hl_varref"><span class="mpre">isDTLosing</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">b</span></span><span class="mpre">
                                                          | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="#loc_302_3_302_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_302_3_302_20&#39;)"><span class="hl_varref"><span class="mpre">isDTFrontAnchored</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_302_3_302_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_302_3_302_20&#39;)"><span class="hl_varref"><span class="mpre">isDTFrontAnchored</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">b</span></span><span class="mpre">
   where
    </span><span class="hl_comment"><span class="mpre">-- can DT never win or accept a character (when following trans_single)?</span></span><span class="mpre">
    </span><a href="#loc_308_5_308_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_308_5_308_15&#39;)"><span class="mpre">isDTLosing</span></a><span class="mpre"> :: </span><a href="Text.Regex.TDFA.Common.html#loc_221_6_221_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_221_6_221_8&#39;)"><span class="hl_tyconref"><span class="mpre">DT</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
    </span><a name="loc_308_5_308_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_308_5_308_15&#39;)"><span class="hl_fundecl"><span class="mpre">isDTLosing</span></span></a><span class="mpre"> (</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 308, srcSpanStartColumn = 17, srcSpanEndLine = 308, srcSpanEndColumn = 43}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 308, srcSpanStartColumn = 26, srcSpanEndLine = 308, srcSpanEndColumn = 27},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, "><span class="mpre">Testing&#39; {dt_a=a&#39;,dt_b=b&#39;}</span></span><span class="mpre">) = </span><a href="#loc_308_5_308_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_308_5_308_15&#39;)"><span class="hl_varref"><span class="mpre">isDTLosing</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">a&#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_308_5_308_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_308_5_308_15&#39;)"><span class="hl_varref"><span class="mpre">isDTLosing</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">b&#39;</span></span><span class="mpre">
    </span><a href="#loc_308_5_308_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_308_5_308_15&#39;)"><span class="hl_fundecl"><span class="mpre">isDTLosing</span></span></a><span class="mpre"> (</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 309, srcSpanStartColumn = 17, srcSpanEndLine = 309, srcSpanEndColumn = 35}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 309, srcSpanStartColumn = 25, srcSpanEndLine = 309, srcSpanEndColumn = 26},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, "><span class="mpre">Simple&#39; {dt_win=w}</span></span><span class="mpre">) | </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">IMap.null</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">w</span></span><span class="mpre">) = </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- can win with 0 characters</span></span><span class="mpre">
    </span><a href="#loc_308_5_308_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_308_5_308_15&#39;)"><span class="hl_fundecl"><span class="mpre">isDTLosing</span></span></a><span class="mpre"> (</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 310, srcSpanStartColumn = 17, srcSpanEndLine = 310, srcSpanEndColumn = 57}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 310, srcSpanStartColumn = 25, srcSpanEndLine = 310, srcSpanEndColumn = 26},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, "><span class="mpre">Simple&#39; {dt_trans=CharMap mt,dt_other=o}</span></span><span class="mpre">) =
      let </span><a name="loc_311_11_311_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_311_11_311_13&#39;)"><span class="hl_vardecl"><span class="mpre">ts</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">o</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">IMap.elems</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">mt</span></span><span class="mpre">
      in </span><span class="hl_varref"><span class="mpre">all</span></span><span class="mpre"> </span><a href="#loc_315_7_315_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_315_7_315_17&#39;)"><span class="hl_varref"><span class="mpre">transLoses</span></span></a><span class="mpre"> </span><a href="#loc_311_11_311_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_311_11_311_13&#39;)"><span class="hl_varref"><span class="mpre">ts</span></span></a><span class="mpre">
     where
      </span><a href="#loc_315_7_315_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_315_7_315_17&#39;)"><span class="mpre">transLoses</span></a><span class="mpre"> :: </span><a href="Text.Regex.TDFA.Common.html#loc_216_6_216_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_216_6_216_16&#39;)"><span class="hl_tyconref"><span class="mpre">Transition</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
      </span><a name="loc_315_7_315_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_315_7_315_17&#39;)"><span class="hl_fundecl"><span class="mpre">transLoses</span></span></a><span class="mpre"> (</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 315, srcSpanStartColumn = 19, srcSpanEndLine = 315, srcSpanEndColumn = 65}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 315, srcSpanStartColumn = 30, srcSpanEndLine = 315, srcSpanEndColumn = 31},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, "><span class="mpre">Transition {trans_single=dfa,trans_how=dtrans}</span></span><span class="mpre">) = </span><a href="#loc_318_9_318_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_318_9_318_17&#39;)"><span class="hl_varref"><span class="mpre">isDTLose</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">dfa</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><a href="#loc_320_9_320_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_320_9_320_19&#39;)"><span class="hl_varref"><span class="mpre">onlySpawns</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">dtrans</span></span><span class="mpre">
       where
        </span><a href="#loc_318_9_318_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_318_9_318_17&#39;)"><span class="mpre">isDTLose</span></a><span class="mpre"> :: </span><a href="Text.Regex.TDFA.Common.html#loc_215_6_215_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_215_6_215_9&#39;)"><span class="hl_tyconref"><span class="mpre">DFA</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
        </span><a name="loc_318_9_318_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_318_9_318_17&#39;)"><span class="hl_fundecl"><span class="mpre">isDTLose</span></span></a><span class="mpre"> </span><a name="loc_318_18_318_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_318_18_318_22&#39;)"><span class="hl_vardecl"><span class="mpre">dfa&#39;</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">ISet.null</span></span><span class="mpre"> (</span><a href="Text.Regex.TDFA.Common.html#loc_215_18_215_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_215_18_215_22&#39;)"><span class="hl_varref"><span class="mpre">d_id</span></span></a><span class="mpre"> </span><a href="#loc_318_18_318_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_318_18_318_22&#39;)"><span class="hl_varref"><span class="mpre">dfa&#39;</span></span></a><span class="mpre">)
        </span><a href="#loc_320_9_320_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_320_9_320_19&#39;)"><span class="mpre">onlySpawns</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">DTrans</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
        </span><a name="loc_320_9_320_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_320_9_320_19&#39;)"><span class="hl_fundecl"><span class="mpre">onlySpawns</span></span></a><span class="mpre"> </span><a name="loc_320_20_320_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_320_20_320_21&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> = case </span><span class="hl_varref"><span class="mpre">IMap.elems</span></span><span class="mpre"> </span><a href="#loc_320_20_320_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_320_20_320_21&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> of
                         [</span><a name="loc_321_27_321_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_321_27_321_28&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre">] -&gt; </span><span class="hl_varref"><span class="mpre">IMap.null</span></span><span class="mpre"> </span><a href="#loc_321_27_321_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_321_27_321_28&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">
                         _ -&gt; </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">{- toInstructions -}</span></span><span class="mpre">

</span><a href="#loc_327_1_327_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_327_1_327_15&#39;)"><span class="mpre">toInstructions</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">TagList</span></span><span class="mpre"> -&gt; </span><a href="Text.Regex.TDFA.Common.html#loc_259_6_259_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_259_6_259_18&#39;)"><span class="hl_tyconref"><span class="mpre">Instructions</span></span></a><span class="mpre">
</span><a name="loc_327_1_327_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_327_1_327_15&#39;)"><span class="hl_fundecl"><span class="mpre">toInstructions</span></span></a><span class="mpre"> </span><a name="loc_327_16_327_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_327_16_327_20&#39;)"><span class="hl_vardecl"><span class="mpre">spec</span></span></a><span class="mpre"> =
  let (</span><span class="hl_vardecl"><span class="mpre">p</span></span><span class="mpre">,</span><span class="hl_vardecl"><span class="mpre">o</span></span><span class="mpre">) = </span><a href="Control.Monad.Trans.State.Lazy.html#loc_116_1_116_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.Trans.State.Lazy.html#loc_116_1_116_10&#39;)"><span class="hl_varref"><span class="mpre">execState</span></span></a><span class="mpre"> (</span><a href="#loc_346_1_346_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_346_1_346_9&#39;)"><span class="hl_varref"><span class="mpre">assemble</span></span></a><span class="mpre"> </span><a href="#loc_327_16_327_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_327_16_327_20&#39;)"><span class="hl_varref"><span class="mpre">spec</span></span></a><span class="mpre">) (</span><a href="Data.Monoid.html#loc_80_9_80_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_80_9_80_15&#39;)"><span class="hl_varref"><span class="mpre">mempty</span></span></a><span class="mpre">,</span><a href="Data.Monoid.html#loc_80_9_80_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_80_9_80_15&#39;)"><span class="hl_varref"><span class="mpre">mempty</span></span></a><span class="mpre">)
  in </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 329, srcSpanStartColumn = 6, srcSpanEndLine = 332, srcSpanEndColumn = 20}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 329, srcSpanStartColumn = 19, srcSpanEndLine = 329, srcSpanEndColumn = 20},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.h"><span class="mpre">Instructions { newPos = IMap.toList p
                  , newOrbits = if IMap.null o then Nothing
                                  else Just $ alterOrbits (IMap.toList o)
                  }</span></span><span class="mpre">

</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 334, srcSpanStartColumn = 1, srcSpanEndLine = 337, srcSpanEndColumn = 6}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 334, srcSpanStartColumn = 1, srcSpanEndLine = 334, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, "><span class="mpre">type CompileInstructions a = State
  ( IntMap Action </span><span class="hl_comment"><span class="mpre">-- 2009: change to SetPre | SetPost enum</span></span><span class="mpre">
  , IntMap AlterOrbit
  ) a</span></span><span class="mpre">

data </span><a name="loc_339_6_339_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_339_6_339_16&#39;)"><span class="hl_tycondecl"><span class="mpre">AlterOrbit</span></span></a><span class="mpre"> = </span><a name="loc_339_19_339_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_339_19_339_29&#39;)"><span class="hl_condecl"><span class="mpre">AlterReset</span></span></a><span class="mpre">                        </span><span class="hl_comment"><span class="mpre">-- removing the Orbits record from the OrbitLog</span></span><span class="mpre">
                | </span><a name="loc_340_19_340_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_340_19_340_29&#39;)"><span class="hl_condecl"><span class="mpre">AlterLeave</span></span></a><span class="mpre">                        </span><span class="hl_comment"><span class="mpre">-- set inOrbit to False</span></span><span class="mpre">
                | </span><span class="hl_condecl"><span class="mpre">AlterModify</span></span><span class="mpre"> { </span><span class="hl_fielddecl"><span class="mpre">newInOrbit</span></span><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">   </span><span class="hl_comment"><span class="mpre">-- set inOrbit to the newInOrbit value</span></span><span class="mpre">
                              , </span><span class="hl_fielddecl"><span class="mpre">freshOrbit</span></span><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">}  </span><span class="hl_comment"><span class="mpre">-- freshOrbit of True means to set getOrbits to mempty</span></span><span class="mpre">
                  </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 343, srcSpanStartColumn = 19, srcSpanEndLine = 343, srcSpanEndColumn = 34}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 343, srcSpanStartColumn = 19, srcSpanEndLine = 343, srcSpanEndColumn = 27},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.h"><span class="mpre">deriving (Show)</span></span><span class="mpre">                   </span><span class="hl_comment"><span class="mpre">-- freshOrbit of False means try appending position or else Seq.empty</span></span><span class="mpre">

</span><a href="#loc_346_1_346_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_346_1_346_9&#39;)"><span class="mpre">assemble</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">TagList</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">CompileInstructions</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_346_1_346_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_346_1_346_9&#39;)"><span class="hl_vardecl"><span class="mpre">assemble</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">mapM_</span></span><span class="mpre"> </span><a href="#loc_347_3_347_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_347_3_347_17&#39;)"><span class="hl_varref"><span class="mpre">oneInstruction</span></span></a><span class="mpre"> where
  </span><a name="loc_347_3_347_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_347_3_347_17&#39;)"><span class="hl_fundecl"><span class="mpre">oneInstruction</span></span></a><span class="mpre"> (</span><a name="loc_347_19_347_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_347_19_347_22&#39;)"><span class="hl_vardecl"><span class="mpre">tag</span></span></a><span class="mpre">,</span><a name="loc_347_23_347_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_347_23_347_30&#39;)"><span class="hl_vardecl"><span class="mpre">command</span></span></a><span class="mpre">) =
    case </span><a href="#loc_347_23_347_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_347_23_347_30&#39;)"><span class="hl_varref"><span class="mpre">command</span></span></a><span class="mpre"> of
      </span><a href="Text.Regex.TDFA.Common.html#loc_203_18_203_27" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_203_18_203_27&#39;)"><span class="hl_conref"><span class="mpre">PreUpdate</span></span></a><span class="mpre"> </span><a href="Text.Regex.TDFA.Common.html#loc_196_16_196_23" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_196_16_196_23&#39;)"><span class="hl_conref"><span class="mpre">TagTask</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_361_1_361_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_361_1_361_10&#39;)"><span class="hl_varref"><span class="mpre">setPreTag</span></span></a><span class="mpre"> </span><a href="#loc_347_19_347_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_347_19_347_22&#39;)"><span class="hl_varref"><span class="mpre">tag</span></span></a><span class="mpre">
      </span><a href="Text.Regex.TDFA.Common.html#loc_203_18_203_27" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_203_18_203_27&#39;)"><span class="hl_conref"><span class="mpre">PreUpdate</span></span></a><span class="mpre"> </span><a href="Text.Regex.TDFA.Common.html#loc_196_26_196_44" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_196_26_196_44&#39;)"><span class="hl_conref"><span class="mpre">ResetGroupStopTask</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_367_1_367_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_367_1_367_14&#39;)"><span class="hl_varref"><span class="mpre">resetGroupTag</span></span></a><span class="mpre"> </span><a href="#loc_347_19_347_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_347_19_347_22&#39;)"><span class="hl_varref"><span class="mpre">tag</span></span></a><span class="mpre">
      </span><a href="Text.Regex.TDFA.Common.html#loc_203_18_203_27" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_203_18_203_27&#39;)"><span class="hl_conref"><span class="mpre">PreUpdate</span></span></a><span class="mpre"> </span><a href="Text.Regex.TDFA.Common.html#loc_196_47_196_63" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_196_47_196_63&#39;)"><span class="hl_conref"><span class="mpre">SetGroupStopTask</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_370_1_370_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_370_1_370_12&#39;)"><span class="hl_varref"><span class="mpre">setGroupTag</span></span></a><span class="mpre"> </span><a href="#loc_347_19_347_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_347_19_347_22&#39;)"><span class="hl_varref"><span class="mpre">tag</span></span></a><span class="mpre">
      </span><a href="Text.Regex.TDFA.Common.html#loc_203_18_203_27" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_203_18_203_27&#39;)"><span class="hl_conref"><span class="mpre">PreUpdate</span></span></a><span class="mpre"> </span><a href="Text.Regex.TDFA.Common.html#loc_197_16_197_30" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_197_16_197_30&#39;)"><span class="hl_conref"><span class="mpre">ResetOrbitTask</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_376_1_376_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_376_1_376_11&#39;)"><span class="hl_varref"><span class="mpre">resetOrbit</span></span></a><span class="mpre"> </span><a href="#loc_347_19_347_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_347_19_347_22&#39;)"><span class="hl_varref"><span class="mpre">tag</span></span></a><span class="mpre">
      </span><a href="Text.Regex.TDFA.Common.html#loc_203_18_203_27" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_203_18_203_27&#39;)"><span class="hl_conref"><span class="mpre">PreUpdate</span></span></a><span class="mpre"> </span><a href="Text.Regex.TDFA.Common.html#loc_197_33_197_47" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_197_33_197_47&#39;)"><span class="hl_conref"><span class="mpre">EnterOrbitTask</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_379_1_379_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_379_1_379_11&#39;)"><span class="hl_varref"><span class="mpre">enterOrbit</span></span></a><span class="mpre"> </span><a href="#loc_347_19_347_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_347_19_347_22&#39;)"><span class="hl_varref"><span class="mpre">tag</span></span></a><span class="mpre">
      </span><a href="Text.Regex.TDFA.Common.html#loc_203_18_203_27" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_203_18_203_27&#39;)"><span class="hl_conref"><span class="mpre">PreUpdate</span></span></a><span class="mpre"> </span><a href="Text.Regex.TDFA.Common.html#loc_197_50_197_64" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_197_50_197_64&#39;)"><span class="hl_conref"><span class="mpre">LeaveOrbitTask</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_392_1_392_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_392_1_392_11&#39;)"><span class="hl_varref"><span class="mpre">leaveOrbit</span></span></a><span class="mpre"> </span><a href="#loc_347_19_347_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_347_19_347_22&#39;)"><span class="hl_varref"><span class="mpre">tag</span></span></a><span class="mpre">
      </span><a href="Text.Regex.TDFA.Common.html#loc_203_38_203_48" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_203_38_203_48&#39;)"><span class="hl_conref"><span class="mpre">PostUpdate</span></span></a><span class="mpre"> </span><a href="Text.Regex.TDFA.Common.html#loc_196_16_196_23" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_196_16_196_23&#39;)"><span class="hl_conref"><span class="mpre">TagTask</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_364_1_364_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_364_1_364_11&#39;)"><span class="hl_varref"><span class="mpre">setPostTag</span></span></a><span class="mpre"> </span><a href="#loc_347_19_347_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_347_19_347_22&#39;)"><span class="hl_varref"><span class="mpre">tag</span></span></a><span class="mpre">
      </span><a href="Text.Regex.TDFA.Common.html#loc_203_38_203_48" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_203_38_203_48&#39;)"><span class="hl_conref"><span class="mpre">PostUpdate</span></span></a><span class="mpre"> </span><a href="Text.Regex.TDFA.Common.html#loc_196_26_196_44" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_196_26_196_44&#39;)"><span class="hl_conref"><span class="mpre">ResetGroupStopTask</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_367_1_367_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_367_1_367_14&#39;)"><span class="hl_varref"><span class="mpre">resetGroupTag</span></span></a><span class="mpre"> </span><a href="#loc_347_19_347_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_347_19_347_22&#39;)"><span class="hl_varref"><span class="mpre">tag</span></span></a><span class="mpre">
      </span><a href="Text.Regex.TDFA.Common.html#loc_203_38_203_48" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_203_38_203_48&#39;)"><span class="hl_conref"><span class="mpre">PostUpdate</span></span></a><span class="mpre"> </span><a href="Text.Regex.TDFA.Common.html#loc_196_47_196_63" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_196_47_196_63&#39;)"><span class="hl_conref"><span class="mpre">SetGroupStopTask</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_370_1_370_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_370_1_370_12&#39;)"><span class="hl_varref"><span class="mpre">setGroupTag</span></span></a><span class="mpre"> </span><a href="#loc_347_19_347_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_347_19_347_22&#39;)"><span class="hl_varref"><span class="mpre">tag</span></span></a><span class="mpre">
      _ -&gt; </span><a href="#loc_37_1_37_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_1_37_4&#39;)"><span class="hl_varref"><span class="mpre">err</span></span></a><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;assemble : Weird orbit command: &quot;</span></span><span class="hl_infix"><span class="mpre">++</span></span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> (</span><a href="#loc_347_19_347_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_347_19_347_22&#39;)"><span class="hl_varref"><span class="mpre">tag</span></span></a><span class="mpre">,</span><a href="#loc_347_23_347_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_347_23_347_30&#39;)"><span class="hl_varref"><span class="mpre">command</span></span></a><span class="mpre">))

</span><a href="#loc_361_1_361_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_361_1_361_10&#39;)"><span class="mpre">setPreTag</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Tag</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">CompileInstructions</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_361_1_361_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_361_1_361_10&#39;)"><span class="hl_vardecl"><span class="mpre">setPreTag</span></span></a><span class="mpre"> = </span><a href="#loc_398_1_398_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_398_1_398_10&#39;)"><span class="hl_varref"><span class="mpre">modifyPos</span></span></a><span class="mpre"> </span><a href="Text.Regex.TDFA.Common.html#loc_263_15_263_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_263_15_263_21&#39;)"><span class="hl_conref"><span class="mpre">SetPre</span></span></a><span class="mpre">

</span><a href="#loc_364_1_364_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_364_1_364_11&#39;)"><span class="mpre">setPostTag</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Tag</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">CompileInstructions</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_364_1_364_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_364_1_364_11&#39;)"><span class="hl_vardecl"><span class="mpre">setPostTag</span></span></a><span class="mpre"> = </span><a href="#loc_398_1_398_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_398_1_398_10&#39;)"><span class="hl_varref"><span class="mpre">modifyPos</span></span></a><span class="mpre"> </span><a href="Text.Regex.TDFA.Common.html#loc_263_24_263_31" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_263_24_263_31&#39;)"><span class="hl_conref"><span class="mpre">SetPost</span></span></a><span class="mpre">

</span><a href="#loc_367_1_367_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_367_1_367_14&#39;)"><span class="mpre">resetGroupTag</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Tag</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">CompileInstructions</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_367_1_367_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_367_1_367_14&#39;)"><span class="hl_vardecl"><span class="mpre">resetGroupTag</span></span></a><span class="mpre"> = </span><a href="#loc_398_1_398_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_398_1_398_10&#39;)"><span class="hl_varref"><span class="mpre">modifyPos</span></span></a><span class="mpre"> (</span><a href="Text.Regex.TDFA.Common.html#loc_263_34_263_40" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_263_34_263_40&#39;)"><span class="hl_conref"><span class="mpre">SetVal</span></span></a><span class="mpre"> (-</span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">))

</span><a href="#loc_370_1_370_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_370_1_370_12&#39;)"><span class="mpre">setGroupTag</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Tag</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">CompileInstructions</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_370_1_370_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_370_1_370_12&#39;)"><span class="hl_vardecl"><span class="mpre">setGroupTag</span></span></a><span class="mpre"> = </span><a href="#loc_398_1_398_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_398_1_398_10&#39;)"><span class="hl_varref"><span class="mpre">modifyPos</span></span></a><span class="mpre"> (</span><a href="Text.Regex.TDFA.Common.html#loc_263_34_263_40" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_263_34_263_40&#39;)"><span class="hl_conref"><span class="mpre">SetVal</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- The following is ten times more complicated than it ought to be.  Sorry, I was too new, and now</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- too busy to clean this up.</span></span><span class="mpre">

</span><a href="#loc_376_1_376_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_376_1_376_11&#39;)"><span class="mpre">resetOrbit</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Tag</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">CompileInstructions</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_376_1_376_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_376_1_376_11&#39;)"><span class="hl_fundecl"><span class="mpre">resetOrbit</span></span></a><span class="mpre"> </span><a name="loc_376_12_376_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_376_12_376_15&#39;)"><span class="hl_vardecl"><span class="mpre">tag</span></span></a><span class="mpre"> = </span><a href="#loc_398_1_398_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_398_1_398_10&#39;)"><span class="hl_varref"><span class="mpre">modifyPos</span></span></a><span class="mpre"> (</span><a href="Text.Regex.TDFA.Common.html#loc_263_34_263_40" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_263_34_263_40&#39;)"><span class="hl_conref"><span class="mpre">SetVal</span></span></a><span class="mpre"> (-</span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)) </span><a href="#loc_376_12_376_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_376_12_376_15&#39;)"><span class="hl_varref"><span class="mpre">tag</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="#loc_404_1_404_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_404_1_404_12&#39;)"><span class="hl_varref"><span class="mpre">modifyOrbit</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">IMap.insert</span></span><span class="mpre"> </span><a href="#loc_376_12_376_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_376_12_376_15&#39;)"><span class="hl_varref"><span class="mpre">tag</span></span></a><span class="mpre"> </span><a href="#loc_339_19_339_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_339_19_339_29&#39;)"><span class="hl_conref"><span class="mpre">AlterReset</span></span></a><span class="mpre">)

</span><a href="#loc_379_1_379_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_379_1_379_11&#39;)"><span class="mpre">enterOrbit</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Tag</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">CompileInstructions</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_379_1_379_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_379_1_379_11&#39;)"><span class="hl_fundecl"><span class="mpre">enterOrbit</span></span></a><span class="mpre"> </span><a name="loc_379_12_379_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_379_12_379_15&#39;)"><span class="hl_vardecl"><span class="mpre">tag</span></span></a><span class="mpre"> = </span><a href="#loc_398_1_398_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_398_1_398_10&#39;)"><span class="hl_varref"><span class="mpre">modifyPos</span></span></a><span class="mpre"> (</span><a href="Text.Regex.TDFA.Common.html#loc_263_34_263_40" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_263_34_263_40&#39;)"><span class="hl_conref"><span class="mpre">SetVal</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">) </span><a href="#loc_379_12_379_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_379_12_379_15&#39;)"><span class="hl_varref"><span class="mpre">tag</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="#loc_404_1_404_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_404_1_404_12&#39;)"><span class="hl_varref"><span class="mpre">modifyOrbit</span></span></a><span class="mpre"> </span><a href="#loc_380_3_380_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_380_3_380_14&#39;)"><span class="hl_varref"><span class="mpre">changeOrbit</span></span></a><span class="mpre"> where
  </span><a name="loc_380_3_380_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_380_3_380_14&#39;)"><span class="hl_vardecl"><span class="mpre">changeOrbit</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">IMap.insertWith</span></span><span class="mpre"> </span><a href="#loc_385_3_385_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_385_3_385_17&#39;)"><span class="hl_varref"><span class="mpre">overwriteOrbit</span></span></a><span class="mpre"> </span><a href="#loc_379_12_379_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_379_12_379_15&#39;)"><span class="hl_varref"><span class="mpre">tag</span></span></a><span class="mpre"> </span><a href="#loc_382_3_382_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_382_3_382_17&#39;)"><span class="hl_varref"><span class="mpre">appendNewOrbit</span></span></a><span class="mpre">

  </span><a name="loc_382_3_382_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_382_3_382_17&#39;)"><span class="hl_vardecl"><span class="mpre">appendNewOrbit</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 382, srcSpanStartColumn = 20, srcSpanEndLine = 382, srcSpanEndColumn = 71}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 382, srcSpanStartColumn = 32, srcSpanEndLine = 382, srcSpanEndColumn = 33},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA."><span class="mpre">AlterModify {newInOrbit = True, freshOrbit = False}</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- try to append</span></span><span class="mpre">
  </span><a name="loc_383_3_383_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_383_3_383_16&#39;)"><span class="hl_vardecl"><span class="mpre">startNewOrbit</span></span></a><span class="mpre">  = </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 383, srcSpanStartColumn = 20, srcSpanEndLine = 383, srcSpanEndColumn = 70}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 383, srcSpanStartColumn = 32, srcSpanEndLine = 383, srcSpanEndColumn = 33},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA."><span class="mpre">AlterModify {newInOrbit = True, freshOrbit = True}</span></span><span class="mpre">  </span><span class="hl_comment"><span class="mpre">-- will start a new series</span></span><span class="mpre">

  </span><a name="loc_385_3_385_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_385_3_385_17&#39;)"><span class="hl_fundecl"><span class="mpre">overwriteOrbit</span></span></a><span class="mpre"> _ </span><a href="#loc_339_19_339_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_339_19_339_29&#39;)"><span class="hl_conref"><span class="mpre">AlterReset</span></span></a><span class="mpre"> = </span><a href="#loc_383_3_383_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_383_3_383_16&#39;)"><span class="hl_varref"><span class="mpre">startNewOrbit</span></span></a><span class="mpre">
  </span><a href="#loc_385_3_385_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_385_3_385_17&#39;)"><span class="hl_fundecl"><span class="mpre">overwriteOrbit</span></span></a><span class="mpre"> _ </span><a href="#loc_340_19_340_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_340_19_340_29&#39;)"><span class="hl_conref"><span class="mpre">AlterLeave</span></span></a><span class="mpre"> = </span><a href="#loc_383_3_383_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_383_3_383_16&#39;)"><span class="hl_varref"><span class="mpre">startNewOrbit</span></span></a><span class="mpre">
  </span><a href="#loc_385_3_385_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_385_3_385_17&#39;)"><span class="hl_fundecl"><span class="mpre">overwriteOrbit</span></span></a><span class="mpre"> _ (</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 387, srcSpanStartColumn = 21, srcSpanEndLine = 387, srcSpanEndColumn = 53}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 387, srcSpanStartColumn = 33, srcSpanEndLine = 387, srcSpanEndColumn = 34},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, "><span class="mpre">AlterModify {newInOrbit = False}</span></span><span class="mpre">) = </span><a href="#loc_383_3_383_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_383_3_383_16&#39;)"><span class="hl_varref"><span class="mpre">startNewOrbit</span></span></a><span class="mpre">
  </span><a href="#loc_385_3_385_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_385_3_385_17&#39;)"><span class="hl_fundecl"><span class="mpre">overwriteOrbit</span></span></a><span class="mpre"> _ (</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 388, srcSpanStartColumn = 21, srcSpanEndLine = 388, srcSpanEndColumn = 52}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 388, srcSpanStartColumn = 33, srcSpanEndLine = 388, srcSpanEndColumn = 34},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, "><span class="mpre">AlterModify {newInOrbit = True}</span></span><span class="mpre">) =
    </span><a href="#loc_37_1_37_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_1_37_4&#39;)"><span class="hl_varref"><span class="mpre">err</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;enterOrbit: Cannot enterOrbit twice in a row: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_379_12_379_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_379_12_379_15&#39;)"><span class="hl_varref"><span class="mpre">tag</span></span></a><span class="mpre">

</span><a href="#loc_392_1_392_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_392_1_392_11&#39;)"><span class="mpre">leaveOrbit</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Tag</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">CompileInstructions</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_392_1_392_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_392_1_392_11&#39;)"><span class="hl_fundecl"><span class="mpre">leaveOrbit</span></span></a><span class="mpre"> </span><a name="loc_392_12_392_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_392_12_392_15&#39;)"><span class="hl_vardecl"><span class="mpre">tag</span></span></a><span class="mpre"> = </span><a href="#loc_404_1_404_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_404_1_404_12&#39;)"><span class="hl_varref"><span class="mpre">modifyOrbit</span></span></a><span class="mpre"> </span><a href="#loc_393_3_393_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_393_3_393_14&#39;)"><span class="hl_varref"><span class="mpre">escapeOrbit</span></span></a><span class="mpre"> where
  </span><a name="loc_393_3_393_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_393_3_393_14&#39;)"><span class="hl_vardecl"><span class="mpre">escapeOrbit</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">IMap.insertWith</span></span><span class="mpre"> </span><a href="#loc_394_5_394_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_394_5_394_20&#39;)"><span class="hl_varref"><span class="mpre">setInOrbitFalse</span></span></a><span class="mpre"> </span><a href="#loc_392_12_392_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_392_12_392_15&#39;)"><span class="hl_varref"><span class="mpre">tag</span></span></a><span class="mpre"> </span><a href="#loc_340_19_340_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_340_19_340_29&#39;)"><span class="hl_conref"><span class="mpre">AlterLeave</span></span></a><span class="mpre"> where
    </span><a name="loc_394_5_394_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_394_5_394_20&#39;)"><span class="hl_fundecl"><span class="mpre">setInOrbitFalse</span></span></a><span class="mpre"> _ </span><span class="hl_specname"><span class="mpre">x</span></span><span class="mpre">@(</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 394, srcSpanStartColumn = 26, srcSpanEndLine = 394, srcSpanEndColumn = 40}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 394, srcSpanStartColumn = 38, srcSpanEndLine = 394, srcSpanEndColumn = 39},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, "><span class="mpre">AlterModify {}</span></span><span class="mpre">) = </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 394, srcSpanStartColumn = 44, srcSpanEndLine = 394, srcSpanEndColumn = 66}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 394, srcSpanStartColumn = 46, srcSpanEndLine = 394, srcSpanEndColumn = 47},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA."><span class="mpre">x {newInOrbit = False}</span></span><span class="mpre">
    </span><a href="#loc_394_5_394_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_394_5_394_20&#39;)"><span class="hl_fundecl"><span class="mpre">setInOrbitFalse</span></span></a><span class="mpre"> _ </span><a name="loc_395_23_395_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_395_23_395_24&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="#loc_395_23_395_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_395_23_395_24&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">

</span><a href="#loc_398_1_398_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_398_1_398_10&#39;)"><span class="mpre">modifyPos</span></a><span class="mpre"> :: </span><a href="Text.Regex.TDFA.Common.html#loc_263_6_263_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_263_6_263_12&#39;)"><span class="hl_tyconref"><span class="mpre">Action</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Tag</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">CompileInstructions</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_398_1_398_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_398_1_398_10&#39;)"><span class="hl_fundecl"><span class="mpre">modifyPos</span></span></a><span class="mpre"> </span><a name="loc_398_11_398_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_398_11_398_15&#39;)"><span class="hl_vardecl"><span class="mpre">todo</span></span></a><span class="mpre"> </span><a name="loc_398_16_398_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_398_16_398_19&#39;)"><span class="hl_vardecl"><span class="mpre">tag</span></span></a><span class="mpre"> = do
  (</span><a name="loc_399_4_399_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_399_4_399_5&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">,</span><a name="loc_399_6_399_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_399_6_399_7&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">) &lt;- </span><span class="hl_varref"><span class="mpre">get</span></span><span class="mpre">
  let </span><a name="loc_400_7_400_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_400_7_400_9&#39;)"><span class="hl_vardecl"><span class="mpre">a&#39;</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">IMap.insert</span></span><span class="mpre"> </span><a href="#loc_398_16_398_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_398_16_398_19&#39;)"><span class="hl_varref"><span class="mpre">tag</span></span></a><span class="mpre"> </span><a href="#loc_398_11_398_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_398_11_398_15&#39;)"><span class="hl_varref"><span class="mpre">todo</span></span></a><span class="mpre"> </span><a href="#loc_399_4_399_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_399_4_399_5&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">
  </span><span class="hl_varref"><span class="mpre">seq</span></span><span class="mpre"> </span><a href="#loc_400_7_400_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_400_7_400_9&#39;)"><span class="hl_varref"><span class="mpre">a&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">put</span></span><span class="mpre"> (</span><a href="#loc_400_7_400_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_400_7_400_9&#39;)"><span class="hl_varref"><span class="mpre">a&#39;</span></span></a><span class="mpre">,</span><a href="#loc_399_6_399_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_399_6_399_7&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">)

</span><a href="#loc_404_1_404_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_404_1_404_12&#39;)"><span class="mpre">modifyOrbit</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">IntMap</span></span><span class="mpre"> </span><a href="#loc_339_6_339_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_339_6_339_16&#39;)"><span class="hl_tyconref"><span class="mpre">AlterOrbit</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IntMap</span></span><span class="mpre"> </span><a href="#loc_339_6_339_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_339_6_339_16&#39;)"><span class="hl_tyconref"><span class="mpre">AlterOrbit</span></span></a><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">CompileInstructions</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_404_1_404_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_404_1_404_12&#39;)"><span class="hl_fundecl"><span class="mpre">modifyOrbit</span></span></a><span class="mpre"> </span><a name="loc_404_13_404_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_404_13_404_14&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = do
  (</span><a name="loc_405_4_405_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_405_4_405_5&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">,</span><a name="loc_405_6_405_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_405_6_405_7&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">) &lt;- </span><span class="hl_varref"><span class="mpre">get</span></span><span class="mpre">
  let </span><a name="loc_406_7_406_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_406_7_406_9&#39;)"><span class="hl_vardecl"><span class="mpre">c&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_404_13_404_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_404_13_404_14&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_405_6_405_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_405_6_405_7&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">
  </span><span class="hl_varref"><span class="mpre">seq</span></span><span class="mpre"> </span><a href="#loc_406_7_406_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_406_7_406_9&#39;)"><span class="hl_varref"><span class="mpre">c&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">put</span></span><span class="mpre"> (</span><a href="#loc_405_4_405_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_405_4_405_5&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">,</span><a href="#loc_406_7_406_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_406_7_406_9&#39;)"><span class="hl_varref"><span class="mpre">c&#39;</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">----</span></span><span class="mpre">

</span><a href="#loc_412_1_412_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_412_1_412_12&#39;)"><span class="mpre">alterOrbits</span></a><span class="mpre"> :: [(</span><span class="hl_tyconref"><span class="mpre">Tag</span></span><span class="mpre">,</span><a href="#loc_339_6_339_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_339_6_339_16&#39;)"><span class="hl_tyconref"><span class="mpre">AlterOrbit</span></span></a><span class="mpre">)] -&gt; (</span><span class="hl_tyconref"><span class="mpre">Position</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">OrbitTransformer</span></span><span class="mpre">)
</span><a name="loc_412_1_412_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_412_1_412_12&#39;)"><span class="hl_fundecl"><span class="mpre">alterOrbits</span></span></a><span class="mpre"> </span><a name="loc_412_13_412_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_412_13_412_14&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = let </span><a name="loc_412_21_412_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_412_21_412_26&#39;)"><span class="hl_vardecl"><span class="mpre">items</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="#loc_417_1_417_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_417_1_417_11&#39;)"><span class="hl_varref"><span class="mpre">alterOrbit</span></span></a><span class="mpre"> </span><a href="#loc_412_13_412_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_412_13_412_14&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
                in (\ </span><a name="loc_413_23_413_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_413_23_413_26&#39;)"><span class="hl_vardecl"><span class="mpre">pos</span></span></a><span class="mpre"> </span><a name="loc_413_27_413_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_413_27_413_28&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">foldl</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">flip</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">($)</span></span><span class="mpre">) </span><a href="#loc_413_27_413_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_413_27_413_28&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_413_23_413_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_413_23_413_26&#39;)"><span class="hl_varref"><span class="mpre">pos</span></span></a><span class="mpre">) </span><a href="#loc_412_21_412_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_412_21_412_26&#39;)"><span class="hl_varref"><span class="mpre">items</span></span></a><span class="mpre">))

</span><a href="#loc_417_1_417_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_417_1_417_11&#39;)"><span class="mpre">alterOrbit</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">Tag</span></span><span class="mpre">,</span><a href="#loc_339_6_339_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_339_6_339_16&#39;)"><span class="hl_tyconref"><span class="mpre">AlterOrbit</span></span></a><span class="mpre">) -&gt; (</span><span class="hl_tyconref"><span class="mpre">Position</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">OrbitTransformer</span></span><span class="mpre">)

</span><a name="loc_417_1_417_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_417_1_417_11&#39;)"><span class="hl_fundecl"><span class="mpre">alterOrbit</span></span></a><span class="mpre"> (</span><a name="loc_417_13_417_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_417_13_417_16&#39;)"><span class="hl_vardecl"><span class="mpre">tag</span></span></a><span class="mpre">,</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 417, srcSpanStartColumn = 17, srcSpanEndLine = 417, srcSpanEndColumn = 70}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 417, srcSpanStartColumn = 29, srcSpanEndLine = 417, srcSpanEndColumn = 30},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, "><span class="mpre">AlterModify {newInOrbit = inOrbit&#39;,freshOrbit = True}</span></span><span class="mpre">) =
  (\ </span><span class="hl_vardecl"><span class="mpre">pos</span></span><span class="mpre"> </span><a name="loc_418_10_418_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_418_10_418_11&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">IMap.insert</span></span><span class="mpre"> </span><a href="#loc_417_13_417_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_417_13_417_16&#39;)"><span class="hl_varref"><span class="mpre">tag</span></span></a><span class="mpre"> (</span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 418, srcSpanStartColumn = 32, srcSpanEndLine = 421, srcSpanEndColumn = 59}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 418, srcSpanStartColumn = 39, srcSpanEndLine = 418, srcSpanEndColumn = 40},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA."><span class="mpre">Orbits { inOrbit = inOrbit&#39;
                                     , basePos = pos
                                     , ordinal = Nothing
                                     , getOrbits = mempty}</span></span><span class="mpre">) </span><a href="#loc_418_10_418_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_418_10_418_11&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">)

</span><a href="#loc_417_1_417_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_417_1_417_11&#39;)"><span class="hl_fundecl"><span class="mpre">alterOrbit</span></span></a><span class="mpre"> (</span><a name="loc_423_13_423_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_423_13_423_16&#39;)"><span class="hl_vardecl"><span class="mpre">tag</span></span></a><span class="mpre">,</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 423, srcSpanStartColumn = 17, srcSpanEndLine = 423, srcSpanEndColumn = 71}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 423, srcSpanStartColumn = 29, srcSpanEndLine = 423, srcSpanEndColumn = 30},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, "><span class="mpre">AlterModify {newInOrbit = inOrbit&#39;,freshOrbit = False}</span></span><span class="mpre">) =
  (\ </span><a name="loc_424_6_424_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_424_6_424_9&#39;)"><span class="hl_vardecl"><span class="mpre">pos</span></span></a><span class="mpre"> </span><a name="loc_424_10_424_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_424_10_424_11&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">IMap.insertWithKey</span></span><span class="mpre"> (</span><a href="#loc_429_3_429_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_429_3_429_14&#39;)"><span class="hl_varref"><span class="mpre">updateOrbit</span></span></a><span class="mpre"> </span><a href="#loc_424_6_424_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_424_6_424_9&#39;)"><span class="hl_varref"><span class="mpre">pos</span></span></a><span class="mpre">) </span><a href="#loc_423_13_423_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_423_13_423_16&#39;)"><span class="hl_varref"><span class="mpre">tag</span></span></a><span class="mpre"> (</span><a href="#loc_425_3_425_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_425_3_425_11&#39;)"><span class="hl_varref"><span class="mpre">newOrbit</span></span></a><span class="mpre"> </span><a href="#loc_424_6_424_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_424_6_424_9&#39;)"><span class="hl_varref"><span class="mpre">pos</span></span></a><span class="mpre">) </span><a href="#loc_424_10_424_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_424_10_424_11&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">) where
  </span><a name="loc_425_3_425_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_425_3_425_11&#39;)"><span class="hl_fundecl"><span class="mpre">newOrbit</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">pos</span></span><span class="mpre"> = </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 425, srcSpanStartColumn = 18, srcSpanEndLine = 428, srcSpanEndColumn = 46}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 425, srcSpanStartColumn = 25, srcSpanEndLine = 425, srcSpanEndColumn = 26},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA."><span class="mpre">Orbits { inOrbit = inOrbit&#39;
                        , basePos = pos
                        , ordinal = Nothing
                        , getOrbits = mempty}</span></span><span class="mpre">
  </span><a name="loc_429_3_429_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_429_3_429_14&#39;)"><span class="hl_fundecl"><span class="mpre">updateOrbit</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">pos</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">_tag</span></span><span class="mpre"> </span><a name="loc_429_24_429_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_429_24_429_27&#39;)"><span class="hl_vardecl"><span class="mpre">new</span></span></a><span class="mpre"> </span><a name="loc_429_28_429_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_429_28_429_31&#39;)"><span class="hl_vardecl"><span class="mpre">old</span></span></a><span class="mpre"> | </span><a href="Text.Regex.TDFA.Common.html#loc_252_5_252_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Regex.TDFA.Common.html#loc_252_5_252_12&#39;)"><span class="hl_varref"><span class="mpre">inOrbit</span></span></a><span class="mpre"> </span><a href="#loc_429_28_429_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_429_28_429_31&#39;)"><span class="hl_varref"><span class="mpre">old</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 429, srcSpanStartColumn = 48, srcSpanEndLine = 430, srcSpanEndColumn = 88}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 429, srcSpanStartColumn = 52, srcSpanEndLine = 429, srcSpanEndColumn = 53},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA."><span class="mpre">old { inOrbit = inOrbit&#39;
                                                   , getOrbits = getOrbits old |&gt; pos }</span></span><span class="mpre">
                               | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="#loc_429_24_429_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_429_24_429_27&#39;)"><span class="hl_varref"><span class="mpre">new</span></span></a><span class="mpre">

</span><a href="#loc_417_1_417_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_417_1_417_11&#39;)"><span class="hl_fundecl"><span class="mpre">alterOrbit</span></span></a><span class="mpre"> (</span><a name="loc_433_13_433_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_433_13_433_16&#39;)"><span class="hl_vardecl"><span class="mpre">tag</span></span></a><span class="mpre">,</span><a href="#loc_339_19_339_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_339_19_339_29&#39;)"><span class="hl_conref"><span class="mpre">AlterReset</span></span></a><span class="mpre">) = (\ _ </span><a name="loc_433_36_433_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_433_36_433_37&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">IMap.delete</span></span><span class="mpre"> </span><a href="#loc_433_13_433_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_433_13_433_16&#39;)"><span class="hl_varref"><span class="mpre">tag</span></span></a><span class="mpre"> </span><a href="#loc_433_36_433_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_433_36_433_37&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">)

</span><a href="#loc_417_1_417_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_417_1_417_11&#39;)"><span class="hl_fundecl"><span class="mpre">alterOrbit</span></span></a><span class="mpre"> (</span><a name="loc_435_13_435_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_435_13_435_16&#39;)"><span class="hl_vardecl"><span class="mpre">tag</span></span></a><span class="mpre">,</span><a href="#loc_340_19_340_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_340_19_340_29&#39;)"><span class="hl_conref"><span class="mpre">AlterLeave</span></span></a><span class="mpre">) = (\ _ </span><a name="loc_435_36_435_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_435_36_435_37&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> -&gt; case </span><span class="hl_varref"><span class="mpre">IMap.lookup</span></span><span class="mpre"> </span><a href="#loc_435_13_435_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_435_13_435_16&#39;)"><span class="hl_varref"><span class="mpre">tag</span></span></a><span class="mpre"> </span><a href="#loc_435_36_435_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_435_36_435_37&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> of
                                         </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt; </span><a href="#loc_435_36_435_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_435_36_435_37&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">
                                         </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">x</span></span><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">IMap.insert</span></span><span class="mpre"> </span><a href="#loc_435_13_435_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_435_13_435_16&#39;)"><span class="hl_varref"><span class="mpre">tag</span></span></a><span class="mpre"> (</span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 437, srcSpanStartColumn = 69, srcSpanEndLine = 437, srcSpanEndColumn = 86}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA.hs&quot;, srcSpanStartLine = 437, srcSpanStartColumn = 71, srcSpanEndLine = 437, srcSpanEndColumn = 72},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/regex-tdfa-1.2.0/Text/Regex/TDFA/TDFA."><span class="mpre">x {inOrbit=False}</span></span><span class="mpre">) </span><a href="#loc_435_36_435_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_435_36_435_37&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">)
</span></div></body></html>