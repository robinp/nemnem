<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE DeriveDataTypeable #-}
{-# LANGUAGE OverloadedStrings #-}
{-# LANGUAGE CPP #-}

module Network.Wai.Handler.Warp.Types where

import Control.Exception
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/Network/Wai/Handler/Warp/Types.hs&quot;, srcSpanStartLine = 8, srcSpanStartColumn = 8, srcSpanEndLine = 8, srcSpanEndColumn = 23}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> (ByteString)
import Data.Typeable (</span><a href="Data.Typeable.Internal.html#loc_196_7_196_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Typeable.Internal.html#loc_196_7_196_15&#39;)"><span class="mpre">Typeable</span></a><span class="mpre">)
import Network.HTTP.Types.Header
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/Network/Wai/Handler/Warp/Types.hs&quot;, srcSpanStartLine = 11, srcSpanStartColumn = 8, srcSpanEndLine = 11, srcSpanEndColumn = 22}, srcInfoPoints = []}) &quot;Network.Socket&quot;"><span class="mpre">Network.Socket</span></span><span class="mpre"> (Socket)
import qualified Network.Wai.Handler.Warp.Date as D
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/Network/Wai/Handler/Warp/Types.hs&quot;, srcSpanStartLine = 13, srcSpanStartColumn = 18, srcSpanEndLine = 13, srcSpanEndColumn = 50}, srcInfoPoints = []}) &quot;Network.Wai.Handler.Warp.FdCache&quot;"><span class="mpre">Network.Wai.Handler.Warp.FdCache</span></span><span class="mpre"> as F
import qualified Network.Wai.Handler.Warp.Timeout as T
import Network.Wai.Handler.Warp.Buffer (Buffer,BufSize)
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/Network/Wai/Handler/Warp/Types.hs&quot;, srcSpanStartLine = 16, srcSpanStartColumn = 18, srcSpanEndLine = 16, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> as S
import Data.IORef (</span><a href="GHC.IORef.html#loc_34_9_34_14" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_34_9_34_14&#39;)"><span class="mpre">IORef</span></a><span class="mpre">, </span><a href="GHC.IORef.html#loc_46_1_46_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_46_1_46_10&#39;)"><span class="mpre">readIORef</span></a><span class="mpre">, </span><a href="GHC.IORef.html#loc_50_1_50_11" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_50_1_50_11&#39;)"><span class="mpre">writeIORef</span></a><span class="mpre">, </span><a href="GHC.IORef.html#loc_42_1_42_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_42_1_42_9&#39;)"><span class="mpre">newIORef</span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | TCP port number.</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/Network/Wai/Handler/Warp/Types.hs&quot;, srcSpanStartLine = 22, srcSpanStartColumn = 1, srcSpanEndLine = 22, srcSpanEndColumn = 16}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/Network/Wai/Handler/Warp/Types.hs&quot;, srcSpanStartLine = 22, srcSpanStartColumn = 1, srcSpanEndLine = 22, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/Network/Wai/Handler/W"><span class="mpre">type Port = Int</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The type for header value used with &#39;HeaderName&#39;.</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/Network/Wai/Handler/Warp/Types.hs&quot;, srcSpanStartLine = 27, srcSpanStartColumn = 1, srcSpanEndLine = 27, srcSpanEndColumn = 30}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/Network/Wai/Handler/Warp/Types.hs&quot;, srcSpanStartLine = 27, srcSpanStartColumn = 1, srcSpanEndLine = 27, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/Network/Wai/Handler/W"><span class="mpre">type HeaderValue = ByteString</span></span><span class="mpre">

</span><a href="#loc_30_1_30_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_1_30_18&#39;)"><span class="mpre">hTransferEncoding</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">HeaderName</span></span><span class="mpre">
</span><a name="loc_30_1_30_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_1_30_18&#39;)"><span class="hl_vardecl"><span class="mpre">hTransferEncoding</span></span></a><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;Transfer-Encoding&quot;</span></span><span class="mpre">

</span><a href="#loc_33_1_33_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_1_33_14&#39;)"><span class="mpre">hContentRange</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">HeaderName</span></span><span class="mpre">
</span><a name="loc_33_1_33_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_1_33_14&#39;)"><span class="hl_vardecl"><span class="mpre">hContentRange</span></span></a><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;Content-Range&quot;</span></span><span class="mpre">

</span><a href="#loc_36_1_36_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_1_36_14&#39;)"><span class="mpre">hAcceptRanges</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">HeaderName</span></span><span class="mpre">
</span><a name="loc_36_1_36_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_1_36_14&#39;)"><span class="hl_vardecl"><span class="mpre">hAcceptRanges</span></span></a><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;Accept-Ranges&quot;</span></span><span class="mpre">

</span><a href="#loc_39_1_39_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_1_39_8&#39;)"><span class="mpre">hServer</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">HeaderName</span></span><span class="mpre">
</span><a name="loc_39_1_39_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_1_39_8&#39;)"><span class="hl_vardecl"><span class="mpre">hServer</span></span></a><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;Server&quot;</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Error types for bad &#39;Request&#39;.</span></span><span class="mpre">
data </span><a name="loc_44_6_44_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_6_44_20&#39;)"><span class="hl_tycondecl"><span class="mpre">InvalidRequest</span></span></a><span class="mpre"> = </span><a name="loc_44_23_44_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_23_44_37&#39;)"><span class="hl_condecl"><span class="mpre">NotEnoughLines</span></span></a><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">]
                    | </span><a name="loc_45_23_45_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_23_45_35&#39;)"><span class="hl_condecl"><span class="mpre">BadFirstLine</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
                    | </span><a name="loc_46_23_46_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_23_46_30&#39;)"><span class="hl_condecl"><span class="mpre">NonHttp</span></span></a><span class="mpre">
                    | </span><a name="loc_47_23_47_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_23_47_40&#39;)"><span class="hl_condecl"><span class="mpre">IncompleteHeaders</span></span></a><span class="mpre">
                    | </span><a name="loc_48_23_48_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_23_48_45&#39;)"><span class="hl_condecl"><span class="mpre">ConnectionClosedByPeer</span></span></a><span class="mpre">
                    | </span><a name="loc_49_23_49_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_23_49_38&#39;)"><span class="hl_condecl"><span class="mpre">OverLargeHeader</span></span></a><span class="mpre">
                    </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/Network/Wai/Handler/Warp/Types.hs&quot;, srcSpanStartLine = 50, srcSpanStartColumn = 21, srcSpanEndLine = 50, srcSpanEndColumn = 44}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/Network/Wai/Handler/Warp/Types.hs&quot;, srcSpanStartLine = 50, srcSpanStartColumn = 21, srcSpanEndLine = 50, srcSpanEndColumn = 29},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/Network/Wai/Handle"><span class="mpre">deriving (Eq, Typeable)</span></span><span class="mpre">

instance </span><span class="hl_classref"><span class="mpre">Show</span></span><span class="mpre"> </span><a href="#loc_44_6_44_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_6_44_20&#39;)"><span class="hl_tyconref"><span class="mpre">InvalidRequest</span></span></a><span class="mpre"> where
    </span><a name="loc_53_5_53_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_5_53_9&#39;)"><span class="hl_fundecl"><span class="mpre">show</span></span></a><span class="mpre"> (</span><a href="#loc_44_23_44_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_23_44_37&#39;)"><span class="hl_conref"><span class="mpre">NotEnoughLines</span></span></a><span class="mpre"> </span><a name="loc_53_26_53_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_26_53_28&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) = </span><span class="hl_string"><span class="mpre">&quot;Warp: Incomplete request headers, received: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_53_26_53_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_26_53_28&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
    </span><a href="#loc_53_5_53_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_5_53_9&#39;)"><span class="hl_fundecl"><span class="mpre">show</span></span></a><span class="mpre"> (</span><a href="#loc_45_23_45_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_23_45_35&#39;)"><span class="hl_conref"><span class="mpre">BadFirstLine</span></span></a><span class="mpre"> </span><a name="loc_54_24_54_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_24_54_25&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">) = </span><span class="hl_string"><span class="mpre">&quot;Warp: Invalid first line of request: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_54_24_54_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_24_54_25&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
    </span><a href="#loc_53_5_53_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_5_53_9&#39;)"><span class="hl_fundecl"><span class="mpre">show</span></span></a><span class="mpre"> </span><a href="#loc_46_23_46_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_23_46_30&#39;)"><span class="hl_conref"><span class="mpre">NonHttp</span></span></a><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;Warp: Request line specified a non-HTTP request&quot;</span></span><span class="mpre">
    </span><a href="#loc_53_5_53_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_5_53_9&#39;)"><span class="hl_fundecl"><span class="mpre">show</span></span></a><span class="mpre"> </span><a href="#loc_47_23_47_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_23_47_40&#39;)"><span class="hl_conref"><span class="mpre">IncompleteHeaders</span></span></a><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;Warp: Request headers did not finish transmission&quot;</span></span><span class="mpre">
    </span><a href="#loc_53_5_53_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_5_53_9&#39;)"><span class="hl_fundecl"><span class="mpre">show</span></span></a><span class="mpre"> </span><a href="#loc_48_23_48_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_23_48_45&#39;)"><span class="hl_conref"><span class="mpre">ConnectionClosedByPeer</span></span></a><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;Warp: Client closed connection prematurely&quot;</span></span><span class="mpre">
    </span><a href="#loc_53_5_53_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_5_53_9&#39;)"><span class="hl_fundecl"><span class="mpre">show</span></span></a><span class="mpre"> </span><a href="#loc_49_23_49_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_23_49_38&#39;)"><span class="hl_conref"><span class="mpre">OverLargeHeader</span></span></a><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;Warp: Request headers too large, possible memory attack detected. Closing connection.&quot;</span></span><span class="mpre">

instance </span><span class="hl_classref"><span class="mpre">Exception</span></span><span class="mpre"> </span><a href="#loc_44_6_44_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_6_44_20&#39;)"><span class="hl_tyconref"><span class="mpre">InvalidRequest</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Whether or not &#39;ConnSendFileOverride&#39; in &#39;Connection&#39; can be</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   overridden. This is a kind of hack to keep the signature of</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   &#39;Connection&#39; clean.</span></span><span class="mpre">
data </span><a name="loc_67_6_67_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_6_67_26&#39;)"><span class="hl_tycondecl"><span class="mpre">ConnSendFileOverride</span></span></a><span class="mpre"> = </span><a name="loc_67_29_67_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_29_67_40&#39;)"><span class="hl_condecl"><span class="mpre">NotOverride</span></span></a><span class="mpre">     </span><span class="hl_comment"><span class="mpre">-- ^ Don&#39;t override</span></span><span class="mpre">
                          | </span><a name="loc_68_29_68_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_29_68_37&#39;)"><span class="hl_condecl"><span class="mpre">Override</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Socket</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ Override with this &#39;Socket&#39;</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Data type to manipulate IO actions for connections.</span></span><span class="mpre">
data </span><a name="loc_73_6_73_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_6_73_16&#39;)"><span class="hl_tycondecl"><span class="mpre">Connection</span></span></a><span class="mpre"> = </span><a name="loc_73_19_73_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_19_73_29&#39;)"><span class="hl_condecl"><span class="mpre">Connection</span></span></a><span class="mpre">
    { </span><a name="loc_74_7_74_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_7_74_19&#39;)"><span class="hl_fielddecl"><span class="mpre">connSendMany</span></span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
    , </span><a name="loc_75_7_75_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_7_75_18&#39;)"><span class="hl_fielddecl"><span class="mpre">connSendAll</span></span></a><span class="mpre">  :: </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
    , </span><a name="loc_76_7_76_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_7_76_19&#39;)"><span class="hl_fielddecl"><span class="mpre">connSendFile</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Integer</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ filepath, offset, length, hook action, HTTP headers</span></span><span class="mpre">
    , </span><a name="loc_77_7_77_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_7_77_16&#39;)"><span class="hl_fielddecl"><span class="mpre">connClose</span></span></a><span class="mpre">    :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
    , </span><a name="loc_78_7_78_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_7_78_15&#39;)"><span class="hl_fielddecl"><span class="mpre">connRecv</span></span></a><span class="mpre">     :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
    , </span><a name="loc_79_7_79_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_7_79_21&#39;)"><span class="hl_fielddecl"><span class="mpre">connReadBuffer</span></span></a><span class="mpre">       :: </span><span class="hl_tyconref"><span class="mpre">Buffer</span></span><span class="mpre">
    , </span><a name="loc_80_7_80_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_7_80_22&#39;)"><span class="hl_fielddecl"><span class="mpre">connWriteBuffer</span></span></a><span class="mpre">      :: </span><span class="hl_tyconref"><span class="mpre">Buffer</span></span><span class="mpre">
    , </span><a name="loc_81_7_81_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_7_81_21&#39;)"><span class="hl_fielddecl"><span class="mpre">connBufferSize</span></span></a><span class="mpre">       :: </span><span class="hl_tyconref"><span class="mpre">BufSize</span></span><span class="mpre">
    , </span><a name="loc_82_7_82_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_7_82_27&#39;)"><span class="hl_fielddecl"><span class="mpre">connSendFileOverride</span></span></a><span class="mpre"> :: </span><a href="#loc_67_6_67_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_6_67_26&#39;)"><span class="hl_tyconref"><span class="mpre">ConnSendFileOverride</span></span></a><span class="mpre">
    }

</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Internal information.</span></span><span class="mpre">
data </span><a name="loc_88_6_88_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_6_88_18&#39;)"><span class="hl_tycondecl"><span class="mpre">InternalInfo</span></span></a><span class="mpre"> = </span><a name="loc_88_21_88_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_21_88_33&#39;)"><span class="hl_condecl"><span class="mpre">InternalInfo</span></span></a><span class="mpre"> {
    </span><a name="loc_89_5_89_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_5_89_17&#39;)"><span class="hl_fielddecl"><span class="mpre">threadHandle</span></span></a><span class="mpre"> :: </span><a href="Network.Wai.Handler.Warp.Timeout.html#loc_70_6_70_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Handler.Warp.Timeout.html#loc_70_6_70_12&#39;)"><span class="hl_tyconref"><span class="mpre">T.Handle</span></span></a><span class="mpre">
  , </span><a name="loc_90_5_90_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_5_90_13&#39;)"><span class="hl_fielddecl"><span class="mpre">fdCacher</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">F.MutableFdCache</span></span><span class="mpre">
  , </span><a name="loc_91_5_91_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_5_91_15&#39;)"><span class="hl_fielddecl"><span class="mpre">dateCacher</span></span></a><span class="mpre"> :: </span><a href="Network.Wai.Handler.Warp.Date.html#loc_29_6_29_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Handler.Warp.Date.html#loc_29_6_29_15&#39;)"><span class="hl_tyconref"><span class="mpre">D.DateCache</span></span></a><span class="mpre">
  }

</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------</span></span><span class="mpre">

data </span><a name="loc_96_6_96_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_6_96_12&#39;)"><span class="hl_tycondecl"><span class="mpre">Source</span></span></a><span class="mpre"> = </span><a name="loc_96_15_96_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_15_96_21&#39;)"><span class="hl_condecl"><span class="mpre">Source</span></span></a><span class="mpre"> !(</span><a href="GHC.IORef.html#loc_34_9_34_14" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_34_9_34_14&#39;)"><span class="hl_tyconref"><span class="mpre">IORef</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">) !(</span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">)

</span><a href="#loc_99_1_99_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_1_99_9&#39;)"><span class="mpre">mkSource</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><a href="#loc_96_6_96_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_6_96_12&#39;)"><span class="hl_tyconref"><span class="mpre">Source</span></span></a><span class="mpre">
</span><a name="loc_99_1_99_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_1_99_9&#39;)"><span class="hl_fundecl"><span class="mpre">mkSource</span></span></a><span class="mpre"> </span><a name="loc_99_10_99_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_10_99_14&#39;)"><span class="hl_vardecl"><span class="mpre">func</span></span></a><span class="mpre"> = do
    </span><a name="loc_100_5_100_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_5_100_8&#39;)"><span class="hl_vardecl"><span class="mpre">ref</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IORef.html#loc_42_1_42_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_42_1_42_9&#39;)"><span class="hl_varref"><span class="mpre">newIORef</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.empty</span></span><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$!</span></span><span class="mpre"> </span><a href="#loc_96_15_96_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_15_96_21&#39;)"><span class="hl_conref"><span class="mpre">Source</span></span></a><span class="mpre"> </span><a href="#loc_100_5_100_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_5_100_8&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre"> </span><a href="#loc_99_10_99_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_10_99_14&#39;)"><span class="hl_varref"><span class="mpre">func</span></span></a><span class="mpre">

</span><a href="#loc_104_1_104_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_1_104_11&#39;)"><span class="mpre">readSource</span></a><span class="mpre"> :: </span><a href="#loc_96_6_96_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_6_96_12&#39;)"><span class="hl_tyconref"><span class="mpre">Source</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
</span><a name="loc_104_1_104_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_1_104_11&#39;)"><span class="hl_fundecl"><span class="mpre">readSource</span></span></a><span class="mpre"> (</span><a href="#loc_96_15_96_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_15_96_21&#39;)"><span class="hl_conref"><span class="mpre">Source</span></span></a><span class="mpre"> </span><a name="loc_104_20_104_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_20_104_23&#39;)"><span class="hl_vardecl"><span class="mpre">ref</span></span></a><span class="mpre"> </span><a name="loc_104_24_104_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_24_104_28&#39;)"><span class="hl_vardecl"><span class="mpre">func</span></span></a><span class="mpre">) = do
    </span><a name="loc_105_5_105_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_5_105_7&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IORef.html#loc_46_1_46_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_46_1_46_10&#39;)"><span class="hl_varref"><span class="mpre">readIORef</span></span></a><span class="mpre"> </span><a href="#loc_104_20_104_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_20_104_23&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre">
    if </span><span class="hl_varref"><span class="mpre">S.null</span></span><span class="mpre"> </span><a href="#loc_105_5_105_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_5_105_7&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
        then </span><a href="#loc_104_24_104_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_24_104_28&#39;)"><span class="hl_varref"><span class="mpre">func</span></span></a><span class="mpre">
        else do
            </span><a href="GHC.IORef.html#loc_50_1_50_11" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_50_1_50_11&#39;)"><span class="hl_varref"><span class="mpre">writeIORef</span></span></a><span class="mpre"> </span><a href="#loc_104_20_104_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_20_104_23&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.empty</span></span><span class="mpre">
            </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_105_5_105_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_5_105_7&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Read from a Source, ignoring any leftovers.</span></span><span class="mpre">
</span><a href="#loc_114_1_114_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_1_114_12&#39;)"><span class="mpre">readSource&#39;</span></a><span class="mpre"> :: </span><a href="#loc_96_6_96_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_6_96_12&#39;)"><span class="hl_tyconref"><span class="mpre">Source</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
</span><a name="loc_114_1_114_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_1_114_12&#39;)"><span class="hl_fundecl"><span class="mpre">readSource&#39;</span></span></a><span class="mpre"> (</span><a href="#loc_96_15_96_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_15_96_21&#39;)"><span class="hl_conref"><span class="mpre">Source</span></span></a><span class="mpre"> _ </span><a name="loc_114_23_114_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_23_114_27&#39;)"><span class="hl_vardecl"><span class="mpre">func</span></span></a><span class="mpre">) = </span><a href="#loc_114_23_114_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_23_114_27&#39;)"><span class="hl_varref"><span class="mpre">func</span></span></a><span class="mpre">

</span><a href="#loc_117_1_117_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_1_117_15&#39;)"><span class="mpre">leftoverSource</span></a><span class="mpre"> :: </span><a href="#loc_96_6_96_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_6_96_12&#39;)"><span class="hl_tyconref"><span class="mpre">Source</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_117_1_117_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_1_117_15&#39;)"><span class="hl_fundecl"><span class="mpre">leftoverSource</span></span></a><span class="mpre"> (</span><a href="#loc_96_15_96_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_15_96_21&#39;)"><span class="hl_conref"><span class="mpre">Source</span></span></a><span class="mpre"> </span><a name="loc_117_24_117_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_24_117_27&#39;)"><span class="hl_vardecl"><span class="mpre">ref</span></span></a><span class="mpre"> _) </span><a name="loc_117_31_117_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_31_117_33&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> = </span><a href="GHC.IORef.html#loc_50_1_50_11" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_50_1_50_11&#39;)"><span class="hl_varref"><span class="mpre">writeIORef</span></span></a><span class="mpre"> </span><a href="#loc_117_24_117_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_24_117_27&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre"> </span><a href="#loc_117_31_117_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_31_117_33&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">

</span><a href="#loc_120_1_120_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_1_120_19&#39;)"><span class="mpre">readLeftoverSource</span></a><span class="mpre"> :: </span><a href="#loc_96_6_96_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_6_96_12&#39;)"><span class="hl_tyconref"><span class="mpre">Source</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
</span><a name="loc_120_1_120_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_1_120_19&#39;)"><span class="hl_fundecl"><span class="mpre">readLeftoverSource</span></span></a><span class="mpre"> (</span><a href="#loc_96_15_96_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_15_96_21&#39;)"><span class="hl_conref"><span class="mpre">Source</span></span></a><span class="mpre"> </span><a name="loc_120_28_120_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_28_120_31&#39;)"><span class="hl_vardecl"><span class="mpre">ref</span></span></a><span class="mpre"> _) = </span><a href="GHC.IORef.html#loc_46_1_46_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_46_1_46_10&#39;)"><span class="hl_varref"><span class="mpre">readIORef</span></span></a><span class="mpre"> </span><a href="#loc_120_28_120_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_28_120_31&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre">
</span></div></body></html>