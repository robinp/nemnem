<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      :  Distribution.GetOpt</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright   :  (c) Sven Panne 2002-2005</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     :  BSD-style (see the file libraries/base/LICENSE)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  :  libraries@haskell.org</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability :  portable</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This library provides facilities for parsing the command-line options</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- in a standalone program.  It is essentially a Haskell port of the GNU</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @getopt@ library.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">{-
Sven Panne &lt;Sven.Panne@informatik.uni-muenchen.de&gt; Oct. 1996 (small
changes Dec. 1997)

Two rather obscure features are missing: The Bash 2.0 non-option hack
(if you don&#39;t already know it, you probably don&#39;t want to hear about
it...) and the recognition of long options with a single dash
(e.g. &#39;-help&#39; is recognised as &#39;--help&#39;, as long as there is no short
option &#39;h&#39;).

Other differences between GNU&#39;s getopt and this implementation:

* To enforce a coherent description of options and arguments, there
  are explanation fields in the option/argument descriptor.

* Error messages are now more informative, but no longer POSIX
  compliant... :-(

And a final Haskell advertisement: The GNU C implementation uses well
over 1100 lines, we need only 195 here, including a 46 line example!
:-)
-}</span></span><span class="mpre">

{-# OPTIONS_HADDOCK hide #-}
module Distribution.GetOpt (
   </span><span class="hl_comment"><span class="mpre">-- * GetOpt</span></span><span class="mpre">
   getOpt, getOpt&#39;,
   usageInfo,
   ArgOrder(..),
   OptDescr(..),
   ArgDescr(..),

   </span><span class="hl_comment"><span class="mpre">-- * Example</span></span><span class="mpre">

   </span><span class="hl_comment"><span class="mpre">-- $example</span></span><span class="mpre">
) where

import Data.List ( </span><a href="Data.List.html#loc_286_1_286_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_286_1_286_11&#39;)"><span class="mpre">isPrefixOf</span></a><span class="mpre">, </span><a href="Data.List.html#loc_443_1_443_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_443_1_443_12&#39;)"><span class="mpre">intercalate</span></a><span class="mpre">, </span><a href="Data.List.html#loc_261_1_261_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_261_1_261_5&#39;)"><span class="mpre">find</span></a><span class="mpre"> )
import Data.Maybe ( </span><a href="Data.Maybe.html#loc_80_1_80_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_80_1_80_7&#39;)"><span class="mpre">isJust</span></a><span class="mpre"> )

</span><span class="hl_comment"><span class="mpre">-- |What to do with options following non-options</span></span><span class="mpre">
data </span><a name="loc_57_6_57_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_6_57_14&#39;)"><span class="hl_tycondecl"><span class="mpre">ArgOrder</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
  = </span><a name="loc_58_5_58_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_5_58_17&#39;)"><span class="hl_condecl"><span class="mpre">RequireOrder</span></span></a><span class="mpre">                </span><span class="hl_comment"><span class="mpre">-- ^ no option processing after first non-option</span></span><span class="mpre">
  | </span><a name="loc_59_5_59_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_5_59_12&#39;)"><span class="hl_condecl"><span class="mpre">Permute</span></span></a><span class="mpre">                     </span><span class="hl_comment"><span class="mpre">-- ^ freely intersperse options and non-options</span></span><span class="mpre">
  | </span><a name="loc_60_5_60_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_5_60_18&#39;)"><span class="hl_condecl"><span class="mpre">ReturnInOrder</span></span></a><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) </span><span class="hl_comment"><span class="mpre">-- ^ wrap non-options into options</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">{-|
Each &#39;OptDescr&#39; describes a single option.

The arguments to &#39;Option&#39; are:

* list of short option characters

* list of long option strings (without \&quot;--\&quot;)

* argument descriptor

* explanation of option for user
-}</span></span><span class="mpre">
data </span><a name="loc_75_6_75_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_6_75_14&#39;)"><span class="hl_tycondecl"><span class="mpre">OptDescr</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> =              </span><span class="hl_comment"><span class="mpre">-- description of a single options:</span></span><span class="mpre">
   </span><a name="loc_76_4_76_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_4_76_10&#39;)"><span class="hl_condecl"><span class="mpre">Option</span></span></a><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">]                </span><span class="hl_comment"><span class="mpre">--    list of short option characters</span></span><span class="mpre">
          [</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">]              </span><span class="hl_comment"><span class="mpre">--    list of long option strings (without &quot;--&quot;)</span></span><span class="mpre">
          (</span><a href="#loc_83_6_83_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_6_83_14&#39;)"><span class="hl_tyconref"><span class="mpre">ArgDescr</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)          </span><span class="hl_comment"><span class="mpre">--    argument descriptor</span></span><span class="mpre">
          </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">                </span><span class="hl_comment"><span class="mpre">--    explanation of option for user</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- |Describes whether an option takes an argument or not, and if so</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- how the argument is injected into a value of type @a@.</span></span><span class="mpre">
data </span><a name="loc_83_6_83_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_6_83_14&#39;)"><span class="hl_tycondecl"><span class="mpre">ArgDescr</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
   = </span><a name="loc_84_6_84_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_6_84_11&#39;)"><span class="hl_condecl"><span class="mpre">NoArg</span></span></a><span class="mpre">                   </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">         </span><span class="hl_comment"><span class="mpre">-- ^   no argument expected</span></span><span class="mpre">
   | </span><a name="loc_85_6_85_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_6_85_12&#39;)"><span class="hl_condecl"><span class="mpre">ReqArg</span></span></a><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">       -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^   option requires argument</span></span><span class="mpre">
   | </span><a name="loc_86_6_86_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_6_86_12&#39;)"><span class="hl_condecl"><span class="mpre">OptArg</span></span></a><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^   optional argument</span></span><span class="mpre">

data </span><a name="loc_88_6_88_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_6_88_13&#39;)"><span class="hl_tycondecl"><span class="mpre">OptKind</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">                </span><span class="hl_comment"><span class="mpre">-- kind of cmd line arg (internal use only):</span></span><span class="mpre">
   = </span><a name="loc_89_6_89_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_6_89_9&#39;)"><span class="hl_condecl"><span class="mpre">Opt</span></span></a><span class="mpre">       </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">                </span><span class="hl_comment"><span class="mpre">--    an option</span></span><span class="mpre">
   | </span><a name="loc_90_6_90_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_6_90_14&#39;)"><span class="hl_condecl"><span class="mpre">UnreqOpt</span></span></a><span class="mpre">  </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">           </span><span class="hl_comment"><span class="mpre">--    an un-recognized option</span></span><span class="mpre">
   | </span><a name="loc_91_6_91_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_6_91_12&#39;)"><span class="hl_condecl"><span class="mpre">NonOpt</span></span></a><span class="mpre">    </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">           </span><span class="hl_comment"><span class="mpre">--    a non-option</span></span><span class="mpre">
   | </span><a name="loc_92_6_92_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_6_92_15&#39;)"><span class="hl_condecl"><span class="mpre">EndOfOpts</span></span></a><span class="mpre">                  </span><span class="hl_comment"><span class="mpre">--    end-of-options marker (i.e. &quot;--&quot;)</span></span><span class="mpre">
   | </span><a name="loc_93_6_93_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_6_93_12&#39;)"><span class="hl_condecl"><span class="mpre">OptErr</span></span></a><span class="mpre">    </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">           </span><span class="hl_comment"><span class="mpre">--    something went wrong...</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Return a string describing the usage of a command, derived from</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the header (first argument) and the options described by the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- second argument.</span></span><span class="mpre">
</span><a href="#loc_101_1_101_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_1_101_10&#39;)"><span class="mpre">usageInfo</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">                    </span><span class="hl_comment"><span class="mpre">-- header</span></span><span class="mpre">
          -&gt; [</span><a href="#loc_75_6_75_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_6_75_14&#39;)"><span class="hl_tyconref"><span class="mpre">OptDescr</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">]              </span><span class="hl_comment"><span class="mpre">-- option descriptors</span></span><span class="mpre">
          -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">                    </span><span class="hl_comment"><span class="mpre">-- nicely formatted decription of options</span></span><span class="mpre">
</span><a name="loc_101_1_101_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_1_101_10&#39;)"><span class="hl_fundecl"><span class="mpre">usageInfo</span></span></a><span class="mpre"> </span><a name="loc_101_11_101_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_11_101_17&#39;)"><span class="hl_vardecl"><span class="mpre">header</span></span></a><span class="mpre"> </span><a name="loc_101_18_101_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_18_101_26&#39;)"><span class="hl_vardecl"><span class="mpre">optDescr</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">unlines</span></span><span class="mpre"> (</span><a href="#loc_101_11_101_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_11_101_17&#39;)"><span class="hl_varref"><span class="mpre">header</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_109_10_109_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_10_109_15&#39;)"><span class="hl_varref"><span class="mpre">table</span></span></a><span class="mpre">)
   where (</span><a name="loc_102_11_102_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_11_102_13&#39;)"><span class="hl_vardecl"><span class="mpre">ss</span></span></a><span class="mpre">,</span><a name="loc_102_14_102_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_14_102_16&#39;)"><span class="hl_vardecl"><span class="mpre">ls</span></span></a><span class="mpre">,</span><a name="loc_102_17_102_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_17_102_19&#39;)"><span class="hl_vardecl"><span class="mpre">ds</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">unzip3</span></span><span class="mpre"> [ (</span><a href="Data.List.html#loc_443_1_443_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_443_1_443_12&#39;)"><span class="hl_varref"><span class="mpre">intercalate</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;, &quot;</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><a href="#loc_123_1_123_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_1_123_9&#39;)"><span class="hl_varref"><span class="mpre">fmtShort</span></span></a><span class="mpre"> </span><a href="#loc_105_47_105_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_47_105_49&#39;)"><span class="hl_varref"><span class="mpre">ad</span></span></a><span class="mpre">) </span><a href="#loc_105_39_105_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_39_105_42&#39;)"><span class="hl_varref"><span class="mpre">sos</span></span></a><span class="mpre">)
                               ,</span><span class="hl_varref"><span class="mpre">concatMap</span></span><span class="mpre"> (</span><a href="#loc_128_1_128_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_1_128_8&#39;)"><span class="hl_varref"><span class="mpre">fmtLong</span></span></a><span class="mpre">  </span><a href="#loc_105_47_105_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_47_105_49&#39;)"><span class="hl_varref"><span class="mpre">ad</span></span></a><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">take</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><a href="#loc_105_43_105_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_43_105_46&#39;)"><span class="hl_varref"><span class="mpre">los</span></span></a><span class="mpre">)
                               ,</span><a href="#loc_105_50_105_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_50_105_51&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre">)
                             | </span><a href="#loc_76_4_76_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_4_76_10&#39;)"><span class="hl_conref"><span class="mpre">Option</span></span></a><span class="mpre"> </span><a name="loc_105_39_105_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_39_105_42&#39;)"><span class="hl_vardecl"><span class="mpre">sos</span></span></a><span class="mpre"> </span><a name="loc_105_43_105_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_43_105_46&#39;)"><span class="hl_vardecl"><span class="mpre">los</span></span></a><span class="mpre"> </span><a name="loc_105_47_105_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_47_105_49&#39;)"><span class="hl_vardecl"><span class="mpre">ad</span></span></a><span class="mpre"> </span><a name="loc_105_50_105_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_50_105_51&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_101_18_101_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_18_101_26&#39;)"><span class="hl_varref"><span class="mpre">optDescr</span></span></a><span class="mpre"> ]
         </span><a name="loc_106_10_106_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_10_106_17&#39;)"><span class="hl_vardecl"><span class="mpre">ssWidth</span></span></a><span class="mpre">    = (</span><span class="hl_varref"><span class="mpre">maximum</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre">) </span><a href="#loc_102_11_102_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_11_102_13&#39;)"><span class="hl_varref"><span class="mpre">ss</span></span></a><span class="mpre">
         </span><a name="loc_107_10_107_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_10_107_17&#39;)"><span class="hl_vardecl"><span class="mpre">lsWidth</span></span></a><span class="mpre">    = (</span><span class="hl_varref"><span class="mpre">maximum</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre">) </span><a href="#loc_102_14_102_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_14_102_16&#39;)"><span class="hl_varref"><span class="mpre">ls</span></span></a><span class="mpre">
         </span><a name="loc_108_10_108_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_10_108_17&#39;)"><span class="hl_vardecl"><span class="mpre">dsWidth</span></span></a><span class="mpre">    = </span><span class="hl_num"><span class="mpre">30</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`max`</span></span><span class="mpre"> (</span><span class="hl_num"><span class="mpre">80</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> (</span><a href="#loc_106_10_106_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_10_106_17&#39;)"><span class="hl_varref"><span class="mpre">ssWidth</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_107_10_107_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_10_107_17&#39;)"><span class="hl_varref"><span class="mpre">lsWidth</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">))
         </span><a name="loc_109_10_109_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_10_109_15&#39;)"><span class="hl_vardecl"><span class="mpre">table</span></span></a><span class="mpre">      = [ </span><span class="hl_string"><span class="mpre">&quot; &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_114_10_114_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_10_114_15&#39;)"><span class="hl_varref"><span class="mpre">padTo</span></span></a><span class="mpre"> </span><a href="#loc_106_10_106_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_10_106_17&#39;)"><span class="hl_varref"><span class="mpre">ssWidth</span></span></a><span class="mpre"> </span><a href="#loc_113_26_113_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_26_113_29&#39;)"><span class="hl_varref"><span class="mpre">so&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">
                        </span><span class="hl_string"><span class="mpre">&quot; &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_114_10_114_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_10_114_15&#39;)"><span class="hl_varref"><span class="mpre">padTo</span></span></a><span class="mpre"> </span><a href="#loc_107_10_107_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_10_107_17&#39;)"><span class="hl_varref"><span class="mpre">lsWidth</span></span></a><span class="mpre"> </span><a href="#loc_113_30_113_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_30_113_33&#39;)"><span class="hl_varref"><span class="mpre">lo&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">
                        </span><span class="hl_string"><span class="mpre">&quot; &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_113_34_113_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_34_113_36&#39;)"><span class="hl_varref"><span class="mpre">d&#39;</span></span></a><span class="mpre">
                      | (</span><a name="loc_112_26_112_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_26_112_28&#39;)"><span class="hl_vardecl"><span class="mpre">so</span></span></a><span class="mpre">,</span><a name="loc_112_29_112_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_29_112_31&#39;)"><span class="hl_vardecl"><span class="mpre">lo</span></span></a><span class="mpre">,</span><a name="loc_112_32_112_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_32_112_33&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre">) &lt;- </span><span class="hl_varref"><span class="mpre">zip3</span></span><span class="mpre"> </span><a href="#loc_102_11_102_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_11_102_13&#39;)"><span class="hl_varref"><span class="mpre">ss</span></span></a><span class="mpre"> </span><a href="#loc_102_14_102_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_14_102_16&#39;)"><span class="hl_varref"><span class="mpre">ls</span></span></a><span class="mpre"> </span><a href="#loc_102_17_102_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_17_102_19&#39;)"><span class="hl_varref"><span class="mpre">ds</span></span></a><span class="mpre">
                      , (</span><a name="loc_113_26_113_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_26_113_29&#39;)"><span class="hl_vardecl"><span class="mpre">so&#39;</span></span></a><span class="mpre">,</span><a name="loc_113_30_113_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_30_113_33&#39;)"><span class="hl_vardecl"><span class="mpre">lo&#39;</span></span></a><span class="mpre">,</span><a name="loc_113_34_113_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_34_113_36&#39;)"><span class="hl_vardecl"><span class="mpre">d&#39;</span></span></a><span class="mpre">) &lt;- </span><a href="#loc_117_1_117_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_1_117_7&#39;)"><span class="hl_varref"><span class="mpre">fmtOpt</span></span></a><span class="mpre"> </span><a href="#loc_108_10_108_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_10_108_17&#39;)"><span class="hl_varref"><span class="mpre">dsWidth</span></span></a><span class="mpre"> </span><a href="#loc_112_26_112_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_26_112_28&#39;)"><span class="hl_varref"><span class="mpre">so</span></span></a><span class="mpre"> </span><a href="#loc_112_29_112_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_29_112_31&#39;)"><span class="hl_varref"><span class="mpre">lo</span></span></a><span class="mpre"> </span><a href="#loc_112_32_112_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_32_112_33&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> ]
         </span><a name="loc_114_10_114_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_10_114_15&#39;)"><span class="hl_fundecl"><span class="mpre">padTo</span></span></a><span class="mpre"> </span><a name="loc_114_16_114_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_16_114_17&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_114_18_114_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_18_114_19&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">  = </span><span class="hl_varref"><span class="mpre">take</span></span><span class="mpre"> </span><a href="#loc_114_16_114_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_16_114_17&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> (</span><a href="#loc_114_18_114_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_18_114_19&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">repeat</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39; &#39;</span></span><span class="mpre">)

</span><a href="#loc_117_1_117_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_1_117_7&#39;)"><span class="mpre">fmtOpt</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; [(</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">)]
</span><a name="loc_117_1_117_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_1_117_7&#39;)"><span class="hl_fundecl"><span class="mpre">fmtOpt</span></span></a><span class="mpre"> </span><a name="loc_117_8_117_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_8_117_18&#39;)"><span class="hl_vardecl"><span class="mpre">descrWidth</span></span></a><span class="mpre"> </span><a name="loc_117_19_117_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_19_117_21&#39;)"><span class="hl_vardecl"><span class="mpre">so</span></span></a><span class="mpre"> </span><a name="loc_117_22_117_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_22_117_24&#39;)"><span class="hl_vardecl"><span class="mpre">lo</span></span></a><span class="mpre"> </span><a name="loc_117_25_117_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_25_117_30&#39;)"><span class="hl_vardecl"><span class="mpre">descr</span></span></a><span class="mpre"> =
   case </span><a href="#loc_133_1_133_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_1_133_9&#39;)"><span class="hl_varref"><span class="mpre">wrapText</span></span></a><span class="mpre"> </span><a href="#loc_117_8_117_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_8_117_18&#39;)"><span class="hl_varref"><span class="mpre">descrWidth</span></span></a><span class="mpre"> </span><a href="#loc_117_25_117_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_25_117_30&#39;)"><span class="hl_varref"><span class="mpre">descr</span></span></a><span class="mpre"> of
     []     -&gt; [(</span><a href="#loc_117_19_117_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_19_117_21&#39;)"><span class="hl_varref"><span class="mpre">so</span></span></a><span class="mpre">,</span><a href="#loc_117_22_117_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_22_117_24&#39;)"><span class="hl_varref"><span class="mpre">lo</span></span></a><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">)]
     (</span><a name="loc_120_7_120_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_7_120_8&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_120_9_120_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_9_120_11&#39;)"><span class="hl_vardecl"><span class="mpre">ds</span></span></a><span class="mpre">) -&gt; (</span><a href="#loc_117_19_117_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_19_117_21&#39;)"><span class="hl_varref"><span class="mpre">so</span></span></a><span class="mpre">,</span><a href="#loc_117_22_117_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_22_117_24&#39;)"><span class="hl_varref"><span class="mpre">lo</span></span></a><span class="mpre">,</span><a href="#loc_120_7_120_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_7_120_8&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> [ (</span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">,</span><a href="#loc_120_43_120_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_43_120_45&#39;)"><span class="hl_varref"><span class="mpre">d&#39;</span></span></a><span class="mpre">) | </span><a name="loc_120_43_120_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_43_120_45&#39;)"><span class="hl_vardecl"><span class="mpre">d&#39;</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_120_9_120_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_9_120_11&#39;)"><span class="hl_varref"><span class="mpre">ds</span></span></a><span class="mpre"> ]

</span><a href="#loc_123_1_123_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_1_123_9&#39;)"><span class="mpre">fmtShort</span></a><span class="mpre"> :: </span><a href="#loc_83_6_83_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_6_83_14&#39;)"><span class="hl_tyconref"><span class="mpre">ArgDescr</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_123_1_123_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_1_123_9&#39;)"><span class="hl_fundecl"><span class="mpre">fmtShort</span></span></a><span class="mpre"> (</span><a href="#loc_84_6_84_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_6_84_11&#39;)"><span class="hl_conref"><span class="mpre">NoArg</span></span></a><span class="mpre">  _   ) </span><a name="loc_123_24_123_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_24_123_26&#39;)"><span class="hl_vardecl"><span class="mpre">so</span></span></a><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;-&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> [</span><a href="#loc_123_24_123_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_24_123_26&#39;)"><span class="hl_varref"><span class="mpre">so</span></span></a><span class="mpre">]
</span><a href="#loc_123_1_123_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_1_123_9&#39;)"><span class="hl_fundecl"><span class="mpre">fmtShort</span></span></a><span class="mpre"> (</span><a href="#loc_85_6_85_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_6_85_12&#39;)"><span class="hl_conref"><span class="mpre">ReqArg</span></span></a><span class="mpre"> _  _) </span><a name="loc_124_24_124_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_24_124_26&#39;)"><span class="hl_vardecl"><span class="mpre">so</span></span></a><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;-&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> [</span><a href="#loc_124_24_124_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_24_124_26&#39;)"><span class="hl_varref"><span class="mpre">so</span></span></a><span class="mpre">]
</span><a href="#loc_123_1_123_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_1_123_9&#39;)"><span class="hl_fundecl"><span class="mpre">fmtShort</span></span></a><span class="mpre"> (</span><a href="#loc_86_6_86_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_6_86_12&#39;)"><span class="hl_conref"><span class="mpre">OptArg</span></span></a><span class="mpre"> _  _) </span><a name="loc_125_24_125_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_24_125_26&#39;)"><span class="hl_vardecl"><span class="mpre">so</span></span></a><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;-&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> [</span><a href="#loc_125_24_125_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_24_125_26&#39;)"><span class="hl_varref"><span class="mpre">so</span></span></a><span class="mpre">]

</span><a href="#loc_128_1_128_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_1_128_8&#39;)"><span class="mpre">fmtLong</span></a><span class="mpre"> :: </span><a href="#loc_83_6_83_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_6_83_14&#39;)"><span class="hl_tyconref"><span class="mpre">ArgDescr</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_128_1_128_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_1_128_8&#39;)"><span class="hl_fundecl"><span class="mpre">fmtLong</span></span></a><span class="mpre"> (</span><a href="#loc_84_6_84_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_6_84_11&#39;)"><span class="hl_conref"><span class="mpre">NoArg</span></span></a><span class="mpre">  _   ) </span><a name="loc_128_23_128_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_23_128_25&#39;)"><span class="hl_vardecl"><span class="mpre">lo</span></span></a><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;--&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_128_23_128_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_23_128_25&#39;)"><span class="hl_varref"><span class="mpre">lo</span></span></a><span class="mpre">
</span><a href="#loc_128_1_128_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_1_128_8&#39;)"><span class="hl_fundecl"><span class="mpre">fmtLong</span></span></a><span class="mpre"> (</span><a href="#loc_85_6_85_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_6_85_12&#39;)"><span class="hl_conref"><span class="mpre">ReqArg</span></span></a><span class="mpre"> _ </span><a name="loc_129_19_129_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_19_129_21&#39;)"><span class="hl_vardecl"><span class="mpre">ad</span></span></a><span class="mpre">) </span><a name="loc_129_23_129_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_23_129_25&#39;)"><span class="hl_vardecl"><span class="mpre">lo</span></span></a><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;--&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_129_23_129_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_23_129_25&#39;)"><span class="hl_varref"><span class="mpre">lo</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;=&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_129_19_129_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_19_129_21&#39;)"><span class="hl_varref"><span class="mpre">ad</span></span></a><span class="mpre">
</span><a href="#loc_128_1_128_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_1_128_8&#39;)"><span class="hl_fundecl"><span class="mpre">fmtLong</span></span></a><span class="mpre"> (</span><a href="#loc_86_6_86_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_6_86_12&#39;)"><span class="hl_conref"><span class="mpre">OptArg</span></span></a><span class="mpre"> _ </span><a name="loc_130_19_130_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_19_130_21&#39;)"><span class="hl_vardecl"><span class="mpre">ad</span></span></a><span class="mpre">) </span><a name="loc_130_23_130_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_23_130_25&#39;)"><span class="hl_vardecl"><span class="mpre">lo</span></span></a><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;--&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_130_23_130_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_23_130_25&#39;)"><span class="hl_varref"><span class="mpre">lo</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;[=&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_130_19_130_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_19_130_21&#39;)"><span class="hl_varref"><span class="mpre">ad</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;]&quot;</span></span><span class="mpre">

</span><a href="#loc_133_1_133_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_1_133_9&#39;)"><span class="mpre">wrapText</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">]
</span><a name="loc_133_1_133_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_1_133_9&#39;)"><span class="hl_fundecl"><span class="mpre">wrapText</span></span></a><span class="mpre"> </span><a name="loc_133_10_133_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_10_133_15&#39;)"><span class="hl_vardecl"><span class="mpre">width</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">unwords</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_135_9_135_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_9_135_13&#39;)"><span class="hl_varref"><span class="mpre">wrap</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> [] </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">words</span></span><span class="mpre">
  where </span><a href="#loc_135_9_135_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_9_135_13&#39;)"><span class="mpre">wrap</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">] -&gt; [</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">] -&gt; [[</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">]]
        </span><a name="loc_135_9_135_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_9_135_13&#39;)"><span class="hl_fundecl"><span class="mpre">wrap</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">   []   (</span><a name="loc_135_24_135_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_24_135_25&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_135_26_135_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_26_135_28&#39;)"><span class="hl_vardecl"><span class="mpre">ws</span></span></a><span class="mpre">)
          | </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_135_24_135_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_24_135_25&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><a href="#loc_133_10_133_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_10_133_15&#39;)"><span class="hl_varref"><span class="mpre">width</span></span></a><span class="mpre">
          = </span><a href="#loc_135_9_135_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_9_135_13&#39;)"><span class="hl_varref"><span class="mpre">wrap</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_135_24_135_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_24_135_25&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">) [</span><a href="#loc_135_24_135_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_24_135_25&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">] </span><a href="#loc_135_26_135_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_26_135_28&#39;)"><span class="hl_varref"><span class="mpre">ws</span></span></a><span class="mpre">
        </span><a href="#loc_135_9_135_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_9_135_13&#39;)"><span class="hl_fundecl"><span class="mpre">wrap</span></span></a><span class="mpre"> </span><a name="loc_138_14_138_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_14_138_17&#39;)"><span class="hl_vardecl"><span class="mpre">col</span></span></a><span class="mpre"> </span><a name="loc_138_18_138_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_18_138_22&#39;)"><span class="hl_vardecl"><span class="mpre">line</span></span></a><span class="mpre"> (</span><a name="loc_138_24_138_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_24_138_25&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_138_26_138_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_26_138_28&#39;)"><span class="hl_vardecl"><span class="mpre">ws</span></span></a><span class="mpre">)
          | </span><a href="#loc_138_14_138_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_14_138_17&#39;)"><span class="hl_varref"><span class="mpre">col</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_138_24_138_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_24_138_25&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><a href="#loc_133_10_133_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_10_133_15&#39;)"><span class="hl_varref"><span class="mpre">width</span></span></a><span class="mpre">
          = </span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><a href="#loc_138_18_138_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_18_138_22&#39;)"><span class="hl_varref"><span class="mpre">line</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_135_9_135_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_9_135_13&#39;)"><span class="hl_varref"><span class="mpre">wrap</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> [] (</span><a href="#loc_138_24_138_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_24_138_25&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_138_26_138_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_26_138_28&#39;)"><span class="hl_varref"><span class="mpre">ws</span></span></a><span class="mpre">)
        </span><a href="#loc_135_9_135_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_9_135_13&#39;)"><span class="hl_fundecl"><span class="mpre">wrap</span></span></a><span class="mpre"> </span><a name="loc_141_14_141_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_14_141_17&#39;)"><span class="hl_vardecl"><span class="mpre">col</span></span></a><span class="mpre"> </span><a name="loc_141_18_141_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_18_141_22&#39;)"><span class="hl_vardecl"><span class="mpre">line</span></span></a><span class="mpre"> (</span><a name="loc_141_24_141_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_24_141_25&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_141_26_141_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_26_141_28&#39;)"><span class="hl_vardecl"><span class="mpre">ws</span></span></a><span class="mpre">)
          = let </span><a name="loc_142_17_142_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_17_142_21&#39;)"><span class="hl_vardecl"><span class="mpre">col&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_141_14_141_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_14_141_17&#39;)"><span class="hl_varref"><span class="mpre">col</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_141_24_141_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_24_141_25&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
             in </span><a href="#loc_135_9_135_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_9_135_13&#39;)"><span class="hl_varref"><span class="mpre">wrap</span></span></a><span class="mpre"> </span><a href="#loc_142_17_142_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_17_142_21&#39;)"><span class="hl_varref"><span class="mpre">col&#39;</span></span></a><span class="mpre"> (</span><a href="#loc_141_24_141_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_24_141_25&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_141_18_141_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_18_141_22&#39;)"><span class="hl_varref"><span class="mpre">line</span></span></a><span class="mpre">) </span><a href="#loc_141_26_141_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_26_141_28&#39;)"><span class="hl_varref"><span class="mpre">ws</span></span></a><span class="mpre">
        </span><a href="#loc_135_9_135_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_9_135_13&#39;)"><span class="hl_fundecl"><span class="mpre">wrap</span></span></a><span class="mpre"> _ []   [] = []
        </span><a href="#loc_135_9_135_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_9_135_13&#39;)"><span class="hl_fundecl"><span class="mpre">wrap</span></span></a><span class="mpre"> _ </span><a name="loc_145_16_145_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_16_145_20&#39;)"><span class="hl_vardecl"><span class="mpre">line</span></span></a><span class="mpre"> [] = [</span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><a href="#loc_145_16_145_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_16_145_20&#39;)"><span class="hl_varref"><span class="mpre">line</span></span></a><span class="mpre">]

</span><span class="hl_comment"><span class="mpre">{-|
Process the command-line, and return the list of values that matched
(and those that didn\&#39;t). The arguments are:

* The order requirements (see &#39;ArgOrder&#39;)

* The option descriptions (see &#39;OptDescr&#39;)

* The actual command line arguments (presumably got from
  &#39;System.Environment.getArgs&#39;).

&#39;getOpt&#39; returns a triple consisting of the option arguments, a list
of non-options, and a list of error messages.
-}</span></span><span class="mpre">
</span><a href="#loc_165_1_165_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_1_165_7&#39;)"><span class="mpre">getOpt</span></a><span class="mpre"> :: </span><a href="#loc_57_6_57_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_6_57_14&#39;)"><span class="hl_tyconref"><span class="mpre">ArgOrder</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">                   </span><span class="hl_comment"><span class="mpre">-- non-option handling</span></span><span class="mpre">
       -&gt; [</span><a href="#loc_75_6_75_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_6_75_14&#39;)"><span class="hl_tyconref"><span class="mpre">OptDescr</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">]                 </span><span class="hl_comment"><span class="mpre">-- option descriptors</span></span><span class="mpre">
       -&gt; [</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">]                     </span><span class="hl_comment"><span class="mpre">-- the command-line arguments</span></span><span class="mpre">
       -&gt; ([</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">],[</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">],[</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">])      </span><span class="hl_comment"><span class="mpre">-- (options,non-options,error messages)</span></span><span class="mpre">
</span><a name="loc_165_1_165_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_1_165_7&#39;)"><span class="hl_fundecl"><span class="mpre">getOpt</span></span></a><span class="mpre"> </span><a name="loc_165_8_165_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_8_165_16&#39;)"><span class="hl_vardecl"><span class="mpre">ordering</span></span></a><span class="mpre"> </span><a name="loc_165_17_165_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_17_165_25&#39;)"><span class="hl_vardecl"><span class="mpre">optDescr</span></span></a><span class="mpre"> </span><a name="loc_165_26_165_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_26_165_30&#39;)"><span class="hl_vardecl"><span class="mpre">args</span></span></a><span class="mpre"> = (</span><a href="#loc_166_11_166_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_11_166_13&#39;)"><span class="hl_varref"><span class="mpre">os</span></span></a><span class="mpre">,</span><a href="#loc_166_14_166_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_14_166_16&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">,</span><a href="#loc_166_20_166_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_20_166_22&#39;)"><span class="hl_varref"><span class="mpre">es</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="#loc_248_1_248_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_1_248_9&#39;)"><span class="hl_varref"><span class="mpre">errUnrec</span></span></a><span class="mpre"> </span><a href="#loc_166_17_166_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_17_166_19&#39;)"><span class="hl_varref"><span class="mpre">us</span></span></a><span class="mpre">)
   where (</span><a name="loc_166_11_166_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_11_166_13&#39;)"><span class="hl_vardecl"><span class="mpre">os</span></span></a><span class="mpre">,</span><a name="loc_166_14_166_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_14_166_16&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">,</span><a name="loc_166_17_166_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_17_166_19&#39;)"><span class="hl_vardecl"><span class="mpre">us</span></span></a><span class="mpre">,</span><a name="loc_166_20_166_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_166_20_166_22&#39;)"><span class="hl_vardecl"><span class="mpre">es</span></span></a><span class="mpre">) = </span><a href="#loc_177_1_177_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_177_1_177_8&#39;)"><span class="hl_varref"><span class="mpre">getOpt&#39;</span></span></a><span class="mpre"> </span><a href="#loc_165_8_165_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_8_165_16&#39;)"><span class="hl_varref"><span class="mpre">ordering</span></span></a><span class="mpre"> </span><a href="#loc_165_17_165_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_17_165_25&#39;)"><span class="hl_varref"><span class="mpre">optDescr</span></span></a><span class="mpre"> </span><a href="#loc_165_26_165_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_26_165_30&#39;)"><span class="hl_varref"><span class="mpre">args</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">{-|
This is almost the same as &#39;getOpt&#39;, but returns a quadruple
consisting of the option arguments, a list of non-options, a list of
unrecognized options, and a list of error messages.
-}</span></span><span class="mpre">
</span><a href="#loc_177_1_177_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_177_1_177_8&#39;)"><span class="mpre">getOpt&#39;</span></a><span class="mpre"> :: </span><a href="#loc_57_6_57_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_6_57_14&#39;)"><span class="hl_tyconref"><span class="mpre">ArgOrder</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">                         </span><span class="hl_comment"><span class="mpre">-- non-option handling</span></span><span class="mpre">
        -&gt; [</span><a href="#loc_75_6_75_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_6_75_14&#39;)"><span class="hl_tyconref"><span class="mpre">OptDescr</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">]                       </span><span class="hl_comment"><span class="mpre">-- option descriptors</span></span><span class="mpre">
        -&gt; [</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">]                           </span><span class="hl_comment"><span class="mpre">-- the command-line arguments</span></span><span class="mpre">
        -&gt; ([</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">],[</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">], [</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">] ,[</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">]) </span><span class="hl_comment"><span class="mpre">-- (options,non-options,unrecognized,error messages)</span></span><span class="mpre">
</span><a name="loc_177_1_177_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_177_1_177_8&#39;)"><span class="hl_fundecl"><span class="mpre">getOpt&#39;</span></span></a><span class="mpre"> _        _        []         =  ([],[],[],[])
</span><a href="#loc_177_1_177_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_177_1_177_8&#39;)"><span class="hl_fundecl"><span class="mpre">getOpt&#39;</span></span></a><span class="mpre"> </span><a name="loc_178_9_178_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_9_178_17&#39;)"><span class="hl_vardecl"><span class="mpre">ordering</span></span></a><span class="mpre"> </span><a name="loc_178_18_178_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_18_178_26&#39;)"><span class="hl_vardecl"><span class="mpre">optDescr</span></span></a><span class="mpre"> (</span><a name="loc_178_28_178_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_28_178_31&#39;)"><span class="hl_vardecl"><span class="mpre">arg</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_178_32_178_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_32_178_36&#39;)"><span class="hl_vardecl"><span class="mpre">args</span></span></a><span class="mpre">) = </span><a href="#loc_179_10_179_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_10_179_21&#39;)"><span class="hl_varref"><span class="mpre">procNextOpt</span></span></a><span class="mpre"> </span><a href="#loc_189_11_189_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_11_189_14&#39;)"><span class="hl_varref"><span class="mpre">opt</span></span></a><span class="mpre"> </span><a href="#loc_178_9_178_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_9_178_17&#39;)"><span class="hl_varref"><span class="mpre">ordering</span></span></a><span class="mpre">
   where </span><a name="loc_179_10_179_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_10_179_21&#39;)"><span class="hl_fundecl"><span class="mpre">procNextOpt</span></span></a><span class="mpre"> (</span><a href="#loc_89_6_89_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_6_89_9&#39;)"><span class="hl_conref"><span class="mpre">Opt</span></span></a><span class="mpre"> </span><a name="loc_179_27_179_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_27_179_28&#39;)"><span class="hl_vardecl"><span class="mpre">o</span></span></a><span class="mpre">)      _                 = (</span><a href="#loc_179_27_179_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_27_179_28&#39;)"><span class="hl_varref"><span class="mpre">o</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_190_11_190_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_11_190_13&#39;)"><span class="hl_varref"><span class="mpre">os</span></span></a><span class="mpre">,</span><a href="#loc_190_14_190_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_14_190_16&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">,</span><a href="#loc_190_17_190_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_17_190_19&#39;)"><span class="hl_varref"><span class="mpre">us</span></span></a><span class="mpre">,</span><a href="#loc_190_20_190_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_20_190_22&#39;)"><span class="hl_varref"><span class="mpre">es</span></span></a><span class="mpre">)
         </span><a href="#loc_179_10_179_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_10_179_21&#39;)"><span class="hl_fundecl"><span class="mpre">procNextOpt</span></span></a><span class="mpre"> (</span><a href="#loc_90_6_90_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_6_90_14&#39;)"><span class="hl_conref"><span class="mpre">UnreqOpt</span></span></a><span class="mpre"> </span><a name="loc_180_32_180_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_32_180_33&#39;)"><span class="hl_vardecl"><span class="mpre">u</span></span></a><span class="mpre">) _                 = (</span><a href="#loc_190_11_190_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_11_190_13&#39;)"><span class="hl_varref"><span class="mpre">os</span></span></a><span class="mpre">,</span><a href="#loc_190_14_190_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_14_190_16&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">,</span><a href="#loc_180_32_180_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_180_32_180_33&#39;)"><span class="hl_varref"><span class="mpre">u</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_190_17_190_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_17_190_19&#39;)"><span class="hl_varref"><span class="mpre">us</span></span></a><span class="mpre">,</span><a href="#loc_190_20_190_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_20_190_22&#39;)"><span class="hl_varref"><span class="mpre">es</span></span></a><span class="mpre">)
         </span><a href="#loc_179_10_179_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_10_179_21&#39;)"><span class="hl_fundecl"><span class="mpre">procNextOpt</span></span></a><span class="mpre"> (</span><a href="#loc_91_6_91_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_6_91_12&#39;)"><span class="hl_conref"><span class="mpre">NonOpt</span></span></a><span class="mpre"> </span><a name="loc_181_30_181_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_181_30_181_31&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">)   </span><a href="#loc_58_5_58_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_5_58_17&#39;)"><span class="hl_conref"><span class="mpre">RequireOrder</span></span></a><span class="mpre">      = ([],</span><a href="#loc_181_30_181_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_181_30_181_31&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_189_15_189_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_15_189_19&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">,[],[])
         </span><a href="#loc_179_10_179_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_10_179_21&#39;)"><span class="hl_fundecl"><span class="mpre">procNextOpt</span></span></a><span class="mpre"> (</span><a href="#loc_91_6_91_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_6_91_12&#39;)"><span class="hl_conref"><span class="mpre">NonOpt</span></span></a><span class="mpre"> </span><a name="loc_182_30_182_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_30_182_31&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">)   </span><a href="#loc_59_5_59_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_5_59_12&#39;)"><span class="hl_conref"><span class="mpre">Permute</span></span></a><span class="mpre">           = (</span><a href="#loc_190_11_190_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_11_190_13&#39;)"><span class="hl_varref"><span class="mpre">os</span></span></a><span class="mpre">,</span><a href="#loc_182_30_182_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_30_182_31&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_190_14_190_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_14_190_16&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">,</span><a href="#loc_190_17_190_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_17_190_19&#39;)"><span class="hl_varref"><span class="mpre">us</span></span></a><span class="mpre">,</span><a href="#loc_190_20_190_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_20_190_22&#39;)"><span class="hl_varref"><span class="mpre">es</span></span></a><span class="mpre">)
         </span><a href="#loc_179_10_179_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_10_179_21&#39;)"><span class="hl_fundecl"><span class="mpre">procNextOpt</span></span></a><span class="mpre"> (</span><a href="#loc_91_6_91_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_6_91_12&#39;)"><span class="hl_conref"><span class="mpre">NonOpt</span></span></a><span class="mpre"> </span><a name="loc_183_30_183_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_30_183_31&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">)   (</span><a href="#loc_60_5_60_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_5_60_18&#39;)"><span class="hl_conref"><span class="mpre">ReturnInOrder</span></span></a><span class="mpre"> </span><a name="loc_183_50_183_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_50_183_51&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">) = (</span><a href="#loc_183_50_183_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_50_183_51&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_183_30_183_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_30_183_31&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_190_11_190_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_11_190_13&#39;)"><span class="hl_varref"><span class="mpre">os</span></span></a><span class="mpre">, </span><a href="#loc_190_14_190_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_14_190_16&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">,</span><a href="#loc_190_17_190_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_17_190_19&#39;)"><span class="hl_varref"><span class="mpre">us</span></span></a><span class="mpre">,</span><a href="#loc_190_20_190_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_20_190_22&#39;)"><span class="hl_varref"><span class="mpre">es</span></span></a><span class="mpre">)
         </span><a href="#loc_179_10_179_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_10_179_21&#39;)"><span class="hl_fundecl"><span class="mpre">procNextOpt</span></span></a><span class="mpre"> </span><a href="#loc_92_6_92_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_6_92_15&#39;)"><span class="hl_conref"><span class="mpre">EndOfOpts</span></span></a><span class="mpre">    </span><a href="#loc_58_5_58_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_5_58_17&#39;)"><span class="hl_conref"><span class="mpre">RequireOrder</span></span></a><span class="mpre">      = ([],</span><a href="#loc_189_15_189_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_15_189_19&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">,[],[])
         </span><a href="#loc_179_10_179_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_10_179_21&#39;)"><span class="hl_fundecl"><span class="mpre">procNextOpt</span></span></a><span class="mpre"> </span><a href="#loc_92_6_92_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_6_92_15&#39;)"><span class="hl_conref"><span class="mpre">EndOfOpts</span></span></a><span class="mpre">    </span><a href="#loc_59_5_59_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_5_59_12&#39;)"><span class="hl_conref"><span class="mpre">Permute</span></span></a><span class="mpre">           = ([],</span><a href="#loc_189_15_189_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_15_189_19&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">,[],[])
         </span><a href="#loc_179_10_179_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_10_179_21&#39;)"><span class="hl_fundecl"><span class="mpre">procNextOpt</span></span></a><span class="mpre"> </span><a href="#loc_92_6_92_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_6_92_15&#39;)"><span class="hl_conref"><span class="mpre">EndOfOpts</span></span></a><span class="mpre">    (</span><a href="#loc_60_5_60_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_5_60_18&#39;)"><span class="hl_conref"><span class="mpre">ReturnInOrder</span></span></a><span class="mpre"> </span><a name="loc_186_50_186_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_50_186_51&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">) = (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="#loc_186_50_186_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_50_186_51&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_189_15_189_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_15_189_19&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">,[],[],[])
         </span><a href="#loc_179_10_179_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_10_179_21&#39;)"><span class="hl_fundecl"><span class="mpre">procNextOpt</span></span></a><span class="mpre"> (</span><a href="#loc_93_6_93_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_6_93_12&#39;)"><span class="hl_conref"><span class="mpre">OptErr</span></span></a><span class="mpre"> </span><a name="loc_187_30_187_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_30_187_31&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre">)   _                 = (</span><a href="#loc_190_11_190_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_11_190_13&#39;)"><span class="hl_varref"><span class="mpre">os</span></span></a><span class="mpre">,</span><a href="#loc_190_14_190_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_14_190_16&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">,</span><a href="#loc_190_17_190_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_17_190_19&#39;)"><span class="hl_varref"><span class="mpre">us</span></span></a><span class="mpre">,</span><a href="#loc_187_30_187_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_187_30_187_31&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_190_20_190_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_20_190_22&#39;)"><span class="hl_varref"><span class="mpre">es</span></span></a><span class="mpre">)

         (</span><a name="loc_189_11_189_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_11_189_14&#39;)"><span class="hl_vardecl"><span class="mpre">opt</span></span></a><span class="mpre">,</span><a name="loc_189_15_189_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_15_189_19&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">) = </span><a href="#loc_194_1_194_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_1_194_8&#39;)"><span class="hl_varref"><span class="mpre">getNext</span></span></a><span class="mpre"> </span><a href="#loc_178_28_178_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_28_178_31&#39;)"><span class="hl_varref"><span class="mpre">arg</span></span></a><span class="mpre"> </span><a href="#loc_178_32_178_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_32_178_36&#39;)"><span class="hl_varref"><span class="mpre">args</span></span></a><span class="mpre"> </span><a href="#loc_178_18_178_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_18_178_26&#39;)"><span class="hl_varref"><span class="mpre">optDescr</span></span></a><span class="mpre">
         (</span><a name="loc_190_11_190_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_11_190_13&#39;)"><span class="hl_vardecl"><span class="mpre">os</span></span></a><span class="mpre">,</span><a name="loc_190_14_190_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_14_190_16&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">,</span><a name="loc_190_17_190_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_17_190_19&#39;)"><span class="hl_vardecl"><span class="mpre">us</span></span></a><span class="mpre">,</span><a name="loc_190_20_190_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_20_190_22&#39;)"><span class="hl_vardecl"><span class="mpre">es</span></span></a><span class="mpre">) = </span><a href="#loc_177_1_177_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_177_1_177_8&#39;)"><span class="hl_varref"><span class="mpre">getOpt&#39;</span></span></a><span class="mpre"> </span><a href="#loc_178_9_178_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_9_178_17&#39;)"><span class="hl_varref"><span class="mpre">ordering</span></span></a><span class="mpre"> </span><a href="#loc_178_18_178_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_18_178_26&#39;)"><span class="hl_varref"><span class="mpre">optDescr</span></span></a><span class="mpre"> </span><a href="#loc_189_15_189_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_15_189_19&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- take a look at the next cmd line arg and decide what to do with it</span></span><span class="mpre">
</span><a href="#loc_194_1_194_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_1_194_8&#39;)"><span class="mpre">getNext</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">] -&gt; [</span><a href="#loc_75_6_75_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_6_75_14&#39;)"><span class="hl_tyconref"><span class="mpre">OptDescr</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">] -&gt; (</span><a href="#loc_88_6_88_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_6_88_13&#39;)"><span class="hl_tyconref"><span class="mpre">OptKind</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">,[</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">])
</span><a name="loc_194_1_194_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_1_194_8&#39;)"><span class="hl_fundecl"><span class="mpre">getNext</span></span></a><span class="mpre"> (</span><span class="hl_char"><span class="mpre">&#39;-&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="hl_char"><span class="mpre">&#39;-&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">[]) </span><a name="loc_194_22_194_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_22_194_26&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre"> _        = (</span><a href="#loc_92_6_92_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_6_92_15&#39;)"><span class="hl_conref"><span class="mpre">EndOfOpts</span></span></a><span class="mpre">,</span><a href="#loc_194_22_194_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_22_194_26&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">)
</span><a href="#loc_194_1_194_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_1_194_8&#39;)"><span class="hl_fundecl"><span class="mpre">getNext</span></span></a><span class="mpre"> (</span><span class="hl_char"><span class="mpre">&#39;-&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="hl_char"><span class="mpre">&#39;-&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_195_18_195_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_18_195_20&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) </span><a name="loc_195_22_195_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_22_195_26&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre"> </span><a name="loc_195_27_195_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_27_195_35&#39;)"><span class="hl_vardecl"><span class="mpre">optDescr</span></span></a><span class="mpre"> = </span><a href="#loc_201_1_201_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_1_201_8&#39;)"><span class="hl_varref"><span class="mpre">longOpt</span></span></a><span class="mpre"> </span><a href="#loc_195_18_195_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_18_195_20&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> </span><a href="#loc_195_22_195_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_22_195_26&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre"> </span><a href="#loc_195_27_195_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_27_195_35&#39;)"><span class="hl_varref"><span class="mpre">optDescr</span></span></a><span class="mpre">
</span><a href="#loc_194_1_194_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_1_194_8&#39;)"><span class="hl_fundecl"><span class="mpre">getNext</span></span></a><span class="mpre"> (</span><span class="hl_char"><span class="mpre">&#39;-&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a name="loc_196_15_196_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_15_196_16&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_196_18_196_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_18_196_20&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) </span><a name="loc_196_22_196_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_22_196_26&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre"> </span><a name="loc_196_27_196_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_27_196_35&#39;)"><span class="hl_vardecl"><span class="mpre">optDescr</span></span></a><span class="mpre"> = </span><a href="#loc_222_1_222_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_1_222_9&#39;)"><span class="hl_varref"><span class="mpre">shortOpt</span></span></a><span class="mpre"> </span><a href="#loc_196_15_196_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_15_196_16&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_196_18_196_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_18_196_20&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> </span><a href="#loc_196_22_196_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_22_196_26&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre"> </span><a href="#loc_196_27_196_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_27_196_35&#39;)"><span class="hl_varref"><span class="mpre">optDescr</span></span></a><span class="mpre">
</span><a href="#loc_194_1_194_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_1_194_8&#39;)"><span class="hl_fundecl"><span class="mpre">getNext</span></span></a><span class="mpre"> </span><a name="loc_197_9_197_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_9_197_10&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">            </span><a name="loc_197_22_197_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_22_197_26&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre"> _        = (</span><a href="#loc_91_6_91_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_6_91_12&#39;)"><span class="hl_conref"><span class="mpre">NonOpt</span></span></a><span class="mpre"> </span><a href="#loc_197_9_197_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_9_197_10&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">,</span><a href="#loc_197_22_197_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_22_197_26&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- handle long option</span></span><span class="mpre">
</span><a href="#loc_201_1_201_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_1_201_8&#39;)"><span class="mpre">longOpt</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">] -&gt; [</span><a href="#loc_75_6_75_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_6_75_14&#39;)"><span class="hl_tyconref"><span class="mpre">OptDescr</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">] -&gt; (</span><a href="#loc_88_6_88_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_6_88_13&#39;)"><span class="hl_tyconref"><span class="mpre">OptKind</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">,[</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">])
</span><a name="loc_201_1_201_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_1_201_8&#39;)"><span class="hl_fundecl"><span class="mpre">longOpt</span></span></a><span class="mpre"> </span><a name="loc_201_9_201_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_9_201_11&#39;)"><span class="hl_vardecl"><span class="mpre">ls</span></span></a><span class="mpre"> </span><a name="loc_201_12_201_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_12_201_14&#39;)"><span class="hl_vardecl"><span class="mpre">rs</span></span></a><span class="mpre"> </span><a name="loc_201_15_201_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_15_201_23&#39;)"><span class="hl_vardecl"><span class="mpre">optDescr</span></span></a><span class="mpre"> = </span><a href="#loc_210_10_210_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_10_210_14&#39;)"><span class="hl_varref"><span class="mpre">long</span></span></a><span class="mpre"> </span><a href="#loc_207_10_207_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_207_10_207_13&#39;)"><span class="hl_varref"><span class="mpre">ads</span></span></a><span class="mpre"> </span><a href="#loc_202_15_202_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_15_202_18&#39;)"><span class="hl_varref"><span class="mpre">arg</span></span></a><span class="mpre"> </span><a href="#loc_201_12_201_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_12_201_14&#39;)"><span class="hl_varref"><span class="mpre">rs</span></span></a><span class="mpre">
   where (</span><a name="loc_202_11_202_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_11_202_14&#39;)"><span class="hl_vardecl"><span class="mpre">opt</span></span></a><span class="mpre">,</span><a name="loc_202_15_202_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_15_202_18&#39;)"><span class="hl_vardecl"><span class="mpre">arg</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">break</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">==</span></span><span class="hl_char"><span class="mpre">&#39;=&#39;</span></span><span class="mpre">) </span><a href="#loc_201_9_201_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_9_201_11&#39;)"><span class="hl_varref"><span class="mpre">ls</span></span></a><span class="mpre">
         </span><a name="loc_203_10_203_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_10_203_17&#39;)"><span class="hl_fundecl"><span class="mpre">getWith</span></span></a><span class="mpre"> </span><a name="loc_203_18_203_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_18_203_19&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> = [ </span><a href="#loc_203_29_203_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_29_203_30&#39;)"><span class="hl_varref"><span class="mpre">o</span></span></a><span class="mpre">  | </span><a name="loc_203_29_203_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_29_203_30&#39;)"><span class="hl_specname"><span class="mpre">o</span></span></a><span class="mpre">@(</span><a href="#loc_76_4_76_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_4_76_10&#39;)"><span class="hl_conref"><span class="mpre">Option</span></span></a><span class="mpre"> _ </span><a name="loc_203_41_203_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_41_203_43&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> _ _) &lt;- </span><a href="#loc_201_15_201_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_15_201_23&#39;)"><span class="hl_varref"><span class="mpre">optDescr</span></span></a><span class="mpre">
                          , </span><a href="Data.Maybe.html#loc_80_1_80_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_80_1_80_7&#39;)"><span class="hl_varref"><span class="mpre">isJust</span></span></a><span class="mpre"> (</span><a href="Data.List.html#loc_261_1_261_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_261_1_261_5&#39;)"><span class="hl_varref"><span class="mpre">find</span></span></a><span class="mpre"> (</span><a href="#loc_203_18_203_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_18_203_19&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_202_11_202_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_11_202_14&#39;)"><span class="hl_varref"><span class="mpre">opt</span></span></a><span class="mpre">) </span><a href="#loc_203_41_203_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_41_203_43&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">)]
         </span><a name="loc_205_10_205_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_10_205_15&#39;)"><span class="hl_vardecl"><span class="mpre">exact</span></span></a><span class="mpre">     = </span><a href="#loc_203_10_203_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_10_203_17&#39;)"><span class="hl_varref"><span class="mpre">getWith</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">(==)</span></span><span class="mpre">
         </span><a name="loc_206_10_206_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_10_206_17&#39;)"><span class="hl_vardecl"><span class="mpre">options</span></span></a><span class="mpre">   = if </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><a href="#loc_205_10_205_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_10_205_15&#39;)"><span class="hl_varref"><span class="mpre">exact</span></span></a><span class="mpre"> then </span><a href="#loc_203_10_203_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_10_203_17&#39;)"><span class="hl_varref"><span class="mpre">getWith</span></span></a><span class="mpre"> </span><a href="Data.List.html#loc_286_1_286_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_286_1_286_11&#39;)"><span class="hl_varref"><span class="mpre">isPrefixOf</span></span></a><span class="mpre"> else </span><a href="#loc_205_10_205_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_205_10_205_15&#39;)"><span class="hl_varref"><span class="mpre">exact</span></span></a><span class="mpre">
         </span><a name="loc_207_10_207_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_207_10_207_13&#39;)"><span class="hl_vardecl"><span class="mpre">ads</span></span></a><span class="mpre">       = [ </span><a href="#loc_207_40_207_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_207_40_207_42&#39;)"><span class="hl_varref"><span class="mpre">ad</span></span></a><span class="mpre"> | </span><a href="#loc_76_4_76_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_4_76_10&#39;)"><span class="hl_conref"><span class="mpre">Option</span></span></a><span class="mpre"> _ _ </span><a name="loc_207_40_207_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_207_40_207_42&#39;)"><span class="hl_vardecl"><span class="mpre">ad</span></span></a><span class="mpre"> _ &lt;- </span><a href="#loc_206_10_206_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_10_206_17&#39;)"><span class="hl_varref"><span class="mpre">options</span></span></a><span class="mpre"> ]
         </span><a name="loc_208_10_208_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_10_208_16&#39;)"><span class="hl_vardecl"><span class="mpre">optStr</span></span></a><span class="mpre">    = </span><span class="hl_string"><span class="mpre">&quot;--&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_202_11_202_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_11_202_14&#39;)"><span class="hl_varref"><span class="mpre">opt</span></span></a><span class="mpre">

         </span><a name="loc_210_10_210_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_10_210_14&#39;)"><span class="hl_fundecl"><span class="mpre">long</span></span></a><span class="mpre"> (_</span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_</span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_)      _        </span><a name="loc_210_37_210_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_37_210_41&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">     = (</span><a href="#loc_241_1_241_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_241_1_241_9&#39;)"><span class="hl_varref"><span class="mpre">errAmbig</span></span></a><span class="mpre"> </span><a href="#loc_206_10_206_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_10_206_17&#39;)"><span class="hl_varref"><span class="mpre">options</span></span></a><span class="mpre"> </span><a href="#loc_208_10_208_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_10_208_16&#39;)"><span class="hl_varref"><span class="mpre">optStr</span></span></a><span class="mpre">,</span><a href="#loc_210_37_210_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_37_210_41&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">)
         </span><a href="#loc_210_10_210_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_10_210_14&#39;)"><span class="hl_fundecl"><span class="mpre">long</span></span></a><span class="mpre"> [</span><a href="#loc_84_6_84_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_6_84_11&#39;)"><span class="hl_conref"><span class="mpre">NoArg</span></span></a><span class="mpre">  </span><a name="loc_211_23_211_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_211_23_211_24&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">  ] []       </span><a name="loc_211_37_211_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_211_37_211_41&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">     = (</span><a href="#loc_89_6_89_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_6_89_9&#39;)"><span class="hl_conref"><span class="mpre">Opt</span></span></a><span class="mpre"> </span><a href="#loc_211_23_211_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_211_23_211_24&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">,</span><a href="#loc_211_37_211_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_211_37_211_41&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">)
         </span><a href="#loc_210_10_210_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_10_210_14&#39;)"><span class="hl_fundecl"><span class="mpre">long</span></span></a><span class="mpre"> [</span><a href="#loc_84_6_84_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_6_84_11&#39;)"><span class="hl_conref"><span class="mpre">NoArg</span></span></a><span class="mpre">  _  ] (</span><span class="hl_char"><span class="mpre">&#39;=&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_)  </span><a name="loc_212_37_212_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_37_212_41&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">     = (</span><a href="#loc_251_1_251_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_251_1_251_9&#39;)"><span class="hl_varref"><span class="mpre">errNoArg</span></span></a><span class="mpre"> </span><a href="#loc_208_10_208_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_10_208_16&#39;)"><span class="hl_varref"><span class="mpre">optStr</span></span></a><span class="mpre">,</span><a href="#loc_212_37_212_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_37_212_41&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">)
         </span><a href="#loc_210_10_210_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_10_210_14&#39;)"><span class="hl_fundecl"><span class="mpre">long</span></span></a><span class="mpre"> [</span><a href="#loc_85_6_85_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_6_85_12&#39;)"><span class="hl_conref"><span class="mpre">ReqArg</span></span></a><span class="mpre"> _ </span><a name="loc_213_25_213_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_25_213_26&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre">] []       []       = (</span><a href="#loc_245_1_245_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_1_245_7&#39;)"><span class="hl_varref"><span class="mpre">errReq</span></span></a><span class="mpre"> </span><a href="#loc_213_25_213_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_25_213_26&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><a href="#loc_208_10_208_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_208_10_208_16&#39;)"><span class="hl_varref"><span class="mpre">optStr</span></span></a><span class="mpre">,[])
         </span><a href="#loc_210_10_210_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_10_210_14&#39;)"><span class="hl_fundecl"><span class="mpre">long</span></span></a><span class="mpre"> [</span><a href="#loc_85_6_85_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_6_85_12&#39;)"><span class="hl_conref"><span class="mpre">ReqArg</span></span></a><span class="mpre"> </span><a name="loc_214_23_214_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_23_214_24&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> _] []       (</span><a name="loc_214_38_214_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_38_214_39&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_214_40_214_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_40_214_44&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">) = (</span><a href="#loc_89_6_89_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_6_89_9&#39;)"><span class="hl_conref"><span class="mpre">Opt</span></span></a><span class="mpre"> (</span><a href="#loc_214_23_214_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_23_214_24&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_214_38_214_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_38_214_39&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">),</span><a href="#loc_214_40_214_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_40_214_44&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">)
         </span><a href="#loc_210_10_210_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_10_210_14&#39;)"><span class="hl_fundecl"><span class="mpre">long</span></span></a><span class="mpre"> [</span><a href="#loc_85_6_85_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_6_85_12&#39;)"><span class="hl_conref"><span class="mpre">ReqArg</span></span></a><span class="mpre"> </span><a name="loc_215_23_215_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_23_215_24&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> _] (</span><span class="hl_char"><span class="mpre">&#39;=&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_215_33_215_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_33_215_35&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) </span><a name="loc_215_37_215_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_37_215_41&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">     = (</span><a href="#loc_89_6_89_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_6_89_9&#39;)"><span class="hl_conref"><span class="mpre">Opt</span></span></a><span class="mpre"> (</span><a href="#loc_215_23_215_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_23_215_24&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_215_33_215_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_33_215_35&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">),</span><a href="#loc_215_37_215_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_37_215_41&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">)
         </span><a href="#loc_210_10_210_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_10_210_14&#39;)"><span class="hl_fundecl"><span class="mpre">long</span></span></a><span class="mpre"> [</span><a href="#loc_86_6_86_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_6_86_12&#39;)"><span class="hl_conref"><span class="mpre">OptArg</span></span></a><span class="mpre"> </span><a name="loc_216_23_216_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_23_216_24&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> _] []       </span><a name="loc_216_37_216_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_37_216_41&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">     = (</span><a href="#loc_89_6_89_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_6_89_9&#39;)"><span class="hl_conref"><span class="mpre">Opt</span></span></a><span class="mpre"> (</span><a href="#loc_216_23_216_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_23_216_24&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">),</span><a href="#loc_216_37_216_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_37_216_41&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">)
         </span><a href="#loc_210_10_210_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_10_210_14&#39;)"><span class="hl_fundecl"><span class="mpre">long</span></span></a><span class="mpre"> [</span><a href="#loc_86_6_86_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_6_86_12&#39;)"><span class="hl_conref"><span class="mpre">OptArg</span></span></a><span class="mpre"> </span><a name="loc_217_23_217_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_23_217_24&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> _] (</span><span class="hl_char"><span class="mpre">&#39;=&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_217_33_217_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_33_217_35&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) </span><a name="loc_217_37_217_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_37_217_41&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">     = (</span><a href="#loc_89_6_89_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_6_89_9&#39;)"><span class="hl_conref"><span class="mpre">Opt</span></span></a><span class="mpre"> (</span><a href="#loc_217_23_217_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_23_217_24&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="#loc_217_33_217_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_33_217_35&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">)),</span><a href="#loc_217_37_217_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_37_217_41&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">)
         </span><a href="#loc_210_10_210_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_10_210_14&#39;)"><span class="hl_fundecl"><span class="mpre">long</span></span></a><span class="mpre"> _            _        </span><a name="loc_218_37_218_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_37_218_41&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">     = (</span><a href="#loc_90_6_90_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_6_90_14&#39;)"><span class="hl_conref"><span class="mpre">UnreqOpt</span></span></a><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;--&quot;</span></span><span class="hl_infix"><span class="mpre">++</span></span><a href="#loc_201_9_201_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_9_201_11&#39;)"><span class="hl_varref"><span class="mpre">ls</span></span></a><span class="mpre">),</span><a href="#loc_218_37_218_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_37_218_41&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- handle short option</span></span><span class="mpre">
</span><a href="#loc_222_1_222_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_1_222_9&#39;)"><span class="mpre">shortOpt</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">] -&gt; [</span><a href="#loc_75_6_75_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_6_75_14&#39;)"><span class="hl_tyconref"><span class="mpre">OptDescr</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">] -&gt; (</span><a href="#loc_88_6_88_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_6_88_13&#39;)"><span class="hl_tyconref"><span class="mpre">OptKind</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">,[</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">])
</span><a name="loc_222_1_222_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_1_222_9&#39;)"><span class="hl_fundecl"><span class="mpre">shortOpt</span></span></a><span class="mpre"> </span><a name="loc_222_10_222_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_10_222_11&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> </span><a name="loc_222_12_222_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_12_222_14&#39;)"><span class="hl_vardecl"><span class="mpre">ys</span></span></a><span class="mpre"> </span><a name="loc_222_15_222_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_15_222_17&#39;)"><span class="hl_vardecl"><span class="mpre">rs</span></span></a><span class="mpre"> </span><a name="loc_222_18_222_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_18_222_26&#39;)"><span class="hl_vardecl"><span class="mpre">optDescr</span></span></a><span class="mpre"> = </span><a href="#loc_227_9_227_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_9_227_14&#39;)"><span class="hl_varref"><span class="mpre">short</span></span></a><span class="mpre"> </span><a href="#loc_224_9_224_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_9_224_12&#39;)"><span class="hl_varref"><span class="mpre">ads</span></span></a><span class="mpre"> </span><a href="#loc_222_12_222_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_12_222_14&#39;)"><span class="hl_varref"><span class="mpre">ys</span></span></a><span class="mpre"> </span><a href="#loc_222_15_222_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_15_222_17&#39;)"><span class="hl_varref"><span class="mpre">rs</span></span></a><span class="mpre">
  where </span><a name="loc_223_9_223_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_9_223_16&#39;)"><span class="hl_vardecl"><span class="mpre">options</span></span></a><span class="mpre"> = [ </span><a href="#loc_223_26_223_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_26_223_27&#39;)"><span class="hl_varref"><span class="mpre">o</span></span></a><span class="mpre">  | </span><a name="loc_223_26_223_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_26_223_27&#39;)"><span class="hl_specname"><span class="mpre">o</span></span></a><span class="mpre">@(</span><a href="#loc_76_4_76_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_4_76_10&#39;)"><span class="hl_conref"><span class="mpre">Option</span></span></a><span class="mpre"> </span><a name="loc_223_36_223_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_36_223_38&#39;)"><span class="hl_vardecl"><span class="mpre">ss</span></span></a><span class="mpre"> _ _ _) &lt;- </span><a href="#loc_222_18_222_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_18_222_26&#39;)"><span class="hl_varref"><span class="mpre">optDescr</span></span></a><span class="mpre">, </span><a name="loc_223_59_223_60" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_59_223_60&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_223_36_223_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_36_223_38&#39;)"><span class="hl_varref"><span class="mpre">ss</span></span></a><span class="mpre">, </span><a href="#loc_222_10_222_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_10_222_11&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_223_59_223_60" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_59_223_60&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> ]
        </span><a name="loc_224_9_224_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_9_224_12&#39;)"><span class="hl_vardecl"><span class="mpre">ads</span></span></a><span class="mpre">     = [ </span><a href="#loc_224_37_224_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_37_224_39&#39;)"><span class="hl_varref"><span class="mpre">ad</span></span></a><span class="mpre"> | </span><a href="#loc_76_4_76_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_4_76_10&#39;)"><span class="hl_conref"><span class="mpre">Option</span></span></a><span class="mpre"> _ _ </span><a name="loc_224_37_224_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_37_224_39&#39;)"><span class="hl_vardecl"><span class="mpre">ad</span></span></a><span class="mpre"> _ &lt;- </span><a href="#loc_223_9_223_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_9_223_16&#39;)"><span class="hl_varref"><span class="mpre">options</span></span></a><span class="mpre"> ]
        </span><a name="loc_225_9_225_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_225_9_225_15&#39;)"><span class="hl_vardecl"><span class="mpre">optStr</span></span></a><span class="mpre">  = </span><span class="hl_char"><span class="mpre">&#39;-&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">[</span><a href="#loc_222_10_222_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_10_222_11&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">]

        </span><a name="loc_227_9_227_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_9_227_14&#39;)"><span class="hl_fundecl"><span class="mpre">short</span></span></a><span class="mpre"> (_</span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_</span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_)        _  </span><a name="loc_227_33_227_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_33_227_37&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">     = (</span><a href="#loc_241_1_241_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_241_1_241_9&#39;)"><span class="hl_varref"><span class="mpre">errAmbig</span></span></a><span class="mpre"> </span><a href="#loc_223_9_223_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_9_223_16&#39;)"><span class="hl_varref"><span class="mpre">options</span></span></a><span class="mpre"> </span><a href="#loc_225_9_225_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_225_9_225_15&#39;)"><span class="hl_varref"><span class="mpre">optStr</span></span></a><span class="mpre">,</span><a href="#loc_227_33_227_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_33_227_37&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">)
        </span><a href="#loc_227_9_227_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_9_227_14&#39;)"><span class="hl_fundecl"><span class="mpre">short</span></span></a><span class="mpre"> (</span><a href="#loc_84_6_84_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_6_84_11&#39;)"><span class="hl_conref"><span class="mpre">NoArg</span></span></a><span class="mpre">  </span><a name="loc_228_23_228_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_228_23_228_24&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">  </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_) [] </span><a name="loc_228_33_228_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_228_33_228_37&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">     = (</span><a href="#loc_89_6_89_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_6_89_9&#39;)"><span class="hl_conref"><span class="mpre">Opt</span></span></a><span class="mpre"> </span><a href="#loc_228_23_228_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_228_23_228_24&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">,</span><a href="#loc_228_33_228_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_228_33_228_37&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">)
        </span><a href="#loc_227_9_227_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_9_227_14&#39;)"><span class="hl_fundecl"><span class="mpre">short</span></span></a><span class="mpre"> (</span><a href="#loc_84_6_84_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_6_84_11&#39;)"><span class="hl_conref"><span class="mpre">NoArg</span></span></a><span class="mpre">  </span><a name="loc_229_23_229_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_23_229_24&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">  </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_) </span><a name="loc_229_30_229_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_30_229_32&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> </span><a name="loc_229_33_229_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_33_229_37&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">     = (</span><a href="#loc_89_6_89_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_6_89_9&#39;)"><span class="hl_conref"><span class="mpre">Opt</span></span></a><span class="mpre"> </span><a href="#loc_229_23_229_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_23_229_24&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">,(</span><span class="hl_char"><span class="mpre">&#39;-&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_229_30_229_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_30_229_32&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_229_33_229_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_33_229_37&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">)
        </span><a href="#loc_227_9_227_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_9_227_14&#39;)"><span class="hl_fundecl"><span class="mpre">short</span></span></a><span class="mpre"> (</span><a href="#loc_85_6_85_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_6_85_12&#39;)"><span class="hl_conref"><span class="mpre">ReqArg</span></span></a><span class="mpre"> _ </span><a name="loc_230_25_230_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_25_230_26&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_) [] []       = (</span><a href="#loc_245_1_245_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_1_245_7&#39;)"><span class="hl_varref"><span class="mpre">errReq</span></span></a><span class="mpre"> </span><a href="#loc_230_25_230_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_25_230_26&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><a href="#loc_225_9_225_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_225_9_225_15&#39;)"><span class="hl_varref"><span class="mpre">optStr</span></span></a><span class="mpre">,[])
        </span><a href="#loc_227_9_227_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_9_227_14&#39;)"><span class="hl_fundecl"><span class="mpre">short</span></span></a><span class="mpre"> (</span><a href="#loc_85_6_85_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_6_85_12&#39;)"><span class="hl_conref"><span class="mpre">ReqArg</span></span></a><span class="mpre"> </span><a name="loc_231_23_231_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_23_231_24&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> _</span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_) [] (</span><a name="loc_231_34_231_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_34_231_35&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_231_36_231_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_36_231_40&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">) = (</span><a href="#loc_89_6_89_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_6_89_9&#39;)"><span class="hl_conref"><span class="mpre">Opt</span></span></a><span class="mpre"> (</span><a href="#loc_231_23_231_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_23_231_24&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_231_34_231_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_34_231_35&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">),</span><a href="#loc_231_36_231_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_231_36_231_40&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">)
        </span><a href="#loc_227_9_227_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_9_227_14&#39;)"><span class="hl_fundecl"><span class="mpre">short</span></span></a><span class="mpre"> (</span><a href="#loc_85_6_85_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_6_85_12&#39;)"><span class="hl_conref"><span class="mpre">ReqArg</span></span></a><span class="mpre"> </span><a name="loc_232_23_232_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_232_23_232_24&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> _</span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_) </span><a name="loc_232_30_232_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_232_30_232_32&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> </span><a name="loc_232_33_232_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_232_33_232_37&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">     = (</span><a href="#loc_89_6_89_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_6_89_9&#39;)"><span class="hl_conref"><span class="mpre">Opt</span></span></a><span class="mpre"> (</span><a href="#loc_232_23_232_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_232_23_232_24&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_232_30_232_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_232_30_232_32&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">),</span><a href="#loc_232_33_232_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_232_33_232_37&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">)
        </span><a href="#loc_227_9_227_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_9_227_14&#39;)"><span class="hl_fundecl"><span class="mpre">short</span></span></a><span class="mpre"> (</span><a href="#loc_86_6_86_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_6_86_12&#39;)"><span class="hl_conref"><span class="mpre">OptArg</span></span></a><span class="mpre"> </span><a name="loc_233_23_233_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_233_23_233_24&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> _</span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_) [] </span><a name="loc_233_33_233_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_233_33_233_37&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">     = (</span><a href="#loc_89_6_89_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_6_89_9&#39;)"><span class="hl_conref"><span class="mpre">Opt</span></span></a><span class="mpre"> (</span><a href="#loc_233_23_233_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_233_23_233_24&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">),</span><a href="#loc_233_33_233_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_233_33_233_37&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">)
        </span><a href="#loc_227_9_227_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_9_227_14&#39;)"><span class="hl_fundecl"><span class="mpre">short</span></span></a><span class="mpre"> (</span><a href="#loc_86_6_86_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_6_86_12&#39;)"><span class="hl_conref"><span class="mpre">OptArg</span></span></a><span class="mpre"> </span><a name="loc_234_23_234_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_234_23_234_24&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> _</span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_) </span><a name="loc_234_30_234_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_234_30_234_32&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> </span><a name="loc_234_33_234_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_234_33_234_37&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">     = (</span><a href="#loc_89_6_89_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_6_89_9&#39;)"><span class="hl_conref"><span class="mpre">Opt</span></span></a><span class="mpre"> (</span><a href="#loc_234_23_234_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_234_23_234_24&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="#loc_234_30_234_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_234_30_234_32&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">)),</span><a href="#loc_234_33_234_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_234_33_234_37&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">)
        </span><a href="#loc_227_9_227_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_9_227_14&#39;)"><span class="hl_fundecl"><span class="mpre">short</span></span></a><span class="mpre"> []             [] </span><a name="loc_235_33_235_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_235_33_235_37&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">     = (</span><a href="#loc_90_6_90_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_6_90_14&#39;)"><span class="hl_conref"><span class="mpre">UnreqOpt</span></span></a><span class="mpre"> </span><a href="#loc_225_9_225_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_225_9_225_15&#39;)"><span class="hl_varref"><span class="mpre">optStr</span></span></a><span class="mpre">,</span><a href="#loc_235_33_235_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_235_33_235_37&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">)
        </span><a href="#loc_227_9_227_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_9_227_14&#39;)"><span class="hl_fundecl"><span class="mpre">short</span></span></a><span class="mpre"> []             </span><a name="loc_236_30_236_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_30_236_32&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> </span><a name="loc_236_33_236_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_33_236_37&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">     = (</span><a href="#loc_90_6_90_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_6_90_14&#39;)"><span class="hl_conref"><span class="mpre">UnreqOpt</span></span></a><span class="mpre"> (</span><a href="#loc_225_9_225_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_225_9_225_15&#39;)"><span class="hl_varref"><span class="mpre">optStr</span></span></a><span class="hl_infix"><span class="mpre">++</span></span><a href="#loc_236_30_236_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_30_236_32&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">),</span><a href="#loc_236_33_236_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_33_236_37&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- miscellaneous error formatting</span></span><span class="mpre">

</span><a href="#loc_241_1_241_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_241_1_241_9&#39;)"><span class="mpre">errAmbig</span></a><span class="mpre"> :: [</span><a href="#loc_75_6_75_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_6_75_14&#39;)"><span class="hl_tyconref"><span class="mpre">OptDescr</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><a href="#loc_88_6_88_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_6_88_13&#39;)"><span class="hl_tyconref"><span class="mpre">OptKind</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_241_1_241_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_241_1_241_9&#39;)"><span class="hl_fundecl"><span class="mpre">errAmbig</span></span></a><span class="mpre"> </span><a name="loc_241_10_241_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_241_10_241_13&#39;)"><span class="hl_vardecl"><span class="mpre">ods</span></span></a><span class="mpre"> </span><a name="loc_241_14_241_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_241_14_241_20&#39;)"><span class="hl_vardecl"><span class="mpre">optStr</span></span></a><span class="mpre"> = </span><a href="#loc_93_6_93_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_6_93_12&#39;)"><span class="hl_conref"><span class="mpre">OptErr</span></span></a><span class="mpre"> (</span><a href="#loc_101_1_101_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_1_101_10&#39;)"><span class="hl_varref"><span class="mpre">usageInfo</span></span></a><span class="mpre"> </span><a href="#loc_242_10_242_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_10_242_16&#39;)"><span class="hl_varref"><span class="mpre">header</span></span></a><span class="mpre"> </span><a href="#loc_241_10_241_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_241_10_241_13&#39;)"><span class="hl_varref"><span class="mpre">ods</span></span></a><span class="mpre">)
   where </span><a name="loc_242_10_242_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_10_242_16&#39;)"><span class="hl_vardecl"><span class="mpre">header</span></span></a><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;option `&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_241_14_241_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_241_14_241_20&#39;)"><span class="hl_varref"><span class="mpre">optStr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&#39; is ambiguous; could be one of:&quot;</span></span><span class="mpre">

</span><a href="#loc_245_1_245_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_1_245_7&#39;)"><span class="mpre">errReq</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><a href="#loc_88_6_88_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_6_88_13&#39;)"><span class="hl_tyconref"><span class="mpre">OptKind</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_245_1_245_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_1_245_7&#39;)"><span class="hl_fundecl"><span class="mpre">errReq</span></span></a><span class="mpre"> </span><a name="loc_245_8_245_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_8_245_9&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre"> </span><a name="loc_245_10_245_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_10_245_16&#39;)"><span class="hl_vardecl"><span class="mpre">optStr</span></span></a><span class="mpre"> = </span><a href="#loc_93_6_93_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_6_93_12&#39;)"><span class="hl_conref"><span class="mpre">OptErr</span></span></a><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;option `&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_245_10_245_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_10_245_16&#39;)"><span class="hl_varref"><span class="mpre">optStr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&#39; requires an argument &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_245_8_245_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_8_245_9&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;\n&quot;</span></span><span class="mpre">)

</span><a href="#loc_248_1_248_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_1_248_9&#39;)"><span class="mpre">errUnrec</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_248_1_248_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_1_248_9&#39;)"><span class="hl_fundecl"><span class="mpre">errUnrec</span></span></a><span class="mpre"> </span><a name="loc_248_10_248_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_10_248_16&#39;)"><span class="hl_vardecl"><span class="mpre">optStr</span></span></a><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;unrecognized option `&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_248_10_248_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_10_248_16&#39;)"><span class="hl_varref"><span class="mpre">optStr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&#39;\n&quot;</span></span><span class="mpre">

</span><a href="#loc_251_1_251_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_251_1_251_9&#39;)"><span class="mpre">errNoArg</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><a href="#loc_88_6_88_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_6_88_13&#39;)"><span class="hl_tyconref"><span class="mpre">OptKind</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_251_1_251_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_251_1_251_9&#39;)"><span class="hl_fundecl"><span class="mpre">errNoArg</span></span></a><span class="mpre"> </span><a name="loc_251_10_251_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_251_10_251_16&#39;)"><span class="hl_vardecl"><span class="mpre">optStr</span></span></a><span class="mpre"> = </span><a href="#loc_93_6_93_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_6_93_12&#39;)"><span class="hl_conref"><span class="mpre">OptErr</span></span></a><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;option `&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_251_10_251_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_251_10_251_16&#39;)"><span class="hl_varref"><span class="mpre">optStr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&#39; doesn&#39;t allow an argument\n&quot;</span></span><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">{-
-----------------------------------------------------------------------------------------
-- and here a small and hopefully enlightening example:

data Flag = Verbose | Version | Name String | Output String | Arg String   deriving Show

options :: [OptDescr Flag]
options =
   [Option [&#39;v&#39;]     [&quot;verbose&quot;]           (NoArg Verbose)      &quot;verbosely list files&quot;,
    Option [&#39;V&#39;,&#39;?&#39;] [&quot;version&quot;,&quot;release&quot;] (NoArg Version)      &quot;show version info&quot;,
    Option [&#39;o&#39;]     [&quot;output&quot;]            (OptArg out &quot;FILE&quot;)  &quot;use FILE for dump&quot;,
    Option [&#39;n&#39;]     [&quot;name&quot;]              (ReqArg Name &quot;USER&quot;) &quot;only dump USER&#39;s files&quot;]

out :: Maybe String -&gt; Flag
out Nothing  = Output &quot;stdout&quot;
out (Just o) = Output o

test :: ArgOrder Flag -&gt; [String] -&gt; String
test order cmdline = case getOpt order options cmdline of
                        (o,n,[]  ) -&gt; &quot;options=&quot; ++ show o ++ &quot;  args=&quot; ++ show n ++ &quot;\n&quot;
                        (_,_,errs) -&gt; concat errs ++ usageInfo header options
   where header = &quot;Usage: foobar [OPTION...] files...&quot;

-- example runs:
-- putStr (test RequireOrder [&quot;foo&quot;,&quot;-v&quot;])
--    ==&gt; options=[]  args=[&quot;foo&quot;, &quot;-v&quot;]
-- putStr (test Permute [&quot;foo&quot;,&quot;-v&quot;])
--    ==&gt; options=[Verbose]  args=[&quot;foo&quot;]
-- putStr (test (ReturnInOrder Arg) [&quot;foo&quot;,&quot;-v&quot;])
--    ==&gt; options=[Arg &quot;foo&quot;, Verbose]  args=[]
-- putStr (test Permute [&quot;foo&quot;,&quot;--&quot;,&quot;-v&quot;])
--    ==&gt; options=[]  args=[&quot;foo&quot;, &quot;-v&quot;]
-- putStr (test Permute [&quot;-?o&quot;,&quot;--name&quot;,&quot;bar&quot;,&quot;--na=baz&quot;])
--    ==&gt; options=[Version, Output &quot;stdout&quot;, Name &quot;bar&quot;, Name &quot;baz&quot;]  args=[]
-- putStr (test Permute [&quot;--ver&quot;,&quot;foo&quot;])
--    ==&gt; option `--ver&#39; is ambiguous; could be one of:
--          -v      --verbose             verbosely list files
--          -V, -?  --version, --release  show version info
--        Usage: foobar [OPTION...] files...
--          -v        --verbose             verbosely list files
--          -V, -?    --version, --release  show version info
--          -o[FILE]  --output[=FILE]       use FILE for dump
--          -n USER   --name=USER           only dump USER&#39;s files
-----------------------------------------------------------------------------------------
-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">{- $example

To hopefully illuminate the role of the different data
structures, here\&#39;s the command-line options for a (very simple)
compiler:

&gt;    module Opts where
&gt;
&gt;    import Distribution.GetOpt
&gt;    import Data.Maybe ( fromMaybe )
&gt;
&gt;    data Flag
&gt;     = Verbose  | Version
&gt;     | Input String | Output String | LibDir String
&gt;       deriving Show
&gt;
&gt;    options :: [OptDescr Flag]
&gt;    options =
&gt;     [ Option [&#39;v&#39;]     [&quot;verbose&quot;] (NoArg Verbose)       &quot;chatty output on stderr&quot;
&gt;     , Option [&#39;V&#39;,&#39;?&#39;] [&quot;version&quot;] (NoArg Version)       &quot;show version number&quot;
&gt;     , Option [&#39;o&#39;]     [&quot;output&quot;]  (OptArg outp &quot;FILE&quot;)  &quot;output FILE&quot;
&gt;     , Option [&#39;c&#39;]     []          (OptArg inp  &quot;FILE&quot;)  &quot;input FILE&quot;
&gt;     , Option [&#39;L&#39;]     [&quot;libdir&quot;]  (ReqArg LibDir &quot;DIR&quot;) &quot;library directory&quot;
&gt;     ]
&gt;
&gt;    inp,outp :: Maybe String -&gt; Flag
&gt;    outp = Output . fromMaybe &quot;stdout&quot;
&gt;    inp  = Input  . fromMaybe &quot;stdin&quot;
&gt;
&gt;    compilerOpts :: [String] -&gt; IO ([Flag], [String])
&gt;    compilerOpts argv =
&gt;       case getOpt Permute options argv of
&gt;          (o,n,[]  ) -&gt; return (o,n)
&gt;          (_,_,errs) -&gt; ioError (userError (concat errs ++ usageInfo header options))
&gt;      where header = &quot;Usage: ic [OPTION...] files...&quot;

-}</span></span><span class="mpre">
</span></div></body></html>