<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      : Network.TLS.Util.ASN1</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     : BSD-style</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  : Vincent Hanquez &lt;vincent@snarc.org&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   : experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability : unknown</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ASN1 utils for TLS</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
module Network.TLS.Util.ASN1
    ( decodeASN1Object
    , encodeASN1Object
    ) where

import Data.ASN1.Types (</span><a href="Data.ASN1.Types.html#loc_70_5_70_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_70_5_70_13&#39;)"><span class="mpre">fromASN1</span></a><span class="mpre">, </span><a href="Data.ASN1.Types.html#loc_66_5_66_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_66_5_66_11&#39;)"><span class="mpre">toASN1</span></a><span class="mpre">, </span><a href="Data.ASN1.Types.html#loc_64_7_64_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_64_7_64_17&#39;)"><span class="mpre">ASN1Object</span></a><span class="mpre">)
import Data.ASN1.Encoding (</span><a href="Data.ASN1.Encoding.html#loc_43_1_43_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Encoding.html#loc_43_1_43_12&#39;)"><span class="mpre">decodeASN1&#39;</span></a><span class="mpre">, </span><a href="Data.ASN1.Encoding.html#loc_51_1_51_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Encoding.html#loc_51_1_51_12&#39;)"><span class="mpre">encodeASN1&#39;</span></a><span class="mpre">)
import Data.ASN1.BinaryEncoding (</span><a href="Data.ASN1.BinaryEncoding.html#loc_30_6_30_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.BinaryEncoding.html#loc_30_6_30_9&#39;)"><span class="mpre">DER</span></a><span class="mpre">(..))
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Util/ASN1.hs&quot;, srcSpanStartLine = 18, srcSpanStartColumn = 8, srcSpanEndLine = 18, srcSpanEndColumn = 23}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> (ByteString)

</span><span class="hl_comment"><span class="mpre">-- | Attempt to decode a bytestring representing</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- an DER ASN.1 serialized object into the object.</span></span><span class="mpre">
</span><a href="#loc_26_1_26_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_1_26_17&#39;)"><span class="mpre">decodeASN1Object</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Util/ASN1.hs&quot;, srcSpanStartLine = 22, srcSpanStartColumn = 21, srcSpanEndLine = 23, srcSpanEndColumn = 20}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Util/ASN1.hs&quot;, srcSpanStartLine = 23, srcSpanStartColumn = 18, srcSpanEndLine = 23, srcSpanEndColumn = 20}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Networ"><span class="mpre">ASN1Object a
                 =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
                 -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
                 -&gt; </span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_26_1_26_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_1_26_17&#39;)"><span class="hl_fundecl"><span class="mpre">decodeASN1Object</span></span></a><span class="mpre"> </span><a name="loc_26_18_26_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_18_26_22&#39;)"><span class="hl_vardecl"><span class="mpre">name</span></span></a><span class="mpre"> </span><a name="loc_26_23_26_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_23_26_25&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> =
    case </span><a href="Data.ASN1.Encoding.html#loc_43_1_43_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Encoding.html#loc_43_1_43_12&#39;)"><span class="hl_varref"><span class="mpre">decodeASN1&#39;</span></span></a><span class="mpre"> </span><a href="Data.ASN1.BinaryEncoding.html#loc_30_12_30_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.BinaryEncoding.html#loc_30_12_30_15&#39;)"><span class="hl_conref"><span class="mpre">DER</span></span></a><span class="mpre"> </span><a href="#loc_26_23_26_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_23_26_25&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> of
        </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><a name="loc_28_14_28_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_14_28_15&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre">     -&gt; </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> (</span><a href="#loc_26_18_26_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_18_26_22&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;: cannot decode ASN1: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_28_14_28_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_14_28_15&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">)
        </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><a name="loc_29_15_29_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_15_29_19&#39;)"><span class="hl_vardecl"><span class="mpre">asn1</span></span></a><span class="mpre"> -&gt; case </span><a href="Data.ASN1.Types.html#loc_70_5_70_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_70_5_70_13&#39;)"><span class="hl_varref"><span class="mpre">fromASN1</span></span></a><span class="mpre"> </span><a href="#loc_29_15_29_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_15_29_19&#39;)"><span class="hl_varref"><span class="mpre">asn1</span></span></a><span class="mpre"> of
                            </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><a name="loc_30_34_30_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_34_30_35&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre">      -&gt; </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> (</span><a href="#loc_26_18_26_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_18_26_22&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;: cannot parse ASN1: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_30_34_30_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_34_30_35&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">)
                            </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> (</span><a name="loc_31_36_31_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_36_31_37&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre">,_) -&gt; </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><a href="#loc_31_36_31_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_36_31_37&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Encode an ASN.1 Object to the DER serialized bytestring</span></span><span class="mpre">
</span><a href="#loc_37_1_37_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_1_37_17&#39;)"><span class="mpre">encodeASN1Object</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Util/ASN1.hs&quot;, srcSpanStartLine = 34, srcSpanStartColumn = 21, srcSpanEndLine = 35, srcSpanEndColumn = 20}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Util/ASN1.hs&quot;, srcSpanStartLine = 35, srcSpanStartColumn = 18, srcSpanEndLine = 35, srcSpanEndColumn = 20}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Networ"><span class="mpre">ASN1Object a
                 =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
                 -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
</span><a name="loc_37_1_37_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_1_37_17&#39;)"><span class="hl_fundecl"><span class="mpre">encodeASN1Object</span></span></a><span class="mpre"> </span><a name="loc_37_18_37_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_18_37_21&#39;)"><span class="hl_vardecl"><span class="mpre">obj</span></span></a><span class="mpre"> = </span><a href="Data.ASN1.Encoding.html#loc_51_1_51_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Encoding.html#loc_51_1_51_12&#39;)"><span class="hl_varref"><span class="mpre">encodeASN1&#39;</span></span></a><span class="mpre"> </span><a href="Data.ASN1.BinaryEncoding.html#loc_30_12_30_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.BinaryEncoding.html#loc_30_12_30_15&#39;)"><span class="hl_conref"><span class="mpre">DER</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_66_5_66_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_66_5_66_11&#39;)"><span class="hl_varref"><span class="mpre">toASN1</span></span></a><span class="mpre"> </span><a href="#loc_37_18_37_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_18_37_21&#39;)"><span class="hl_varref"><span class="mpre">obj</span></span></a><span class="mpre"> []
</span></div></body></html>