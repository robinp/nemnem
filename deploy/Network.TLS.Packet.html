<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE OverloadedStrings #-}
</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      : Network.TLS.Packet</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     : BSD-style</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  : Vincent Hanquez &lt;vincent@snarc.org&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   : experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability : unknown</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the Packet module contains everything necessary to serialize and deserialize things</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- with only explicit parameters, no TLS state is involved here.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
module Network.TLS.Packet
    (
    </span><span class="hl_comment"><span class="mpre">-- * params for encoding and decoding</span></span><span class="mpre">
      CurrentParams(..)
    </span><span class="hl_comment"><span class="mpre">-- * marshall functions for header messages</span></span><span class="mpre">
    , decodeHeader
    , decodeDeprecatedHeaderLength
    , decodeDeprecatedHeader
    , encodeHeader
    , encodeHeaderNoVer </span><span class="hl_comment"><span class="mpre">-- use for SSL3</span></span><span class="mpre">

    </span><span class="hl_comment"><span class="mpre">-- * marshall functions for alert messages</span></span><span class="mpre">
    , decodeAlert
    , decodeAlerts
    , encodeAlerts

    </span><span class="hl_comment"><span class="mpre">-- * marshall functions for handshake messages</span></span><span class="mpre">
    , decodeHandshakeRecord
    , decodeHandshake
    , decodeDeprecatedHandshake
    , encodeHandshake
    , encodeHandshakes
    , encodeHandshakeHeader
    , encodeHandshakeContent

    </span><span class="hl_comment"><span class="mpre">-- * marshall functions for change cipher spec message</span></span><span class="mpre">
    , decodeChangeCipherSpec
    , encodeChangeCipherSpec

    , decodePreMasterSecret
    , encodePreMasterSecret
    , encodeSignedDHParams

    , decodeReallyServerKeyXchgAlgorithmData

    </span><span class="hl_comment"><span class="mpre">-- * generate things for packet content</span></span><span class="mpre">
    , generateMasterSecret
    , generateKeyBlock
    , generateClientFinished
    , generateServerFinished

    , generateCertificateVerify_SSL
    ) where

import Network.TLS.Struct
import Network.TLS.Wire
import Network.TLS.Cap
import Data.Maybe (</span><a href="Data.Maybe.html#loc_91_1_91_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_91_1_91_9&#39;)"><span class="mpre">fromJust</span></a><span class="mpre">)
import Data.Word
import Control.Applicative (</span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="mpre">(&lt;$&gt;)</span></a><span class="mpre">, </span><a href="Control.Applicative.html#loc_118_5_118_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_118_5_118_10&#39;)"><span class="mpre">(&lt;*&gt;)</span></a><span class="mpre">)
import Control.Monad
import Data.ASN1.Types (</span><a href="Data.ASN1.Types.html#loc_70_5_70_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_70_5_70_13&#39;)"><span class="mpre">fromASN1</span></a><span class="mpre">, </span><a href="Data.ASN1.Types.html#loc_66_5_66_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_66_5_66_11&#39;)"><span class="mpre">toASN1</span></a><span class="mpre">)
import Data.ASN1.Encoding (</span><a href="Data.ASN1.Encoding.html#loc_43_1_43_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Encoding.html#loc_43_1_43_12&#39;)"><span class="mpre">decodeASN1&#39;</span></a><span class="mpre">, </span><a href="Data.ASN1.Encoding.html#loc_51_1_51_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Encoding.html#loc_51_1_51_12&#39;)"><span class="mpre">encodeASN1&#39;</span></a><span class="mpre">)
import Data.ASN1.BinaryEncoding (</span><a href="Data.ASN1.BinaryEncoding.html#loc_30_6_30_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.BinaryEncoding.html#loc_30_6_30_9&#39;)"><span class="mpre">DER</span></a><span class="mpre">(..))
import Data.X509 (</span><a href="Data.X509.CertificateChain.html#loc_25_9_25_28" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.CertificateChain.html#loc_25_9_25_28&#39;)"><span class="mpre">CertificateChainRaw</span></a><span class="mpre">(..), </span><a href="Data.X509.CertificateChain.html#loc_41_1_41_23" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.CertificateChain.html#loc_41_1_41_23&#39;)"><span class="mpre">encodeCertificateChain</span></a><span class="mpre">, </span><a href="Data.X509.CertificateChain.html#loc_32_1_32_23" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.CertificateChain.html#loc_32_1_32_23&#39;)"><span class="mpre">decodeCertificateChain</span></a><span class="mpre">)
import Network.TLS.Crypto
import Network.TLS.MAC
import Network.TLS.Cipher (</span><a href="Network.TLS.Cipher.html#loc_40_6_40_27" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Cipher.html#loc_40_6_40_27&#39;)"><span class="mpre">CipherKeyExchangeType</span></a><span class="mpre">(..))
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Packet.hs&quot;, srcSpanStartLine = 70, srcSpanStartColumn = 8, srcSpanEndLine = 70, srcSpanEndColumn = 23}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> (ByteString)
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Packet.hs&quot;, srcSpanStartLine = 71, srcSpanStartColumn = 18, srcSpanEndLine = 71, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> as B
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Packet.hs&quot;, srcSpanStartLine = 72, srcSpanStartColumn = 18, srcSpanEndLine = 72, srcSpanEndColumn = 39}, srcInfoPoints = []}) &quot;Data.ByteString.Char8&quot;"><span class="mpre">Data.ByteString.Char8</span></span><span class="mpre"> as BC

import qualified Crypto.Hash.SHA1 as SHA1
import qualified Crypto.Hash.MD5 as MD5

data </span><a name="loc_77_6_77_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_6_77_19&#39;)"><span class="hl_tycondecl"><span class="mpre">CurrentParams</span></span></a><span class="mpre"> = </span><span class="hl_condecl"><span class="mpre">CurrentParams</span></span><span class="mpre">
    { </span><a name="loc_78_7_78_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_7_78_21&#39;)"><span class="hl_fielddecl"><span class="mpre">cParamsVersion</span></span></a><span class="mpre">     :: </span><a href="Network.TLS.Types.html#loc_25_6_25_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Types.html#loc_25_6_25_13&#39;)"><span class="hl_tyconref"><span class="mpre">Version</span></span></a><span class="mpre">                     </span><span class="hl_comment"><span class="mpre">-- ^ current protocol version</span></span><span class="mpre">
    , </span><a name="loc_79_7_79_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_7_79_25&#39;)"><span class="hl_fielddecl"><span class="mpre">cParamsKeyXchgType</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><a href="Network.TLS.Cipher.html#loc_40_6_40_27" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Cipher.html#loc_40_6_40_27&#39;)"><span class="hl_tyconref"><span class="mpre">CipherKeyExchangeType</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ current key exchange type</span></span><span class="mpre">
    , </span><a name="loc_80_7_80_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_7_80_24&#39;)"><span class="hl_fielddecl"><span class="mpre">cParamsSupportNPN</span></span></a><span class="mpre">  :: </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">                        </span><span class="hl_comment"><span class="mpre">-- ^ support Next Protocol Negotiation extension</span></span><span class="mpre">
    } </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Packet.hs&quot;, srcSpanStartLine = 81, srcSpanStartColumn = 7, srcSpanEndLine = 81, srcSpanEndColumn = 25}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Packet.hs&quot;, srcSpanStartLine = 81, srcSpanStartColumn = 7, srcSpanEndLine = 81, srcSpanEndColumn = 15},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Packet.hs&quot;, srcSpanStartLine = 81, srcSpa"><span class="mpre">deriving (Show,Eq)</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">{- marshall helpers -}</span></span><span class="mpre">
</span><a href="#loc_85_1_85_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_1_85_11&#39;)"><span class="mpre">getVersion</span></a><span class="mpre"> :: </span><a href="Data.Serialize.Get.html#loc_138_9_138_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Get.html#loc_138_9_138_12&#39;)"><span class="hl_tyconref"><span class="mpre">Get</span></span></a><span class="mpre"> </span><a href="Network.TLS.Types.html#loc_25_6_25_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Types.html#loc_25_6_25_13&#39;)"><span class="hl_tyconref"><span class="mpre">Version</span></span></a><span class="mpre">
</span><a name="loc_85_1_85_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_1_85_11&#39;)"><span class="hl_vardecl"><span class="mpre">getVersion</span></span></a><span class="mpre"> = do
    </span><a name="loc_86_5_86_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_5_86_10&#39;)"><span class="hl_vardecl"><span class="mpre">major</span></span></a><span class="mpre"> &lt;- </span><a href="Data.Serialize.Get.html#loc_467_1_467_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Get.html#loc_467_1_467_9&#39;)"><span class="hl_varref"><span class="mpre">getWord8</span></span></a><span class="mpre">
    </span><a name="loc_87_5_87_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_5_87_10&#39;)"><span class="hl_vardecl"><span class="mpre">minor</span></span></a><span class="mpre"> &lt;- </span><a href="Data.Serialize.Get.html#loc_467_1_467_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Get.html#loc_467_1_467_9&#39;)"><span class="hl_varref"><span class="mpre">getWord8</span></span></a><span class="mpre">
    case </span><a href="Network.TLS.Struct.html#loc_293_1_293_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_293_1_293_9&#39;)"><span class="hl_varref"><span class="mpre">verOfNum</span></span></a><span class="mpre"> (</span><a href="#loc_86_5_86_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_5_86_10&#39;)"><span class="hl_varref"><span class="mpre">major</span></span></a><span class="mpre">, </span><a href="#loc_87_5_87_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_5_87_10&#39;)"><span class="hl_varref"><span class="mpre">minor</span></span></a><span class="mpre">) of
        </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">fail</span></span><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;invalid version : &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_86_5_86_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_5_86_10&#39;)"><span class="hl_varref"><span class="mpre">major</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;,&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_87_5_87_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_5_87_10&#39;)"><span class="hl_varref"><span class="mpre">minor</span></span></a><span class="mpre">)
        </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_90_14_90_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_14_90_15&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">  -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_90_14_90_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_14_90_15&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">

</span><a href="#loc_93_1_93_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_1_93_11&#39;)"><span class="mpre">putVersion</span></a><span class="mpre"> :: </span><a href="Network.TLS.Types.html#loc_25_6_25_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Types.html#loc_25_6_25_13&#39;)"><span class="hl_tyconref"><span class="mpre">Version</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Put</span></span><span class="mpre">
</span><a name="loc_93_1_93_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_1_93_11&#39;)"><span class="hl_fundecl"><span class="mpre">putVersion</span></span></a><span class="mpre"> </span><a name="loc_93_12_93_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_12_93_15&#39;)"><span class="hl_vardecl"><span class="mpre">ver</span></span></a><span class="mpre"> = </span><a href="Data.Serialize.Put.html#loc_176_1_176_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Put.html#loc_176_1_176_9&#39;)"><span class="hl_varref"><span class="mpre">putWord8</span></span></a><span class="mpre"> </span><a href="#loc_94_10_94_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_10_94_15&#39;)"><span class="hl_varref"><span class="mpre">major</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="Data.Serialize.Put.html#loc_176_1_176_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Put.html#loc_176_1_176_9&#39;)"><span class="hl_varref"><span class="mpre">putWord8</span></span></a><span class="mpre"> </span><a href="#loc_94_17_94_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_17_94_22&#39;)"><span class="hl_varref"><span class="mpre">minor</span></span></a><span class="mpre">
  where (</span><a name="loc_94_10_94_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_10_94_15&#39;)"><span class="hl_vardecl"><span class="mpre">major</span></span></a><span class="mpre">, </span><a name="loc_94_17_94_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_17_94_22&#39;)"><span class="hl_vardecl"><span class="mpre">minor</span></span></a><span class="mpre">) = </span><a href="Network.TLS.Struct.html#loc_286_1_286_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_286_1_286_13&#39;)"><span class="hl_varref"><span class="mpre">numericalVer</span></span></a><span class="mpre"> </span><a href="#loc_93_12_93_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_12_93_15&#39;)"><span class="hl_varref"><span class="mpre">ver</span></span></a><span class="mpre">

</span><a href="#loc_97_1_97_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_1_97_14&#39;)"><span class="mpre">getHeaderType</span></a><span class="mpre"> :: </span><a href="Data.Serialize.Get.html#loc_138_9_138_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Get.html#loc_138_9_138_12&#39;)"><span class="hl_tyconref"><span class="mpre">Get</span></span></a><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_112_6_112_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_112_6_112_18&#39;)"><span class="hl_tyconref"><span class="mpre">ProtocolType</span></span></a><span class="mpre">
</span><a name="loc_97_1_97_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_1_97_14&#39;)"><span class="hl_vardecl"><span class="mpre">getHeaderType</span></span></a><span class="mpre"> = do
    </span><a name="loc_98_5_98_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_5_98_7&#39;)"><span class="hl_vardecl"><span class="mpre">ty</span></span></a><span class="mpre"> &lt;- </span><a href="Data.Serialize.Get.html#loc_467_1_467_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Get.html#loc_467_1_467_9&#39;)"><span class="hl_varref"><span class="mpre">getWord8</span></span></a><span class="mpre">
    case </span><a href="Network.TLS.Struct.html#loc_302_5_302_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_302_5_302_14&#39;)"><span class="hl_varref"><span class="mpre">valToType</span></span></a><span class="mpre"> </span><a href="#loc_98_5_98_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_5_98_7&#39;)"><span class="hl_varref"><span class="mpre">ty</span></span></a><span class="mpre"> of
        </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">fail</span></span><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;invalid header type: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_98_5_98_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_5_98_7&#39;)"><span class="hl_varref"><span class="mpre">ty</span></span></a><span class="mpre">)
        </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_101_14_101_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_14_101_15&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre">  -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_101_14_101_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_14_101_15&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">

</span><a href="#loc_104_1_104_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_1_104_14&#39;)"><span class="mpre">putHeaderType</span></a><span class="mpre"> :: </span><a href="Network.TLS.Struct.html#loc_112_6_112_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_112_6_112_18&#39;)"><span class="hl_tyconref"><span class="mpre">ProtocolType</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Put</span></span><span class="mpre">
</span><a name="loc_104_1_104_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_1_104_14&#39;)"><span class="hl_vardecl"><span class="mpre">putHeaderType</span></span></a><span class="mpre"> = </span><a href="Data.Serialize.Put.html#loc_176_1_176_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Put.html#loc_176_1_176_9&#39;)"><span class="hl_varref"><span class="mpre">putWord8</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_301_5_301_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_301_5_301_14&#39;)"><span class="hl_varref"><span class="mpre">valOfType</span></span></a><span class="mpre">

</span><a href="#loc_107_1_107_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_1_107_17&#39;)"><span class="mpre">getHandshakeType</span></a><span class="mpre"> :: </span><a href="Data.Serialize.Get.html#loc_138_9_138_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Get.html#loc_138_9_138_12&#39;)"><span class="hl_tyconref"><span class="mpre">Get</span></span></a><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_212_6_212_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_212_6_212_19&#39;)"><span class="hl_tyconref"><span class="mpre">HandshakeType</span></span></a><span class="mpre">
</span><a name="loc_107_1_107_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_1_107_17&#39;)"><span class="hl_vardecl"><span class="mpre">getHandshakeType</span></span></a><span class="mpre"> = do
    </span><a name="loc_108_5_108_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_5_108_7&#39;)"><span class="hl_vardecl"><span class="mpre">ty</span></span></a><span class="mpre"> &lt;- </span><a href="Data.Serialize.Get.html#loc_467_1_467_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Get.html#loc_467_1_467_9&#39;)"><span class="hl_varref"><span class="mpre">getWord8</span></span></a><span class="mpre">
    case </span><a href="Network.TLS.Struct.html#loc_302_5_302_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_302_5_302_14&#39;)"><span class="hl_varref"><span class="mpre">valToType</span></span></a><span class="mpre"> </span><a href="#loc_108_5_108_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_5_108_7&#39;)"><span class="hl_varref"><span class="mpre">ty</span></span></a><span class="mpre"> of
        </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">fail</span></span><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;invalid handshake type: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_108_5_108_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_5_108_7&#39;)"><span class="hl_varref"><span class="mpre">ty</span></span></a><span class="mpre">)
        </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_111_14_111_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_14_111_15&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre">  -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_111_14_111_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_14_111_15&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">{-
 - decode and encode headers
 -}</span></span><span class="mpre">
</span><a href="#loc_117_1_117_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_1_117_13&#39;)"><span class="mpre">decodeHeader</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_121_6_121_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_121_6_121_14&#39;)"><span class="hl_tyconref"><span class="mpre">TLSError</span></span></a><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_157_6_157_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_157_6_157_12&#39;)"><span class="hl_tyconref"><span class="mpre">Header</span></span></a><span class="mpre">
</span><a name="loc_117_1_117_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_1_117_13&#39;)"><span class="hl_vardecl"><span class="mpre">decodeHeader</span></span></a><span class="mpre"> = </span><a href="Network.TLS.Wire.html#loc_76_1_76_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Wire.html#loc_76_1_76_10&#39;)"><span class="hl_varref"><span class="mpre">runGetErr</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;header&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Control.Monad.html#loc_288_1_288_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_288_1_288_7&#39;)"><span class="hl_varref"><span class="mpre">liftM3</span></span></a><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_157_15_157_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_157_15_157_21&#39;)"><span class="hl_conref"><span class="mpre">Header</span></span></a><span class="mpre"> </span><a href="#loc_97_1_97_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_1_97_14&#39;)"><span class="hl_varref"><span class="mpre">getHeaderType</span></span></a><span class="mpre"> </span><a href="#loc_85_1_85_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_1_85_11&#39;)"><span class="hl_varref"><span class="mpre">getVersion</span></span></a><span class="mpre"> </span><a href="Network.TLS.Wire.html#loc_92_1_92_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Wire.html#loc_92_1_92_10&#39;)"><span class="hl_varref"><span class="mpre">getWord16</span></span></a><span class="mpre">

</span><a href="#loc_120_1_120_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_1_120_29&#39;)"><span class="mpre">decodeDeprecatedHeaderLength</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_121_6_121_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_121_6_121_14&#39;)"><span class="hl_tyconref"><span class="mpre">TLSError</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word16</span></span><span class="mpre">
</span><a name="loc_120_1_120_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_1_120_29&#39;)"><span class="hl_vardecl"><span class="mpre">decodeDeprecatedHeaderLength</span></span></a><span class="mpre"> = </span><a href="Network.TLS.Wire.html#loc_76_1_76_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Wire.html#loc_76_1_76_10&#39;)"><span class="hl_varref"><span class="mpre">runGetErr</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;deprecatedheaderlength&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">subtract</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x8000</span></span><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="Network.TLS.Wire.html#loc_92_1_92_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Wire.html#loc_92_1_92_10&#39;)"><span class="hl_varref"><span class="mpre">getWord16</span></span></a><span class="mpre">

</span><a href="#loc_123_1_123_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_1_123_23&#39;)"><span class="mpre">decodeDeprecatedHeader</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Word16</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_121_6_121_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_121_6_121_14&#39;)"><span class="hl_tyconref"><span class="mpre">TLSError</span></span></a><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_157_6_157_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_157_6_157_12&#39;)"><span class="hl_tyconref"><span class="mpre">Header</span></span></a><span class="mpre">
</span><a name="loc_123_1_123_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_1_123_23&#39;)"><span class="hl_fundecl"><span class="mpre">decodeDeprecatedHeader</span></span></a><span class="mpre"> </span><a name="loc_123_24_123_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_24_123_28&#39;)"><span class="hl_vardecl"><span class="mpre">size</span></span></a><span class="mpre"> =
    </span><a href="Network.TLS.Wire.html#loc_76_1_76_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Wire.html#loc_76_1_76_10&#39;)"><span class="hl_varref"><span class="mpre">runGetErr</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;deprecatedheader&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
        </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> &lt;- </span><a href="Data.Serialize.Get.html#loc_467_1_467_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Get.html#loc_467_1_467_9&#39;)"><span class="hl_varref"><span class="mpre">getWord8</span></span></a><span class="mpre">
        </span><a name="loc_126_9_126_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_9_126_16&#39;)"><span class="hl_vardecl"><span class="mpre">version</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_85_1_85_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_1_85_11&#39;)"><span class="hl_varref"><span class="mpre">getVersion</span></span></a><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_157_15_157_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_157_15_157_21&#39;)"><span class="hl_conref"><span class="mpre">Header</span></span></a><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_117_7_117_39" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_117_7_117_39&#39;)"><span class="hl_conref"><span class="mpre">ProtocolType_DeprecatedHandshake</span></span></a><span class="mpre"> </span><a href="#loc_126_9_126_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_9_126_16&#39;)"><span class="hl_varref"><span class="mpre">version</span></span></a><span class="mpre"> </span><a href="#loc_123_24_123_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_24_123_28&#39;)"><span class="hl_varref"><span class="mpre">size</span></span></a><span class="mpre">

</span><a href="#loc_130_1_130_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_1_130_13&#39;)"><span class="mpre">encodeHeader</span></a><span class="mpre"> :: </span><a href="Network.TLS.Struct.html#loc_157_6_157_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_157_6_157_12&#39;)"><span class="hl_tyconref"><span class="mpre">Header</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
</span><a name="loc_130_1_130_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_1_130_13&#39;)"><span class="hl_fundecl"><span class="mpre">encodeHeader</span></span></a><span class="mpre"> (</span><a href="Network.TLS.Struct.html#loc_157_15_157_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_157_15_157_21&#39;)"><span class="hl_conref"><span class="mpre">Header</span></span></a><span class="mpre"> </span><a name="loc_130_22_130_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_22_130_24&#39;)"><span class="hl_vardecl"><span class="mpre">pt</span></span></a><span class="mpre"> </span><a name="loc_130_25_130_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_25_130_28&#39;)"><span class="hl_vardecl"><span class="mpre">ver</span></span></a><span class="mpre"> </span><a name="loc_130_29_130_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_29_130_32&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre">) = </span><a href="Data.Serialize.Put.html#loc_148_1_148_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Put.html#loc_148_1_148_7&#39;)"><span class="hl_varref"><span class="mpre">runPut</span></span></a><span class="mpre"> (</span><a href="#loc_104_1_104_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_1_104_14&#39;)"><span class="hl_varref"><span class="mpre">putHeaderType</span></span></a><span class="mpre"> </span><a href="#loc_130_22_130_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_22_130_24&#39;)"><span class="hl_varref"><span class="mpre">pt</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="#loc_93_1_93_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_1_93_11&#39;)"><span class="hl_varref"><span class="mpre">putVersion</span></span></a><span class="mpre"> </span><a href="#loc_130_25_130_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_25_130_28&#39;)"><span class="hl_varref"><span class="mpre">ver</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="Network.TLS.Wire.html#loc_132_1_132_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Wire.html#loc_132_1_132_10&#39;)"><span class="hl_varref"><span class="mpre">putWord16</span></span></a><span class="mpre"> </span><a href="#loc_130_29_130_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_29_130_32&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre">)
        </span><span class="hl_comment"><span class="mpre">{- FIXME check len &lt;= 2^14 -}</span></span><span class="mpre">

</span><a href="#loc_134_1_134_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_1_134_18&#39;)"><span class="mpre">encodeHeaderNoVer</span></a><span class="mpre"> :: </span><a href="Network.TLS.Struct.html#loc_157_6_157_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_157_6_157_12&#39;)"><span class="hl_tyconref"><span class="mpre">Header</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
</span><a name="loc_134_1_134_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_1_134_18&#39;)"><span class="hl_fundecl"><span class="mpre">encodeHeaderNoVer</span></span></a><span class="mpre"> (</span><a href="Network.TLS.Struct.html#loc_157_15_157_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_157_15_157_21&#39;)"><span class="hl_conref"><span class="mpre">Header</span></span></a><span class="mpre"> </span><a name="loc_134_27_134_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_27_134_29&#39;)"><span class="hl_vardecl"><span class="mpre">pt</span></span></a><span class="mpre"> _ </span><a name="loc_134_32_134_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_32_134_35&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre">) = </span><a href="Data.Serialize.Put.html#loc_148_1_148_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Put.html#loc_148_1_148_7&#39;)"><span class="hl_varref"><span class="mpre">runPut</span></span></a><span class="mpre"> (</span><a href="#loc_104_1_104_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_1_104_14&#39;)"><span class="hl_varref"><span class="mpre">putHeaderType</span></span></a><span class="mpre"> </span><a href="#loc_134_27_134_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_27_134_29&#39;)"><span class="hl_varref"><span class="mpre">pt</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="Network.TLS.Wire.html#loc_132_1_132_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Wire.html#loc_132_1_132_10&#39;)"><span class="hl_varref"><span class="mpre">putWord16</span></span></a><span class="mpre"> </span><a href="#loc_134_32_134_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_32_134_35&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre">)
        </span><span class="hl_comment"><span class="mpre">{- FIXME check len &lt;= 2^14 -}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">{-
 - decode and encode ALERT
 -}</span></span><span class="mpre">
</span><a href="#loc_141_1_141_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_1_141_12&#39;)"><span class="mpre">decodeAlert</span></a><span class="mpre"> :: </span><a href="Data.Serialize.Get.html#loc_138_9_138_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Get.html#loc_138_9_138_12&#39;)"><span class="hl_tyconref"><span class="mpre">Get</span></span></a><span class="mpre"> (</span><a href="Network.TLS.Struct.html#loc_176_6_176_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_176_6_176_16&#39;)"><span class="hl_tyconref"><span class="mpre">AlertLevel</span></span></a><span class="mpre">, </span><a href="Network.TLS.Struct.html#loc_181_6_181_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_181_6_181_22&#39;)"><span class="hl_tyconref"><span class="mpre">AlertDescription</span></span></a><span class="mpre">)
</span><a name="loc_141_1_141_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_1_141_12&#39;)"><span class="hl_vardecl"><span class="mpre">decodeAlert</span></span></a><span class="mpre"> = do
    </span><a name="loc_142_5_142_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_5_142_7&#39;)"><span class="hl_vardecl"><span class="mpre">al</span></span></a><span class="mpre"> &lt;- </span><a href="Data.Serialize.Get.html#loc_467_1_467_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Get.html#loc_467_1_467_9&#39;)"><span class="hl_varref"><span class="mpre">getWord8</span></span></a><span class="mpre">
    </span><a name="loc_143_5_143_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_5_143_7&#39;)"><span class="hl_vardecl"><span class="mpre">ad</span></span></a><span class="mpre"> &lt;- </span><a href="Data.Serialize.Get.html#loc_467_1_467_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Get.html#loc_467_1_467_9&#39;)"><span class="hl_varref"><span class="mpre">getWord8</span></span></a><span class="mpre">
    case (</span><a href="Network.TLS.Struct.html#loc_302_5_302_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_302_5_302_14&#39;)"><span class="hl_varref"><span class="mpre">valToType</span></span></a><span class="mpre"> </span><a href="#loc_142_5_142_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_5_142_7&#39;)"><span class="hl_varref"><span class="mpre">al</span></span></a><span class="mpre">, </span><a href="Network.TLS.Struct.html#loc_302_5_302_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_302_5_302_14&#39;)"><span class="hl_varref"><span class="mpre">valToType</span></span></a><span class="mpre"> </span><a href="#loc_143_5_143_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_5_143_7&#39;)"><span class="hl_varref"><span class="mpre">ad</span></span></a><span class="mpre">) of
        (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_145_15_145_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_15_145_16&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">, </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_145_23_145_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_23_145_24&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre">) -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_145_15_145_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_15_145_16&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">, </span><a href="#loc_145_23_145_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_145_23_145_24&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre">)
        (</span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">, _)     -&gt; </span><span class="hl_varref"><span class="mpre">fail</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;cannot decode alert level&quot;</span></span><span class="mpre">
        (_, </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">)     -&gt; </span><span class="hl_varref"><span class="mpre">fail</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;cannot decode alert description&quot;</span></span><span class="mpre">

</span><a href="#loc_150_1_150_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_1_150_13&#39;)"><span class="mpre">decodeAlerts</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_121_6_121_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_121_6_121_14&#39;)"><span class="hl_tyconref"><span class="mpre">TLSError</span></span></a><span class="mpre"> [(</span><a href="Network.TLS.Struct.html#loc_176_6_176_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_176_6_176_16&#39;)"><span class="hl_tyconref"><span class="mpre">AlertLevel</span></span></a><span class="mpre">, </span><a href="Network.TLS.Struct.html#loc_181_6_181_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_181_6_181_22&#39;)"><span class="hl_tyconref"><span class="mpre">AlertDescription</span></span></a><span class="mpre">)]
</span><a name="loc_150_1_150_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_1_150_13&#39;)"><span class="hl_vardecl"><span class="mpre">decodeAlerts</span></span></a><span class="mpre"> = </span><a href="Network.TLS.Wire.html#loc_76_1_76_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Wire.html#loc_76_1_76_10&#39;)"><span class="hl_varref"><span class="mpre">runGetErr</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;alerts&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_151_9_151_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_9_151_13&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre">
  where </span><a name="loc_151_9_151_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_9_151_13&#39;)"><span class="hl_vardecl"><span class="mpre">loop</span></span></a><span class="mpre"> = do
            </span><a name="loc_152_13_152_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_13_152_14&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> &lt;- </span><a href="Data.Serialize.Get.html#loc_408_1_408_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Get.html#loc_408_1_408_10&#39;)"><span class="hl_varref"><span class="mpre">remaining</span></span></a><span class="mpre">
            if </span><a href="#loc_152_13_152_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_13_152_14&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
                then </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> []
                else </span><a href="Control.Monad.html#loc_283_1_283_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_283_1_283_7&#39;)"><span class="hl_varref"><span class="mpre">liftM2</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">(:)</span></span><span class="mpre"> </span><a href="#loc_141_1_141_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_1_141_12&#39;)"><span class="hl_varref"><span class="mpre">decodeAlert</span></span></a><span class="mpre"> </span><a href="#loc_151_9_151_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_9_151_13&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre">

</span><a href="#loc_158_1_158_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_1_158_13&#39;)"><span class="mpre">encodeAlerts</span></a><span class="mpre"> :: [(</span><a href="Network.TLS.Struct.html#loc_176_6_176_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_176_6_176_16&#39;)"><span class="hl_tyconref"><span class="mpre">AlertLevel</span></span></a><span class="mpre">, </span><a href="Network.TLS.Struct.html#loc_181_6_181_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_181_6_181_22&#39;)"><span class="hl_tyconref"><span class="mpre">AlertDescription</span></span></a><span class="mpre">)] -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
</span><a name="loc_158_1_158_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_1_158_13&#39;)"><span class="hl_fundecl"><span class="mpre">encodeAlerts</span></span></a><span class="mpre"> </span><a name="loc_158_14_158_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_14_158_15&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> = </span><a href="Data.Serialize.Put.html#loc_148_1_148_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Put.html#loc_148_1_148_7&#39;)"><span class="hl_varref"><span class="mpre">runPut</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Control.Monad.html#loc_116_1_116_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_116_1_116_6&#39;)"><span class="hl_varref"><span class="mpre">mapM_</span></span></a><span class="mpre"> </span><a href="#loc_159_9_159_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_9_159_20&#39;)"><span class="hl_varref"><span class="mpre">encodeAlert</span></span></a><span class="mpre"> </span><a href="#loc_158_14_158_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_158_14_158_15&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">
  where </span><a name="loc_159_9_159_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_9_159_20&#39;)"><span class="hl_fundecl"><span class="mpre">encodeAlert</span></span></a><span class="mpre"> (</span><a name="loc_159_22_159_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_22_159_24&#39;)"><span class="hl_vardecl"><span class="mpre">al</span></span></a><span class="mpre">, </span><a name="loc_159_26_159_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_26_159_28&#39;)"><span class="hl_vardecl"><span class="mpre">ad</span></span></a><span class="mpre">) = </span><a href="Data.Serialize.Put.html#loc_176_1_176_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Put.html#loc_176_1_176_9&#39;)"><span class="hl_varref"><span class="mpre">putWord8</span></span></a><span class="mpre"> (</span><a href="Network.TLS.Struct.html#loc_301_5_301_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_301_5_301_14&#39;)"><span class="hl_varref"><span class="mpre">valOfType</span></span></a><span class="mpre"> </span><a href="#loc_159_22_159_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_22_159_24&#39;)"><span class="hl_varref"><span class="mpre">al</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="Data.Serialize.Put.html#loc_176_1_176_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Put.html#loc_176_1_176_9&#39;)"><span class="hl_varref"><span class="mpre">putWord8</span></span></a><span class="mpre"> (</span><a href="Network.TLS.Struct.html#loc_301_5_301_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_301_5_301_14&#39;)"><span class="hl_varref"><span class="mpre">valOfType</span></span></a><span class="mpre"> </span><a href="#loc_159_26_159_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_26_159_28&#39;)"><span class="hl_varref"><span class="mpre">ad</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">{- decode and encode HANDSHAKE -}</span></span><span class="mpre">
</span><a href="#loc_163_1_163_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_1_163_22&#39;)"><span class="mpre">decodeHandshakeRecord</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><a href="Network.TLS.Wire.html#loc_61_6_61_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Wire.html#loc_61_6_61_15&#39;)"><span class="hl_tyconref"><span class="mpre">GetResult</span></span></a><span class="mpre"> (</span><a href="Network.TLS.Struct.html#loc_212_6_212_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_212_6_212_19&#39;)"><span class="hl_tyconref"><span class="mpre">HandshakeType</span></span></a><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Bytes</span></span><span class="mpre">)
</span><a name="loc_163_1_163_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_1_163_22&#39;)"><span class="hl_vardecl"><span class="mpre">decodeHandshakeRecord</span></span></a><span class="mpre"> = </span><a href="Network.TLS.Wire.html#loc_68_1_68_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Wire.html#loc_68_1_68_7&#39;)"><span class="hl_varref"><span class="mpre">runGet</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;handshake-record&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
    </span><a name="loc_164_5_164_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_5_164_7&#39;)"><span class="hl_vardecl"><span class="mpre">ty</span></span></a><span class="mpre">      &lt;- </span><a href="#loc_107_1_107_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_1_107_17&#39;)"><span class="hl_varref"><span class="mpre">getHandshakeType</span></span></a><span class="mpre">
    </span><a name="loc_165_5_165_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_5_165_12&#39;)"><span class="hl_vardecl"><span class="mpre">content</span></span></a><span class="mpre"> &lt;- </span><a href="Network.TLS.Wire.html#loc_111_1_111_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Wire.html#loc_111_1_111_12&#39;)"><span class="hl_varref"><span class="mpre">getOpaque24</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_164_5_164_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_5_164_7&#39;)"><span class="hl_varref"><span class="mpre">ty</span></span></a><span class="mpre">, </span><a href="#loc_165_5_165_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_165_5_165_12&#39;)"><span class="hl_varref"><span class="mpre">content</span></span></a><span class="mpre">)

</span><a href="#loc_169_1_169_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_1_169_16&#39;)"><span class="mpre">decodeHandshake</span></a><span class="mpre"> :: </span><a href="#loc_77_6_77_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_6_77_19&#39;)"><span class="hl_tyconref"><span class="mpre">CurrentParams</span></span></a><span class="mpre"> -&gt; </span><a href="Network.TLS.Struct.html#loc_212_6_212_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_212_6_212_19&#39;)"><span class="hl_tyconref"><span class="mpre">HandshakeType</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_121_6_121_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_121_6_121_14&#39;)"><span class="hl_tyconref"><span class="mpre">TLSError</span></span></a><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_252_6_252_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_252_6_252_15&#39;)"><span class="hl_tyconref"><span class="mpre">Handshake</span></span></a><span class="mpre">
</span><a name="loc_169_1_169_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_1_169_16&#39;)"><span class="hl_fundecl"><span class="mpre">decodeHandshake</span></span></a><span class="mpre"> </span><a name="loc_169_17_169_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_17_169_19&#39;)"><span class="hl_vardecl"><span class="mpre">cp</span></span></a><span class="mpre"> </span><a name="loc_169_20_169_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_20_169_22&#39;)"><span class="hl_vardecl"><span class="mpre">ty</span></span></a><span class="mpre"> = </span><a href="Network.TLS.Wire.html#loc_76_1_76_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Wire.html#loc_76_1_76_10&#39;)"><span class="hl_varref"><span class="mpre">runGetErr</span></span></a><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;handshake[&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_169_20_169_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_20_169_22&#39;)"><span class="hl_varref"><span class="mpre">ty</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;]&quot;</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> case </span><a href="#loc_169_20_169_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_20_169_22&#39;)"><span class="hl_varref"><span class="mpre">ty</span></span></a><span class="mpre"> of
    </span><a href="Network.TLS.Struct.html#loc_213_7_213_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_213_7_213_33&#39;)"><span class="hl_conref"><span class="mpre">HandshakeType_HelloRequest</span></span></a><span class="mpre">    -&gt; </span><a href="#loc_207_1_207_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_207_1_207_19&#39;)"><span class="hl_varref"><span class="mpre">decodeHelloRequest</span></span></a><span class="mpre">
    </span><a href="Network.TLS.Struct.html#loc_214_7_214_32" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_214_7_214_32&#39;)"><span class="hl_conref"><span class="mpre">HandshakeType_ClientHello</span></span></a><span class="mpre">     -&gt; </span><a href="#loc_210_1_210_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_1_210_18&#39;)"><span class="hl_varref"><span class="mpre">decodeClientHello</span></span></a><span class="mpre">
    </span><a href="Network.TLS.Struct.html#loc_215_7_215_32" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_215_7_215_32&#39;)"><span class="hl_conref"><span class="mpre">HandshakeType_ServerHello</span></span></a><span class="mpre">     -&gt; </span><a href="#loc_223_1_223_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_1_223_18&#39;)"><span class="hl_varref"><span class="mpre">decodeServerHello</span></span></a><span class="mpre">
    </span><a href="Network.TLS.Struct.html#loc_216_7_216_32" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_216_7_216_32&#39;)"><span class="hl_conref"><span class="mpre">HandshakeType_Certificate</span></span></a><span class="mpre">     -&gt; </span><a href="#loc_239_1_239_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_1_239_19&#39;)"><span class="hl_varref"><span class="mpre">decodeCertificates</span></span></a><span class="mpre">
    </span><a href="Network.TLS.Struct.html#loc_217_7_217_34" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_217_7_217_34&#39;)"><span class="hl_conref"><span class="mpre">HandshakeType_ServerKeyXchg</span></span></a><span class="mpre">   -&gt; </span><a href="#loc_320_1_320_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_320_1_320_20&#39;)"><span class="hl_varref"><span class="mpre">decodeServerKeyXchg</span></span></a><span class="mpre"> </span><a href="#loc_169_17_169_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_17_169_19&#39;)"><span class="hl_varref"><span class="mpre">cp</span></span></a><span class="mpre">
    </span><a href="Network.TLS.Struct.html#loc_218_7_218_32" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_218_7_218_32&#39;)"><span class="hl_conref"><span class="mpre">HandshakeType_CertRequest</span></span></a><span class="mpre">     -&gt; </span><a href="#loc_256_1_256_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_256_1_256_18&#39;)"><span class="hl_varref"><span class="mpre">decodeCertRequest</span></span></a><span class="mpre"> </span><a href="#loc_169_17_169_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_17_169_19&#39;)"><span class="hl_varref"><span class="mpre">cp</span></span></a><span class="mpre">
    </span><a href="Network.TLS.Struct.html#loc_219_7_219_36" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_219_7_219_36&#39;)"><span class="hl_conref"><span class="mpre">HandshakeType_ServerHelloDone</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_236_1_236_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_1_236_22&#39;)"><span class="hl_varref"><span class="mpre">decodeServerHelloDone</span></span></a><span class="mpre">
    </span><a href="Network.TLS.Struct.html#loc_220_7_220_31" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_220_7_220_31&#39;)"><span class="hl_conref"><span class="mpre">HandshakeType_CertVerify</span></span></a><span class="mpre">      -&gt; </span><a href="#loc_279_1_279_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_279_1_279_17&#39;)"><span class="hl_varref"><span class="mpre">decodeCertVerify</span></span></a><span class="mpre"> </span><a href="#loc_169_17_169_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_17_169_19&#39;)"><span class="hl_varref"><span class="mpre">cp</span></span></a><span class="mpre">
    </span><a href="Network.TLS.Struct.html#loc_221_7_221_34" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_221_7_221_34&#39;)"><span class="hl_conref"><span class="mpre">HandshakeType_ClientKeyXchg</span></span></a><span class="mpre">   -&gt; </span><a href="#loc_282_1_282_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_282_1_282_20&#39;)"><span class="hl_varref"><span class="mpre">decodeClientKeyXchg</span></span></a><span class="mpre"> </span><a href="#loc_169_17_169_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_17_169_19&#39;)"><span class="hl_varref"><span class="mpre">cp</span></span></a><span class="mpre">
    </span><a href="Network.TLS.Struct.html#loc_222_7_222_29" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_222_7_222_29&#39;)"><span class="hl_conref"><span class="mpre">HandshakeType_Finished</span></span></a><span class="mpre">        -&gt; </span><a href="#loc_247_1_247_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_247_1_247_15&#39;)"><span class="hl_varref"><span class="mpre">decodeFinished</span></span></a><span class="mpre">
    </span><a href="Network.TLS.Struct.html#loc_223_7_223_24" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_223_7_223_24&#39;)"><span class="hl_conref"><span class="mpre">HandshakeType_NPN</span></span></a><span class="mpre">             -&gt; do
        </span><a href="Control.Monad.html#loc_270_1_270_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_270_1_270_7&#39;)"><span class="hl_varref"><span class="mpre">unless</span></span></a><span class="mpre"> (</span><a href="#loc_80_7_80_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_7_80_24&#39;)"><span class="hl_varref"><span class="mpre">cParamsSupportNPN</span></span></a><span class="mpre"> </span><a href="#loc_169_17_169_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_17_169_19&#39;)"><span class="hl_varref"><span class="mpre">cp</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fail</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;unsupported handshake type&quot;</span></span><span class="mpre">
        </span><a href="#loc_250_1_250_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_1_250_30&#39;)"><span class="hl_varref"><span class="mpre">decodeNextProtocolNegotiation</span></span></a><span class="mpre">

</span><a href="#loc_185_1_185_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_1_185_26&#39;)"><span class="mpre">decodeDeprecatedHandshake</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_121_6_121_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_121_6_121_14&#39;)"><span class="hl_tyconref"><span class="mpre">TLSError</span></span></a><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_252_6_252_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_252_6_252_15&#39;)"><span class="hl_tyconref"><span class="mpre">Handshake</span></span></a><span class="mpre">
</span><a name="loc_185_1_185_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_1_185_26&#39;)"><span class="hl_fundecl"><span class="mpre">decodeDeprecatedHandshake</span></span></a><span class="mpre"> </span><a name="loc_185_27_185_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_27_185_28&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> = </span><a href="Network.TLS.Wire.html#loc_76_1_76_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Wire.html#loc_76_1_76_10&#39;)"><span class="hl_varref"><span class="mpre">runGetErr</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;deprecatedhandshake&quot;</span></span><span class="mpre"> </span><a href="#loc_186_9_186_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_9_186_22&#39;)"><span class="hl_varref"><span class="mpre">getDeprecated</span></span></a><span class="mpre"> </span><a href="#loc_185_27_185_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_27_185_28&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">
  where </span><a name="loc_186_9_186_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_186_9_186_22&#39;)"><span class="hl_vardecl"><span class="mpre">getDeprecated</span></span></a><span class="mpre"> = do
            </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> &lt;- </span><a href="Data.Serialize.Get.html#loc_467_1_467_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Get.html#loc_467_1_467_9&#39;)"><span class="hl_varref"><span class="mpre">getWord8</span></span></a><span class="mpre">
            </span><a name="loc_188_13_188_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_13_188_16&#39;)"><span class="hl_vardecl"><span class="mpre">ver</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_85_1_85_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_1_85_11&#39;)"><span class="hl_varref"><span class="mpre">getVersion</span></span></a><span class="mpre">
            </span><a name="loc_189_13_189_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_13_189_26&#39;)"><span class="hl_vardecl"><span class="mpre">cipherSpecLen</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">fromEnum</span></span><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="Network.TLS.Wire.html#loc_92_1_92_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Wire.html#loc_92_1_92_10&#39;)"><span class="hl_varref"><span class="mpre">getWord16</span></span></a><span class="mpre">
            </span><a name="loc_190_13_190_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_13_190_25&#39;)"><span class="hl_vardecl"><span class="mpre">sessionIdLen</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">fromEnum</span></span><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="Network.TLS.Wire.html#loc_92_1_92_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Wire.html#loc_92_1_92_10&#39;)"><span class="hl_varref"><span class="mpre">getWord16</span></span></a><span class="mpre">
            </span><a name="loc_191_13_191_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_13_191_25&#39;)"><span class="hl_vardecl"><span class="mpre">challengeLen</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">fromEnum</span></span><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="Network.TLS.Wire.html#loc_92_1_92_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Wire.html#loc_92_1_92_10&#39;)"><span class="hl_varref"><span class="mpre">getWord16</span></span></a><span class="mpre">
            </span><a name="loc_192_13_192_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_13_192_20&#39;)"><span class="hl_vardecl"><span class="mpre">ciphers</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_197_9_197_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_9_197_22&#39;)"><span class="hl_varref"><span class="mpre">getCipherSpec</span></span></a><span class="mpre"> </span><a href="#loc_189_13_189_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_13_189_26&#39;)"><span class="hl_varref"><span class="mpre">cipherSpecLen</span></span></a><span class="mpre">
            </span><a name="loc_193_13_193_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_13_193_20&#39;)"><span class="hl_vardecl"><span class="mpre">session</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_201_9_201_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_9_201_21&#39;)"><span class="hl_varref"><span class="mpre">getSessionId</span></span></a><span class="mpre"> </span><a href="#loc_190_13_190_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_13_190_25&#39;)"><span class="hl_varref"><span class="mpre">sessionIdLen</span></span></a><span class="mpre">
            </span><a name="loc_194_13_194_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_13_194_19&#39;)"><span class="hl_vardecl"><span class="mpre">random</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_203_9_203_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_9_203_21&#39;)"><span class="hl_varref"><span class="mpre">getChallenge</span></span></a><span class="mpre"> </span><a href="#loc_191_13_191_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_13_191_25&#39;)"><span class="hl_varref"><span class="mpre">challengeLen</span></span></a><span class="mpre">
            let </span><a name="loc_195_17_195_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_17_195_29&#39;)"><span class="hl_vardecl"><span class="mpre">compressions</span></span></a><span class="mpre"> = [</span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">]
            </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_253_7_253_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_253_7_253_18&#39;)"><span class="hl_conref"><span class="mpre">ClientHello</span></span></a><span class="mpre"> </span><a href="#loc_188_13_188_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_13_188_16&#39;)"><span class="hl_varref"><span class="mpre">ver</span></span></a><span class="mpre"> </span><a href="#loc_194_13_194_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_194_13_194_19&#39;)"><span class="hl_varref"><span class="mpre">random</span></span></a><span class="mpre"> </span><a href="#loc_193_13_193_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_193_13_193_20&#39;)"><span class="hl_varref"><span class="mpre">session</span></span></a><span class="mpre"> </span><a href="#loc_192_13_192_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_13_192_20&#39;)"><span class="hl_varref"><span class="mpre">ciphers</span></span></a><span class="mpre"> </span><a href="#loc_195_17_195_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_17_195_29&#39;)"><span class="hl_varref"><span class="mpre">compressions</span></span></a><span class="mpre"> [] (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="#loc_185_27_185_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_27_185_28&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">)
        </span><a name="loc_197_9_197_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_9_197_22&#39;)"><span class="hl_fundecl"><span class="mpre">getCipherSpec</span></span></a><span class="mpre"> </span><a name="loc_197_23_197_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_23_197_26&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre"> | </span><a href="#loc_197_23_197_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_23_197_26&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> []
        </span><a href="#loc_197_9_197_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_9_197_22&#39;)"><span class="hl_fundecl"><span class="mpre">getCipherSpec</span></span></a><span class="mpre"> </span><a name="loc_198_23_198_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_23_198_26&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre"> = do
            [</span><a name="loc_199_14_199_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_14_199_16&#39;)"><span class="hl_vardecl"><span class="mpre">c0</span></span></a><span class="mpre">,</span><a name="loc_199_17_199_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_17_199_19&#39;)"><span class="hl_vardecl"><span class="mpre">c1</span></span></a><span class="mpre">,</span><a name="loc_199_20_199_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_20_199_22&#39;)"><span class="hl_vardecl"><span class="mpre">c2</span></span></a><span class="mpre">] &lt;- </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromEnum</span></span><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="Control.Monad.html#loc_250_1_250_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_250_1_250_11&#39;)"><span class="hl_varref"><span class="mpre">replicateM</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre"> </span><a href="Data.Serialize.Get.html#loc_467_1_467_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Get.html#loc_467_1_467_9&#39;)"><span class="hl_varref"><span class="mpre">getWord8</span></span></a><span class="mpre">
            ([ </span><span class="hl_varref"><span class="mpre">toEnum</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_199_17_199_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_17_199_19&#39;)"><span class="hl_varref"><span class="mpre">c1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x100</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_199_20_199_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_20_199_22&#39;)"><span class="hl_varref"><span class="mpre">c2</span></span></a><span class="mpre"> | </span><a href="#loc_199_14_199_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_14_199_16&#39;)"><span class="hl_varref"><span class="mpre">c0</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> ] </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">) </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="#loc_197_9_197_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_9_197_22&#39;)"><span class="hl_varref"><span class="mpre">getCipherSpec</span></span></a><span class="mpre"> (</span><a href="#loc_198_23_198_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_23_198_26&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">)
        </span><a name="loc_201_9_201_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_9_201_21&#39;)"><span class="hl_fundecl"><span class="mpre">getSessionId</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_161_19_161_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_161_19_161_26&#39;)"><span class="hl_conref"><span class="mpre">Session</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
        </span><a href="#loc_201_9_201_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_9_201_21&#39;)"><span class="hl_fundecl"><span class="mpre">getSessionId</span></span></a><span class="mpre"> </span><a name="loc_202_22_202_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_22_202_25&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre"> = </span><a href="Network.TLS.Struct.html#loc_161_19_161_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_161_19_161_26&#39;)"><span class="hl_conref"><span class="mpre">Session</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="Data.Serialize.Get.html#loc_438_1_438_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Get.html#loc_438_1_438_9&#39;)"><span class="hl_varref"><span class="mpre">getBytes</span></span></a><span class="mpre"> </span><a href="#loc_202_22_202_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_202_22_202_25&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre">
        </span><a name="loc_203_9_203_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_9_203_21&#39;)"><span class="hl_fundecl"><span class="mpre">getChallenge</span></span></a><span class="mpre"> </span><a name="loc_203_22_203_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_22_203_25&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre"> | </span><span class="hl_num"><span class="mpre">32</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_203_22_203_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_22_203_25&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre"> = </span><a href="Data.Serialize.Get.html#loc_438_1_438_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Get.html#loc_438_1_438_9&#39;)"><span class="hl_varref"><span class="mpre">getBytes</span></span></a><span class="mpre"> (</span><a href="#loc_203_22_203_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_22_203_25&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">32</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="#loc_203_9_203_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_9_203_21&#39;)"><span class="hl_varref"><span class="mpre">getChallenge</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">32</span></span><span class="mpre">
        </span><a href="#loc_203_9_203_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_9_203_21&#39;)"><span class="hl_fundecl"><span class="mpre">getChallenge</span></span></a><span class="mpre"> </span><a name="loc_204_22_204_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_22_204_25&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre"> = </span><a href="Network.TLS.Struct.html#loc_160_24_160_36" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_160_24_160_36&#39;)"><span class="hl_conref"><span class="mpre">ClientRandom</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.append</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">B.replicate</span></span><span class="mpre"> (</span><span class="hl_num"><span class="mpre">32</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><a href="#loc_204_22_204_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_22_204_25&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre">) </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">) </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="Data.Serialize.Get.html#loc_438_1_438_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Get.html#loc_438_1_438_9&#39;)"><span class="hl_varref"><span class="mpre">getBytes</span></span></a><span class="mpre"> </span><a href="#loc_204_22_204_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_22_204_25&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre">

</span><a href="#loc_207_1_207_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_207_1_207_19&#39;)"><span class="mpre">decodeHelloRequest</span></a><span class="mpre"> :: </span><a href="Data.Serialize.Get.html#loc_138_9_138_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Get.html#loc_138_9_138_12&#39;)"><span class="hl_tyconref"><span class="mpre">Get</span></span></a><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_252_6_252_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_252_6_252_15&#39;)"><span class="hl_tyconref"><span class="mpre">Handshake</span></span></a><span class="mpre">
</span><a name="loc_207_1_207_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_207_1_207_19&#39;)"><span class="hl_vardecl"><span class="mpre">decodeHelloRequest</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_256_7_256_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_256_7_256_19&#39;)"><span class="hl_conref"><span class="mpre">HelloRequest</span></span></a><span class="mpre">

</span><a href="#loc_210_1_210_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_1_210_18&#39;)"><span class="mpre">decodeClientHello</span></a><span class="mpre"> :: </span><a href="Data.Serialize.Get.html#loc_138_9_138_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Get.html#loc_138_9_138_12&#39;)"><span class="hl_tyconref"><span class="mpre">Get</span></span></a><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_252_6_252_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_252_6_252_15&#39;)"><span class="hl_tyconref"><span class="mpre">Handshake</span></span></a><span class="mpre">
</span><a name="loc_210_1_210_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_210_1_210_18&#39;)"><span class="hl_vardecl"><span class="mpre">decodeClientHello</span></span></a><span class="mpre"> = do
    </span><a name="loc_211_5_211_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_211_5_211_8&#39;)"><span class="hl_vardecl"><span class="mpre">ver</span></span></a><span class="mpre">          &lt;- </span><a href="#loc_85_1_85_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_1_85_11&#39;)"><span class="hl_varref"><span class="mpre">getVersion</span></span></a><span class="mpre">
    </span><a name="loc_212_5_212_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_5_212_11&#39;)"><span class="hl_vardecl"><span class="mpre">random</span></span></a><span class="mpre">       &lt;- </span><a href="#loc_411_1_411_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_411_1_411_18&#39;)"><span class="hl_varref"><span class="mpre">getClientRandom32</span></span></a><span class="mpre">
    </span><a name="loc_213_5_213_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_5_213_12&#39;)"><span class="hl_vardecl"><span class="mpre">session</span></span></a><span class="mpre">      &lt;- </span><a href="#loc_423_1_423_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_423_1_423_11&#39;)"><span class="hl_varref"><span class="mpre">getSession</span></span></a><span class="mpre">
    </span><a name="loc_214_5_214_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_5_214_12&#39;)"><span class="hl_vardecl"><span class="mpre">ciphers</span></span></a><span class="mpre">      &lt;- </span><a href="Network.TLS.Wire.html#loc_95_1_95_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Wire.html#loc_95_1_95_11&#39;)"><span class="hl_varref"><span class="mpre">getWords16</span></span></a><span class="mpre">
    </span><a name="loc_215_5_215_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_5_215_17&#39;)"><span class="hl_vardecl"><span class="mpre">compressions</span></span></a><span class="mpre"> &lt;- </span><a href="Network.TLS.Wire.html#loc_89_1_89_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Wire.html#loc_89_1_89_10&#39;)"><span class="hl_varref"><span class="mpre">getWords8</span></span></a><span class="mpre">
    </span><a name="loc_216_5_216_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_5_216_6&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">            &lt;- </span><a href="Data.Serialize.Get.html#loc_408_1_408_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Get.html#loc_408_1_408_10&#39;)"><span class="hl_varref"><span class="mpre">remaining</span></span></a><span class="mpre">
    </span><a name="loc_217_5_217_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_5_217_9&#39;)"><span class="hl_vardecl"><span class="mpre">exts</span></span></a><span class="mpre"> &lt;- if </span><a href="Network.TLS.Cap.html#loc_18_1_18_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Cap.html#loc_18_1_18_19&#39;)"><span class="hl_varref"><span class="mpre">hasHelloExtensions</span></span></a><span class="mpre"> </span><a href="#loc_211_5_211_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_211_5_211_8&#39;)"><span class="hl_varref"><span class="mpre">ver</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_216_5_216_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_216_5_216_6&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
            then </span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="Network.TLS.Wire.html#loc_92_1_92_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Wire.html#loc_92_1_92_10&#39;)"><span class="hl_varref"><span class="mpre">getWord16</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="#loc_434_1_434_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_434_1_434_14&#39;)"><span class="hl_varref"><span class="mpre">getExtensions</span></span></a><span class="mpre">
            else </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> []
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_253_7_253_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_253_7_253_18&#39;)"><span class="hl_conref"><span class="mpre">ClientHello</span></span></a><span class="mpre"> </span><a href="#loc_211_5_211_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_211_5_211_8&#39;)"><span class="hl_varref"><span class="mpre">ver</span></span></a><span class="mpre"> </span><a href="#loc_212_5_212_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_212_5_212_11&#39;)"><span class="hl_varref"><span class="mpre">random</span></span></a><span class="mpre"> </span><a href="#loc_213_5_213_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_213_5_213_12&#39;)"><span class="hl_varref"><span class="mpre">session</span></span></a><span class="mpre"> </span><a href="#loc_214_5_214_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_214_5_214_12&#39;)"><span class="hl_varref"><span class="mpre">ciphers</span></span></a><span class="mpre"> </span><a href="#loc_215_5_215_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_5_215_17&#39;)"><span class="hl_varref"><span class="mpre">compressions</span></span></a><span class="mpre"> </span><a href="#loc_217_5_217_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_217_5_217_9&#39;)"><span class="hl_varref"><span class="mpre">exts</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">

</span><a href="#loc_223_1_223_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_1_223_18&#39;)"><span class="mpre">decodeServerHello</span></a><span class="mpre"> :: </span><a href="Data.Serialize.Get.html#loc_138_9_138_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Get.html#loc_138_9_138_12&#39;)"><span class="hl_tyconref"><span class="mpre">Get</span></span></a><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_252_6_252_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_252_6_252_15&#39;)"><span class="hl_tyconref"><span class="mpre">Handshake</span></span></a><span class="mpre">
</span><a name="loc_223_1_223_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_223_1_223_18&#39;)"><span class="hl_vardecl"><span class="mpre">decodeServerHello</span></span></a><span class="mpre"> = do
    </span><a name="loc_224_5_224_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_5_224_8&#39;)"><span class="hl_vardecl"><span class="mpre">ver</span></span></a><span class="mpre">           &lt;- </span><a href="#loc_85_1_85_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_1_85_11&#39;)"><span class="hl_varref"><span class="mpre">getVersion</span></span></a><span class="mpre">
    </span><a name="loc_225_5_225_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_225_5_225_11&#39;)"><span class="hl_vardecl"><span class="mpre">random</span></span></a><span class="mpre">        &lt;- </span><a href="#loc_408_1_408_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_408_1_408_18&#39;)"><span class="hl_varref"><span class="mpre">getServerRandom32</span></span></a><span class="mpre">
    </span><a name="loc_226_5_226_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_5_226_12&#39;)"><span class="hl_vardecl"><span class="mpre">session</span></span></a><span class="mpre">       &lt;- </span><a href="#loc_423_1_423_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_423_1_423_11&#39;)"><span class="hl_varref"><span class="mpre">getSession</span></span></a><span class="mpre">
    </span><a name="loc_227_5_227_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_5_227_13&#39;)"><span class="hl_vardecl"><span class="mpre">cipherid</span></span></a><span class="mpre">      &lt;- </span><a href="Network.TLS.Wire.html#loc_92_1_92_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Wire.html#loc_92_1_92_10&#39;)"><span class="hl_varref"><span class="mpre">getWord16</span></span></a><span class="mpre">
    </span><a name="loc_228_5_228_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_228_5_228_18&#39;)"><span class="hl_vardecl"><span class="mpre">compressionid</span></span></a><span class="mpre"> &lt;- </span><a href="Data.Serialize.Get.html#loc_467_1_467_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Get.html#loc_467_1_467_9&#39;)"><span class="hl_varref"><span class="mpre">getWord8</span></span></a><span class="mpre">
    </span><a name="loc_229_5_229_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_5_229_6&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">             &lt;- </span><a href="Data.Serialize.Get.html#loc_408_1_408_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Get.html#loc_408_1_408_10&#39;)"><span class="hl_varref"><span class="mpre">remaining</span></span></a><span class="mpre">
    </span><a name="loc_230_5_230_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_5_230_9&#39;)"><span class="hl_vardecl"><span class="mpre">exts</span></span></a><span class="mpre"> &lt;- if </span><a href="Network.TLS.Cap.html#loc_18_1_18_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Cap.html#loc_18_1_18_19&#39;)"><span class="hl_varref"><span class="mpre">hasHelloExtensions</span></span></a><span class="mpre"> </span><a href="#loc_224_5_224_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_5_224_8&#39;)"><span class="hl_varref"><span class="mpre">ver</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_229_5_229_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_5_229_6&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
            then </span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="Network.TLS.Wire.html#loc_92_1_92_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Wire.html#loc_92_1_92_10&#39;)"><span class="hl_varref"><span class="mpre">getWord16</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="#loc_434_1_434_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_434_1_434_14&#39;)"><span class="hl_varref"><span class="mpre">getExtensions</span></span></a><span class="mpre">
            else </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> []
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_254_7_254_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_254_7_254_18&#39;)"><span class="hl_conref"><span class="mpre">ServerHello</span></span></a><span class="mpre"> </span><a href="#loc_224_5_224_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_5_224_8&#39;)"><span class="hl_varref"><span class="mpre">ver</span></span></a><span class="mpre"> </span><a href="#loc_225_5_225_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_225_5_225_11&#39;)"><span class="hl_varref"><span class="mpre">random</span></span></a><span class="mpre"> </span><a href="#loc_226_5_226_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_5_226_12&#39;)"><span class="hl_varref"><span class="mpre">session</span></span></a><span class="mpre"> </span><a href="#loc_227_5_227_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_5_227_13&#39;)"><span class="hl_varref"><span class="mpre">cipherid</span></span></a><span class="mpre"> </span><a href="#loc_228_5_228_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_228_5_228_18&#39;)"><span class="hl_varref"><span class="mpre">compressionid</span></span></a><span class="mpre"> </span><a href="#loc_230_5_230_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_5_230_9&#39;)"><span class="hl_varref"><span class="mpre">exts</span></span></a><span class="mpre">

</span><a href="#loc_236_1_236_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_1_236_22&#39;)"><span class="mpre">decodeServerHelloDone</span></a><span class="mpre"> :: </span><a href="Data.Serialize.Get.html#loc_138_9_138_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Get.html#loc_138_9_138_12&#39;)"><span class="hl_tyconref"><span class="mpre">Get</span></span></a><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_252_6_252_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_252_6_252_15&#39;)"><span class="hl_tyconref"><span class="mpre">Handshake</span></span></a><span class="mpre">
</span><a name="loc_236_1_236_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_1_236_22&#39;)"><span class="hl_vardecl"><span class="mpre">decodeServerHelloDone</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_257_7_257_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_257_7_257_22&#39;)"><span class="hl_conref"><span class="mpre">ServerHelloDone</span></span></a><span class="mpre">

</span><a href="#loc_239_1_239_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_1_239_19&#39;)"><span class="mpre">decodeCertificates</span></a><span class="mpre"> :: </span><a href="Data.Serialize.Get.html#loc_138_9_138_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Get.html#loc_138_9_138_12&#39;)"><span class="hl_tyconref"><span class="mpre">Get</span></span></a><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_252_6_252_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_252_6_252_15&#39;)"><span class="hl_tyconref"><span class="mpre">Handshake</span></span></a><span class="mpre">
</span><a name="loc_239_1_239_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_239_1_239_19&#39;)"><span class="hl_vardecl"><span class="mpre">decodeCertificates</span></span></a><span class="mpre"> = do
    </span><a name="loc_240_5_240_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_240_5_240_13&#39;)"><span class="hl_vardecl"><span class="mpre">certsRaw</span></span></a><span class="mpre"> &lt;- </span><a href="Data.X509.CertificateChain.html#loc_25_31_25_50" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.CertificateChain.html#loc_25_31_25_50&#39;)"><span class="hl_conref"><span class="mpre">CertificateChainRaw</span></span></a><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> (</span><a href="Network.TLS.Wire.html#loc_98_1_98_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Wire.html#loc_98_1_98_10&#39;)"><span class="hl_varref"><span class="mpre">getWord24</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> \</span><a name="loc_240_57_240_60" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_240_57_240_60&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre"> -&gt; </span><a href="Network.TLS.Wire.html#loc_117_1_117_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Wire.html#loc_117_1_117_8&#39;)"><span class="hl_varref"><span class="mpre">getList</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_240_57_240_60" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_240_57_240_60&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre">) </span><a href="#loc_244_9_244_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_244_9_244_19&#39;)"><span class="hl_varref"><span class="mpre">getCertRaw</span></span></a><span class="mpre">)
    case </span><a href="Data.X509.CertificateChain.html#loc_32_1_32_23" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.CertificateChain.html#loc_32_1_32_23&#39;)"><span class="hl_varref"><span class="mpre">decodeCertificateChain</span></span></a><span class="mpre"> </span><a href="#loc_240_5_240_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_240_5_240_13&#39;)"><span class="hl_varref"><span class="mpre">certsRaw</span></span></a><span class="mpre"> of
        </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> (</span><a name="loc_242_15_242_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_15_242_16&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre">, </span><a name="loc_242_18_242_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_18_242_19&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">) -&gt; </span><span class="hl_varref"><span class="mpre">fail</span></span><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;error certificate parsing &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_242_15_242_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_15_242_16&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;:&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_242_18_242_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_242_18_242_19&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)
        </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><a name="loc_243_15_243_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_243_15_243_17&#39;)"><span class="hl_vardecl"><span class="mpre">cc</span></span></a><span class="mpre">    -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_255_7_255_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_255_7_255_19&#39;)"><span class="hl_conref"><span class="mpre">Certificates</span></span></a><span class="mpre"> </span><a href="#loc_243_15_243_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_243_15_243_17&#39;)"><span class="hl_varref"><span class="mpre">cc</span></span></a><span class="mpre">
  where </span><a name="loc_244_9_244_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_244_9_244_19&#39;)"><span class="hl_vardecl"><span class="mpre">getCertRaw</span></span></a><span class="mpre"> = </span><a href="Network.TLS.Wire.html#loc_111_1_111_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Wire.html#loc_111_1_111_12&#39;)"><span class="hl_varref"><span class="mpre">getOpaque24</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> \</span><a name="loc_244_39_244_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_244_39_244_43&#39;)"><span class="hl_vardecl"><span class="mpre">cert</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_244_39_244_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_244_39_244_43&#39;)"><span class="hl_varref"><span class="mpre">cert</span></span></a><span class="mpre">, </span><a href="#loc_244_39_244_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_244_39_244_43&#39;)"><span class="hl_varref"><span class="mpre">cert</span></span></a><span class="mpre">)

</span><a href="#loc_247_1_247_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_247_1_247_15&#39;)"><span class="mpre">decodeFinished</span></a><span class="mpre"> :: </span><a href="Data.Serialize.Get.html#loc_138_9_138_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Get.html#loc_138_9_138_12&#39;)"><span class="hl_tyconref"><span class="mpre">Get</span></span></a><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_252_6_252_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_252_6_252_15&#39;)"><span class="hl_tyconref"><span class="mpre">Handshake</span></span></a><span class="mpre">
</span><a name="loc_247_1_247_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_247_1_247_15&#39;)"><span class="hl_vardecl"><span class="mpre">decodeFinished</span></span></a><span class="mpre"> = </span><a href="Network.TLS.Struct.html#loc_262_7_262_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_262_7_262_15&#39;)"><span class="hl_conref"><span class="mpre">Finished</span></span></a><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> (</span><a href="Data.Serialize.Get.html#loc_408_1_408_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Get.html#loc_408_1_408_10&#39;)"><span class="hl_varref"><span class="mpre">remaining</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="Data.Serialize.Get.html#loc_438_1_438_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Get.html#loc_438_1_438_9&#39;)"><span class="hl_varref"><span class="mpre">getBytes</span></span></a><span class="mpre">)

</span><a href="#loc_250_1_250_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_1_250_30&#39;)"><span class="mpre">decodeNextProtocolNegotiation</span></a><span class="mpre"> :: </span><a href="Data.Serialize.Get.html#loc_138_9_138_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Get.html#loc_138_9_138_12&#39;)"><span class="hl_tyconref"><span class="mpre">Get</span></span></a><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_252_6_252_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_252_6_252_15&#39;)"><span class="hl_tyconref"><span class="mpre">Handshake</span></span></a><span class="mpre">
</span><a name="loc_250_1_250_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_250_1_250_30&#39;)"><span class="hl_vardecl"><span class="mpre">decodeNextProtocolNegotiation</span></span></a><span class="mpre"> = do
    </span><a name="loc_251_5_251_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_251_5_251_11&#39;)"><span class="hl_vardecl"><span class="mpre">opaque</span></span></a><span class="mpre"> &lt;- </span><a href="Network.TLS.Wire.html#loc_105_1_105_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Wire.html#loc_105_1_105_11&#39;)"><span class="hl_varref"><span class="mpre">getOpaque8</span></span></a><span class="mpre">
    _      &lt;- </span><a href="Network.TLS.Wire.html#loc_105_1_105_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Wire.html#loc_105_1_105_11&#39;)"><span class="hl_varref"><span class="mpre">getOpaque8</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ignore padding</span></span><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_263_7_263_32" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_263_7_263_32&#39;)"><span class="hl_conref"><span class="mpre">HsNextProtocolNegotiation</span></span></a><span class="mpre"> </span><a href="#loc_251_5_251_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_251_5_251_11&#39;)"><span class="hl_varref"><span class="mpre">opaque</span></span></a><span class="mpre">

</span><a href="#loc_256_1_256_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_256_1_256_18&#39;)"><span class="mpre">decodeCertRequest</span></a><span class="mpre"> :: </span><a href="#loc_77_6_77_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_6_77_19&#39;)"><span class="hl_tyconref"><span class="mpre">CurrentParams</span></span></a><span class="mpre"> -&gt; </span><a href="Data.Serialize.Get.html#loc_138_9_138_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Get.html#loc_138_9_138_12&#39;)"><span class="hl_tyconref"><span class="mpre">Get</span></span></a><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_252_6_252_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_252_6_252_15&#39;)"><span class="hl_tyconref"><span class="mpre">Handshake</span></span></a><span class="mpre">
</span><a name="loc_256_1_256_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_256_1_256_18&#39;)"><span class="hl_fundecl"><span class="mpre">decodeCertRequest</span></span></a><span class="mpre"> </span><a name="loc_256_19_256_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_256_19_256_21&#39;)"><span class="hl_vardecl"><span class="mpre">cp</span></span></a><span class="mpre"> = do
    </span><a name="loc_257_5_257_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_257_5_257_14&#39;)"><span class="hl_vardecl"><span class="mpre">certTypes</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><a href="Data.Maybe.html#loc_91_1_91_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_91_1_91_9&#39;)"><span class="hl_varref"><span class="mpre">fromJust</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_302_5_302_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_302_5_302_14&#39;)"><span class="hl_varref"><span class="mpre">valToType</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre">) </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="Network.TLS.Wire.html#loc_89_1_89_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Wire.html#loc_89_1_89_10&#39;)"><span class="hl_varref"><span class="mpre">getWords8</span></span></a><span class="mpre">

    </span><a name="loc_259_5_259_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_259_5_259_16&#39;)"><span class="hl_vardecl"><span class="mpre">sigHashAlgs</span></span></a><span class="mpre"> &lt;- if </span><a href="#loc_78_7_78_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_7_78_21&#39;)"><span class="hl_varref"><span class="mpre">cParamsVersion</span></span></a><span class="mpre"> </span><a href="#loc_256_19_256_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_256_19_256_21&#39;)"><span class="hl_varref"><span class="mpre">cp</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">TLS12</span></span><span class="mpre">
                       then </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> (</span><a href="Network.TLS.Wire.html#loc_92_1_92_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Wire.html#loc_92_1_92_10&#39;)"><span class="hl_varref"><span class="mpre">getWord16</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="#loc_267_9_267_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_9_267_35&#39;)"><span class="hl_varref"><span class="mpre">getSignatureHashAlgorithms</span></span></a><span class="mpre">)
                       else </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
    </span><a name="loc_262_5_262_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_5_262_13&#39;)"><span class="hl_vardecl"><span class="mpre">dNameLen</span></span></a><span class="mpre"> &lt;- </span><a href="Network.TLS.Wire.html#loc_92_1_92_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Wire.html#loc_92_1_92_10&#39;)"><span class="hl_varref"><span class="mpre">getWord16</span></span></a><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- FIXME: Decide whether to remove this check completely or to make it an option.</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- when (cParamsVersion cp &lt; TLS12 &amp;&amp; dNameLen &lt; 3) $ fail &quot;certrequest distinguishname not of the correct size&quot;</span></span><span class="mpre">
    </span><a name="loc_265_5_265_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_265_5_265_11&#39;)"><span class="hl_vardecl"><span class="mpre">dNames</span></span></a><span class="mpre"> &lt;- </span><a href="Network.TLS.Wire.html#loc_117_1_117_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Wire.html#loc_117_1_117_8&#39;)"><span class="hl_varref"><span class="mpre">getList</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_262_5_262_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_262_5_262_13&#39;)"><span class="hl_varref"><span class="mpre">dNameLen</span></span></a><span class="mpre">) </span><a href="#loc_268_9_268_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_268_9_268_17&#39;)"><span class="hl_varref"><span class="mpre">getDName</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_260_7_260_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_260_7_260_18&#39;)"><span class="hl_conref"><span class="mpre">CertRequest</span></span></a><span class="mpre"> </span><a href="#loc_257_5_257_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_257_5_257_14&#39;)"><span class="hl_varref"><span class="mpre">certTypes</span></span></a><span class="mpre"> </span><a href="#loc_259_5_259_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_259_5_259_16&#39;)"><span class="hl_varref"><span class="mpre">sigHashAlgs</span></span></a><span class="mpre"> </span><a href="#loc_265_5_265_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_265_5_265_11&#39;)"><span class="hl_varref"><span class="mpre">dNames</span></span></a><span class="mpre">
  where </span><a name="loc_267_9_267_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_9_267_35&#39;)"><span class="hl_fundecl"><span class="mpre">getSignatureHashAlgorithms</span></span></a><span class="mpre"> </span><a name="loc_267_36_267_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_36_267_39&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre"> = </span><a href="Network.TLS.Wire.html#loc_117_1_117_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Wire.html#loc_117_1_117_8&#39;)"><span class="hl_varref"><span class="mpre">getList</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_267_36_267_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_36_267_39&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre">) (</span><a href="#loc_450_1_450_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_450_1_450_26&#39;)"><span class="hl_varref"><span class="mpre">getSignatureHashAlgorithm</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> \</span><a name="loc_267_101_267_103" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_101_267_103&#39;)"><span class="hl_vardecl"><span class="mpre">sh</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">, </span><a href="#loc_267_101_267_103" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_267_101_267_103&#39;)"><span class="hl_varref"><span class="mpre">sh</span></span></a><span class="mpre">))
        </span><a name="loc_268_9_268_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_268_9_268_17&#39;)"><span class="hl_vardecl"><span class="mpre">getDName</span></span></a><span class="mpre"> = do
            </span><a name="loc_269_13_269_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_269_13_269_18&#39;)"><span class="hl_vardecl"><span class="mpre">dName</span></span></a><span class="mpre"> &lt;- </span><a href="Network.TLS.Wire.html#loc_108_1_108_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Wire.html#loc_108_1_108_12&#39;)"><span class="hl_varref"><span class="mpre">getOpaque16</span></span></a><span class="mpre">
            </span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="hl_varref"><span class="mpre">when</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_269_13_269_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_269_13_269_18&#39;)"><span class="hl_varref"><span class="mpre">dName</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fail</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;certrequest: invalid DN length&quot;</span></span><span class="mpre">
            </span><a name="loc_271_13_271_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_271_13_271_15&#39;)"><span class="hl_vardecl"><span class="mpre">dn</span></span></a><span class="mpre"> &lt;- case </span><a href="Data.ASN1.Encoding.html#loc_43_1_43_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Encoding.html#loc_43_1_43_12&#39;)"><span class="hl_varref"><span class="mpre">decodeASN1&#39;</span></span></a><span class="mpre"> </span><a href="Data.ASN1.BinaryEncoding.html#loc_30_12_30_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.BinaryEncoding.html#loc_30_12_30_15&#39;)"><span class="hl_conref"><span class="mpre">DER</span></span></a><span class="mpre"> </span><a href="#loc_269_13_269_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_269_13_269_18&#39;)"><span class="hl_varref"><span class="mpre">dName</span></span></a><span class="mpre"> of
                    </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><a name="loc_272_26_272_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_272_26_272_27&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre">      -&gt; </span><span class="hl_varref"><span class="mpre">fail</span></span><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;cert request decoding DistinguishedName ASN1 failed: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_272_26_272_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_272_26_272_27&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">)
                    </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><a name="loc_273_27_273_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_273_27_273_32&#39;)"><span class="hl_vardecl"><span class="mpre">asn1s</span></span></a><span class="mpre"> -&gt; case </span><a href="Data.ASN1.Types.html#loc_70_5_70_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_70_5_70_13&#39;)"><span class="hl_varref"><span class="mpre">fromASN1</span></span></a><span class="mpre"> </span><a href="#loc_273_27_273_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_273_27_273_32&#39;)"><span class="hl_varref"><span class="mpre">asn1s</span></span></a><span class="mpre"> of
                                        </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><a name="loc_274_46_274_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_274_46_274_47&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre">      -&gt; </span><span class="hl_varref"><span class="mpre">fail</span></span><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;cert request parsing DistinguishedName ASN1 failed: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_274_46_274_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_274_46_274_47&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">)
                                        </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> (</span><a name="loc_275_48_275_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_275_48_275_49&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre">,_) -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_275_48_275_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_275_48_275_49&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre">
            </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_269_13_269_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_269_13_269_18&#39;)"><span class="hl_varref"><span class="mpre">dName</span></span></a><span class="mpre">, </span><a href="#loc_271_13_271_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_271_13_271_15&#39;)"><span class="hl_varref"><span class="mpre">dn</span></span></a><span class="mpre">)

</span><a href="#loc_279_1_279_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_279_1_279_17&#39;)"><span class="mpre">decodeCertVerify</span></a><span class="mpre"> :: </span><a href="#loc_77_6_77_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_6_77_19&#39;)"><span class="hl_tyconref"><span class="mpre">CurrentParams</span></span></a><span class="mpre"> -&gt; </span><a href="Data.Serialize.Get.html#loc_138_9_138_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Get.html#loc_138_9_138_12&#39;)"><span class="hl_tyconref"><span class="mpre">Get</span></span></a><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_252_6_252_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_252_6_252_15&#39;)"><span class="hl_tyconref"><span class="mpre">Handshake</span></span></a><span class="mpre">
</span><a name="loc_279_1_279_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_279_1_279_17&#39;)"><span class="hl_fundecl"><span class="mpre">decodeCertVerify</span></span></a><span class="mpre"> </span><a name="loc_279_18_279_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_279_18_279_20&#39;)"><span class="hl_vardecl"><span class="mpre">cp</span></span></a><span class="mpre"> = </span><a href="Network.TLS.Struct.html#loc_261_7_261_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_261_7_261_17&#39;)"><span class="hl_conref"><span class="mpre">CertVerify</span></span></a><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="#loc_470_1_470_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_470_1_470_19&#39;)"><span class="hl_varref"><span class="mpre">getDigitallySigned</span></span></a><span class="mpre"> (</span><a href="#loc_78_7_78_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_7_78_21&#39;)"><span class="hl_varref"><span class="mpre">cParamsVersion</span></span></a><span class="mpre"> </span><a href="#loc_279_18_279_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_279_18_279_20&#39;)"><span class="hl_varref"><span class="mpre">cp</span></span></a><span class="mpre">)

</span><a href="#loc_282_1_282_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_282_1_282_20&#39;)"><span class="mpre">decodeClientKeyXchg</span></a><span class="mpre"> :: </span><a href="#loc_77_6_77_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_6_77_19&#39;)"><span class="hl_tyconref"><span class="mpre">CurrentParams</span></span></a><span class="mpre"> -&gt; </span><a href="Data.Serialize.Get.html#loc_138_9_138_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Get.html#loc_138_9_138_12&#39;)"><span class="hl_tyconref"><span class="mpre">Get</span></span></a><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_252_6_252_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_252_6_252_15&#39;)"><span class="hl_tyconref"><span class="mpre">Handshake</span></span></a><span class="mpre">
</span><a name="loc_282_1_282_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_282_1_282_20&#39;)"><span class="hl_fundecl"><span class="mpre">decodeClientKeyXchg</span></span></a><span class="mpre"> </span><a name="loc_282_21_282_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_282_21_282_23&#39;)"><span class="hl_vardecl"><span class="mpre">cp</span></span></a><span class="mpre"> = </span><span class="hl_comment"><span class="mpre">-- case  ClientKeyXchg &lt;$&gt; (remaining &gt;&gt;= getBytes)</span></span><span class="mpre">
    case </span><a href="#loc_79_7_79_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_7_79_25&#39;)"><span class="hl_varref"><span class="mpre">cParamsKeyXchgType</span></span></a><span class="mpre"> </span><a href="#loc_282_21_282_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_282_21_282_23&#39;)"><span class="hl_varref"><span class="mpre">cp</span></span></a><span class="mpre"> of
        </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">  -&gt; </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;no client key exchange type&quot;</span></span><span class="mpre">
        </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_285_14_285_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_285_14_285_17&#39;)"><span class="hl_vardecl"><span class="mpre">cke</span></span></a><span class="mpre"> -&gt; </span><a href="Network.TLS.Struct.html#loc_258_7_258_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_258_7_258_20&#39;)"><span class="hl_conref"><span class="mpre">ClientKeyXchg</span></span></a><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="#loc_286_9_286_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_286_9_286_17&#39;)"><span class="hl_varref"><span class="mpre">parseCKE</span></span></a><span class="mpre"> </span><a href="#loc_285_14_285_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_285_14_285_17&#39;)"><span class="hl_varref"><span class="mpre">cke</span></span></a><span class="mpre">
  where </span><a name="loc_286_9_286_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_286_9_286_17&#39;)"><span class="hl_fundecl"><span class="mpre">parseCKE</span></span></a><span class="mpre"> </span><a href="Network.TLS.Cipher.html#loc_41_7_41_28" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Cipher.html#loc_41_7_41_28&#39;)"><span class="hl_conref"><span class="mpre">CipherKeyExchange_RSA</span></span></a><span class="mpre">     = </span><a href="Network.TLS.Struct.html#loc_246_7_246_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_246_7_246_14&#39;)"><span class="hl_conref"><span class="mpre">CKX_RSA</span></span></a><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> (</span><a href="Data.Serialize.Get.html#loc_408_1_408_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Get.html#loc_408_1_408_10&#39;)"><span class="hl_varref"><span class="mpre">remaining</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="Data.Serialize.Get.html#loc_438_1_438_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Get.html#loc_438_1_438_9&#39;)"><span class="hl_varref"><span class="mpre">getBytes</span></span></a><span class="mpre">)
        </span><a href="#loc_286_9_286_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_286_9_286_17&#39;)"><span class="hl_fundecl"><span class="mpre">parseCKE</span></span></a><span class="mpre"> </span><a href="Network.TLS.Cipher.html#loc_43_7_43_32" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Cipher.html#loc_43_7_43_32&#39;)"><span class="hl_conref"><span class="mpre">CipherKeyExchange_DHE_RSA</span></span></a><span class="mpre"> = </span><a href="#loc_291_9_291_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_9_291_28&#39;)"><span class="hl_varref"><span class="mpre">parseClientDHPublic</span></span></a><span class="mpre">
        </span><a href="#loc_286_9_286_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_286_9_286_17&#39;)"><span class="hl_fundecl"><span class="mpre">parseCKE</span></span></a><span class="mpre"> </span><a href="Network.TLS.Cipher.html#loc_45_7_45_32" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Cipher.html#loc_45_7_45_32&#39;)"><span class="hl_conref"><span class="mpre">CipherKeyExchange_DHE_DSS</span></span></a><span class="mpre"> = </span><a href="#loc_291_9_291_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_9_291_28&#39;)"><span class="hl_varref"><span class="mpre">parseClientDHPublic</span></span></a><span class="mpre">
        </span><a href="#loc_286_9_286_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_286_9_286_17&#39;)"><span class="hl_fundecl"><span class="mpre">parseCKE</span></span></a><span class="mpre"> </span><a href="Network.TLS.Cipher.html#loc_42_7_42_32" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Cipher.html#loc_42_7_42_32&#39;)"><span class="hl_conref"><span class="mpre">CipherKeyExchange_DH_Anon</span></span></a><span class="mpre"> = </span><a href="#loc_291_9_291_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_9_291_28&#39;)"><span class="hl_varref"><span class="mpre">parseClientDHPublic</span></span></a><span class="mpre">
        </span><a href="#loc_286_9_286_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_286_9_286_17&#39;)"><span class="hl_fundecl"><span class="mpre">parseCKE</span></span></a><span class="mpre"> _                         = </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;unsupported client key exchange type&quot;</span></span><span class="mpre">
        </span><a name="loc_291_9_291_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_291_9_291_28&#39;)"><span class="hl_vardecl"><span class="mpre">parseClientDHPublic</span></span></a><span class="mpre"> = </span><a href="Network.TLS.Struct.html#loc_247_7_247_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_247_7_247_13&#39;)"><span class="hl_conref"><span class="mpre">CKX_DH</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Network.TLS.Crypto.DH.html#loc_30_1_30_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Crypto.DH.html#loc_30_1_30_9&#39;)"><span class="hl_varref"><span class="mpre">dhPublic</span></span></a><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="Network.TLS.Wire.html#loc_114_1_114_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Wire.html#loc_114_1_114_13&#39;)"><span class="hl_varref"><span class="mpre">getInteger16</span></span></a><span class="mpre">

</span><a href="#loc_294_1_294_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_294_1_294_23&#39;)"><span class="mpre">decodeServerKeyXchg_DH</span></a><span class="mpre"> :: </span><a href="Data.Serialize.Get.html#loc_138_9_138_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Get.html#loc_138_9_138_12&#39;)"><span class="hl_tyconref"><span class="mpre">Get</span></span></a><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_226_6_226_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_226_6_226_20&#39;)"><span class="hl_tyconref"><span class="mpre">ServerDHParams</span></span></a><span class="mpre">
</span><a name="loc_294_1_294_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_294_1_294_23&#39;)"><span class="hl_vardecl"><span class="mpre">decodeServerKeyXchg_DH</span></span></a><span class="mpre"> = </span><a href="#loc_460_1_460_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_460_1_460_18&#39;)"><span class="hl_varref"><span class="mpre">getServerDHParams</span></span></a><span class="mpre">

</span><a href="#loc_297_1_297_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_297_1_297_24&#39;)"><span class="mpre">decodeServerKeyXchg_RSA</span></a><span class="mpre"> :: </span><a href="Data.Serialize.Get.html#loc_138_9_138_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Get.html#loc_138_9_138_12&#39;)"><span class="hl_tyconref"><span class="mpre">Get</span></span></a><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_229_6_229_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_229_6_229_21&#39;)"><span class="hl_tyconref"><span class="mpre">ServerRSAParams</span></span></a><span class="mpre">
</span><a name="loc_297_1_297_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_297_1_297_24&#39;)"><span class="hl_vardecl"><span class="mpre">decodeServerKeyXchg_RSA</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">ServerRSAParams</span></span><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="Network.TLS.Wire.html#loc_114_1_114_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Wire.html#loc_114_1_114_13&#39;)"><span class="hl_varref"><span class="mpre">getInteger16</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- modulus</span></span><span class="mpre">
                                          </span><a href="Control.Applicative.html#loc_118_5_118_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_118_5_118_10&#39;)"><span class="hl_infix"><span class="mpre">&lt;*&gt;</span></span></a><span class="mpre"> </span><a href="Network.TLS.Wire.html#loc_114_1_114_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Wire.html#loc_114_1_114_13&#39;)"><span class="hl_varref"><span class="mpre">getInteger16</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- exponent</span></span><span class="mpre">

</span><a href="#loc_303_1_303_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_303_1_303_33&#39;)"><span class="mpre">decodeServerKeyXchgAlgorithmData</span></a><span class="mpre"> :: </span><a href="Network.TLS.Types.html#loc_25_6_25_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Types.html#loc_25_6_25_13&#39;)"><span class="hl_tyconref"><span class="mpre">Version</span></span></a><span class="mpre">
                                 -&gt; </span><a href="Network.TLS.Cipher.html#loc_40_6_40_27" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Cipher.html#loc_40_6_40_27&#39;)"><span class="hl_tyconref"><span class="mpre">CipherKeyExchangeType</span></span></a><span class="mpre">
                                 -&gt; </span><a href="Data.Serialize.Get.html#loc_138_9_138_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Get.html#loc_138_9_138_12&#39;)"><span class="hl_tyconref"><span class="mpre">Get</span></span></a><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_234_6_234_32" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_234_6_234_32&#39;)"><span class="hl_tyconref"><span class="mpre">ServerKeyXchgAlgorithmData</span></span></a><span class="mpre">
</span><a name="loc_303_1_303_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_303_1_303_33&#39;)"><span class="hl_fundecl"><span class="mpre">decodeServerKeyXchgAlgorithmData</span></span></a><span class="mpre"> </span><a name="loc_303_34_303_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_303_34_303_37&#39;)"><span class="hl_vardecl"><span class="mpre">ver</span></span></a><span class="mpre"> </span><a name="loc_303_38_303_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_303_38_303_41&#39;)"><span class="hl_vardecl"><span class="mpre">cke</span></span></a><span class="mpre"> = </span><a href="#loc_304_9_304_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_304_9_304_14&#39;)"><span class="hl_varref"><span class="mpre">toCKE</span></span></a><span class="mpre">
  where </span><a name="loc_304_9_304_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_304_9_304_14&#39;)"><span class="hl_vardecl"><span class="mpre">toCKE</span></span></a><span class="mpre"> = case </span><a href="#loc_303_38_303_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_303_38_303_41&#39;)"><span class="hl_varref"><span class="mpre">cke</span></span></a><span class="mpre"> of
            </span><a href="Network.TLS.Cipher.html#loc_41_7_41_28" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Cipher.html#loc_41_7_41_28&#39;)"><span class="hl_conref"><span class="mpre">CipherKeyExchange_RSA</span></span></a><span class="mpre">     -&gt; </span><a href="Network.TLS.Struct.html#loc_238_7_238_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_238_7_238_14&#39;)"><span class="hl_conref"><span class="mpre">SKX_RSA</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="#loc_297_1_297_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_297_1_297_24&#39;)"><span class="hl_varref"><span class="mpre">decodeServerKeyXchg_RSA</span></span></a><span class="mpre">
            </span><a href="Network.TLS.Cipher.html#loc_42_7_42_32" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Cipher.html#loc_42_7_42_32&#39;)"><span class="hl_conref"><span class="mpre">CipherKeyExchange_DH_Anon</span></span></a><span class="mpre"> -&gt; </span><a href="Network.TLS.Struct.html#loc_235_7_235_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_235_7_235_18&#39;)"><span class="hl_conref"><span class="mpre">SKX_DH_Anon</span></span></a><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="#loc_294_1_294_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_294_1_294_23&#39;)"><span class="hl_varref"><span class="mpre">decodeServerKeyXchg_DH</span></span></a><span class="mpre">
            </span><a href="Network.TLS.Cipher.html#loc_43_7_43_32" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Cipher.html#loc_43_7_43_32&#39;)"><span class="hl_conref"><span class="mpre">CipherKeyExchange_DHE_RSA</span></span></a><span class="mpre"> -&gt; do
                </span><a name="loc_308_17_308_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_308_17_308_25&#39;)"><span class="hl_vardecl"><span class="mpre">dhparams</span></span></a><span class="mpre">  &lt;- </span><a href="#loc_460_1_460_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_460_1_460_18&#39;)"><span class="hl_varref"><span class="mpre">getServerDHParams</span></span></a><span class="mpre">
                </span><a name="loc_309_17_309_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_309_17_309_26&#39;)"><span class="hl_vardecl"><span class="mpre">signature</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_470_1_470_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_470_1_470_19&#39;)"><span class="hl_varref"><span class="mpre">getDigitallySigned</span></span></a><span class="mpre"> </span><a href="#loc_303_34_303_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_303_34_303_37&#39;)"><span class="hl_varref"><span class="mpre">ver</span></span></a><span class="mpre">
                </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_237_7_237_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_237_7_237_18&#39;)"><span class="hl_conref"><span class="mpre">SKX_DHE_RSA</span></span></a><span class="mpre"> </span><a href="#loc_308_17_308_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_308_17_308_25&#39;)"><span class="hl_varref"><span class="mpre">dhparams</span></span></a><span class="mpre"> </span><a href="#loc_309_17_309_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_309_17_309_26&#39;)"><span class="hl_varref"><span class="mpre">signature</span></span></a><span class="mpre">
            </span><a href="Network.TLS.Cipher.html#loc_45_7_45_32" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Cipher.html#loc_45_7_45_32&#39;)"><span class="hl_conref"><span class="mpre">CipherKeyExchange_DHE_DSS</span></span></a><span class="mpre"> -&gt; do
                </span><a name="loc_312_17_312_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_17_312_25&#39;)"><span class="hl_vardecl"><span class="mpre">dhparams</span></span></a><span class="mpre">  &lt;- </span><a href="#loc_460_1_460_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_460_1_460_18&#39;)"><span class="hl_varref"><span class="mpre">getServerDHParams</span></span></a><span class="mpre">
                </span><a name="loc_313_17_313_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_313_17_313_26&#39;)"><span class="hl_vardecl"><span class="mpre">signature</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_470_1_470_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_470_1_470_19&#39;)"><span class="hl_varref"><span class="mpre">getDigitallySigned</span></span></a><span class="mpre"> </span><a href="#loc_303_34_303_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_303_34_303_37&#39;)"><span class="hl_varref"><span class="mpre">ver</span></span></a><span class="mpre">
                </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_236_7_236_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_236_7_236_18&#39;)"><span class="hl_conref"><span class="mpre">SKX_DHE_DSS</span></span></a><span class="mpre"> </span><a href="#loc_312_17_312_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_312_17_312_25&#39;)"><span class="hl_varref"><span class="mpre">dhparams</span></span></a><span class="mpre"> </span><a href="#loc_313_17_313_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_313_17_313_26&#39;)"><span class="hl_varref"><span class="mpre">signature</span></span></a><span class="mpre">
            _ -&gt; do
                </span><a name="loc_316_17_316_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_316_17_316_19&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> &lt;- </span><a href="Data.Serialize.Get.html#loc_408_1_408_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Get.html#loc_408_1_408_10&#39;)"><span class="hl_varref"><span class="mpre">remaining</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="Data.Serialize.Get.html#loc_438_1_438_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Get.html#loc_438_1_438_9&#39;)"><span class="hl_varref"><span class="mpre">getBytes</span></span></a><span class="mpre">
                </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_242_7_242_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_242_7_242_18&#39;)"><span class="hl_conref"><span class="mpre">SKX_Unknown</span></span></a><span class="mpre"> </span><a href="#loc_316_17_316_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_316_17_316_19&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">

</span><a href="#loc_320_1_320_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_320_1_320_20&#39;)"><span class="mpre">decodeServerKeyXchg</span></a><span class="mpre"> :: </span><a href="#loc_77_6_77_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_6_77_19&#39;)"><span class="hl_tyconref"><span class="mpre">CurrentParams</span></span></a><span class="mpre"> -&gt; </span><a href="Data.Serialize.Get.html#loc_138_9_138_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Get.html#loc_138_9_138_12&#39;)"><span class="hl_tyconref"><span class="mpre">Get</span></span></a><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_252_6_252_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_252_6_252_15&#39;)"><span class="hl_tyconref"><span class="mpre">Handshake</span></span></a><span class="mpre">
</span><a name="loc_320_1_320_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_320_1_320_20&#39;)"><span class="hl_fundecl"><span class="mpre">decodeServerKeyXchg</span></span></a><span class="mpre"> </span><a name="loc_320_21_320_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_320_21_320_23&#39;)"><span class="hl_vardecl"><span class="mpre">cp</span></span></a><span class="mpre"> =
    case </span><a href="#loc_79_7_79_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_7_79_25&#39;)"><span class="hl_varref"><span class="mpre">cParamsKeyXchgType</span></span></a><span class="mpre"> </span><a href="#loc_320_21_320_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_320_21_320_23&#39;)"><span class="hl_varref"><span class="mpre">cp</span></span></a><span class="mpre"> of
        </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_322_14_322_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_322_14_322_17&#39;)"><span class="hl_vardecl"><span class="mpre">cke</span></span></a><span class="mpre"> -&gt; </span><a href="Network.TLS.Struct.html#loc_259_7_259_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_259_7_259_20&#39;)"><span class="hl_conref"><span class="mpre">ServerKeyXchg</span></span></a><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="#loc_303_1_303_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_303_1_303_33&#39;)"><span class="hl_varref"><span class="mpre">decodeServerKeyXchgAlgorithmData</span></span></a><span class="mpre"> (</span><a href="#loc_78_7_78_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_7_78_21&#39;)"><span class="hl_varref"><span class="mpre">cParamsVersion</span></span></a><span class="mpre"> </span><a href="#loc_320_21_320_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_320_21_320_23&#39;)"><span class="hl_varref"><span class="mpre">cp</span></span></a><span class="mpre">) </span><a href="#loc_322_14_322_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_322_14_322_17&#39;)"><span class="hl_varref"><span class="mpre">cke</span></span></a><span class="mpre">
        </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">  -&gt; </span><a href="Network.TLS.Struct.html#loc_259_7_259_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_259_7_259_20&#39;)"><span class="hl_conref"><span class="mpre">ServerKeyXchg</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_241_7_241_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_241_7_241_19&#39;)"><span class="hl_conref"><span class="mpre">SKX_Unparsed</span></span></a><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> (</span><a href="Data.Serialize.Get.html#loc_408_1_408_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Get.html#loc_408_1_408_10&#39;)"><span class="hl_varref"><span class="mpre">remaining</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="Data.Serialize.Get.html#loc_438_1_438_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Get.html#loc_438_1_438_9&#39;)"><span class="hl_varref"><span class="mpre">getBytes</span></span></a><span class="mpre">)

</span><a href="#loc_326_1_326_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_326_1_326_16&#39;)"><span class="mpre">encodeHandshake</span></a><span class="mpre"> :: </span><a href="Network.TLS.Struct.html#loc_252_6_252_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_252_6_252_15&#39;)"><span class="hl_tyconref"><span class="mpre">Handshake</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
</span><a name="loc_326_1_326_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_326_1_326_16&#39;)"><span class="hl_fundecl"><span class="mpre">encodeHandshake</span></span></a><span class="mpre"> </span><a name="loc_326_17_326_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_326_17_326_18&#39;)"><span class="hl_vardecl"><span class="mpre">o</span></span></a><span class="mpre"> =
    let </span><a name="loc_327_9_327_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_327_9_327_16&#39;)"><span class="hl_vardecl"><span class="mpre">content</span></span></a><span class="mpre"> = </span><a href="Data.Serialize.Put.html#loc_148_1_148_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Put.html#loc_148_1_148_7&#39;)"><span class="hl_varref"><span class="mpre">runPut</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_342_1_342_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_342_1_342_23&#39;)"><span class="hl_varref"><span class="mpre">encodeHandshakeContent</span></span></a><span class="mpre"> </span><a href="#loc_326_17_326_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_326_17_326_18&#39;)"><span class="hl_varref"><span class="mpre">o</span></span></a><span class="mpre"> in
    let </span><a name="loc_328_9_328_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_9_328_12&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_327_9_327_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_327_9_327_16&#39;)"><span class="hl_varref"><span class="mpre">content</span></span></a><span class="mpre"> in
    let </span><a name="loc_329_9_329_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_329_9_329_15&#39;)"><span class="hl_vardecl"><span class="mpre">header</span></span></a><span class="mpre"> = case </span><a href="#loc_326_17_326_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_326_17_326_18&#39;)"><span class="hl_varref"><span class="mpre">o</span></span></a><span class="mpre"> of
                    </span><a href="Network.TLS.Struct.html#loc_253_7_253_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_253_7_253_18&#39;)"><span class="hl_conref"><span class="mpre">ClientHello</span></span></a><span class="mpre"> _ _ _ _ _ _ (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> _) -&gt; </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- SSLv2 ClientHello message</span></span><span class="mpre">
                    _ -&gt; </span><a href="Data.Serialize.Put.html#loc_148_1_148_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Put.html#loc_148_1_148_7&#39;)"><span class="hl_varref"><span class="mpre">runPut</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_338_1_338_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_338_1_338_22&#39;)"><span class="hl_varref"><span class="mpre">encodeHandshakeHeader</span></span></a><span class="mpre"> (</span><a href="Network.TLS.Struct.html#loc_273_1_273_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_273_1_273_16&#39;)"><span class="hl_varref"><span class="mpre">typeOfHandshake</span></span></a><span class="mpre"> </span><a href="#loc_326_17_326_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_326_17_326_18&#39;)"><span class="hl_varref"><span class="mpre">o</span></span></a><span class="mpre">) </span><a href="#loc_328_9_328_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_328_9_328_12&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre"> in
    </span><span class="hl_varref"><span class="mpre">B.concat</span></span><span class="mpre"> [ </span><a href="#loc_329_9_329_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_329_9_329_15&#39;)"><span class="hl_varref"><span class="mpre">header</span></span></a><span class="mpre">, </span><a href="#loc_327_9_327_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_327_9_327_16&#39;)"><span class="hl_varref"><span class="mpre">content</span></span></a><span class="mpre"> ]

</span><a href="#loc_335_1_335_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_335_1_335_17&#39;)"><span class="mpre">encodeHandshakes</span></a><span class="mpre"> :: [</span><a href="Network.TLS.Struct.html#loc_252_6_252_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_252_6_252_15&#39;)"><span class="hl_tyconref"><span class="mpre">Handshake</span></span></a><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
</span><a name="loc_335_1_335_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_335_1_335_17&#39;)"><span class="hl_fundecl"><span class="mpre">encodeHandshakes</span></span></a><span class="mpre"> </span><a name="loc_335_18_335_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_335_18_335_21&#39;)"><span class="hl_vardecl"><span class="mpre">hss</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">B.concat</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="#loc_326_1_326_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_326_1_326_16&#39;)"><span class="hl_varref"><span class="mpre">encodeHandshake</span></span></a><span class="mpre"> </span><a href="#loc_335_18_335_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_335_18_335_21&#39;)"><span class="hl_varref"><span class="mpre">hss</span></span></a><span class="mpre">

</span><a href="#loc_338_1_338_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_338_1_338_22&#39;)"><span class="mpre">encodeHandshakeHeader</span></a><span class="mpre"> :: </span><a href="Network.TLS.Struct.html#loc_212_6_212_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_212_6_212_19&#39;)"><span class="hl_tyconref"><span class="mpre">HandshakeType</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Put</span></span><span class="mpre">
</span><a name="loc_338_1_338_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_338_1_338_22&#39;)"><span class="hl_fundecl"><span class="mpre">encodeHandshakeHeader</span></span></a><span class="mpre"> </span><a name="loc_338_23_338_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_338_23_338_25&#39;)"><span class="hl_vardecl"><span class="mpre">ty</span></span></a><span class="mpre"> </span><a name="loc_338_26_338_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_338_26_338_29&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre"> = </span><a href="Data.Serialize.Put.html#loc_176_1_176_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Put.html#loc_176_1_176_9&#39;)"><span class="hl_varref"><span class="mpre">putWord8</span></span></a><span class="mpre"> (</span><a href="Network.TLS.Struct.html#loc_301_5_301_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_301_5_301_14&#39;)"><span class="hl_varref"><span class="mpre">valOfType</span></span></a><span class="mpre"> </span><a href="#loc_338_23_338_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_338_23_338_25&#39;)"><span class="hl_varref"><span class="mpre">ty</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="Network.TLS.Wire.html#loc_140_1_140_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Wire.html#loc_140_1_140_10&#39;)"><span class="hl_varref"><span class="mpre">putWord24</span></span></a><span class="mpre"> </span><a href="#loc_338_26_338_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_338_26_338_29&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre">

</span><a href="#loc_342_1_342_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_342_1_342_23&#39;)"><span class="mpre">encodeHandshakeContent</span></a><span class="mpre"> :: </span><a href="Network.TLS.Struct.html#loc_252_6_252_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_252_6_252_15&#39;)"><span class="hl_tyconref"><span class="mpre">Handshake</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Put</span></span><span class="mpre">

</span><a name="loc_342_1_342_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_342_1_342_23&#39;)"><span class="hl_fundecl"><span class="mpre">encodeHandshakeContent</span></span></a><span class="mpre"> (</span><a href="Network.TLS.Struct.html#loc_253_7_253_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_253_7_253_18&#39;)"><span class="hl_conref"><span class="mpre">ClientHello</span></span></a><span class="mpre"> _ _ _ _ _ _ (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_342_55_342_65" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_342_55_342_65&#39;)"><span class="hl_vardecl"><span class="mpre">deprecated</span></span></a><span class="mpre">)) = do
    </span><a href="Network.TLS.Wire.html#loc_147_1_147_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Wire.html#loc_147_1_147_9&#39;)"><span class="hl_varref"><span class="mpre">putBytes</span></span></a><span class="mpre"> </span><a href="#loc_342_55_342_65" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_342_55_342_65&#39;)"><span class="hl_varref"><span class="mpre">deprecated</span></span></a><span class="mpre">
</span><a href="#loc_342_1_342_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_342_1_342_23&#39;)"><span class="hl_fundecl"><span class="mpre">encodeHandshakeContent</span></span></a><span class="mpre"> (</span><a href="Network.TLS.Struct.html#loc_253_7_253_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_253_7_253_18&#39;)"><span class="hl_conref"><span class="mpre">ClientHello</span></span></a><span class="mpre"> </span><a name="loc_344_37_344_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_344_37_344_44&#39;)"><span class="hl_vardecl"><span class="mpre">version</span></span></a><span class="mpre"> </span><a name="loc_344_45_344_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_344_45_344_51&#39;)"><span class="hl_vardecl"><span class="mpre">random</span></span></a><span class="mpre"> </span><a name="loc_344_52_344_59" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_344_52_344_59&#39;)"><span class="hl_vardecl"><span class="mpre">session</span></span></a><span class="mpre"> </span><a name="loc_344_60_344_69" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_344_60_344_69&#39;)"><span class="hl_vardecl"><span class="mpre">cipherIDs</span></span></a><span class="mpre"> </span><a name="loc_344_70_344_84" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_344_70_344_84&#39;)"><span class="hl_vardecl"><span class="mpre">compressionIDs</span></span></a><span class="mpre"> </span><a name="loc_344_85_344_89" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_344_85_344_89&#39;)"><span class="hl_vardecl"><span class="mpre">exts</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">) = do
    </span><a href="#loc_93_1_93_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_1_93_11&#39;)"><span class="hl_varref"><span class="mpre">putVersion</span></span></a><span class="mpre"> </span><a href="#loc_344_37_344_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_344_37_344_44&#39;)"><span class="hl_varref"><span class="mpre">version</span></span></a><span class="mpre">
    </span><a href="#loc_417_1_417_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_417_1_417_18&#39;)"><span class="hl_varref"><span class="mpre">putClientRandom32</span></span></a><span class="mpre"> </span><a href="#loc_344_45_344_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_344_45_344_51&#39;)"><span class="hl_varref"><span class="mpre">random</span></span></a><span class="mpre">
    </span><a href="#loc_430_1_430_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_430_1_430_11&#39;)"><span class="hl_varref"><span class="mpre">putSession</span></span></a><span class="mpre"> </span><a href="#loc_344_52_344_59" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_344_52_344_59&#39;)"><span class="hl_varref"><span class="mpre">session</span></span></a><span class="mpre">
    </span><a href="Network.TLS.Wire.html#loc_135_1_135_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Wire.html#loc_135_1_135_11&#39;)"><span class="hl_varref"><span class="mpre">putWords16</span></span></a><span class="mpre"> </span><a href="#loc_344_60_344_69" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_344_60_344_69&#39;)"><span class="hl_varref"><span class="mpre">cipherIDs</span></span></a><span class="mpre">
    </span><a href="Network.TLS.Wire.html#loc_127_1_127_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Wire.html#loc_127_1_127_10&#39;)"><span class="hl_varref"><span class="mpre">putWords8</span></span></a><span class="mpre"> </span><a href="#loc_344_70_344_84" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_344_70_344_84&#39;)"><span class="hl_varref"><span class="mpre">compressionIDs</span></span></a><span class="mpre">
    </span><a href="#loc_446_1_446_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_1_446_14&#39;)"><span class="hl_varref"><span class="mpre">putExtensions</span></span></a><span class="mpre"> </span><a href="#loc_344_85_344_89" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_344_85_344_89&#39;)"><span class="hl_varref"><span class="mpre">exts</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">

</span><a href="#loc_342_1_342_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_342_1_342_23&#39;)"><span class="hl_fundecl"><span class="mpre">encodeHandshakeContent</span></span></a><span class="mpre"> (</span><a href="Network.TLS.Struct.html#loc_254_7_254_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_254_7_254_18&#39;)"><span class="hl_conref"><span class="mpre">ServerHello</span></span></a><span class="mpre"> </span><a name="loc_353_37_353_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_353_37_353_44&#39;)"><span class="hl_vardecl"><span class="mpre">version</span></span></a><span class="mpre"> </span><a name="loc_353_45_353_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_353_45_353_51&#39;)"><span class="hl_vardecl"><span class="mpre">random</span></span></a><span class="mpre"> </span><a name="loc_353_52_353_59" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_353_52_353_59&#39;)"><span class="hl_vardecl"><span class="mpre">session</span></span></a><span class="mpre"> </span><a name="loc_353_60_353_68" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_353_60_353_68&#39;)"><span class="hl_vardecl"><span class="mpre">cipherID</span></span></a><span class="mpre"> </span><a name="loc_353_69_353_82" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_353_69_353_82&#39;)"><span class="hl_vardecl"><span class="mpre">compressionID</span></span></a><span class="mpre"> </span><a name="loc_353_83_353_87" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_353_83_353_87&#39;)"><span class="hl_vardecl"><span class="mpre">exts</span></span></a><span class="mpre">) =
    </span><a href="#loc_93_1_93_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_1_93_11&#39;)"><span class="hl_varref"><span class="mpre">putVersion</span></span></a><span class="mpre"> </span><a href="#loc_353_37_353_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_353_37_353_44&#39;)"><span class="hl_varref"><span class="mpre">version</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="#loc_420_1_420_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_420_1_420_18&#39;)"><span class="hl_varref"><span class="mpre">putServerRandom32</span></span></a><span class="mpre"> </span><a href="#loc_353_45_353_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_353_45_353_51&#39;)"><span class="hl_varref"><span class="mpre">random</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="#loc_430_1_430_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_430_1_430_11&#39;)"><span class="hl_varref"><span class="mpre">putSession</span></span></a><span class="mpre"> </span><a href="#loc_353_52_353_59" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_353_52_353_59&#39;)"><span class="hl_varref"><span class="mpre">session</span></span></a><span class="mpre">
                       </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="Network.TLS.Wire.html#loc_132_1_132_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Wire.html#loc_132_1_132_10&#39;)"><span class="hl_varref"><span class="mpre">putWord16</span></span></a><span class="mpre"> </span><a href="#loc_353_60_353_68" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_353_60_353_68&#39;)"><span class="hl_varref"><span class="mpre">cipherID</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="Data.Serialize.Put.html#loc_176_1_176_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Put.html#loc_176_1_176_9&#39;)"><span class="hl_varref"><span class="mpre">putWord8</span></span></a><span class="mpre"> </span><a href="#loc_353_69_353_82" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_353_69_353_82&#39;)"><span class="hl_varref"><span class="mpre">compressionID</span></span></a><span class="mpre">
                       </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="#loc_446_1_446_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_1_446_14&#39;)"><span class="hl_varref"><span class="mpre">putExtensions</span></span></a><span class="mpre"> </span><a href="#loc_353_83_353_87" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_353_83_353_87&#39;)"><span class="hl_varref"><span class="mpre">exts</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">

</span><a href="#loc_342_1_342_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_342_1_342_23&#39;)"><span class="hl_fundecl"><span class="mpre">encodeHandshakeContent</span></span></a><span class="mpre"> (</span><a href="Network.TLS.Struct.html#loc_255_7_255_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_255_7_255_19&#39;)"><span class="hl_conref"><span class="mpre">Certificates</span></span></a><span class="mpre"> </span><a name="loc_358_38_358_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_358_38_358_40&#39;)"><span class="hl_vardecl"><span class="mpre">cc</span></span></a><span class="mpre">) = </span><a href="Network.TLS.Wire.html#loc_156_1_156_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Wire.html#loc_156_1_156_12&#39;)"><span class="hl_varref"><span class="mpre">putOpaque24</span></span></a><span class="mpre"> (</span><a href="Data.Serialize.Put.html#loc_148_1_148_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Put.html#loc_148_1_148_7&#39;)"><span class="hl_varref"><span class="mpre">runPut</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Control.Monad.html#loc_116_1_116_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_116_1_116_6&#39;)"><span class="hl_varref"><span class="mpre">mapM_</span></span></a><span class="mpre"> </span><a href="Network.TLS.Wire.html#loc_156_1_156_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Wire.html#loc_156_1_156_12&#39;)"><span class="hl_varref"><span class="mpre">putOpaque24</span></span></a><span class="mpre"> </span><a href="#loc_359_30_359_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_359_30_359_35&#39;)"><span class="hl_varref"><span class="mpre">certs</span></span></a><span class="mpre">)
  where (</span><a href="Data.X509.CertificateChain.html#loc_25_31_25_50" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.CertificateChain.html#loc_25_31_25_50&#39;)"><span class="hl_conref"><span class="mpre">CertificateChainRaw</span></span></a><span class="mpre"> </span><a name="loc_359_30_359_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_359_30_359_35&#39;)"><span class="hl_vardecl"><span class="mpre">certs</span></span></a><span class="mpre">) = </span><a href="Data.X509.CertificateChain.html#loc_41_1_41_23" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.CertificateChain.html#loc_41_1_41_23&#39;)"><span class="hl_varref"><span class="mpre">encodeCertificateChain</span></span></a><span class="mpre"> </span><a href="#loc_358_38_358_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_358_38_358_40&#39;)"><span class="hl_varref"><span class="mpre">cc</span></span></a><span class="mpre">

</span><a href="#loc_342_1_342_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_342_1_342_23&#39;)"><span class="hl_fundecl"><span class="mpre">encodeHandshakeContent</span></span></a><span class="mpre"> (</span><a href="Network.TLS.Struct.html#loc_258_7_258_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_258_7_258_20&#39;)"><span class="hl_conref"><span class="mpre">ClientKeyXchg</span></span></a><span class="mpre"> </span><a name="loc_361_39_361_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_361_39_361_42&#39;)"><span class="hl_vardecl"><span class="mpre">ckx</span></span></a><span class="mpre">) = do
    case </span><a href="#loc_361_39_361_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_361_39_361_42&#39;)"><span class="hl_varref"><span class="mpre">ckx</span></span></a><span class="mpre"> of
        </span><a href="Network.TLS.Struct.html#loc_246_7_246_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_246_7_246_14&#39;)"><span class="hl_conref"><span class="mpre">CKX_RSA</span></span></a><span class="mpre"> </span><a name="loc_363_17_363_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_363_17_363_35&#39;)"><span class="hl_vardecl"><span class="mpre">encryptedPreMaster</span></span></a><span class="mpre"> -&gt; </span><a href="Network.TLS.Wire.html#loc_147_1_147_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Wire.html#loc_147_1_147_9&#39;)"><span class="hl_varref"><span class="mpre">putBytes</span></span></a><span class="mpre"> </span><a href="#loc_363_17_363_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_363_17_363_35&#39;)"><span class="hl_varref"><span class="mpre">encryptedPreMaster</span></span></a><span class="mpre">
        </span><a href="Network.TLS.Struct.html#loc_247_7_247_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_247_7_247_13&#39;)"><span class="hl_conref"><span class="mpre">CKX_DH</span></span></a><span class="mpre"> </span><a name="loc_364_16_364_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_364_16_364_30&#39;)"><span class="hl_vardecl"><span class="mpre">clientDHPublic</span></span></a><span class="mpre">      -&gt; </span><a href="Network.TLS.Wire.html#loc_159_1_159_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Wire.html#loc_159_1_159_13&#39;)"><span class="hl_varref"><span class="mpre">putInteger16</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.TLS.Crypto.DH.html#loc_53_1_53_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Crypto.DH.html#loc_53_1_53_15&#39;)"><span class="hl_varref"><span class="mpre">dhUnwrapPublic</span></span></a><span class="mpre"> </span><a href="#loc_364_16_364_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_364_16_364_30&#39;)"><span class="hl_varref"><span class="mpre">clientDHPublic</span></span></a><span class="mpre">

</span><a href="#loc_342_1_342_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_342_1_342_23&#39;)"><span class="hl_fundecl"><span class="mpre">encodeHandshakeContent</span></span></a><span class="mpre"> (</span><a href="Network.TLS.Struct.html#loc_259_7_259_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_259_7_259_20&#39;)"><span class="hl_conref"><span class="mpre">ServerKeyXchg</span></span></a><span class="mpre"> </span><a name="loc_366_39_366_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_366_39_366_42&#39;)"><span class="hl_vardecl"><span class="mpre">skg</span></span></a><span class="mpre">) =
    case </span><a href="#loc_366_39_366_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_366_39_366_42&#39;)"><span class="hl_varref"><span class="mpre">skg</span></span></a><span class="mpre"> of
        </span><a href="Network.TLS.Struct.html#loc_238_7_238_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_238_7_238_14&#39;)"><span class="hl_conref"><span class="mpre">SKX_RSA</span></span></a><span class="mpre"> _              -&gt; </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;encodeHandshakeContent SKX_RSA not implemented&quot;</span></span><span class="mpre">
        </span><a href="Network.TLS.Struct.html#loc_235_7_235_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_235_7_235_18&#39;)"><span class="hl_conref"><span class="mpre">SKX_DH_Anon</span></span></a><span class="mpre"> </span><a name="loc_369_21_369_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_369_21_369_27&#39;)"><span class="hl_vardecl"><span class="mpre">params</span></span></a><span class="mpre">     -&gt; </span><a href="#loc_466_1_466_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_466_1_466_18&#39;)"><span class="hl_varref"><span class="mpre">putServerDHParams</span></span></a><span class="mpre"> </span><a href="#loc_369_21_369_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_369_21_369_27&#39;)"><span class="hl_varref"><span class="mpre">params</span></span></a><span class="mpre">
        </span><a href="Network.TLS.Struct.html#loc_237_7_237_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_237_7_237_18&#39;)"><span class="hl_conref"><span class="mpre">SKX_DHE_RSA</span></span></a><span class="mpre"> </span><a name="loc_370_21_370_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_370_21_370_27&#39;)"><span class="hl_vardecl"><span class="mpre">params</span></span></a><span class="mpre"> </span><a name="loc_370_28_370_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_370_28_370_31&#39;)"><span class="hl_vardecl"><span class="mpre">sig</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_466_1_466_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_466_1_466_18&#39;)"><span class="hl_varref"><span class="mpre">putServerDHParams</span></span></a><span class="mpre"> </span><a href="#loc_370_21_370_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_370_21_370_27&#39;)"><span class="hl_varref"><span class="mpre">params</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="#loc_476_1_476_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_476_1_476_19&#39;)"><span class="hl_varref"><span class="mpre">putDigitallySigned</span></span></a><span class="mpre"> </span><a href="#loc_370_28_370_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_370_28_370_31&#39;)"><span class="hl_varref"><span class="mpre">sig</span></span></a><span class="mpre">
        </span><a href="Network.TLS.Struct.html#loc_236_7_236_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_236_7_236_18&#39;)"><span class="hl_conref"><span class="mpre">SKX_DHE_DSS</span></span></a><span class="mpre"> </span><a name="loc_371_21_371_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_371_21_371_27&#39;)"><span class="hl_vardecl"><span class="mpre">params</span></span></a><span class="mpre"> </span><a name="loc_371_28_371_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_371_28_371_31&#39;)"><span class="hl_vardecl"><span class="mpre">sig</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_466_1_466_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_466_1_466_18&#39;)"><span class="hl_varref"><span class="mpre">putServerDHParams</span></span></a><span class="mpre"> </span><a href="#loc_371_21_371_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_371_21_371_27&#39;)"><span class="hl_varref"><span class="mpre">params</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="#loc_476_1_476_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_476_1_476_19&#39;)"><span class="hl_varref"><span class="mpre">putDigitallySigned</span></span></a><span class="mpre"> </span><a href="#loc_371_28_371_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_371_28_371_31&#39;)"><span class="hl_varref"><span class="mpre">sig</span></span></a><span class="mpre">
        </span><a href="Network.TLS.Struct.html#loc_241_7_241_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_241_7_241_19&#39;)"><span class="hl_conref"><span class="mpre">SKX_Unparsed</span></span></a><span class="mpre"> </span><a name="loc_372_22_372_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_372_22_372_27&#39;)"><span class="hl_vardecl"><span class="mpre">bytes</span></span></a><span class="mpre">     -&gt; </span><a href="Network.TLS.Wire.html#loc_147_1_147_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Wire.html#loc_147_1_147_9&#39;)"><span class="hl_varref"><span class="mpre">putBytes</span></span></a><span class="mpre"> </span><a href="#loc_372_22_372_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_372_22_372_27&#39;)"><span class="hl_varref"><span class="mpre">bytes</span></span></a><span class="mpre">
        _                      -&gt; </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;encodeHandshakeContent: cannot handle: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_366_39_366_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_366_39_366_42&#39;)"><span class="hl_varref"><span class="mpre">skg</span></span></a><span class="mpre">)

</span><a href="#loc_342_1_342_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_342_1_342_23&#39;)"><span class="hl_fundecl"><span class="mpre">encodeHandshakeContent</span></span></a><span class="mpre"> (</span><a href="Network.TLS.Struct.html#loc_256_7_256_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_256_7_256_19&#39;)"><span class="hl_conref"><span class="mpre">HelloRequest</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">
</span><a href="#loc_342_1_342_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_342_1_342_23&#39;)"><span class="hl_fundecl"><span class="mpre">encodeHandshakeContent</span></span></a><span class="mpre"> (</span><a href="Network.TLS.Struct.html#loc_257_7_257_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_257_7_257_22&#39;)"><span class="hl_conref"><span class="mpre">ServerHelloDone</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">

</span><a href="#loc_342_1_342_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_342_1_342_23&#39;)"><span class="hl_fundecl"><span class="mpre">encodeHandshakeContent</span></span></a><span class="mpre"> (</span><a href="Network.TLS.Struct.html#loc_260_7_260_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_260_7_260_18&#39;)"><span class="hl_conref"><span class="mpre">CertRequest</span></span></a><span class="mpre"> </span><a name="loc_378_37_378_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_378_37_378_46&#39;)"><span class="hl_vardecl"><span class="mpre">certTypes</span></span></a><span class="mpre"> </span><a name="loc_378_47_378_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_378_47_378_54&#39;)"><span class="hl_vardecl"><span class="mpre">sigAlgs</span></span></a><span class="mpre"> </span><a name="loc_378_55_378_70" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_378_55_378_70&#39;)"><span class="hl_vardecl"><span class="mpre">certAuthorities</span></span></a><span class="mpre">) = do
    </span><a href="Network.TLS.Wire.html#loc_127_1_127_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Wire.html#loc_127_1_127_10&#39;)"><span class="hl_varref"><span class="mpre">putWords8</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_301_5_301_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_301_5_301_14&#39;)"><span class="hl_varref"><span class="mpre">valOfType</span></span></a><span class="mpre"> </span><a href="#loc_378_37_378_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_378_37_378_46&#39;)"><span class="hl_varref"><span class="mpre">certTypes</span></span></a><span class="mpre">)
    case </span><a href="#loc_378_47_378_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_378_47_378_54&#39;)"><span class="hl_varref"><span class="mpre">sigAlgs</span></span></a><span class="mpre"> of
        </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">
        </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_382_14_382_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_382_14_382_15&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre">  -&gt; </span><a href="Network.TLS.Wire.html#loc_135_1_135_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Wire.html#loc_135_1_135_11&#39;)"><span class="hl_varref"><span class="mpre">putWords16</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (\(</span><a name="loc_382_40_382_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_382_40_382_41&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">,</span><a name="loc_382_42_382_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_382_42_382_43&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre">) -&gt; (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_301_5_301_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_301_5_301_14&#39;)"><span class="hl_varref"><span class="mpre">valOfType</span></span></a><span class="mpre"> </span><a href="#loc_382_40_382_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_382_40_382_41&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">256</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_301_5_301_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_301_5_301_14&#39;)"><span class="hl_varref"><span class="mpre">valOfType</span></span></a><span class="mpre"> </span><a href="#loc_382_42_382_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_382_42_382_43&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">)) </span><a href="#loc_382_14_382_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_382_14_382_15&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">
    </span><a href="#loc_388_9_388_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_388_9_388_30&#39;)"><span class="hl_varref"><span class="mpre">encodeCertAuthorities</span></span></a><span class="mpre"> </span><a href="#loc_378_55_378_70" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_378_55_378_70&#39;)"><span class="hl_varref"><span class="mpre">certAuthorities</span></span></a><span class="mpre">
  where </span><span class="hl_comment"><span class="mpre">-- Convert a distinguished name to its DER encoding.</span></span><span class="mpre">
        </span><a name="loc_385_9_385_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_385_9_385_17&#39;)"><span class="hl_fundecl"><span class="mpre">encodeCA</span></span></a><span class="mpre"> </span><a name="loc_385_18_385_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_385_18_385_20&#39;)"><span class="hl_vardecl"><span class="mpre">dn</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.ASN1.Encoding.html#loc_51_1_51_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Encoding.html#loc_51_1_51_12&#39;)"><span class="hl_varref"><span class="mpre">encodeASN1&#39;</span></span></a><span class="mpre"> </span><a href="Data.ASN1.BinaryEncoding.html#loc_30_12_30_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.BinaryEncoding.html#loc_30_12_30_15&#39;)"><span class="hl_conref"><span class="mpre">DER</span></span></a><span class="mpre"> (</span><a href="Data.ASN1.Types.html#loc_66_5_66_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_66_5_66_11&#39;)"><span class="hl_varref"><span class="mpre">toASN1</span></span></a><span class="mpre"> </span><a href="#loc_385_18_385_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_385_18_385_20&#39;)"><span class="hl_varref"><span class="mpre">dn</span></span></a><span class="mpre"> []) </span><span class="hl_comment"><span class="mpre">--B.concat $ L.toChunks $ encodeDN dn</span></span><span class="mpre">

        </span><span class="hl_comment"><span class="mpre">-- Encode a list of distinguished names.</span></span><span class="mpre">
        </span><a name="loc_388_9_388_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_388_9_388_30&#39;)"><span class="hl_fundecl"><span class="mpre">encodeCertAuthorities</span></span></a><span class="mpre"> </span><a name="loc_388_31_388_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_388_31_388_40&#39;)"><span class="hl_vardecl"><span class="mpre">certAuths</span></span></a><span class="mpre"> = do
            </span><a name="loc_389_13_389_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_389_13_389_16&#39;)"><span class="hl_vardecl"><span class="mpre">enc</span></span></a><span class="mpre"> &lt;- </span><a href="Control.Monad.html#loc_111_1_111_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_111_1_111_5&#39;)"><span class="hl_varref"><span class="mpre">mapM</span></span></a><span class="mpre"> </span><a href="#loc_385_9_385_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_385_9_385_17&#39;)"><span class="hl_varref"><span class="mpre">encodeCA</span></span></a><span class="mpre"> </span><a href="#loc_388_31_388_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_388_31_388_40&#39;)"><span class="hl_varref"><span class="mpre">certAuths</span></span></a><span class="mpre">
            let </span><a name="loc_390_17_390_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_390_17_390_26&#39;)"><span class="hl_vardecl"><span class="mpre">totLength</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">sum</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> ((</span><span class="hl_varref"><span class="mpre">(+)</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre">) </span><a href="#loc_389_13_389_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_389_13_389_16&#39;)"><span class="hl_varref"><span class="mpre">enc</span></span></a><span class="mpre">
            </span><a href="Network.TLS.Wire.html#loc_132_1_132_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Wire.html#loc_132_1_132_10&#39;)"><span class="hl_varref"><span class="mpre">putWord16</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_390_17_390_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_390_17_390_26&#39;)"><span class="hl_varref"><span class="mpre">totLength</span></span></a><span class="mpre">)
            </span><a href="Control.Monad.html#loc_116_1_116_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_116_1_116_6&#39;)"><span class="hl_varref"><span class="mpre">mapM_</span></span></a><span class="mpre"> (\ </span><a name="loc_392_22_392_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_392_22_392_23&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> -&gt; </span><a href="Network.TLS.Wire.html#loc_132_1_132_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Wire.html#loc_132_1_132_10&#39;)"><span class="hl_varref"><span class="mpre">putWord16</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_392_22_392_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_392_22_392_23&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">)) </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="Network.TLS.Wire.html#loc_147_1_147_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Wire.html#loc_147_1_147_9&#39;)"><span class="hl_varref"><span class="mpre">putBytes</span></span></a><span class="mpre"> </span><a href="#loc_392_22_392_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_392_22_392_23&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">) </span><a href="#loc_389_13_389_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_389_13_389_16&#39;)"><span class="hl_varref"><span class="mpre">enc</span></span></a><span class="mpre">

</span><a href="#loc_342_1_342_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_342_1_342_23&#39;)"><span class="hl_fundecl"><span class="mpre">encodeHandshakeContent</span></span></a><span class="mpre"> (</span><a href="Network.TLS.Struct.html#loc_261_7_261_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_261_7_261_17&#39;)"><span class="hl_conref"><span class="mpre">CertVerify</span></span></a><span class="mpre"> </span><a name="loc_394_36_394_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_394_36_394_51&#39;)"><span class="hl_vardecl"><span class="mpre">digitallySigned</span></span></a><span class="mpre">) = </span><a href="#loc_476_1_476_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_476_1_476_19&#39;)"><span class="hl_varref"><span class="mpre">putDigitallySigned</span></span></a><span class="mpre"> </span><a href="#loc_394_36_394_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_394_36_394_51&#39;)"><span class="hl_varref"><span class="mpre">digitallySigned</span></span></a><span class="mpre">

</span><a href="#loc_342_1_342_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_342_1_342_23&#39;)"><span class="hl_fundecl"><span class="mpre">encodeHandshakeContent</span></span></a><span class="mpre"> (</span><a href="Network.TLS.Struct.html#loc_262_7_262_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_262_7_262_15&#39;)"><span class="hl_conref"><span class="mpre">Finished</span></span></a><span class="mpre"> </span><a name="loc_396_34_396_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_396_34_396_40&#39;)"><span class="hl_vardecl"><span class="mpre">opaque</span></span></a><span class="mpre">) = </span><a href="Network.TLS.Wire.html#loc_147_1_147_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Wire.html#loc_147_1_147_9&#39;)"><span class="hl_varref"><span class="mpre">putBytes</span></span></a><span class="mpre"> </span><a href="#loc_396_34_396_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_396_34_396_40&#39;)"><span class="hl_varref"><span class="mpre">opaque</span></span></a><span class="mpre">

</span><a href="#loc_342_1_342_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_342_1_342_23&#39;)"><span class="hl_fundecl"><span class="mpre">encodeHandshakeContent</span></span></a><span class="mpre"> (</span><a href="Network.TLS.Struct.html#loc_263_7_263_32" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_263_7_263_32&#39;)"><span class="hl_conref"><span class="mpre">HsNextProtocolNegotiation</span></span></a><span class="mpre"> </span><a name="loc_398_51_398_59" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_398_51_398_59&#39;)"><span class="hl_vardecl"><span class="mpre">protocol</span></span></a><span class="mpre">) = do
    </span><a href="Network.TLS.Wire.html#loc_150_1_150_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Wire.html#loc_150_1_150_11&#39;)"><span class="hl_varref"><span class="mpre">putOpaque8</span></span></a><span class="mpre"> </span><a href="#loc_398_51_398_59" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_398_51_398_59&#39;)"><span class="hl_varref"><span class="mpre">protocol</span></span></a><span class="mpre">
    </span><a href="Network.TLS.Wire.html#loc_150_1_150_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Wire.html#loc_150_1_150_11&#39;)"><span class="hl_varref"><span class="mpre">putOpaque8</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.replicate</span></span><span class="mpre"> </span><a href="#loc_401_9_401_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_401_9_401_19&#39;)"><span class="hl_varref"><span class="mpre">paddingLen</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
  where </span><a name="loc_401_9_401_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_401_9_401_19&#39;)"><span class="hl_vardecl"><span class="mpre">paddingLen</span></span></a><span class="mpre"> = </span><span class="hl_num"><span class="mpre">32</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> ((</span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_398_51_398_59" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_398_51_398_59&#39;)"><span class="hl_varref"><span class="mpre">protocol</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">`mod`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">32</span></span><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">{- FIXME make sure it return error if not 32 available -}</span></span><span class="mpre">
</span><a href="#loc_405_1_405_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_405_1_405_12&#39;)"><span class="mpre">getRandom32</span></a><span class="mpre"> :: </span><a href="Data.Serialize.Get.html#loc_138_9_138_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Get.html#loc_138_9_138_12&#39;)"><span class="hl_tyconref"><span class="mpre">Get</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bytes</span></span><span class="mpre">
</span><a name="loc_405_1_405_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_405_1_405_12&#39;)"><span class="hl_vardecl"><span class="mpre">getRandom32</span></span></a><span class="mpre"> = </span><a href="Data.Serialize.Get.html#loc_438_1_438_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Get.html#loc_438_1_438_9&#39;)"><span class="hl_varref"><span class="mpre">getBytes</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">32</span></span><span class="mpre">

</span><a href="#loc_408_1_408_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_408_1_408_18&#39;)"><span class="mpre">getServerRandom32</span></a><span class="mpre"> :: </span><a href="Data.Serialize.Get.html#loc_138_9_138_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Get.html#loc_138_9_138_12&#39;)"><span class="hl_tyconref"><span class="mpre">Get</span></span></a><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_159_9_159_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_159_9_159_21&#39;)"><span class="hl_tyconref"><span class="mpre">ServerRandom</span></span></a><span class="mpre">
</span><a name="loc_408_1_408_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_408_1_408_18&#39;)"><span class="hl_vardecl"><span class="mpre">getServerRandom32</span></span></a><span class="mpre"> = </span><a href="Network.TLS.Struct.html#loc_159_24_159_36" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_159_24_159_36&#39;)"><span class="hl_conref"><span class="mpre">ServerRandom</span></span></a><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="#loc_405_1_405_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_405_1_405_12&#39;)"><span class="hl_varref"><span class="mpre">getRandom32</span></span></a><span class="mpre">

</span><a href="#loc_411_1_411_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_411_1_411_18&#39;)"><span class="mpre">getClientRandom32</span></a><span class="mpre"> :: </span><a href="Data.Serialize.Get.html#loc_138_9_138_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Get.html#loc_138_9_138_12&#39;)"><span class="hl_tyconref"><span class="mpre">Get</span></span></a><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_160_9_160_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_160_9_160_21&#39;)"><span class="hl_tyconref"><span class="mpre">ClientRandom</span></span></a><span class="mpre">
</span><a name="loc_411_1_411_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_411_1_411_18&#39;)"><span class="hl_vardecl"><span class="mpre">getClientRandom32</span></span></a><span class="mpre"> = </span><a href="Network.TLS.Struct.html#loc_160_24_160_36" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_160_24_160_36&#39;)"><span class="hl_conref"><span class="mpre">ClientRandom</span></span></a><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="#loc_405_1_405_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_405_1_405_12&#39;)"><span class="hl_varref"><span class="mpre">getRandom32</span></span></a><span class="mpre">

</span><a href="#loc_414_1_414_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_414_1_414_12&#39;)"><span class="mpre">putRandom32</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Bytes</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Put</span></span><span class="mpre">
</span><a name="loc_414_1_414_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_414_1_414_12&#39;)"><span class="hl_vardecl"><span class="mpre">putRandom32</span></span></a><span class="mpre"> = </span><a href="Network.TLS.Wire.html#loc_147_1_147_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Wire.html#loc_147_1_147_9&#39;)"><span class="hl_varref"><span class="mpre">putBytes</span></span></a><span class="mpre">

</span><a href="#loc_417_1_417_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_417_1_417_18&#39;)"><span class="mpre">putClientRandom32</span></a><span class="mpre"> :: </span><a href="Network.TLS.Struct.html#loc_160_9_160_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_160_9_160_21&#39;)"><span class="hl_tyconref"><span class="mpre">ClientRandom</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Put</span></span><span class="mpre">
</span><a name="loc_417_1_417_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_417_1_417_18&#39;)"><span class="hl_fundecl"><span class="mpre">putClientRandom32</span></span></a><span class="mpre"> (</span><a href="Network.TLS.Struct.html#loc_160_24_160_36" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_160_24_160_36&#39;)"><span class="hl_conref"><span class="mpre">ClientRandom</span></span></a><span class="mpre"> </span><a name="loc_417_33_417_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_417_33_417_34&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">) = </span><a href="#loc_414_1_414_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_414_1_414_12&#39;)"><span class="hl_varref"><span class="mpre">putRandom32</span></span></a><span class="mpre"> </span><a href="#loc_417_33_417_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_417_33_417_34&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">

</span><a href="#loc_420_1_420_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_420_1_420_18&#39;)"><span class="mpre">putServerRandom32</span></a><span class="mpre"> :: </span><a href="Network.TLS.Struct.html#loc_159_9_159_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_159_9_159_21&#39;)"><span class="hl_tyconref"><span class="mpre">ServerRandom</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Put</span></span><span class="mpre">
</span><a name="loc_420_1_420_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_420_1_420_18&#39;)"><span class="hl_fundecl"><span class="mpre">putServerRandom32</span></span></a><span class="mpre"> (</span><a href="Network.TLS.Struct.html#loc_159_24_159_36" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_159_24_159_36&#39;)"><span class="hl_conref"><span class="mpre">ServerRandom</span></span></a><span class="mpre"> </span><a name="loc_420_33_420_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_420_33_420_34&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">) = </span><a href="#loc_414_1_414_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_414_1_414_12&#39;)"><span class="hl_varref"><span class="mpre">putRandom32</span></span></a><span class="mpre"> </span><a href="#loc_420_33_420_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_420_33_420_34&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">

</span><a href="#loc_423_1_423_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_423_1_423_11&#39;)"><span class="mpre">getSession</span></a><span class="mpre"> :: </span><a href="Data.Serialize.Get.html#loc_138_9_138_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Get.html#loc_138_9_138_12&#39;)"><span class="hl_tyconref"><span class="mpre">Get</span></span></a><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_161_9_161_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_161_9_161_16&#39;)"><span class="hl_tyconref"><span class="mpre">Session</span></span></a><span class="mpre">
</span><a name="loc_423_1_423_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_423_1_423_11&#39;)"><span class="hl_vardecl"><span class="mpre">getSession</span></span></a><span class="mpre"> = do
    </span><a name="loc_424_5_424_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_424_5_424_9&#39;)"><span class="hl_vardecl"><span class="mpre">len8</span></span></a><span class="mpre"> &lt;- </span><a href="Data.Serialize.Get.html#loc_467_1_467_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Get.html#loc_467_1_467_9&#39;)"><span class="hl_varref"><span class="mpre">getWord8</span></span></a><span class="mpre">
    case </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_424_5_424_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_424_5_424_9&#39;)"><span class="hl_varref"><span class="mpre">len8</span></span></a><span class="mpre"> of
        </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">   -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_161_19_161_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_161_19_161_26&#39;)"><span class="hl_conref"><span class="mpre">Session</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
        </span><a name="loc_427_9_427_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_427_9_427_12&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre"> -&gt; </span><a href="Network.TLS.Struct.html#loc_161_19_161_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_161_19_161_26&#39;)"><span class="hl_conref"><span class="mpre">Session</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="Data.Serialize.Get.html#loc_438_1_438_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Get.html#loc_438_1_438_9&#39;)"><span class="hl_varref"><span class="mpre">getBytes</span></span></a><span class="mpre"> </span><a href="#loc_427_9_427_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_427_9_427_12&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre">

</span><a href="#loc_430_1_430_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_430_1_430_11&#39;)"><span class="mpre">putSession</span></a><span class="mpre"> :: </span><a href="Network.TLS.Struct.html#loc_161_9_161_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_161_9_161_16&#39;)"><span class="hl_tyconref"><span class="mpre">Session</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Put</span></span><span class="mpre">
</span><a name="loc_430_1_430_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_430_1_430_11&#39;)"><span class="hl_fundecl"><span class="mpre">putSession</span></span></a><span class="mpre"> (</span><a href="Network.TLS.Struct.html#loc_161_19_161_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_161_19_161_26&#39;)"><span class="hl_conref"><span class="mpre">Session</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">)  = </span><a href="Data.Serialize.Put.html#loc_176_1_176_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Put.html#loc_176_1_176_9&#39;)"><span class="hl_varref"><span class="mpre">putWord8</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
</span><a href="#loc_430_1_430_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_430_1_430_11&#39;)"><span class="hl_fundecl"><span class="mpre">putSession</span></span></a><span class="mpre"> (</span><a href="Network.TLS.Struct.html#loc_161_19_161_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_161_19_161_26&#39;)"><span class="hl_conref"><span class="mpre">Session</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_431_27_431_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_431_27_431_28&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">)) = </span><a href="Network.TLS.Wire.html#loc_150_1_150_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Wire.html#loc_150_1_150_11&#39;)"><span class="hl_varref"><span class="mpre">putOpaque8</span></span></a><span class="mpre"> </span><a href="#loc_431_27_431_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_431_27_431_28&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">

</span><a href="#loc_434_1_434_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_434_1_434_14&#39;)"><span class="mpre">getExtensions</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><a href="Data.Serialize.Get.html#loc_138_9_138_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Get.html#loc_138_9_138_12&#39;)"><span class="hl_tyconref"><span class="mpre">Get</span></span></a><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">ExtensionRaw</span></span><span class="mpre">]
</span><a name="loc_434_1_434_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_434_1_434_14&#39;)"><span class="hl_fundecl"><span class="mpre">getExtensions</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">   = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> []
</span><a href="#loc_434_1_434_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_434_1_434_14&#39;)"><span class="hl_fundecl"><span class="mpre">getExtensions</span></span></a><span class="mpre"> </span><a name="loc_435_15_435_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_435_15_435_18&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre"> = do
    </span><a name="loc_436_5_436_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_436_5_436_10&#39;)"><span class="hl_vardecl"><span class="mpre">extty</span></span></a><span class="mpre"> &lt;- </span><a href="Network.TLS.Wire.html#loc_92_1_92_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Wire.html#loc_92_1_92_10&#39;)"><span class="hl_varref"><span class="mpre">getWord16</span></span></a><span class="mpre">
    </span><a name="loc_437_5_437_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_437_5_437_15&#39;)"><span class="hl_vardecl"><span class="mpre">extdatalen</span></span></a><span class="mpre"> &lt;- </span><a href="Network.TLS.Wire.html#loc_92_1_92_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Wire.html#loc_92_1_92_10&#39;)"><span class="hl_varref"><span class="mpre">getWord16</span></span></a><span class="mpre">
    </span><a name="loc_438_5_438_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_438_5_438_12&#39;)"><span class="hl_vardecl"><span class="mpre">extdata</span></span></a><span class="mpre"> &lt;- </span><a href="Data.Serialize.Get.html#loc_438_1_438_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Get.html#loc_438_1_438_9&#39;)"><span class="hl_varref"><span class="mpre">getBytes</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_437_5_437_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_437_5_437_15&#39;)"><span class="hl_varref"><span class="mpre">extdatalen</span></span></a><span class="mpre">
    </span><a name="loc_439_5_439_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_439_5_439_10&#39;)"><span class="hl_vardecl"><span class="mpre">extxs</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_434_1_434_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_434_1_434_14&#39;)"><span class="hl_varref"><span class="mpre">getExtensions</span></span></a><span class="mpre"> (</span><a href="#loc_435_15_435_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_435_15_435_18&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_437_5_437_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_437_5_437_15&#39;)"><span class="hl_varref"><span class="mpre">extdatalen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">)
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> (</span><a href="#loc_436_5_436_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_436_5_436_10&#39;)"><span class="hl_varref"><span class="mpre">extty</span></span></a><span class="mpre">, </span><a href="#loc_438_5_438_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_438_5_438_12&#39;)"><span class="hl_varref"><span class="mpre">extdata</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_439_5_439_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_439_5_439_10&#39;)"><span class="hl_varref"><span class="mpre">extxs</span></span></a><span class="mpre">

</span><a href="#loc_443_1_443_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_443_1_443_13&#39;)"><span class="mpre">putExtension</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ExtensionRaw</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Put</span></span><span class="mpre">
</span><a name="loc_443_1_443_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_443_1_443_13&#39;)"><span class="hl_fundecl"><span class="mpre">putExtension</span></span></a><span class="mpre"> (</span><a name="loc_443_15_443_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_443_15_443_17&#39;)"><span class="hl_vardecl"><span class="mpre">ty</span></span></a><span class="mpre">, </span><a name="loc_443_19_443_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_443_19_443_20&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre">) = </span><a href="Network.TLS.Wire.html#loc_132_1_132_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Wire.html#loc_132_1_132_10&#39;)"><span class="hl_varref"><span class="mpre">putWord16</span></span></a><span class="mpre"> </span><a href="#loc_443_15_443_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_443_15_443_17&#39;)"><span class="hl_varref"><span class="mpre">ty</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="Network.TLS.Wire.html#loc_153_1_153_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Wire.html#loc_153_1_153_12&#39;)"><span class="hl_varref"><span class="mpre">putOpaque16</span></span></a><span class="mpre"> </span><a href="#loc_443_19_443_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_443_19_443_20&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">

</span><a href="#loc_446_1_446_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_1_446_14&#39;)"><span class="mpre">putExtensions</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">ExtensionRaw</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">Put</span></span><span class="mpre">
</span><a name="loc_446_1_446_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_1_446_14&#39;)"><span class="hl_fundecl"><span class="mpre">putExtensions</span></span></a><span class="mpre"> [] = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">
</span><a href="#loc_446_1_446_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_446_1_446_14&#39;)"><span class="hl_fundecl"><span class="mpre">putExtensions</span></span></a><span class="mpre"> </span><a name="loc_447_15_447_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_447_15_447_17&#39;)"><span class="hl_vardecl"><span class="mpre">es</span></span></a><span class="mpre"> = </span><a href="Network.TLS.Wire.html#loc_153_1_153_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Wire.html#loc_153_1_153_12&#39;)"><span class="hl_varref"><span class="mpre">putOpaque16</span></span></a><span class="mpre"> (</span><a href="Data.Serialize.Put.html#loc_148_1_148_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Put.html#loc_148_1_148_7&#39;)"><span class="hl_varref"><span class="mpre">runPut</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Control.Monad.html#loc_116_1_116_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_116_1_116_6&#39;)"><span class="hl_varref"><span class="mpre">mapM_</span></span></a><span class="mpre"> </span><a href="#loc_443_1_443_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_443_1_443_13&#39;)"><span class="hl_varref"><span class="mpre">putExtension</span></span></a><span class="mpre"> </span><a href="#loc_447_15_447_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_447_15_447_17&#39;)"><span class="hl_varref"><span class="mpre">es</span></span></a><span class="mpre">)

</span><a href="#loc_450_1_450_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_450_1_450_26&#39;)"><span class="mpre">getSignatureHashAlgorithm</span></a><span class="mpre"> :: </span><a href="Data.Serialize.Get.html#loc_138_9_138_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Get.html#loc_138_9_138_12&#39;)"><span class="hl_tyconref"><span class="mpre">Get</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">HashAndSignatureAlgorithm</span></span><span class="mpre">
</span><a name="loc_450_1_450_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_450_1_450_26&#39;)"><span class="hl_vardecl"><span class="mpre">getSignatureHashAlgorithm</span></span></a><span class="mpre"> = do
    </span><a name="loc_451_5_451_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_451_5_451_6&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre"> &lt;- </span><a href="Data.Maybe.html#loc_91_1_91_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_91_1_91_9&#39;)"><span class="hl_varref"><span class="mpre">fromJust</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_302_5_302_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_302_5_302_14&#39;)"><span class="hl_varref"><span class="mpre">valToType</span></span></a><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="Data.Serialize.Get.html#loc_467_1_467_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Get.html#loc_467_1_467_9&#39;)"><span class="hl_varref"><span class="mpre">getWord8</span></span></a><span class="mpre">
    </span><a name="loc_452_5_452_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_452_5_452_6&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> &lt;- </span><a href="Data.Maybe.html#loc_91_1_91_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_91_1_91_9&#39;)"><span class="hl_varref"><span class="mpre">fromJust</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_302_5_302_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_302_5_302_14&#39;)"><span class="hl_varref"><span class="mpre">valToType</span></span></a><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="Data.Serialize.Get.html#loc_467_1_467_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Get.html#loc_467_1_467_9&#39;)"><span class="hl_varref"><span class="mpre">getWord8</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_451_5_451_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_451_5_451_6&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre">,</span><a href="#loc_452_5_452_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_452_5_452_6&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)

</span><a href="#loc_456_1_456_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_456_1_456_26&#39;)"><span class="mpre">putSignatureHashAlgorithm</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">HashAndSignatureAlgorithm</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Put</span></span><span class="mpre">
</span><a name="loc_456_1_456_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_456_1_456_26&#39;)"><span class="hl_fundecl"><span class="mpre">putSignatureHashAlgorithm</span></span></a><span class="mpre"> (</span><a name="loc_456_28_456_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_456_28_456_29&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre">,</span><a name="loc_456_30_456_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_456_30_456_31&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">) =
    </span><a href="Data.Serialize.Put.html#loc_176_1_176_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Put.html#loc_176_1_176_9&#39;)"><span class="hl_varref"><span class="mpre">putWord8</span></span></a><span class="mpre"> (</span><a href="Network.TLS.Struct.html#loc_301_5_301_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_301_5_301_14&#39;)"><span class="hl_varref"><span class="mpre">valOfType</span></span></a><span class="mpre"> </span><a href="#loc_456_28_456_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_456_28_456_29&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="Data.Serialize.Put.html#loc_176_1_176_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Put.html#loc_176_1_176_9&#39;)"><span class="hl_varref"><span class="mpre">putWord8</span></span></a><span class="mpre"> (</span><a href="Network.TLS.Struct.html#loc_301_5_301_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_301_5_301_14&#39;)"><span class="hl_varref"><span class="mpre">valOfType</span></span></a><span class="mpre"> </span><a href="#loc_456_30_456_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_456_30_456_31&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)

</span><a href="#loc_460_1_460_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_460_1_460_18&#39;)"><span class="mpre">getServerDHParams</span></a><span class="mpre"> :: </span><a href="Data.Serialize.Get.html#loc_138_9_138_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Get.html#loc_138_9_138_12&#39;)"><span class="hl_tyconref"><span class="mpre">Get</span></span></a><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_226_6_226_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_226_6_226_20&#39;)"><span class="hl_tyconref"><span class="mpre">ServerDHParams</span></span></a><span class="mpre">
</span><a name="loc_460_1_460_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_460_1_460_18&#39;)"><span class="hl_vardecl"><span class="mpre">getServerDHParams</span></span></a><span class="mpre"> = </span><a href="Network.TLS.Struct.html#loc_226_23_226_37" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_226_23_226_37&#39;)"><span class="hl_conref"><span class="mpre">ServerDHParams</span></span></a><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="#loc_461_9_461_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_461_9_461_20&#39;)"><span class="hl_varref"><span class="mpre">getDHParams</span></span></a><span class="mpre"> </span><a href="Control.Applicative.html#loc_118_5_118_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_118_5_118_10&#39;)"><span class="hl_infix"><span class="mpre">&lt;*&gt;</span></span></a><span class="mpre"> </span><a href="#loc_463_9_463_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_463_9_463_20&#39;)"><span class="hl_varref"><span class="mpre">getDHPublic</span></span></a><span class="mpre">
  where </span><a name="loc_461_9_461_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_461_9_461_20&#39;)"><span class="hl_vardecl"><span class="mpre">getDHParams</span></span></a><span class="mpre"> = </span><a href="Network.TLS.Crypto.DH.html#loc_36_1_36_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Crypto.DH.html#loc_36_1_36_9&#39;)"><span class="hl_varref"><span class="mpre">dhParams</span></span></a><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="Network.TLS.Wire.html#loc_114_1_114_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Wire.html#loc_114_1_114_13&#39;)"><span class="hl_varref"><span class="mpre">getInteger16</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- p</span></span><span class="mpre">
                               </span><a href="Control.Applicative.html#loc_118_5_118_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_118_5_118_10&#39;)"><span class="hl_infix"><span class="mpre">&lt;*&gt;</span></span></a><span class="mpre"> </span><a href="Network.TLS.Wire.html#loc_114_1_114_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Wire.html#loc_114_1_114_13&#39;)"><span class="hl_varref"><span class="mpre">getInteger16</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- g</span></span><span class="mpre">
        </span><a name="loc_463_9_463_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_463_9_463_20&#39;)"><span class="hl_vardecl"><span class="mpre">getDHPublic</span></span></a><span class="mpre"> = </span><a href="Network.TLS.Crypto.DH.html#loc_30_1_30_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Crypto.DH.html#loc_30_1_30_9&#39;)"><span class="hl_varref"><span class="mpre">dhPublic</span></span></a><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="Network.TLS.Wire.html#loc_114_1_114_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Wire.html#loc_114_1_114_13&#39;)"><span class="hl_varref"><span class="mpre">getInteger16</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- y(server)</span></span><span class="mpre">

</span><a href="#loc_466_1_466_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_466_1_466_18&#39;)"><span class="mpre">putServerDHParams</span></a><span class="mpre"> :: </span><a href="Network.TLS.Struct.html#loc_226_6_226_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_226_6_226_20&#39;)"><span class="hl_tyconref"><span class="mpre">ServerDHParams</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Put</span></span><span class="mpre">
</span><a name="loc_466_1_466_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_466_1_466_18&#39;)"><span class="hl_fundecl"><span class="mpre">putServerDHParams</span></span></a><span class="mpre"> (</span><a href="Network.TLS.Struct.html#loc_226_23_226_37" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_226_23_226_37&#39;)"><span class="hl_conref"><span class="mpre">ServerDHParams</span></span></a><span class="mpre"> </span><a name="loc_466_35_466_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_466_35_466_43&#39;)"><span class="hl_vardecl"><span class="mpre">dhparams</span></span></a><span class="mpre"> </span><a name="loc_466_44_466_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_466_44_466_49&#39;)"><span class="hl_vardecl"><span class="mpre">dhpub</span></span></a><span class="mpre">) =
    </span><a href="Control.Monad.html#loc_116_1_116_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_116_1_116_6&#39;)"><span class="hl_varref"><span class="mpre">mapM_</span></span></a><span class="mpre"> </span><a href="Network.TLS.Wire.html#loc_159_1_159_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Wire.html#loc_159_1_159_13&#39;)"><span class="hl_varref"><span class="mpre">putInteger16</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.TLS.Crypto.DH.html#loc_50_1_50_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Crypto.DH.html#loc_50_1_50_9&#39;)"><span class="hl_varref"><span class="mpre">dhUnwrap</span></span></a><span class="mpre"> </span><a href="#loc_466_35_466_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_466_35_466_43&#39;)"><span class="hl_varref"><span class="mpre">dhparams</span></span></a><span class="mpre"> </span><a href="#loc_466_44_466_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_466_44_466_49&#39;)"><span class="hl_varref"><span class="mpre">dhpub</span></span></a><span class="mpre">

</span><a href="#loc_470_1_470_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_470_1_470_19&#39;)"><span class="mpre">getDigitallySigned</span></a><span class="mpre"> :: </span><a href="Network.TLS.Types.html#loc_25_6_25_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Types.html#loc_25_6_25_13&#39;)"><span class="hl_tyconref"><span class="mpre">Version</span></span></a><span class="mpre"> -&gt; </span><a href="Data.Serialize.Get.html#loc_138_9_138_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Get.html#loc_138_9_138_12&#39;)"><span class="hl_tyconref"><span class="mpre">Get</span></span></a><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_109_6_109_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_109_6_109_21&#39;)"><span class="hl_tyconref"><span class="mpre">DigitallySigned</span></span></a><span class="mpre">
</span><a name="loc_470_1_470_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_470_1_470_19&#39;)"><span class="hl_fundecl"><span class="mpre">getDigitallySigned</span></span></a><span class="mpre"> </span><a name="loc_470_20_470_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_470_20_470_23&#39;)"><span class="hl_vardecl"><span class="mpre">ver</span></span></a><span class="mpre">
    | </span><a href="#loc_470_20_470_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_470_20_470_23&#39;)"><span class="hl_varref"><span class="mpre">ver</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">TLS12</span></span><span class="mpre"> = </span><a href="Network.TLS.Struct.html#loc_109_24_109_39" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_109_24_109_39&#39;)"><span class="hl_conref"><span class="mpre">DigitallySigned</span></span></a><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="#loc_450_1_450_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_450_1_450_26&#39;)"><span class="hl_varref"><span class="mpre">getSignatureHashAlgorithm</span></span></a><span class="mpre">)
                                     </span><a href="Control.Applicative.html#loc_118_5_118_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Applicative.html#loc_118_5_118_10&#39;)"><span class="hl_infix"><span class="mpre">&lt;*&gt;</span></span></a><span class="mpre"> </span><a href="Network.TLS.Wire.html#loc_108_1_108_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Wire.html#loc_108_1_108_12&#39;)"><span class="hl_varref"><span class="mpre">getOpaque16</span></span></a><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">    = </span><a href="Network.TLS.Struct.html#loc_109_24_109_39" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_109_24_109_39&#39;)"><span class="hl_conref"><span class="mpre">DigitallySigned</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="Network.TLS.Wire.html#loc_108_1_108_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Wire.html#loc_108_1_108_12&#39;)"><span class="hl_varref"><span class="mpre">getOpaque16</span></span></a><span class="mpre">

</span><a href="#loc_476_1_476_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_476_1_476_19&#39;)"><span class="mpre">putDigitallySigned</span></a><span class="mpre"> :: </span><a href="Network.TLS.Struct.html#loc_109_6_109_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_109_6_109_21&#39;)"><span class="hl_tyconref"><span class="mpre">DigitallySigned</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Put</span></span><span class="mpre">
</span><a name="loc_476_1_476_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_476_1_476_19&#39;)"><span class="hl_fundecl"><span class="mpre">putDigitallySigned</span></span></a><span class="mpre"> (</span><a href="Network.TLS.Struct.html#loc_109_24_109_39" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_109_24_109_39&#39;)"><span class="hl_conref"><span class="mpre">DigitallySigned</span></span></a><span class="mpre"> </span><a name="loc_476_37_476_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_476_37_476_42&#39;)"><span class="hl_vardecl"><span class="mpre">mhash</span></span></a><span class="mpre"> </span><a name="loc_476_43_476_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_476_43_476_46&#39;)"><span class="hl_vardecl"><span class="mpre">sig</span></span></a><span class="mpre">) =
    </span><span class="hl_varref"><span class="mpre">maybe</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">) </span><a href="#loc_456_1_456_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_456_1_456_26&#39;)"><span class="hl_varref"><span class="mpre">putSignatureHashAlgorithm</span></span></a><span class="mpre"> </span><a href="#loc_476_37_476_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_476_37_476_42&#39;)"><span class="hl_varref"><span class="mpre">mhash</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="Network.TLS.Wire.html#loc_153_1_153_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Wire.html#loc_153_1_153_12&#39;)"><span class="hl_varref"><span class="mpre">putOpaque16</span></span></a><span class="mpre"> </span><a href="#loc_476_43_476_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_476_43_476_46&#39;)"><span class="hl_varref"><span class="mpre">sig</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">{-
 - decode and encode ALERT
 -}</span></span><span class="mpre">

</span><a href="#loc_484_1_484_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_484_1_484_23&#39;)"><span class="mpre">decodeChangeCipherSpec</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_121_6_121_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_121_6_121_14&#39;)"><span class="hl_tyconref"><span class="mpre">TLSError</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_484_1_484_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_484_1_484_23&#39;)"><span class="hl_vardecl"><span class="mpre">decodeChangeCipherSpec</span></span></a><span class="mpre"> = </span><a href="Network.TLS.Wire.html#loc_76_1_76_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Wire.html#loc_76_1_76_10&#39;)"><span class="hl_varref"><span class="mpre">runGetErr</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;changecipherspec&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
    </span><a name="loc_485_5_485_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_485_5_485_6&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> &lt;- </span><a href="Data.Serialize.Get.html#loc_467_1_467_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Get.html#loc_467_1_467_9&#39;)"><span class="hl_varref"><span class="mpre">getWord8</span></span></a><span class="mpre">
    </span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="hl_varref"><span class="mpre">when</span></span></a><span class="mpre"> (</span><a href="#loc_485_5_485_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_485_5_485_6&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">fail</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;unknown change cipher spec content&quot;</span></span><span class="mpre">)

</span><a href="#loc_489_1_489_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_489_1_489_23&#39;)"><span class="mpre">encodeChangeCipherSpec</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
</span><a name="loc_489_1_489_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_489_1_489_23&#39;)"><span class="hl_vardecl"><span class="mpre">encodeChangeCipherSpec</span></span></a><span class="mpre"> = </span><a href="Data.Serialize.Put.html#loc_148_1_148_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Put.html#loc_148_1_148_7&#39;)"><span class="hl_varref"><span class="mpre">runPut</span></span></a><span class="mpre"> (</span><a href="Data.Serialize.Put.html#loc_176_1_176_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Put.html#loc_176_1_176_9&#39;)"><span class="hl_varref"><span class="mpre">putWord8</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- rsa pre master secret</span></span><span class="mpre">
</span><a href="#loc_493_1_493_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_493_1_493_22&#39;)"><span class="mpre">decodePreMasterSecret</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Bytes</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_121_6_121_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_121_6_121_14&#39;)"><span class="hl_tyconref"><span class="mpre">TLSError</span></span></a><span class="mpre"> (</span><a href="Network.TLS.Types.html#loc_25_6_25_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Types.html#loc_25_6_25_13&#39;)"><span class="hl_tyconref"><span class="mpre">Version</span></span></a><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Bytes</span></span><span class="mpre">)
</span><a name="loc_493_1_493_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_493_1_493_22&#39;)"><span class="hl_vardecl"><span class="mpre">decodePreMasterSecret</span></span></a><span class="mpre"> = </span><a href="Network.TLS.Wire.html#loc_76_1_76_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Wire.html#loc_76_1_76_10&#39;)"><span class="hl_varref"><span class="mpre">runGetErr</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;pre-master-secret&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
    </span><a href="Control.Monad.html#loc_283_1_283_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_283_1_283_7&#39;)"><span class="hl_varref"><span class="mpre">liftM2</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">(,)</span></span><span class="mpre"> </span><a href="#loc_85_1_85_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_1_85_11&#39;)"><span class="hl_varref"><span class="mpre">getVersion</span></span></a><span class="mpre"> (</span><a href="Data.Serialize.Get.html#loc_438_1_438_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Get.html#loc_438_1_438_9&#39;)"><span class="hl_varref"><span class="mpre">getBytes</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">46</span></span><span class="mpre">)

</span><a href="#loc_497_1_497_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_497_1_497_22&#39;)"><span class="mpre">encodePreMasterSecret</span></a><span class="mpre"> :: </span><a href="Network.TLS.Types.html#loc_25_6_25_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Types.html#loc_25_6_25_13&#39;)"><span class="hl_tyconref"><span class="mpre">Version</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bytes</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bytes</span></span><span class="mpre">
</span><a name="loc_497_1_497_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_497_1_497_22&#39;)"><span class="hl_fundecl"><span class="mpre">encodePreMasterSecret</span></span></a><span class="mpre"> </span><a name="loc_497_23_497_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_497_23_497_30&#39;)"><span class="hl_vardecl"><span class="mpre">version</span></span></a><span class="mpre"> </span><a name="loc_497_31_497_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_497_31_497_36&#39;)"><span class="hl_vardecl"><span class="mpre">bytes</span></span></a><span class="mpre"> = </span><a href="Data.Serialize.Put.html#loc_148_1_148_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Put.html#loc_148_1_148_7&#39;)"><span class="hl_varref"><span class="mpre">runPut</span></span></a><span class="mpre"> (</span><a href="#loc_93_1_93_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_1_93_11&#39;)"><span class="hl_varref"><span class="mpre">putVersion</span></span></a><span class="mpre"> </span><a href="#loc_497_23_497_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_497_23_497_30&#39;)"><span class="hl_varref"><span class="mpre">version</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="Network.TLS.Wire.html#loc_147_1_147_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Wire.html#loc_147_1_147_9&#39;)"><span class="hl_varref"><span class="mpre">putBytes</span></span></a><span class="mpre"> </span><a href="#loc_497_31_497_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_497_31_497_36&#39;)"><span class="hl_varref"><span class="mpre">bytes</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | in certain cases, we haven&#39;t manage to decode ServerKeyExchange properly,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- because the decoding was too eager and the cipher wasn&#39;t been set yet.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- we keep the Server Key Exchange in it unparsed format, and this function is</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- able to really decode the server key xchange if it&#39;s unparsed.</span></span><span class="mpre">
</span><a href="#loc_507_1_507_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_507_1_507_39&#39;)"><span class="mpre">decodeReallyServerKeyXchgAlgorithmData</span></a><span class="mpre"> :: </span><a href="Network.TLS.Types.html#loc_25_6_25_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Types.html#loc_25_6_25_13&#39;)"><span class="hl_tyconref"><span class="mpre">Version</span></span></a><span class="mpre">
                                       -&gt; </span><a href="Network.TLS.Cipher.html#loc_40_6_40_27" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Cipher.html#loc_40_6_40_27&#39;)"><span class="hl_tyconref"><span class="mpre">CipherKeyExchangeType</span></span></a><span class="mpre">
                                       -&gt; </span><span class="hl_tyconref"><span class="mpre">Bytes</span></span><span class="mpre">
                                       -&gt; </span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_121_6_121_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_121_6_121_14&#39;)"><span class="hl_tyconref"><span class="mpre">TLSError</span></span></a><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_234_6_234_32" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_234_6_234_32&#39;)"><span class="hl_tyconref"><span class="mpre">ServerKeyXchgAlgorithmData</span></span></a><span class="mpre">
</span><a name="loc_507_1_507_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_507_1_507_39&#39;)"><span class="hl_fundecl"><span class="mpre">decodeReallyServerKeyXchgAlgorithmData</span></span></a><span class="mpre"> </span><a name="loc_507_40_507_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_507_40_507_43&#39;)"><span class="hl_vardecl"><span class="mpre">ver</span></span></a><span class="mpre"> </span><a name="loc_507_44_507_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_507_44_507_47&#39;)"><span class="hl_vardecl"><span class="mpre">cke</span></span></a><span class="mpre"> =
    </span><a href="Network.TLS.Wire.html#loc_76_1_76_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Wire.html#loc_76_1_76_10&#39;)"><span class="hl_varref"><span class="mpre">runGetErr</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;server-key-xchg-algorithm-data&quot;</span></span><span class="mpre"> (</span><a href="#loc_303_1_303_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_303_1_303_33&#39;)"><span class="hl_varref"><span class="mpre">decodeServerKeyXchgAlgorithmData</span></span></a><span class="mpre"> </span><a href="#loc_507_40_507_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_507_40_507_43&#39;)"><span class="hl_varref"><span class="mpre">ver</span></span></a><span class="mpre"> </span><a href="#loc_507_44_507_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_507_44_507_47&#39;)"><span class="hl_varref"><span class="mpre">cke</span></span></a><span class="mpre">)


</span><span class="hl_comment"><span class="mpre">{-
 - generate things for packet content
 -}</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Packet.hs&quot;, srcSpanStartLine = 514, srcSpanStartColumn = 1, srcSpanEndLine = 514, srcSpanEndColumn = 42}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Packet.hs&quot;, srcSpanStartLine = 514, srcSpanStartColumn = 1, srcSpanEndLine = 514, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Packet.hs&quot;, srcSpanStartLine = 514, sr"><span class="mpre">type PRF = Bytes -&gt; Bytes -&gt; Int -&gt; Bytes</span></span><span class="mpre">

</span><a href="#loc_517_1_517_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_517_1_517_25&#39;)"><span class="mpre">generateMasterSecret_SSL</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Bytes</span></span><span class="mpre"> -&gt; </span><a href="Network.TLS.Struct.html#loc_160_9_160_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_160_9_160_21&#39;)"><span class="hl_tyconref"><span class="mpre">ClientRandom</span></span></a><span class="mpre"> -&gt; </span><a href="Network.TLS.Struct.html#loc_159_9_159_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_159_9_159_21&#39;)"><span class="hl_tyconref"><span class="mpre">ServerRandom</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bytes</span></span><span class="mpre">
</span><a name="loc_517_1_517_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_517_1_517_25&#39;)"><span class="hl_fundecl"><span class="mpre">generateMasterSecret_SSL</span></span></a><span class="mpre"> </span><a name="loc_517_26_517_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_517_26_517_41&#39;)"><span class="hl_vardecl"><span class="mpre">premasterSecret</span></span></a><span class="mpre"> (</span><a href="Network.TLS.Struct.html#loc_160_24_160_36" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_160_24_160_36&#39;)"><span class="hl_conref"><span class="mpre">ClientRandom</span></span></a><span class="mpre"> </span><a name="loc_517_56_517_57" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_517_56_517_57&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">) (</span><a href="Network.TLS.Struct.html#loc_159_24_159_36" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_159_24_159_36&#39;)"><span class="hl_conref"><span class="mpre">ServerRandom</span></span></a><span class="mpre"> </span><a name="loc_517_73_517_74" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_517_73_517_74&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">) =
    </span><span class="hl_varref"><span class="mpre">B.concat</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><a href="#loc_519_9_519_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_519_9_519_19&#39;)"><span class="hl_varref"><span class="mpre">computeMD5</span></span></a><span class="mpre">) [</span><span class="hl_string"><span class="mpre">&quot;A&quot;</span></span><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;BB&quot;</span></span><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;CCC&quot;</span></span><span class="mpre">]
  where </span><a name="loc_519_9_519_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_519_9_519_19&#39;)"><span class="hl_fundecl"><span class="mpre">computeMD5</span></span></a><span class="mpre">  </span><a name="loc_519_21_519_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_519_21_519_26&#39;)"><span class="hl_vardecl"><span class="mpre">label</span></span></a><span class="mpre"> = </span><a href="Crypto.Hash.MD5.html#loc_126_1_126_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Hash.MD5.html#loc_126_1_126_5&#39;)"><span class="hl_varref"><span class="mpre">MD5.hash</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.concat</span></span><span class="mpre"> [ </span><a href="#loc_517_26_517_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_517_26_517_41&#39;)"><span class="hl_varref"><span class="mpre">premasterSecret</span></span></a><span class="mpre">, </span><a href="#loc_520_9_520_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_520_9_520_20&#39;)"><span class="hl_varref"><span class="mpre">computeSHA1</span></span></a><span class="mpre"> </span><a href="#loc_519_21_519_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_519_21_519_26&#39;)"><span class="hl_varref"><span class="mpre">label</span></span></a><span class="mpre"> ]
        </span><a name="loc_520_9_520_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_520_9_520_20&#39;)"><span class="hl_fundecl"><span class="mpre">computeSHA1</span></span></a><span class="mpre"> </span><a name="loc_520_21_520_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_520_21_520_26&#39;)"><span class="hl_vardecl"><span class="mpre">label</span></span></a><span class="mpre"> = </span><a href="Crypto.Hash.SHA1.html#loc_126_1_126_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Hash.SHA1.html#loc_126_1_126_5&#39;)"><span class="hl_varref"><span class="mpre">SHA1.hash</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.concat</span></span><span class="mpre"> [ </span><a href="#loc_520_21_520_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_520_21_520_26&#39;)"><span class="hl_varref"><span class="mpre">label</span></span></a><span class="mpre">, </span><a href="#loc_517_26_517_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_517_26_517_41&#39;)"><span class="hl_varref"><span class="mpre">premasterSecret</span></span></a><span class="mpre">, </span><a href="#loc_517_56_517_57" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_517_56_517_57&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">, </span><a href="#loc_517_73_517_74" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_517_73_517_74&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> ]

</span><a href="#loc_523_1_523_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_523_1_523_25&#39;)"><span class="mpre">generateMasterSecret_TLS</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">PRF</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bytes</span></span><span class="mpre"> -&gt; </span><a href="Network.TLS.Struct.html#loc_160_9_160_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_160_9_160_21&#39;)"><span class="hl_tyconref"><span class="mpre">ClientRandom</span></span></a><span class="mpre"> -&gt; </span><a href="Network.TLS.Struct.html#loc_159_9_159_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_159_9_159_21&#39;)"><span class="hl_tyconref"><span class="mpre">ServerRandom</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bytes</span></span><span class="mpre">
</span><a name="loc_523_1_523_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_523_1_523_25&#39;)"><span class="hl_fundecl"><span class="mpre">generateMasterSecret_TLS</span></span></a><span class="mpre"> </span><a name="loc_523_26_523_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_523_26_523_29&#39;)"><span class="hl_vardecl"><span class="mpre">prf</span></span></a><span class="mpre"> </span><a name="loc_523_30_523_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_523_30_523_45&#39;)"><span class="hl_vardecl"><span class="mpre">premasterSecret</span></span></a><span class="mpre"> (</span><a href="Network.TLS.Struct.html#loc_160_24_160_36" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_160_24_160_36&#39;)"><span class="hl_conref"><span class="mpre">ClientRandom</span></span></a><span class="mpre"> </span><a name="loc_523_60_523_61" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_523_60_523_61&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">) (</span><a href="Network.TLS.Struct.html#loc_159_24_159_36" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_159_24_159_36&#39;)"><span class="hl_conref"><span class="mpre">ServerRandom</span></span></a><span class="mpre"> </span><a name="loc_523_77_523_78" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_523_77_523_78&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">) =
    </span><a href="#loc_523_26_523_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_523_26_523_29&#39;)"><span class="hl_varref"><span class="mpre">prf</span></span></a><span class="mpre"> </span><a href="#loc_523_30_523_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_523_30_523_45&#39;)"><span class="hl_varref"><span class="mpre">premasterSecret</span></span></a><span class="mpre"> </span><a href="#loc_525_9_525_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_525_9_525_13&#39;)"><span class="hl_varref"><span class="mpre">seed</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">48</span></span><span class="mpre">
  where </span><a name="loc_525_9_525_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_525_9_525_13&#39;)"><span class="hl_vardecl"><span class="mpre">seed</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">B.concat</span></span><span class="mpre"> [ </span><span class="hl_string"><span class="mpre">&quot;master secret&quot;</span></span><span class="mpre">, </span><a href="#loc_523_60_523_61" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_523_60_523_61&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">, </span><a href="#loc_523_77_523_78" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_523_77_523_78&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> ]

</span><a href="#loc_528_1_528_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_528_1_528_21&#39;)"><span class="mpre">generateMasterSecret</span></a><span class="mpre"> :: </span><a href="Network.TLS.Types.html#loc_25_6_25_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Types.html#loc_25_6_25_13&#39;)"><span class="hl_tyconref"><span class="mpre">Version</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bytes</span></span><span class="mpre"> -&gt; </span><a href="Network.TLS.Struct.html#loc_160_9_160_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_160_9_160_21&#39;)"><span class="hl_tyconref"><span class="mpre">ClientRandom</span></span></a><span class="mpre"> -&gt; </span><a href="Network.TLS.Struct.html#loc_159_9_159_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_159_9_159_21&#39;)"><span class="hl_tyconref"><span class="mpre">ServerRandom</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bytes</span></span><span class="mpre">
</span><a name="loc_528_1_528_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_528_1_528_21&#39;)"><span class="hl_fundecl"><span class="mpre">generateMasterSecret</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">SSL2</span></span><span class="mpre">  = </span><a href="#loc_517_1_517_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_517_1_517_25&#39;)"><span class="hl_varref"><span class="mpre">generateMasterSecret_SSL</span></span></a><span class="mpre">
</span><a href="#loc_528_1_528_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_528_1_528_21&#39;)"><span class="hl_fundecl"><span class="mpre">generateMasterSecret</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">SSL3</span></span><span class="mpre">  = </span><a href="#loc_517_1_517_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_517_1_517_25&#39;)"><span class="hl_varref"><span class="mpre">generateMasterSecret_SSL</span></span></a><span class="mpre">
</span><a href="#loc_528_1_528_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_528_1_528_21&#39;)"><span class="hl_fundecl"><span class="mpre">generateMasterSecret</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">TLS10</span></span><span class="mpre"> = </span><a href="#loc_523_1_523_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_523_1_523_25&#39;)"><span class="hl_varref"><span class="mpre">generateMasterSecret_TLS</span></span></a><span class="mpre"> </span><a href="Network.TLS.MAC.html#loc_70_1_70_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.MAC.html#loc_70_1_70_12&#39;)"><span class="hl_varref"><span class="mpre">prf_MD5SHA1</span></span></a><span class="mpre">
</span><a href="#loc_528_1_528_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_528_1_528_21&#39;)"><span class="hl_fundecl"><span class="mpre">generateMasterSecret</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">TLS11</span></span><span class="mpre"> = </span><a href="#loc_523_1_523_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_523_1_523_25&#39;)"><span class="hl_varref"><span class="mpre">generateMasterSecret_TLS</span></span></a><span class="mpre"> </span><a href="Network.TLS.MAC.html#loc_70_1_70_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.MAC.html#loc_70_1_70_12&#39;)"><span class="hl_varref"><span class="mpre">prf_MD5SHA1</span></span></a><span class="mpre">
</span><a href="#loc_528_1_528_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_528_1_528_21&#39;)"><span class="hl_fundecl"><span class="mpre">generateMasterSecret</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">TLS12</span></span><span class="mpre"> = </span><a href="#loc_523_1_523_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_523_1_523_25&#39;)"><span class="hl_varref"><span class="mpre">generateMasterSecret_TLS</span></span></a><span class="mpre"> </span><a href="Network.TLS.MAC.html#loc_77_1_77_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.MAC.html#loc_77_1_77_11&#39;)"><span class="hl_varref"><span class="mpre">prf_SHA256</span></span></a><span class="mpre">

</span><a href="#loc_535_1_535_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_535_1_535_21&#39;)"><span class="mpre">generateKeyBlock_TLS</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">PRF</span></span><span class="mpre"> -&gt; </span><a href="Network.TLS.Struct.html#loc_160_9_160_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_160_9_160_21&#39;)"><span class="hl_tyconref"><span class="mpre">ClientRandom</span></span></a><span class="mpre"> -&gt; </span><a href="Network.TLS.Struct.html#loc_159_9_159_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_159_9_159_21&#39;)"><span class="hl_tyconref"><span class="mpre">ServerRandom</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bytes</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bytes</span></span><span class="mpre">
</span><a name="loc_535_1_535_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_535_1_535_21&#39;)"><span class="hl_fundecl"><span class="mpre">generateKeyBlock_TLS</span></span></a><span class="mpre"> </span><a name="loc_535_22_535_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_535_22_535_25&#39;)"><span class="hl_vardecl"><span class="mpre">prf</span></span></a><span class="mpre"> (</span><a href="Network.TLS.Struct.html#loc_160_24_160_36" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_160_24_160_36&#39;)"><span class="hl_conref"><span class="mpre">ClientRandom</span></span></a><span class="mpre"> </span><a name="loc_535_40_535_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_535_40_535_41&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">) (</span><a href="Network.TLS.Struct.html#loc_159_24_159_36" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_159_24_159_36&#39;)"><span class="hl_conref"><span class="mpre">ServerRandom</span></span></a><span class="mpre"> </span><a name="loc_535_57_535_58" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_535_57_535_58&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">) </span><a name="loc_535_60_535_72" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_535_60_535_72&#39;)"><span class="hl_vardecl"><span class="mpre">mastersecret</span></span></a><span class="mpre"> </span><a name="loc_535_73_535_79" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_535_73_535_79&#39;)"><span class="hl_vardecl"><span class="mpre">kbsize</span></span></a><span class="mpre"> =
    </span><a href="#loc_535_22_535_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_535_22_535_25&#39;)"><span class="hl_varref"><span class="mpre">prf</span></span></a><span class="mpre"> </span><a href="#loc_535_60_535_72" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_535_60_535_72&#39;)"><span class="hl_varref"><span class="mpre">mastersecret</span></span></a><span class="mpre"> </span><a href="#loc_536_40_536_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_536_40_536_44&#39;)"><span class="hl_varref"><span class="mpre">seed</span></span></a><span class="mpre"> </span><a href="#loc_535_73_535_79" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_535_73_535_79&#39;)"><span class="hl_varref"><span class="mpre">kbsize</span></span></a><span class="mpre"> where </span><a name="loc_536_40_536_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_536_40_536_44&#39;)"><span class="hl_vardecl"><span class="mpre">seed</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">B.concat</span></span><span class="mpre"> [ </span><span class="hl_string"><span class="mpre">&quot;key expansion&quot;</span></span><span class="mpre">, </span><a href="#loc_535_57_535_58" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_535_57_535_58&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">, </span><a href="#loc_535_40_535_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_535_40_535_41&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> ]

</span><a href="#loc_539_1_539_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_539_1_539_21&#39;)"><span class="mpre">generateKeyBlock_SSL</span></a><span class="mpre"> :: </span><a href="Network.TLS.Struct.html#loc_160_9_160_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_160_9_160_21&#39;)"><span class="hl_tyconref"><span class="mpre">ClientRandom</span></span></a><span class="mpre"> -&gt; </span><a href="Network.TLS.Struct.html#loc_159_9_159_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_159_9_159_21&#39;)"><span class="hl_tyconref"><span class="mpre">ServerRandom</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bytes</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bytes</span></span><span class="mpre">
</span><a name="loc_539_1_539_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_539_1_539_21&#39;)"><span class="hl_fundecl"><span class="mpre">generateKeyBlock_SSL</span></span></a><span class="mpre"> (</span><a href="Network.TLS.Struct.html#loc_160_24_160_36" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_160_24_160_36&#39;)"><span class="hl_conref"><span class="mpre">ClientRandom</span></span></a><span class="mpre"> </span><a name="loc_539_36_539_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_539_36_539_37&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">) (</span><a href="Network.TLS.Struct.html#loc_159_24_159_36" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_159_24_159_36&#39;)"><span class="hl_conref"><span class="mpre">ServerRandom</span></span></a><span class="mpre"> </span><a name="loc_539_53_539_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_539_53_539_54&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">) </span><a name="loc_539_56_539_68" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_539_56_539_68&#39;)"><span class="hl_vardecl"><span class="mpre">mastersecret</span></span></a><span class="mpre"> </span><a name="loc_539_69_539_75" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_539_69_539_75&#39;)"><span class="hl_vardecl"><span class="mpre">kbsize</span></span></a><span class="mpre"> =
    </span><span class="hl_varref"><span class="mpre">B.concat</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="#loc_542_9_542_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_542_9_542_19&#39;)"><span class="hl_varref"><span class="mpre">computeMD5</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">take</span></span><span class="mpre"> ((</span><a href="#loc_539_69_539_75" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_539_69_539_75&#39;)"><span class="hl_varref"><span class="mpre">kbsize</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`div`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">16</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_541_9_541_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_541_9_541_15&#39;)"><span class="hl_varref"><span class="mpre">labels</span></span></a><span class="mpre">
  where </span><a name="loc_541_9_541_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_541_9_541_15&#39;)"><span class="hl_vardecl"><span class="mpre">labels</span></span></a><span class="mpre">            = [ </span><span class="hl_varref"><span class="mpre">uncurry</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">BC.replicate</span></span><span class="mpre"> </span><a href="#loc_541_56_541_57" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_541_56_541_57&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> | </span><a name="loc_541_56_541_57" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_541_56_541_57&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">zip</span></span><span class="mpre"> </span><span class="warning" data-warning="ExpEnumFrom (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Packet.hs&quot;, srcSpanStartLine = 541, srcSpanStartColumn = 65, srcSpanEndLine = 541, srcSpanEndColumn = 70}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Packet.hs&quot;, srcSpanStartLine = 541, srcSpanStartColumn = 65, srcSpanEndLine = 541, srcSpanEndColumn = 66},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Packet.hs&quot;, srcSpanStartLine = 541,"><span class="mpre">[1..]</span></span><span class="mpre"> </span><span class="warning" data-warning="ExpEnumFromTo (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Packet.hs&quot;, srcSpanStartLine = 541, srcSpanStartColumn = 71, srcSpanEndLine = 541, srcSpanEndColumn = 81}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Packet.hs&quot;, srcSpanStartLine = 541, srcSpanStartColumn = 71, srcSpanEndLine = 541, srcSpanEndColumn = 72},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Packet.hs&quot;, srcSpanStartLine = 54"><span class="mpre">[&#39;A&#39;..&#39;Z&#39;]</span></span><span class="mpre"> ]
        </span><a name="loc_542_9_542_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_542_9_542_19&#39;)"><span class="hl_fundecl"><span class="mpre">computeMD5</span></span></a><span class="mpre">  </span><a name="loc_542_21_542_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_542_21_542_26&#39;)"><span class="hl_vardecl"><span class="mpre">label</span></span></a><span class="mpre"> = </span><a href="Crypto.Hash.MD5.html#loc_126_1_126_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Hash.MD5.html#loc_126_1_126_5&#39;)"><span class="hl_varref"><span class="mpre">MD5.hash</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.concat</span></span><span class="mpre"> [ </span><a href="#loc_539_56_539_68" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_539_56_539_68&#39;)"><span class="hl_varref"><span class="mpre">mastersecret</span></span></a><span class="mpre">, </span><a href="#loc_543_9_543_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_543_9_543_20&#39;)"><span class="hl_varref"><span class="mpre">computeSHA1</span></span></a><span class="mpre"> </span><a href="#loc_542_21_542_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_542_21_542_26&#39;)"><span class="hl_varref"><span class="mpre">label</span></span></a><span class="mpre"> ]
        </span><a name="loc_543_9_543_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_543_9_543_20&#39;)"><span class="hl_fundecl"><span class="mpre">computeSHA1</span></span></a><span class="mpre"> </span><a name="loc_543_21_543_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_543_21_543_26&#39;)"><span class="hl_vardecl"><span class="mpre">label</span></span></a><span class="mpre"> = </span><a href="Crypto.Hash.SHA1.html#loc_126_1_126_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Hash.SHA1.html#loc_126_1_126_5&#39;)"><span class="hl_varref"><span class="mpre">SHA1.hash</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.concat</span></span><span class="mpre"> [ </span><a href="#loc_543_21_543_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_543_21_543_26&#39;)"><span class="hl_varref"><span class="mpre">label</span></span></a><span class="mpre">, </span><a href="#loc_539_56_539_68" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_539_56_539_68&#39;)"><span class="hl_varref"><span class="mpre">mastersecret</span></span></a><span class="mpre">, </span><a href="#loc_539_53_539_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_539_53_539_54&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">, </span><a href="#loc_539_36_539_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_539_36_539_37&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> ]

</span><a href="#loc_546_1_546_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_546_1_546_17&#39;)"><span class="mpre">generateKeyBlock</span></a><span class="mpre"> :: </span><a href="Network.TLS.Types.html#loc_25_6_25_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Types.html#loc_25_6_25_13&#39;)"><span class="hl_tyconref"><span class="mpre">Version</span></span></a><span class="mpre"> -&gt; </span><a href="Network.TLS.Struct.html#loc_160_9_160_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_160_9_160_21&#39;)"><span class="hl_tyconref"><span class="mpre">ClientRandom</span></span></a><span class="mpre"> -&gt; </span><a href="Network.TLS.Struct.html#loc_159_9_159_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_159_9_159_21&#39;)"><span class="hl_tyconref"><span class="mpre">ServerRandom</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bytes</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bytes</span></span><span class="mpre">
</span><a name="loc_546_1_546_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_546_1_546_17&#39;)"><span class="hl_fundecl"><span class="mpre">generateKeyBlock</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">SSL2</span></span><span class="mpre">  = </span><a href="#loc_539_1_539_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_539_1_539_21&#39;)"><span class="hl_varref"><span class="mpre">generateKeyBlock_SSL</span></span></a><span class="mpre">
</span><a href="#loc_546_1_546_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_546_1_546_17&#39;)"><span class="hl_fundecl"><span class="mpre">generateKeyBlock</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">SSL3</span></span><span class="mpre">  = </span><a href="#loc_539_1_539_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_539_1_539_21&#39;)"><span class="hl_varref"><span class="mpre">generateKeyBlock_SSL</span></span></a><span class="mpre">
</span><a href="#loc_546_1_546_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_546_1_546_17&#39;)"><span class="hl_fundecl"><span class="mpre">generateKeyBlock</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">TLS10</span></span><span class="mpre"> = </span><a href="#loc_535_1_535_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_535_1_535_21&#39;)"><span class="hl_varref"><span class="mpre">generateKeyBlock_TLS</span></span></a><span class="mpre"> </span><a href="Network.TLS.MAC.html#loc_70_1_70_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.MAC.html#loc_70_1_70_12&#39;)"><span class="hl_varref"><span class="mpre">prf_MD5SHA1</span></span></a><span class="mpre">
</span><a href="#loc_546_1_546_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_546_1_546_17&#39;)"><span class="hl_fundecl"><span class="mpre">generateKeyBlock</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">TLS11</span></span><span class="mpre"> = </span><a href="#loc_535_1_535_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_535_1_535_21&#39;)"><span class="hl_varref"><span class="mpre">generateKeyBlock_TLS</span></span></a><span class="mpre"> </span><a href="Network.TLS.MAC.html#loc_70_1_70_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.MAC.html#loc_70_1_70_12&#39;)"><span class="hl_varref"><span class="mpre">prf_MD5SHA1</span></span></a><span class="mpre">
</span><a href="#loc_546_1_546_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_546_1_546_17&#39;)"><span class="hl_fundecl"><span class="mpre">generateKeyBlock</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">TLS12</span></span><span class="mpre"> = </span><a href="#loc_535_1_535_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_535_1_535_21&#39;)"><span class="hl_varref"><span class="mpre">generateKeyBlock_TLS</span></span></a><span class="mpre"> </span><a href="Network.TLS.MAC.html#loc_77_1_77_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.MAC.html#loc_77_1_77_11&#39;)"><span class="hl_varref"><span class="mpre">prf_SHA256</span></span></a><span class="mpre">

</span><a href="#loc_553_1_553_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_553_1_553_21&#39;)"><span class="mpre">generateFinished_TLS</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">PRF</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bytes</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bytes</span></span><span class="mpre"> -&gt; </span><a href="Network.TLS.Crypto.html#loc_66_6_66_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Crypto.html#loc_66_6_66_13&#39;)"><span class="hl_tyconref"><span class="mpre">HashCtx</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bytes</span></span><span class="mpre">
</span><a name="loc_553_1_553_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_553_1_553_21&#39;)"><span class="hl_fundecl"><span class="mpre">generateFinished_TLS</span></span></a><span class="mpre"> </span><a name="loc_553_22_553_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_553_22_553_25&#39;)"><span class="hl_vardecl"><span class="mpre">prf</span></span></a><span class="mpre"> </span><a name="loc_553_26_553_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_553_26_553_31&#39;)"><span class="hl_vardecl"><span class="mpre">label</span></span></a><span class="mpre"> </span><a name="loc_553_32_553_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_553_32_553_44&#39;)"><span class="hl_vardecl"><span class="mpre">mastersecret</span></span></a><span class="mpre"> </span><a name="loc_553_45_553_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_553_45_553_52&#39;)"><span class="hl_vardecl"><span class="mpre">hashctx</span></span></a><span class="mpre"> = </span><a href="#loc_553_22_553_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_553_22_553_25&#39;)"><span class="hl_varref"><span class="mpre">prf</span></span></a><span class="mpre"> </span><a href="#loc_553_32_553_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_553_32_553_44&#39;)"><span class="hl_varref"><span class="mpre">mastersecret</span></span></a><span class="mpre"> </span><a href="#loc_554_9_554_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_554_9_554_13&#39;)"><span class="hl_varref"><span class="mpre">seed</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">12</span></span><span class="mpre">
  where </span><a name="loc_554_9_554_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_554_9_554_13&#39;)"><span class="hl_vardecl"><span class="mpre">seed</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">B.concat</span></span><span class="mpre"> [ </span><a href="#loc_553_26_553_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_553_26_553_31&#39;)"><span class="hl_varref"><span class="mpre">label</span></span></a><span class="mpre">, </span><a href="Network.TLS.Crypto.html#loc_121_1_121_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Crypto.html#loc_121_1_121_10&#39;)"><span class="hl_varref"><span class="mpre">hashFinal</span></span></a><span class="mpre"> </span><a href="#loc_553_45_553_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_553_45_553_52&#39;)"><span class="hl_varref"><span class="mpre">hashctx</span></span></a><span class="mpre"> ]

</span><a href="#loc_557_1_557_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_557_1_557_21&#39;)"><span class="mpre">generateFinished_SSL</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Bytes</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bytes</span></span><span class="mpre"> -&gt; </span><a href="Network.TLS.Crypto.html#loc_66_6_66_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Crypto.html#loc_66_6_66_13&#39;)"><span class="hl_tyconref"><span class="mpre">HashCtx</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bytes</span></span><span class="mpre">
</span><a name="loc_557_1_557_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_557_1_557_21&#39;)"><span class="hl_fundecl"><span class="mpre">generateFinished_SSL</span></span></a><span class="mpre"> </span><a name="loc_557_22_557_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_557_22_557_28&#39;)"><span class="hl_vardecl"><span class="mpre">sender</span></span></a><span class="mpre"> </span><a name="loc_557_29_557_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_557_29_557_41&#39;)"><span class="hl_vardecl"><span class="mpre">mastersecret</span></span></a><span class="mpre"> </span><a name="loc_557_42_557_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_557_42_557_49&#39;)"><span class="hl_vardecl"><span class="mpre">hashctx</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">B.concat</span></span><span class="mpre"> [</span><a href="#loc_558_9_558_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_558_9_558_16&#39;)"><span class="hl_varref"><span class="mpre">md5hash</span></span></a><span class="mpre">, </span><a href="#loc_559_9_559_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_559_9_559_17&#39;)"><span class="hl_varref"><span class="mpre">sha1hash</span></span></a><span class="mpre">]
  where </span><a name="loc_558_9_558_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_558_9_558_16&#39;)"><span class="hl_vardecl"><span class="mpre">md5hash</span></span></a><span class="mpre">  = </span><a href="Crypto.Hash.MD5.html#loc_126_1_126_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Hash.MD5.html#loc_126_1_126_5&#39;)"><span class="hl_varref"><span class="mpre">MD5.hash</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.concat</span></span><span class="mpre"> [ </span><a href="#loc_557_29_557_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_557_29_557_41&#39;)"><span class="hl_varref"><span class="mpre">mastersecret</span></span></a><span class="mpre">, </span><a href="#loc_564_9_564_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_564_9_564_13&#39;)"><span class="hl_varref"><span class="mpre">pad2</span></span></a><span class="mpre">, </span><a href="#loc_563_10_563_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_563_10_563_17&#39;)"><span class="hl_varref"><span class="mpre">md5left</span></span></a><span class="mpre"> ]
        </span><a name="loc_559_9_559_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_559_9_559_17&#39;)"><span class="hl_vardecl"><span class="mpre">sha1hash</span></span></a><span class="mpre"> = </span><a href="Crypto.Hash.SHA1.html#loc_126_1_126_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Hash.SHA1.html#loc_126_1_126_5&#39;)"><span class="hl_varref"><span class="mpre">SHA1.hash</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.concat</span></span><span class="mpre"> [ </span><a href="#loc_557_29_557_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_557_29_557_41&#39;)"><span class="hl_varref"><span class="mpre">mastersecret</span></span></a><span class="mpre">, </span><span class="hl_varref"><span class="mpre">B.take</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">40</span></span><span class="mpre"> </span><a href="#loc_564_9_564_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_564_9_564_13&#39;)"><span class="hl_varref"><span class="mpre">pad2</span></span></a><span class="mpre">, </span><a href="#loc_563_18_563_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_563_18_563_26&#39;)"><span class="hl_varref"><span class="mpre">sha1left</span></span></a><span class="mpre"> ]

        </span><a name="loc_561_9_561_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_561_9_561_17&#39;)"><span class="hl_vardecl"><span class="mpre">lefthash</span></span></a><span class="mpre"> = </span><a href="Network.TLS.Crypto.html#loc_121_1_121_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Crypto.html#loc_121_1_121_10&#39;)"><span class="hl_varref"><span class="mpre">hashFinal</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">flip</span></span><span class="mpre"> </span><a href="Network.TLS.Crypto.html#loc_118_1_118_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Crypto.html#loc_118_1_118_14&#39;)"><span class="hl_varref"><span class="mpre">hashUpdateSSL</span></span></a><span class="mpre"> (</span><a href="#loc_565_9_565_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_565_9_565_13&#39;)"><span class="hl_varref"><span class="mpre">pad1</span></span></a><span class="mpre">, </span><span class="hl_varref"><span class="mpre">B.take</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">40</span></span><span class="mpre"> </span><a href="#loc_565_9_565_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_565_9_565_13&#39;)"><span class="hl_varref"><span class="mpre">pad1</span></span></a><span class="mpre">)
                             </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">foldl</span></span><span class="mpre"> </span><a href="Network.TLS.Crypto.html#loc_113_1_113_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Crypto.html#loc_113_1_113_11&#39;)"><span class="hl_varref"><span class="mpre">hashUpdate</span></span></a><span class="mpre"> </span><a href="#loc_557_42_557_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_557_42_557_49&#39;)"><span class="hl_varref"><span class="mpre">hashctx</span></span></a><span class="mpre"> [</span><a href="#loc_557_22_557_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_557_22_557_28&#39;)"><span class="hl_varref"><span class="mpre">sender</span></span></a><span class="mpre">,</span><a href="#loc_557_29_557_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_557_29_557_41&#39;)"><span class="hl_varref"><span class="mpre">mastersecret</span></span></a><span class="mpre">]
        (</span><a name="loc_563_10_563_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_563_10_563_17&#39;)"><span class="hl_vardecl"><span class="mpre">md5left</span></span></a><span class="mpre">,</span><a name="loc_563_18_563_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_563_18_563_26&#39;)"><span class="hl_vardecl"><span class="mpre">sha1left</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">B.splitAt</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">16</span></span><span class="mpre"> </span><a href="#loc_561_9_561_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_561_9_561_17&#39;)"><span class="hl_varref"><span class="mpre">lefthash</span></span></a><span class="mpre">
        </span><a name="loc_564_9_564_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_564_9_564_13&#39;)"><span class="hl_vardecl"><span class="mpre">pad2</span></span></a><span class="mpre">     = </span><span class="hl_varref"><span class="mpre">B.replicate</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">48</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x5c</span></span><span class="mpre">
        </span><a name="loc_565_9_565_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_565_9_565_13&#39;)"><span class="hl_vardecl"><span class="mpre">pad1</span></span></a><span class="mpre">     = </span><span class="hl_varref"><span class="mpre">B.replicate</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">48</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0x36</span></span><span class="mpre">

</span><a href="#loc_568_1_568_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_568_1_568_23&#39;)"><span class="mpre">generateClientFinished</span></a><span class="mpre"> :: </span><a href="Network.TLS.Types.html#loc_25_6_25_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Types.html#loc_25_6_25_13&#39;)"><span class="hl_tyconref"><span class="mpre">Version</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bytes</span></span><span class="mpre"> -&gt; </span><a href="Network.TLS.Crypto.html#loc_66_6_66_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Crypto.html#loc_66_6_66_13&#39;)"><span class="hl_tyconref"><span class="mpre">HashCtx</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bytes</span></span><span class="mpre">
</span><a name="loc_568_1_568_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_568_1_568_23&#39;)"><span class="hl_fundecl"><span class="mpre">generateClientFinished</span></span></a><span class="mpre"> </span><a name="loc_568_24_568_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_568_24_568_27&#39;)"><span class="hl_vardecl"><span class="mpre">ver</span></span></a><span class="mpre">
    | </span><a href="#loc_568_24_568_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_568_24_568_27&#39;)"><span class="hl_varref"><span class="mpre">ver</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">TLS10</span></span><span class="mpre"> = </span><a href="#loc_557_1_557_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_557_1_557_21&#39;)"><span class="hl_varref"><span class="mpre">generateFinished_SSL</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;CLNT&quot;</span></span><span class="mpre">
    | </span><a href="#loc_568_24_568_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_568_24_568_27&#39;)"><span class="hl_varref"><span class="mpre">ver</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">TLS12</span></span><span class="mpre"> = </span><a href="#loc_553_1_553_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_553_1_553_21&#39;)"><span class="hl_varref"><span class="mpre">generateFinished_TLS</span></span></a><span class="mpre"> </span><a href="Network.TLS.MAC.html#loc_70_1_70_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.MAC.html#loc_70_1_70_12&#39;)"><span class="hl_varref"><span class="mpre">prf_MD5SHA1</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;client finished&quot;</span></span><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">   = </span><a href="#loc_553_1_553_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_553_1_553_21&#39;)"><span class="hl_varref"><span class="mpre">generateFinished_TLS</span></span></a><span class="mpre"> </span><a href="Network.TLS.MAC.html#loc_77_1_77_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.MAC.html#loc_77_1_77_11&#39;)"><span class="hl_varref"><span class="mpre">prf_SHA256</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;client finished&quot;</span></span><span class="mpre">

</span><a href="#loc_574_1_574_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_574_1_574_23&#39;)"><span class="mpre">generateServerFinished</span></a><span class="mpre"> :: </span><a href="Network.TLS.Types.html#loc_25_6_25_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Types.html#loc_25_6_25_13&#39;)"><span class="hl_tyconref"><span class="mpre">Version</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bytes</span></span><span class="mpre"> -&gt; </span><a href="Network.TLS.Crypto.html#loc_66_6_66_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Crypto.html#loc_66_6_66_13&#39;)"><span class="hl_tyconref"><span class="mpre">HashCtx</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bytes</span></span><span class="mpre">
</span><a name="loc_574_1_574_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_574_1_574_23&#39;)"><span class="hl_fundecl"><span class="mpre">generateServerFinished</span></span></a><span class="mpre"> </span><a name="loc_574_24_574_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_574_24_574_27&#39;)"><span class="hl_vardecl"><span class="mpre">ver</span></span></a><span class="mpre">
    | </span><a href="#loc_574_24_574_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_574_24_574_27&#39;)"><span class="hl_varref"><span class="mpre">ver</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">TLS10</span></span><span class="mpre"> = </span><a href="#loc_557_1_557_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_557_1_557_21&#39;)"><span class="hl_varref"><span class="mpre">generateFinished_SSL</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;SRVR&quot;</span></span><span class="mpre">
    | </span><a href="#loc_574_24_574_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_574_24_574_27&#39;)"><span class="hl_varref"><span class="mpre">ver</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">TLS12</span></span><span class="mpre"> = </span><a href="#loc_553_1_553_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_553_1_553_21&#39;)"><span class="hl_varref"><span class="mpre">generateFinished_TLS</span></span></a><span class="mpre"> </span><a href="Network.TLS.MAC.html#loc_70_1_70_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.MAC.html#loc_70_1_70_12&#39;)"><span class="hl_varref"><span class="mpre">prf_MD5SHA1</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;server finished&quot;</span></span><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">   = </span><a href="#loc_553_1_553_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_553_1_553_21&#39;)"><span class="hl_varref"><span class="mpre">generateFinished_TLS</span></span></a><span class="mpre"> </span><a href="Network.TLS.MAC.html#loc_77_1_77_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.MAC.html#loc_77_1_77_11&#39;)"><span class="hl_varref"><span class="mpre">prf_SHA256</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;server finished&quot;</span></span><span class="mpre">

</span><a href="#loc_580_1_580_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_580_1_580_30&#39;)"><span class="mpre">generateCertificateVerify_SSL</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Bytes</span></span><span class="mpre"> -&gt; </span><a href="Network.TLS.Crypto.html#loc_66_6_66_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Crypto.html#loc_66_6_66_13&#39;)"><span class="hl_tyconref"><span class="mpre">HashCtx</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bytes</span></span><span class="mpre">
</span><a name="loc_580_1_580_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_580_1_580_30&#39;)"><span class="hl_vardecl"><span class="mpre">generateCertificateVerify_SSL</span></span></a><span class="mpre"> = </span><a href="#loc_557_1_557_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_557_1_557_21&#39;)"><span class="hl_varref"><span class="mpre">generateFinished_SSL</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">

</span><a href="#loc_583_1_583_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_583_1_583_21&#39;)"><span class="mpre">encodeSignedDHParams</span></a><span class="mpre"> :: </span><a href="Network.TLS.Struct.html#loc_160_9_160_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_160_9_160_21&#39;)"><span class="hl_tyconref"><span class="mpre">ClientRandom</span></span></a><span class="mpre"> -&gt; </span><a href="Network.TLS.Struct.html#loc_159_9_159_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_159_9_159_21&#39;)"><span class="hl_tyconref"><span class="mpre">ServerRandom</span></span></a><span class="mpre"> -&gt; </span><a href="Network.TLS.Struct.html#loc_226_6_226_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_226_6_226_20&#39;)"><span class="hl_tyconref"><span class="mpre">ServerDHParams</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bytes</span></span><span class="mpre">
</span><a name="loc_583_1_583_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_583_1_583_21&#39;)"><span class="hl_fundecl"><span class="mpre">encodeSignedDHParams</span></span></a><span class="mpre"> </span><a name="loc_583_22_583_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_583_22_583_26&#39;)"><span class="hl_vardecl"><span class="mpre">cran</span></span></a><span class="mpre"> </span><a name="loc_583_27_583_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_583_27_583_31&#39;)"><span class="hl_vardecl"><span class="mpre">sran</span></span></a><span class="mpre"> </span><a name="loc_583_32_583_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_583_32_583_40&#39;)"><span class="hl_vardecl"><span class="mpre">dhparams</span></span></a><span class="mpre"> = </span><a href="Data.Serialize.Put.html#loc_148_1_148_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Serialize.Put.html#loc_148_1_148_7&#39;)"><span class="hl_varref"><span class="mpre">runPut</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
    </span><a href="#loc_417_1_417_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_417_1_417_18&#39;)"><span class="hl_varref"><span class="mpre">putClientRandom32</span></span></a><span class="mpre"> </span><a href="#loc_583_22_583_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_583_22_583_26&#39;)"><span class="hl_varref"><span class="mpre">cran</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="#loc_420_1_420_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_420_1_420_18&#39;)"><span class="hl_varref"><span class="mpre">putServerRandom32</span></span></a><span class="mpre"> </span><a href="#loc_583_27_583_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_583_27_583_31&#39;)"><span class="hl_varref"><span class="mpre">sran</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="#loc_466_1_466_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_466_1_466_18&#39;)"><span class="hl_varref"><span class="mpre">putServerDHParams</span></span></a><span class="mpre"> </span><a href="#loc_583_32_583_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_583_32_583_40&#39;)"><span class="hl_varref"><span class="mpre">dhparams</span></span></a><span class="mpre">
</span></div></body></html>