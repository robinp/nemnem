<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      : PlotTest</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright   : Simon Meier</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     : BSD3-style (see LICENSE)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  : Simon Meier &lt;iridcode@gmail.com&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   : experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability : GHC</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Test plotting for the benchmarks.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- package.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">

module PlotTest where

import Prelude hiding (</span><a href="Data.List.html#loc_1044_1_1044_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_1044_1_1044_6&#39;)"><span class="mpre">lines</span></a><span class="mpre">)

import Data.List (</span><a href="Data.List.html#loc_984_1_984_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_984_1_984_8&#39;)"><span class="mpre">unfoldr</span></a><span class="mpre">)
import Data.Word (Word8)

import Data.Maybe
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-builder-0.3.3.2/benchmarks/PlotTest.hs&quot;, srcSpanStartLine = 24, srcSpanStartColumn = 8, srcSpanEndLine = 24, srcSpanEndColumn = 21}, srcInfoPoints = []}) &quot;Data.Accessor&quot;"><span class="mpre">Data.Accessor</span></span><span class="mpre">
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-builder-0.3.3.2/benchmarks/PlotTest.hs&quot;, srcSpanStartLine = 25, srcSpanStartColumn = 8, srcSpanEndLine = 25, srcSpanEndColumn = 19}, srcInfoPoints = []}) &quot;Data.Colour&quot;"><span class="mpre">Data.Colour</span></span><span class="mpre">
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-builder-0.3.3.2/benchmarks/PlotTest.hs&quot;, srcSpanStartLine = 26, srcSpanStartColumn = 8, srcSpanEndLine = 26, srcSpanEndColumn = 25}, srcInfoPoints = []}) &quot;Data.Colour.Names&quot;"><span class="mpre">Data.Colour.Names</span></span><span class="mpre">

import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-builder-0.3.3.2/benchmarks/PlotTest.hs&quot;, srcSpanStartLine = 28, srcSpanStartColumn = 8, srcSpanEndLine = 28, srcSpanEndColumn = 32}, srcInfoPoints = []}) &quot;Graphics.Rendering.Chart&quot;"><span class="mpre">Graphics.Rendering.Chart</span></span><span class="mpre">
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-builder-0.3.3.2/benchmarks/PlotTest.hs&quot;, srcSpanStartLine = 29, srcSpanStartColumn = 8, srcSpanEndLine = 29, srcSpanEndColumn = 37}, srcInfoPoints = []}) &quot;Graphics.Rendering.Chart.Grid&quot;"><span class="mpre">Graphics.Rendering.Chart.Grid</span></span><span class="mpre">
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-builder-0.3.3.2/benchmarks/PlotTest.hs&quot;, srcSpanStartLine = 30, srcSpanStartColumn = 8, srcSpanEndLine = 30, srcSpanEndColumn = 36}, srcInfoPoints = []}) &quot;Graphics.Rendering.Chart.Gtk&quot;"><span class="mpre">Graphics.Rendering.Chart.Gtk</span></span><span class="mpre">

import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-builder-0.3.3.2/benchmarks/PlotTest.hs&quot;, srcSpanStartLine = 32, srcSpanStartColumn = 8, srcSpanEndLine = 32, srcSpanEndColumn = 17}, srcInfoPoints = []}) &quot;Criterion&quot;"><span class="mpre">Criterion</span></span><span class="mpre">
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-builder-0.3.3.2/benchmarks/PlotTest.hs&quot;, srcSpanStartLine = 33, srcSpanStartColumn = 8, srcSpanEndLine = 33, srcSpanEndColumn = 29}, srcInfoPoints = []}) &quot;Criterion.Environment&quot;"><span class="mpre">Criterion.Environment</span></span><span class="mpre">
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-builder-0.3.3.2/benchmarks/PlotTest.hs&quot;, srcSpanStartLine = 34, srcSpanStartColumn = 8, srcSpanEndLine = 34, srcSpanEndColumn = 23}, srcInfoPoints = []}) &quot;Criterion.Monad&quot;"><span class="mpre">Criterion.Monad</span></span><span class="mpre">
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-builder-0.3.3.2/benchmarks/PlotTest.hs&quot;, srcSpanStartLine = 35, srcSpanStartColumn = 8, srcSpanEndLine = 35, srcSpanEndColumn = 23}, srcInfoPoints = []}) &quot;Criterion.Types&quot;"><span class="mpre">Criterion.Types</span></span><span class="mpre">
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-builder-0.3.3.2/benchmarks/PlotTest.hs&quot;, srcSpanStartLine = 36, srcSpanStartColumn = 8, srcSpanEndLine = 36, srcSpanEndColumn = 24}, srcInfoPoints = []}) &quot;Criterion.Config&quot;"><span class="mpre">Criterion.Config</span></span><span class="mpre">

import Control.Monad
import Control.Monad.Trans
import Control.Monad.Trans.Reader

import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-builder-0.3.3.2/benchmarks/PlotTest.hs&quot;, srcSpanStartLine = 42, srcSpanStartColumn = 8, srcSpanEndLine = 42, srcSpanEndColumn = 24}, srcInfoPoints = []}) &quot;Statistics.Types&quot;"><span class="mpre">Statistics.Types</span></span><span class="mpre">

import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-builder-0.3.3.2/benchmarks/PlotTest.hs&quot;, srcSpanStartLine = 44, srcSpanStartColumn = 18, srcSpanEndLine = 44, srcSpanEndColumn = 31}, srcInfoPoints = []}) &quot;System.Random&quot;"><span class="mpre">System.Random</span></span><span class="mpre"> as R

</span><span class="hl_comment"><span class="mpre">-- Plots to be generated</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">{-

Compression:
  1 plot (title &quot;compressing &lt;n&gt; MB of random data using &#39;zlib&#39;)
    3 lines (direct, compacted using a Builder, compaction time) [chunk size/ms]


ChunkedWrite:
  1 plot (title &quot;serializing a list of &lt;n&gt; elements&quot;)
    1 line per type of element [chunk size/ms]


Throughput:
  5 x 3 plots (word type x endianness) (title &quot;&lt;n&gt; MB of &lt;type&gt; (&lt;endianness&gt;)&quot;)
    1 line per type of Word [chunk size/ MB/s]

-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | A pseudo-random stream of &#39;Word8&#39; always started from the same initial</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- seed.</span></span><span class="mpre">
</span><a href="#loc_70_1_70_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_1_70_13&#39;)"><span class="mpre">randomWord8s</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">]
</span><a name="loc_70_1_70_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_70_1_70_13&#39;)"><span class="hl_vardecl"><span class="mpre">randomWord8s</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.List.html#loc_984_1_984_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_984_1_984_8&#39;)"><span class="hl_varref"><span class="mpre">unfoldr</span></span></a><span class="mpre"> (</span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">R.next</span></span><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">R.mkStdGen</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">666</span></span><span class="mpre">) 

</span><span class="hl_comment"><span class="mpre">-- Main function</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">----------------</span></span><span class="mpre">

</span><a href="#loc_76_1_76_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_1_76_5&#39;)"><span class="mpre">main</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_76_1_76_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_1_76_5&#39;)"><span class="hl_vardecl"><span class="mpre">main</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">undefined</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- Benchmarking Infrastructure</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">------------------------------</span></span><span class="mpre">

</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-builder-0.3.3.2/benchmarks/PlotTest.hs&quot;, srcSpanStartLine = 82, srcSpanStartColumn = 1, srcSpanEndLine = 82, srcSpanEndColumn = 53}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-builder-0.3.3.2/benchmarks/PlotTest.hs&quot;, srcSpanStartLine = 82, srcSpanStartColumn = 1, srcSpanEndLine = 82, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-builder-0.3.3.2/benchmarks/PlotT"><span class="mpre">type MyCriterion a = ReaderT Environment Criterion a</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Run a list of benchmarks; flattening benchmark groups to a path of strings.</span></span><span class="mpre">
</span><a href="#loc_86_1_86_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_1_86_23&#39;)"><span class="mpre">runFlattenedBenchmarks</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">Benchmark</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">MyCriterion</span></span><span class="mpre"> [([</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">],</span><span class="hl_tyconref"><span class="mpre">Sample</span></span><span class="mpre">)]
</span><a name="loc_86_1_86_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_1_86_23&#39;)"><span class="hl_vardecl"><span class="mpre">runFlattenedBenchmarks</span></span></a><span class="mpre"> = 
    (</span><span class="hl_varref"><span class="mpre">concat</span></span><span class="mpre"> </span><a href="Control.Monad.html#loc_274_1_274_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_274_1_274_6&#39;)"><span class="hl_infix"><span class="mpre">`liftM`</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Control.Monad.html#loc_111_1_111_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_111_1_111_5&#39;)"><span class="hl_varref"><span class="mpre">mapM</span></span></a><span class="mpre"> (</span><a href="#loc_89_5_89_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_5_89_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">)
  where
    </span><a name="loc_89_5_89_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_5_89_7&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a name="loc_89_8_89_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_8_89_12&#39;)"><span class="hl_vardecl"><span class="mpre">path</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Benchmark</span></span><span class="mpre"> </span><a name="loc_89_24_89_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_24_89_28&#39;)"><span class="hl_vardecl"><span class="mpre">name</span></span></a><span class="mpre"> </span><a name="loc_89_29_89_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_29_89_30&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">)   = do
      </span><a name="loc_90_7_90_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_7_90_10&#39;)"><span class="hl_vardecl"><span class="mpre">env</span></span></a><span class="mpre"> &lt;- </span><a href="Control.Monad.Trans.Reader.html#loc_146_1_146_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.Trans.Reader.html#loc_146_1_146_4&#39;)"><span class="hl_varref"><span class="mpre">ask</span></span></a><span class="mpre">
      </span><a name="loc_91_7_91_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_7_91_13&#39;)"><span class="hl_vardecl"><span class="mpre">sample</span></span></a><span class="mpre"> &lt;- </span><a href="Control.Monad.Trans.Class.html#loc_51_5_51_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.Trans.Class.html#loc_51_5_51_9&#39;)"><span class="hl_varref"><span class="mpre">lift</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">runBenchmark</span></span><span class="mpre"> </span><a href="#loc_90_7_90_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_7_90_10&#39;)"><span class="hl_varref"><span class="mpre">env</span></span></a><span class="mpre"> </span><a href="#loc_89_29_89_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_29_89_30&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">
      </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> [(</span><a href="#loc_89_8_89_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_8_89_12&#39;)"><span class="hl_varref"><span class="mpre">path</span></span></a><span class="mpre"> [</span><a href="#loc_89_24_89_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_24_89_28&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre">], </span><a href="#loc_91_7_91_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_7_91_13&#39;)"><span class="hl_varref"><span class="mpre">sample</span></span></a><span class="mpre">)]
    </span><a href="#loc_89_5_89_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_5_89_7&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a name="loc_93_8_93_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_8_93_12&#39;)"><span class="hl_vardecl"><span class="mpre">path</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">BenchGroup</span></span><span class="mpre"> </span><a name="loc_93_25_93_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_25_93_29&#39;)"><span class="hl_vardecl"><span class="mpre">name</span></span></a><span class="mpre"> </span><a name="loc_93_30_93_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_30_93_32&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre">) = 
      </span><span class="hl_varref"><span class="mpre">concat</span></span><span class="mpre"> </span><a href="Control.Monad.html#loc_274_1_274_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_274_1_274_6&#39;)"><span class="hl_infix"><span class="mpre">`liftM`</span></span></a><span class="mpre"> </span><a href="Control.Monad.html#loc_111_1_111_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_111_1_111_5&#39;)"><span class="hl_varref"><span class="mpre">mapM</span></span></a><span class="mpre"> (</span><a href="#loc_89_5_89_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_5_89_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> (</span><a href="#loc_93_8_93_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_8_93_12&#39;)"><span class="hl_varref"><span class="mpre">path</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> (</span><a href="#loc_93_25_93_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_25_93_29&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">))) </span><a href="#loc_93_30_93_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_93_30_93_32&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Run a benchmark for a series of data points; e.g. to measure scalability</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- properties.</span></span><span class="mpre">
</span><a href="#loc_99_1_99_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_1_99_19&#39;)"><span class="mpre">runSeriesBenchmark</span></a><span class="mpre"> :: (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Benchmark</span></span><span class="mpre">) -&gt; [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">MyCriterion</span></span><span class="mpre"> [(</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">Sample</span></span><span class="mpre">)]
</span><a name="loc_99_1_99_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_1_99_19&#39;)"><span class="hl_fundecl"><span class="mpre">runSeriesBenchmark</span></span></a><span class="mpre"> </span><a name="loc_99_20_99_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_20_99_27&#39;)"><span class="hl_vardecl"><span class="mpre">mkBench</span></span></a><span class="mpre"> </span><a name="loc_99_28_99_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_28_99_30&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> =
    (</span><span class="hl_varref"><span class="mpre">zip</span></span><span class="mpre"> </span><a href="#loc_99_28_99_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_28_99_30&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="Data.Tuple.html#loc_52_1_52_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Tuple.html#loc_52_1_52_4&#39;)"><span class="hl_varref"><span class="mpre">snd</span></span></a><span class="mpre">) </span><a href="Control.Monad.html#loc_274_1_274_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_274_1_274_6&#39;)"><span class="hl_infix"><span class="mpre">`liftM`</span></span></a><span class="mpre"> </span><a href="#loc_86_1_86_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_1_86_23&#39;)"><span class="hl_varref"><span class="mpre">runFlattenedBenchmarks</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="#loc_99_20_99_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_20_99_27&#39;)"><span class="hl_varref"><span class="mpre">mkBench</span></span></a><span class="mpre"> </span><a href="#loc_99_28_99_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_28_99_30&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">)


</span><span class="hl_comment"><span class="mpre">-- | Use the given config to measure the environment and then run the embedded</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- criterion operation with this information about the environment.</span></span><span class="mpre">
</span><a href="#loc_106_1_106_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_1_106_15&#39;)"><span class="mpre">runMyCriterion</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Config</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">MyCriterion</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_106_1_106_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_1_106_15&#39;)"><span class="hl_fundecl"><span class="mpre">runMyCriterion</span></span></a><span class="mpre"> </span><a name="loc_106_16_106_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_16_106_22&#39;)"><span class="hl_vardecl"><span class="mpre">config</span></span></a><span class="mpre"> </span><a name="loc_106_23_106_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_23_106_32&#39;)"><span class="hl_vardecl"><span class="mpre">criterion</span></span></a><span class="mpre"> = do
    </span><a name="loc_107_5_107_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_5_107_8&#39;)"><span class="hl_vardecl"><span class="mpre">env</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">withConfig</span></span><span class="mpre"> </span><a href="#loc_106_16_106_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_16_106_22&#39;)"><span class="hl_varref"><span class="mpre">config</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">measureEnvironment</span></span><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">withConfig</span></span><span class="mpre"> </span><a href="#loc_106_16_106_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_16_106_22&#39;)"><span class="hl_varref"><span class="mpre">config</span></span></a><span class="mpre"> (</span><a href="Control.Monad.Trans.Reader.html#loc_92_35_92_45" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.Trans.Reader.html#loc_92_35_92_45&#39;)"><span class="hl_varref"><span class="mpre">runReaderT</span></span></a><span class="mpre"> </span><a href="#loc_106_23_106_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_23_106_32&#39;)"><span class="hl_varref"><span class="mpre">criterion</span></span></a><span class="mpre"> </span><a href="#loc_107_5_107_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_107_5_107_8&#39;)"><span class="hl_varref"><span class="mpre">env</span></span></a><span class="mpre">)
    


</span><span class="hl_comment"><span class="mpre">-- Plotting Infrastructure</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--------------------------</span></span><span class="mpre">

</span><a href="#loc_116_1_116_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_1_116_13&#39;)"><span class="mpre">colorPalette</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">Colour</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Double</span></span><span class="mpre">]
</span><a name="loc_116_1_116_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_1_116_13&#39;)"><span class="hl_vardecl"><span class="mpre">colorPalette</span></span></a><span class="mpre"> = [</span><span class="hl_varref"><span class="mpre">blue</span></span><span class="mpre">, </span><span class="hl_varref"><span class="mpre">green</span></span><span class="mpre">, </span><span class="hl_varref"><span class="mpre">red</span></span><span class="mpre">, </span><span class="hl_varref"><span class="mpre">yellow</span></span><span class="mpre">, </span><span class="hl_varref"><span class="mpre">magenta</span></span><span class="mpre">, </span><span class="hl_varref"><span class="mpre">cyan</span></span><span class="mpre">]

</span><a href="#loc_119_1_119_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_1_119_17&#39;)"><span class="mpre">lineStylePalette</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">CairoLineStyle</span></span><span class="mpre">]
</span><a name="loc_119_1_119_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_1_119_17&#39;)"><span class="hl_vardecl"><span class="mpre">lineStylePalette</span></span></a><span class="mpre"> = 
    </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">solidLine</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">opaque</span></span><span class="mpre">)         </span><a href="#loc_116_1_116_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_1_116_13&#39;)"><span class="hl_varref"><span class="mpre">colorPalette</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">dashedLine</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> [</span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre">, </span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre">] </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">opaque</span></span><span class="mpre">) </span><a href="#loc_116_1_116_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_1_116_13&#39;)"><span class="hl_varref"><span class="mpre">colorPalette</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | &gt; ((title, xName, yName), [(lineName,[(x,y)])])</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-builder-0.3.3.2/benchmarks/PlotTest.hs&quot;, srcSpanStartLine = 124, srcSpanStartColumn = 1, srcSpanEndLine = 124, srcSpanEndColumn = 72}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-builder-0.3.3.2/benchmarks/PlotTest.hs&quot;, srcSpanStartLine = 124, srcSpanStartColumn = 1, srcSpanEndLine = 124, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/blaze-builder-0.3.3.2/benchmarks/P"><span class="mpre">type PlotData = ((String, String, String), [(String, [(Int, Double)])])</span></span><span class="mpre">

</span><a href="#loc_127_1_127_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_1_127_11&#39;)"><span class="mpre">layoutPlot</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">PlotData</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Layout1</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Double</span></span><span class="mpre">
</span><a name="loc_127_1_127_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_1_127_11&#39;)"><span class="hl_fundecl"><span class="mpre">layoutPlot</span></span></a><span class="mpre"> ((</span><a name="loc_127_14_127_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_14_127_19&#39;)"><span class="hl_vardecl"><span class="mpre">title</span></span></a><span class="mpre">, </span><a name="loc_127_21_127_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_21_127_26&#39;)"><span class="hl_vardecl"><span class="mpre">xName</span></span></a><span class="mpre">, </span><a name="loc_127_28_127_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_28_127_33&#39;)"><span class="hl_vardecl"><span class="mpre">yName</span></span></a><span class="mpre">), </span><a name="loc_127_36_127_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_36_127_41&#39;)"><span class="hl_vardecl"><span class="mpre">lines</span></span></a><span class="mpre">) =
    </span><span class="hl_varref"><span class="mpre">layout1_plots</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">^=</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">toPlot</span></span><span class="mpre">) </span><a href="#loc_135_5_135_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_5_135_10&#39;)"><span class="hl_varref"><span class="mpre">plots</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> 
    </span><span class="hl_varref"><span class="mpre">layout1_title</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">^=</span></span><span class="mpre"> </span><a href="#loc_127_14_127_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_14_127_19&#39;)"><span class="hl_varref"><span class="mpre">title</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">layout1_bottom_axis</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">^=</span></span><span class="mpre"> </span><a href="#loc_146_1_146_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_1_146_13&#39;)"><span class="hl_varref"><span class="mpre">mkLinearAxis</span></span></a><span class="mpre"> </span><a href="#loc_127_21_127_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_21_127_26&#39;)"><span class="hl_varref"><span class="mpre">xName</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">layout1_right_axis</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">^=</span></span><span class="mpre"> </span><a href="#loc_149_1_149_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_1_149_10&#39;)"><span class="hl_varref"><span class="mpre">mkLogAxis</span></span></a><span class="mpre"> </span><a href="#loc_127_28_127_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_28_127_33&#39;)"><span class="hl_varref"><span class="mpre">yName</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">defaultLayout1</span></span><span class="mpre">
  where
    (</span><a name="loc_134_6_134_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_6_134_15&#39;)"><span class="hl_vardecl"><span class="mpre">linesName</span></span></a><span class="mpre">, </span><a name="loc_134_17_134_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_17_134_26&#39;)"><span class="hl_vardecl"><span class="mpre">linesData</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">unzip</span></span><span class="mpre"> </span><a href="#loc_127_36_127_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_36_127_41&#39;)"><span class="hl_varref"><span class="mpre">lines</span></span></a><span class="mpre">
    </span><a name="loc_135_5_135_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_5_135_10&#39;)"><span class="hl_vardecl"><span class="mpre">plots</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">zipWith3</span></span><span class="mpre"> </span><a href="#loc_139_1_139_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_1_139_9&#39;)"><span class="hl_varref"><span class="mpre">plotLine</span></span></a><span class="mpre"> </span><a href="#loc_134_6_134_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_6_134_15&#39;)"><span class="hl_varref"><span class="mpre">linesName</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">cycle</span></span><span class="mpre"> </span><a href="#loc_119_1_119_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_1_119_17&#39;)"><span class="hl_varref"><span class="mpre">lineStylePalette</span></span></a><span class="mpre">) </span><a href="#loc_134_17_134_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_17_134_26&#39;)"><span class="hl_varref"><span class="mpre">linesData</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Plot a single named line using the given line style.</span></span><span class="mpre">
</span><a href="#loc_139_1_139_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_1_139_9&#39;)"><span class="mpre">plotLine</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">CairoLineStyle</span></span><span class="mpre"> -&gt; [(</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">Double</span></span><span class="mpre">)] -&gt; </span><span class="hl_tyconref"><span class="mpre">PlotLines</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Double</span></span><span class="mpre">
</span><a name="loc_139_1_139_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_1_139_9&#39;)"><span class="hl_fundecl"><span class="mpre">plotLine</span></span></a><span class="mpre"> </span><a name="loc_139_10_139_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_10_139_14&#39;)"><span class="hl_vardecl"><span class="mpre">name</span></span></a><span class="mpre"> </span><a name="loc_139_15_139_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_15_139_20&#39;)"><span class="hl_vardecl"><span class="mpre">style</span></span></a><span class="mpre"> </span><a name="loc_139_21_139_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_21_139_27&#39;)"><span class="hl_vardecl"><span class="mpre">points</span></span></a><span class="mpre"> = 
    </span><span class="hl_varref"><span class="mpre">plot_lines_title</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">^=</span></span><span class="mpre"> </span><a href="#loc_139_10_139_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_10_139_14&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">plot_lines_style</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">^=</span></span><span class="mpre"> </span><a href="#loc_139_15_139_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_15_139_20&#39;)"><span class="hl_varref"><span class="mpre">style</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">plot_lines_values</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">^=</span></span><span class="mpre"> [</span><a href="#loc_139_21_139_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_21_139_27&#39;)"><span class="hl_varref"><span class="mpre">points</span></span></a><span class="mpre">] </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> 
    </span><span class="hl_varref"><span class="mpre">defaultPlotLines</span></span><span class="mpre">

</span><a href="#loc_146_1_146_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_1_146_13&#39;)"><span class="mpre">mkLinearAxis</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">LayoutAxis</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><a name="loc_146_1_146_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_1_146_13&#39;)"><span class="hl_fundecl"><span class="mpre">mkLinearAxis</span></span></a><span class="mpre"> </span><a name="loc_146_14_146_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_14_146_18&#39;)"><span class="hl_vardecl"><span class="mpre">name</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">laxis_title</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">^=</span></span><span class="mpre"> </span><a href="#loc_146_14_146_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_14_146_18&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">defaultLayoutAxis</span></span><span class="mpre">

</span><a href="#loc_149_1_149_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_1_149_10&#39;)"><span class="mpre">mkLogAxis</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">LayoutAxis</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Double</span></span><span class="mpre">
</span><a name="loc_149_1_149_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_1_149_10&#39;)"><span class="hl_fundecl"><span class="mpre">mkLogAxis</span></span></a><span class="mpre"> </span><a name="loc_149_11_149_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_11_149_15&#39;)"><span class="hl_vardecl"><span class="mpre">name</span></span></a><span class="mpre"> = 
  </span><span class="hl_varref"><span class="mpre">laxis_title</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">^=</span></span><span class="mpre"> </span><a href="#loc_149_11_149_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_149_11_149_15&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> 
  </span><span class="hl_varref"><span class="mpre">laxis_generate</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">^=</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">autoScaledLogAxis</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">defaultLogAxis</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
  </span><span class="hl_varref"><span class="mpre">defaultLayoutAxis</span></span><span class="mpre">




</span><span class="hl_comment"><span class="mpre">{-
-- Plot Experiments
-------------------


testData :: [(Int,Double)]
testData = zip xs (map (fromIntegral . (^2)) xs)
  where xs = [1,2,4,8,16,32]


blazeLineStyle = solidLine 1 . opaque
binaryLineStyle = dashedLine 1 [5, 5] . opaque


plots :: [PlotLines Int Double]
plots = [ plotLine [c] style testData 
        | (c, style) &lt;- zip [&#39;a&#39;..] (cycle lineStylePalette) ]


mkLayout xname yname title p = 
    layout1_plots ^= [Right p] $ 
    layout1_title ^= title $
    layout1_bottom_axis ^= mkLinearAxis xname $
    layout1_right_axis ^= mkLogAxis yname $
    defaultLayout1

layouts = zipWith (mkLayout &quot;chunksize&quot; &quot;MB/s&quot;) (map return [&#39;A&#39;..]) (map toPlot plots)

testGrid = aboveN $ map (besideN . map (flip tspan (1,1) . toRenderable)) [l1,l2]
  where
  (l1,l2) = splitAt 3 layouts

testIt = renderableToWindow (gridToRenderable testGrid) 640 480
-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">{-
mkChart :: [((String,CairoLineStyle,a), [(Int, IO (Maybe Double))])] -&gt; IO ()
mkChart task = do
  lines &lt;- catMaybes `liftM` mapM measureSerializer task
  let plottedLines = flip map lines $ \ ((name,lineStyle,_), points) -&gt;
          plot_lines_title ^= name $
          plot_lines_style ^= lineStyle $
          plot_lines_values ^= [points] $ 
          defaultPlotLines
  let layout = 
        defaultLayout1
          { layout1_plots_ = map (Right . toPlot) plottedLines }
  renderableToWindow (toRenderable layout) 640 480  


measureSerializer :: (a, [(Int, IO (Maybe Double))]) -&gt; IO (Maybe (a, [(Int,Double)]))
measureSerializer (info, tests) = do
  optPoints &lt;- forM tests $ \ (x, test) -&gt; do
    optY &lt;- test
    case optY of 
      Nothing -&gt; return Nothing
      Just y  -&gt; return $ Just (x, y)
  case catMaybes optPoints of
    []     -&gt; return Nothing
    points -&gt; return $ Just (info, points)

-}</span></span><span class="mpre">
</span></div></body></html>