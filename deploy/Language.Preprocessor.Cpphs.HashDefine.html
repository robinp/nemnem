<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      :  HashDefine</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright   :  2004 Malcolm Wallace</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Licence     :  LGPL</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  :  Malcolm Wallace &lt;Malcolm.Wallace@cs.york.ac.uk&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   :  experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability :  All</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- What structures are declared in a \#define.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-----------------------------------------------------------------------------</span></span><span class="mpre">
 
module Language.Preprocessor.Cpphs.HashDefine
  ( HashDefine(..)
  , ArgOrText(..)
  , expandMacro
  , parseHashDefine
  , simplifyHashDefines
  ) where

import Data.Char (isSpace)
import Data.List (intercalate)

data </span><a name="loc_25_6_25_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_6_25_16&#39;)"><span class="hl_tycondecl"><span class="mpre">HashDefine</span></span></a><span class="mpre">
        = </span><a name="loc_26_11_26_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_11_26_19&#39;)"><span class="hl_condecl"><span class="mpre">LineDrop</span></span></a><span class="mpre">
                { </span><a name="loc_27_19_27_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_19_27_23&#39;)"><span class="hl_fielddecl"><span class="mpre">name</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> }
        | </span><a name="loc_28_11_28_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_11_28_17&#39;)"><span class="hl_condecl"><span class="mpre">Pragma</span></span></a><span class="mpre">
                { </span><span class="hl_fielddecl"><span class="mpre">name</span></span><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> }
        | </span><span class="hl_condecl"><span class="mpre">AntiDefined</span></span><span class="mpre">
                { </span><span class="hl_fielddecl"><span class="mpre">name</span></span><span class="mpre">          :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
                , </span><a name="loc_32_19_32_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_19_32_29&#39;)"><span class="hl_fielddecl"><span class="mpre">linebreaks</span></span></a><span class="mpre">    :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
                }
        | </span><span class="hl_condecl"><span class="mpre">SymbolReplacement</span></span><span class="mpre">
                { </span><span class="hl_fielddecl"><span class="mpre">name</span></span><span class="mpre">                :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
                , </span><a name="loc_36_19_36_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_19_36_30&#39;)"><span class="hl_fielddecl"><span class="mpre">replacement</span></span></a><span class="mpre">        :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
                , </span><span class="hl_fielddecl"><span class="mpre">linebreaks</span></span><span class="mpre">    :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
                }
        | </span><span class="hl_condecl"><span class="mpre">MacroExpansion</span></span><span class="mpre">
                { </span><span class="hl_fielddecl"><span class="mpre">name</span></span><span class="mpre">                :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
                , </span><a name="loc_41_19_41_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_19_41_28&#39;)"><span class="hl_fielddecl"><span class="mpre">arguments</span></span></a><span class="mpre">        :: [</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">]
                , </span><a name="loc_42_19_42_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_19_42_28&#39;)"><span class="hl_fielddecl"><span class="mpre">expansion</span></span></a><span class="mpre">        :: [(</span><a href="#loc_56_6_56_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_6_56_15&#39;)"><span class="hl_tyconref"><span class="mpre">ArgOrText</span></span></a><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">)]
                , </span><span class="hl_fielddecl"><span class="mpre">linebreaks</span></span><span class="mpre">    :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
                }
    </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cpphs-1.18.5/Language/Preprocessor/Cpphs/HashDefine.hs&quot;, srcSpanStartLine = 45, srcSpanStartColumn = 5, srcSpanEndLine = 45, srcSpanEndColumn = 23}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cpphs-1.18.5/Language/Preprocessor/Cpphs/HashDefine.hs&quot;, srcSpanStartLine = 45, srcSpanStartColumn = 5, srcSpanEndLine = 45, srcSpanEndColumn = 13},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cpphs-1.18.5/Lang"><span class="mpre">deriving (Eq,Show)</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | &#39;smart&#39; constructor to avoid warnings from ghc (undefined fields)</span></span><span class="mpre">
</span><a href="#loc_49_1_49_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_1_49_18&#39;)"><span class="mpre">symbolReplacement</span></a><span class="mpre"> :: </span><a href="#loc_25_6_25_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_6_25_16&#39;)"><span class="hl_tyconref"><span class="mpre">HashDefine</span></span></a><span class="mpre">
</span><a name="loc_49_1_49_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_1_49_18&#39;)"><span class="hl_vardecl"><span class="mpre">symbolReplacement</span></span></a><span class="mpre"> =
    </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cpphs-1.18.5/Language/Preprocessor/Cpphs/HashDefine.hs&quot;, srcSpanStartLine = 50, srcSpanStartColumn = 5, srcSpanEndLine = 51, srcSpanEndColumn = 73}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cpphs-1.18.5/Language/Preprocessor/Cpphs/HashDefine.hs&quot;, srcSpanStartLine = 51, srcSpanStartColumn = 10, srcSpanEndLine = 51, srcSpanEndColumn = 11},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cpphs-1.18.5/La"><span class="mpre">SymbolReplacement
         { name=undefined, replacement=undefined, linebreaks=undefined }</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Macro expansion text is divided into sections, each of which is classified</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   as one of three kinds: a formal argument (Arg), plain text (Text),</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   or a stringised formal argument (Str).</span></span><span class="mpre">
data </span><a name="loc_56_6_56_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_6_56_15&#39;)"><span class="hl_tycondecl"><span class="mpre">ArgOrText</span></span></a><span class="mpre"> = </span><a name="loc_56_18_56_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_18_56_21&#39;)"><span class="hl_condecl"><span class="mpre">Arg</span></span></a><span class="mpre"> | </span><a name="loc_56_24_56_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_24_56_28&#39;)"><span class="hl_condecl"><span class="mpre">Text</span></span></a><span class="mpre"> | </span><a name="loc_56_31_56_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_31_56_34&#39;)"><span class="hl_condecl"><span class="mpre">Str</span></span></a><span class="mpre"> </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cpphs-1.18.5/Language/Preprocessor/Cpphs/HashDefine.hs&quot;, srcSpanStartLine = 56, srcSpanStartColumn = 35, srcSpanEndLine = 56, srcSpanEndColumn = 53}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cpphs-1.18.5/Language/Preprocessor/Cpphs/HashDefine.hs&quot;, srcSpanStartLine = 56, srcSpanStartColumn = 35, srcSpanEndLine = 56, srcSpanEndColumn = 43},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cpphs-1.18.5/La"><span class="mpre">deriving (Eq,Show)</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Expand an instance of a macro.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   Precondition: got a match on the macro name.</span></span><span class="mpre">
</span><a href="#loc_61_1_61_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_1_61_12&#39;)"><span class="mpre">expandMacro</span></a><span class="mpre"> :: </span><a href="#loc_25_6_25_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_6_25_16&#39;)"><span class="hl_tyconref"><span class="mpre">HashDefine</span></span></a><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_61_1_61_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_1_61_12&#39;)"><span class="hl_fundecl"><span class="mpre">expandMacro</span></span></a><span class="mpre"> </span><a name="loc_61_13_61_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_13_61_18&#39;)"><span class="hl_vardecl"><span class="mpre">macro</span></span></a><span class="mpre"> </span><a name="loc_61_19_61_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_19_61_29&#39;)"><span class="hl_vardecl"><span class="mpre">parameters</span></span></a><span class="mpre"> </span><a name="loc_61_30_61_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_30_61_36&#39;)"><span class="hl_vardecl"><span class="mpre">layout</span></span></a><span class="mpre"> =
    let </span><a name="loc_62_9_62_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_9_62_12&#39;)"><span class="hl_vardecl"><span class="mpre">env</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">zip</span></span><span class="mpre"> (</span><a href="#loc_41_19_41_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_19_41_28&#39;)"><span class="hl_varref"><span class="mpre">arguments</span></span></a><span class="mpre"> </span><a href="#loc_61_13_61_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_13_61_18&#39;)"><span class="hl_varref"><span class="mpre">macro</span></span></a><span class="mpre">) </span><a href="#loc_61_19_61_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_19_61_29&#39;)"><span class="hl_varref"><span class="mpre">parameters</span></span></a><span class="mpre">
        </span><a name="loc_63_9_63_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_9_63_16&#39;)"><span class="hl_fundecl"><span class="mpre">replace</span></span></a><span class="mpre"> (</span><a href="#loc_56_18_56_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_18_56_21&#39;)"><span class="hl_conref"><span class="mpre">Arg</span></span></a><span class="mpre">,</span><a name="loc_63_22_63_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_22_63_23&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">)  = </span><span class="hl_varref"><span class="mpre">maybe</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;formal param&quot;</span></span><span class="mpre">) </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">lookup</span></span><span class="mpre"> </span><a href="#loc_63_22_63_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_22_63_23&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><a href="#loc_62_9_62_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_9_62_12&#39;)"><span class="hl_varref"><span class="mpre">env</span></span></a><span class="mpre">)
        </span><a href="#loc_63_9_63_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_9_63_16&#39;)"><span class="hl_fundecl"><span class="mpre">replace</span></span></a><span class="mpre"> (</span><a href="#loc_56_31_56_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_31_56_34&#39;)"><span class="hl_conref"><span class="mpre">Str</span></span></a><span class="mpre">,</span><a name="loc_64_22_64_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_22_64_23&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">)  = </span><span class="hl_varref"><span class="mpre">maybe</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;formal param&quot;</span></span><span class="mpre">) </span><a href="#loc_66_9_66_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_9_66_12&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">lookup</span></span><span class="mpre"> </span><a href="#loc_64_22_64_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_22_64_23&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><a href="#loc_62_9_62_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_9_62_12&#39;)"><span class="hl_varref"><span class="mpre">env</span></span></a><span class="mpre">)
        </span><a href="#loc_63_9_63_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_9_63_16&#39;)"><span class="hl_fundecl"><span class="mpre">replace</span></span></a><span class="mpre"> (</span><a href="#loc_56_24_56_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_24_56_28&#39;)"><span class="hl_conref"><span class="mpre">Text</span></span></a><span class="mpre">,</span><a name="loc_65_23_65_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_23_65_24&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">) = if </span><a href="#loc_61_30_61_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_30_61_36&#39;)"><span class="hl_varref"><span class="mpre">layout</span></span></a><span class="mpre"> then </span><a href="#loc_65_23_65_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_23_65_24&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> else </span><span class="hl_varref"><span class="mpre">filter</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">/=</span></span><span class="hl_char"><span class="mpre">&#39;\n&#39;</span></span><span class="mpre">) </span><a href="#loc_65_23_65_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_23_65_24&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
        </span><a name="loc_66_9_66_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_9_66_12&#39;)"><span class="hl_fundecl"><span class="mpre">str</span></span></a><span class="mpre"> </span><a name="loc_66_13_66_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_13_66_14&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = </span><span class="hl_char"><span class="mpre">&#39;&quot;&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_66_13_66_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_13_66_14&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="hl_infix"><span class="mpre">++</span></span><span class="hl_string"><span class="mpre">&quot;\&quot;&quot;</span></span><span class="mpre">
    in
    </span><span class="hl_varref"><span class="mpre">concatMap</span></span><span class="mpre"> </span><a href="#loc_63_9_63_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_9_63_16&#39;)"><span class="hl_varref"><span class="mpre">replace</span></span></a><span class="mpre"> (</span><a href="#loc_42_19_42_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_19_42_28&#39;)"><span class="hl_varref"><span class="mpre">expansion</span></span></a><span class="mpre"> </span><a href="#loc_61_13_61_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_13_61_18&#39;)"><span class="hl_varref"><span class="mpre">macro</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Parse a \#define, or \#undef, ignoring other \# directives</span></span><span class="mpre">
</span><a href="#loc_72_1_72_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_1_72_16&#39;)"><span class="mpre">parseHashDefine</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><a href="#loc_25_6_25_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_6_25_16&#39;)"><span class="hl_tyconref"><span class="mpre">HashDefine</span></span></a><span class="mpre">
</span><a name="loc_72_1_72_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_1_72_16&#39;)"><span class="hl_fundecl"><span class="mpre">parseHashDefine</span></span></a><span class="mpre"> </span><a name="loc_72_17_72_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_17_72_21&#39;)"><span class="hl_vardecl"><span class="mpre">ansi</span></span></a><span class="mpre"> </span><a name="loc_72_22_72_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_22_72_25&#39;)"><span class="hl_vardecl"><span class="mpre">def</span></span></a><span class="mpre"> = (</span><a href="#loc_77_5_77_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_5_77_12&#39;)"><span class="hl_varref"><span class="mpre">command</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_74_5_74_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_5_74_9&#39;)"><span class="hl_varref"><span class="mpre">skip</span></span></a><span class="mpre">) </span><a href="#loc_72_22_72_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_22_72_25&#39;)"><span class="hl_varref"><span class="mpre">def</span></span></a><span class="mpre">
  where
    </span><a name="loc_74_5_74_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_5_74_9&#39;)"><span class="hl_fundecl"><span class="mpre">skip</span></span></a><span class="mpre"> </span><a name="loc_74_10_74_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_10_74_13&#39;)"><span class="hl_specname"><span class="mpre">xss</span></span></a><span class="mpre">@(</span><a name="loc_74_15_74_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_15_74_16&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_74_17_74_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_17_74_19&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) | </span><span class="hl_varref"><span class="mpre">all</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">isSpace</span></span><span class="mpre"> </span><a href="#loc_74_15_74_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_15_74_16&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> = </span><a href="#loc_74_5_74_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_5_74_9&#39;)"><span class="hl_varref"><span class="mpre">skip</span></span></a><span class="mpre"> </span><a href="#loc_74_17_74_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_17_74_19&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
                    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">     = </span><a href="#loc_74_10_74_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_10_74_13&#39;)"><span class="hl_varref"><span class="mpre">xss</span></span></a><span class="mpre">
    </span><a href="#loc_74_5_74_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_5_74_9&#39;)"><span class="hl_fundecl"><span class="mpre">skip</span></span></a><span class="mpre">    []      = []
    </span><a name="loc_77_5_77_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_5_77_12&#39;)"><span class="hl_fundecl"><span class="mpre">command</span></span></a><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;line&quot;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_77_21_77_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_21_77_23&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">)   = </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><a href="#loc_26_11_26_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_11_26_19&#39;)"><span class="hl_conref"><span class="mpre">LineDrop</span></span></a><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;#line&quot;</span></span><span class="hl_infix"><span class="mpre">++</span></span><span class="hl_varref"><span class="mpre">concat</span></span><span class="mpre"> </span><a href="#loc_77_21_77_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_21_77_23&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">))
    </span><a href="#loc_77_5_77_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_5_77_12&#39;)"><span class="hl_fundecl"><span class="mpre">command</span></span></a><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;pragma&quot;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_78_23_78_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_23_78_25&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) = </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><a href="#loc_28_11_28_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_11_28_17&#39;)"><span class="hl_conref"><span class="mpre">Pragma</span></span></a><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;#pragma&quot;</span></span><span class="hl_infix"><span class="mpre">++</span></span><span class="hl_varref"><span class="mpre">concat</span></span><span class="mpre"> </span><a href="#loc_78_23_78_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_23_78_25&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">))
    </span><a href="#loc_77_5_77_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_5_77_12&#39;)"><span class="hl_fundecl"><span class="mpre">command</span></span></a><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;define&quot;</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="hl_vardecl"><span class="mpre">xs</span></span><span class="mpre">) = </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cpphs-1.18.5/Language/Preprocessor/Cpphs/HashDefine.hs&quot;, srcSpanStartLine = 79, srcSpanStartColumn = 35, srcSpanEndLine = 79, srcSpanEndColumn = 80}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cpphs-1.18.5/Language/Preprocessor/Cpphs/HashDefine.hs&quot;, srcSpanStartLine = 79, srcSpanStartColumn = 56, srcSpanEndLine = 79, srcSpanEndColumn = 57},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cpphs-1.18.5/L"><span class="mpre">((define . skip) xs) { linebreaks=count def }</span></span><span class="mpre">)
    </span><a href="#loc_77_5_77_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_5_77_12&#39;)"><span class="hl_fundecl"><span class="mpre">command</span></span></a><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;undef&quot;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_80_22_80_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_22_80_24&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">)  = </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (((</span><a href="#loc_82_5_82_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_5_82_10&#39;)"><span class="hl_varref"><span class="mpre">undef</span></span></a><span class="mpre">  </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_74_5_74_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_5_74_9&#39;)"><span class="hl_varref"><span class="mpre">skip</span></span></a><span class="mpre">) </span><a href="#loc_80_22_80_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_22_80_24&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">))
    </span><a href="#loc_77_5_77_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_5_77_12&#39;)"><span class="hl_fundecl"><span class="mpre">command</span></span></a><span class="mpre"> _             = </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
    </span><a name="loc_82_5_82_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_5_82_10&#39;)"><span class="hl_fundecl"><span class="mpre">undef</span></span></a><span class="mpre">  (</span><span class="hl_vardecl"><span class="mpre">sym</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_)   = </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cpphs-1.18.5/Language/Preprocessor/Cpphs/HashDefine.hs&quot;, srcSpanStartLine = 82, srcSpanStartColumn = 24, srcSpanEndLine = 82, srcSpanEndColumn = 62}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cpphs-1.18.5/Language/Preprocessor/Cpphs/HashDefine.hs&quot;, srcSpanStartLine = 82, srcSpanStartColumn = 36, srcSpanEndLine = 82, srcSpanEndColumn = 37},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cpphs-1.18.5/L"><span class="mpre">AntiDefined { name=sym, linebreaks=0 }</span></span><span class="mpre">
    </span><span class="hl_fundecl"><span class="mpre">define</span></span><span class="mpre"> (</span><a name="loc_83_13_83_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_13_83_16&#39;)"><span class="hl_vardecl"><span class="mpre">sym</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_83_17_83_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_17_83_19&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">)  = case </span><span class="hl_comment"><span class="mpre">{-skip-}</span></span><span class="mpre"> </span><a href="#loc_83_17_83_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_17_83_19&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre"> of
                           (</span><span class="hl_string"><span class="mpre">&quot;(&quot;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_84_33_84_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_33_84_35&#39;)"><span class="hl_vardecl"><span class="mpre">ys</span></span></a><span class="mpre">) -&gt; (</span><a href="#loc_89_5_89_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_5_89_14&#39;)"><span class="hl_varref"><span class="mpre">macroHead</span></span></a><span class="mpre"> </span><a href="#loc_83_13_83_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_13_83_16&#39;)"><span class="hl_varref"><span class="mpre">sym</span></span></a><span class="mpre"> [] </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_74_5_74_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_5_74_9&#39;)"><span class="hl_varref"><span class="mpre">skip</span></span></a><span class="mpre">) </span><a href="#loc_84_33_84_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_33_84_35&#39;)"><span class="hl_varref"><span class="mpre">ys</span></span></a><span class="mpre">
                           </span><span class="hl_vardecl"><span class="mpre">ys</span></span><span class="mpre">   -&gt; </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cpphs-1.18.5/Language/Preprocessor/Cpphs/HashDefine.hs&quot;, srcSpanStartLine = 85, srcSpanStartColumn = 36, srcSpanEndLine = 88, srcSpanEndColumn = 81}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cpphs-1.18.5/Language/Preprocessor/Cpphs/HashDefine.hs&quot;, srcSpanStartLine = 86, srcSpanStartColumn = 38, srcSpanEndLine = 86, srcSpanEndColumn = 39},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cpphs-1.18.5/L"><span class="mpre">symbolReplacement
                                     { name=sym
                                     , replacement = concatMap snd
                                             (classifyRhs [] (chop (skip ys))) }</span></span><span class="mpre">
    </span><a name="loc_89_5_89_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_5_89_14&#39;)"><span class="hl_fundecl"><span class="mpre">macroHead</span></span></a><span class="mpre"> </span><a name="loc_89_15_89_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_15_89_18&#39;)"><span class="hl_vardecl"><span class="mpre">sym</span></span></a><span class="mpre"> </span><a name="loc_89_19_89_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_19_89_23&#39;)"><span class="hl_vardecl"><span class="mpre">args</span></span></a><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;,&quot;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_89_29_89_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_29_89_31&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) = (</span><a href="#loc_89_5_89_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_5_89_14&#39;)"><span class="hl_varref"><span class="mpre">macroHead</span></span></a><span class="mpre"> </span><a href="#loc_89_15_89_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_15_89_18&#39;)"><span class="hl_varref"><span class="mpre">sym</span></span></a><span class="mpre"> </span><a href="#loc_89_19_89_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_19_89_23&#39;)"><span class="hl_varref"><span class="mpre">args</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_74_5_74_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_5_74_9&#39;)"><span class="hl_varref"><span class="mpre">skip</span></span></a><span class="mpre">) </span><a href="#loc_89_29_89_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_29_89_31&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
    </span><a href="#loc_89_5_89_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_5_89_14&#39;)"><span class="hl_fundecl"><span class="mpre">macroHead</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">sym</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">args</span></span><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;)&quot;</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="hl_vardecl"><span class="mpre">xs</span></span><span class="mpre">) = </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cpphs-1.18.5/Language/Preprocessor/Cpphs/HashDefine.hs&quot;, srcSpanStartLine = 90, srcSpanStartColumn = 35, srcSpanEndLine = 93, srcSpanEndColumn = 63}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cpphs-1.18.5/Language/Preprocessor/Cpphs/HashDefine.hs&quot;, srcSpanStartLine = 91, srcSpanStartColumn = 37, srcSpanEndLine = 91, srcSpanEndColumn = 38},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cpphs-1.18.5/L"><span class="mpre">MacroExpansion
                                    { name =sym , arguments = reverse args
                                    , expansion = classifyRhs args (skip xs)
                                    , linebreaks = undefined }</span></span><span class="mpre">
    </span><a href="#loc_89_5_89_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_5_89_14&#39;)"><span class="hl_fundecl"><span class="mpre">macroHead</span></span></a><span class="mpre"> </span><a name="loc_94_15_94_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_15_94_18&#39;)"><span class="hl_vardecl"><span class="mpre">sym</span></span></a><span class="mpre"> </span><a name="loc_94_19_94_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_19_94_23&#39;)"><span class="hl_vardecl"><span class="mpre">args</span></span></a><span class="mpre"> (</span><a name="loc_94_25_94_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_25_94_28&#39;)"><span class="hl_vardecl"><span class="mpre">var</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_94_29_94_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_29_94_31&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) = (</span><a href="#loc_89_5_89_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_5_89_14&#39;)"><span class="hl_varref"><span class="mpre">macroHead</span></span></a><span class="mpre"> </span><a href="#loc_94_15_94_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_15_94_18&#39;)"><span class="hl_varref"><span class="mpre">sym</span></span></a><span class="mpre"> (</span><a href="#loc_94_25_94_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_25_94_28&#39;)"><span class="hl_varref"><span class="mpre">var</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_94_19_94_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_19_94_23&#39;)"><span class="hl_varref"><span class="mpre">args</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_74_5_74_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_5_74_9&#39;)"><span class="hl_varref"><span class="mpre">skip</span></span></a><span class="mpre">) </span><a href="#loc_94_29_94_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_29_94_31&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
    </span><a href="#loc_89_5_89_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_5_89_14&#39;)"><span class="hl_fundecl"><span class="mpre">macroHead</span></span></a><span class="mpre"> </span><a name="loc_95_15_95_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_15_95_18&#39;)"><span class="hl_vardecl"><span class="mpre">sym</span></span></a><span class="mpre"> </span><a name="loc_95_19_95_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_19_95_23&#39;)"><span class="hl_vardecl"><span class="mpre">args</span></span></a><span class="mpre"> []       = </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;incomplete macro definition:\n&quot;</span></span><span class="mpre">
                                        </span><span class="hl_infix"><span class="mpre">++</span></span><span class="hl_string"><span class="mpre">&quot;  #define &quot;</span></span><span class="hl_infix"><span class="mpre">++</span></span><a href="#loc_95_15_95_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_15_95_18&#39;)"><span class="hl_varref"><span class="mpre">sym</span></span></a><span class="hl_infix"><span class="mpre">++</span></span><span class="hl_string"><span class="mpre">&quot;(&quot;</span></span><span class="mpre">
                                        </span><span class="hl_infix"><span class="mpre">++</span></span><span class="hl_varref"><span class="mpre">intercalate</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;,&quot;</span></span><span class="mpre"> </span><a href="#loc_95_19_95_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_19_95_23&#39;)"><span class="hl_varref"><span class="mpre">args</span></span></a><span class="mpre">)
    </span><a name="loc_98_5_98_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_5_98_16&#39;)"><span class="hl_fundecl"><span class="mpre">classifyRhs</span></span></a><span class="mpre"> </span><a name="loc_98_17_98_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_17_98_21&#39;)"><span class="hl_vardecl"><span class="mpre">args</span></span></a><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;#&quot;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_98_27_98_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_27_98_28&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_98_29_98_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_29_98_31&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">)
                          | </span><a href="#loc_72_17_72_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_17_72_21&#39;)"><span class="hl_varref"><span class="mpre">ansi</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre">
                            </span><a href="#loc_98_27_98_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_27_98_28&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`elem`</span></span><span class="mpre"> </span><a href="#loc_98_17_98_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_17_98_21&#39;)"><span class="hl_varref"><span class="mpre">args</span></span></a><span class="mpre">    = (</span><a href="#loc_56_31_56_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_31_56_34&#39;)"><span class="hl_conref"><span class="mpre">Str</span></span></a><span class="mpre">,</span><a href="#loc_98_27_98_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_27_98_28&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_98_5_98_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_5_98_16&#39;)"><span class="hl_varref"><span class="mpre">classifyRhs</span></span></a><span class="mpre"> </span><a href="#loc_98_17_98_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_17_98_21&#39;)"><span class="hl_varref"><span class="mpre">args</span></span></a><span class="mpre"> </span><a href="#loc_98_29_98_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_29_98_31&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
    </span><a href="#loc_98_5_98_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_5_98_16&#39;)"><span class="hl_fundecl"><span class="mpre">classifyRhs</span></span></a><span class="mpre"> </span><a name="loc_101_17_101_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_17_101_21&#39;)"><span class="hl_vardecl"><span class="mpre">args</span></span></a><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;##&quot;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_101_28_101_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_28_101_30&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">)
                          | </span><a href="#loc_72_17_72_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_17_72_21&#39;)"><span class="hl_varref"><span class="mpre">ansi</span></span></a><span class="mpre">             = </span><a href="#loc_98_5_98_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_5_98_16&#39;)"><span class="hl_varref"><span class="mpre">classifyRhs</span></span></a><span class="mpre"> </span><a href="#loc_101_17_101_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_17_101_21&#39;)"><span class="hl_varref"><span class="mpre">args</span></span></a><span class="mpre"> </span><a href="#loc_101_28_101_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_28_101_30&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
    </span><a href="#loc_98_5_98_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_5_98_16&#39;)"><span class="hl_fundecl"><span class="mpre">classifyRhs</span></span></a><span class="mpre"> </span><a name="loc_103_17_103_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_17_103_21&#39;)"><span class="hl_vardecl"><span class="mpre">args</span></span></a><span class="mpre"> (</span><a name="loc_103_23_103_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_23_103_24&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="hl_string"><span class="mpre">&quot;##&quot;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_103_30_103_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_30_103_32&#39;)"><span class="hl_vardecl"><span class="mpre">s&#39;</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_103_33_103_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_33_103_35&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">)
                          | </span><a href="#loc_72_17_72_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_17_72_21&#39;)"><span class="hl_varref"><span class="mpre">ansi</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">all</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">isSpace</span></span><span class="mpre"> </span><a href="#loc_103_23_103_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_23_103_24&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">all</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">isSpace</span></span><span class="mpre"> </span><a href="#loc_103_30_103_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_30_103_32&#39;)"><span class="hl_varref"><span class="mpre">s&#39;</span></span></a><span class="mpre">
                                             = </span><a href="#loc_98_5_98_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_5_98_16&#39;)"><span class="hl_varref"><span class="mpre">classifyRhs</span></span></a><span class="mpre"> </span><a href="#loc_103_17_103_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_17_103_21&#39;)"><span class="hl_varref"><span class="mpre">args</span></span></a><span class="mpre"> </span><a href="#loc_103_33_103_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_33_103_35&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
    </span><a href="#loc_98_5_98_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_5_98_16&#39;)"><span class="hl_fundecl"><span class="mpre">classifyRhs</span></span></a><span class="mpre"> </span><a name="loc_106_17_106_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_17_106_21&#39;)"><span class="hl_vardecl"><span class="mpre">args</span></span></a><span class="mpre"> (</span><a name="loc_106_23_106_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_23_106_27&#39;)"><span class="hl_vardecl"><span class="mpre">word</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_106_28_106_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_28_106_30&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">)
                          | </span><a href="#loc_106_23_106_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_23_106_27&#39;)"><span class="hl_varref"><span class="mpre">word</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`elem`</span></span><span class="mpre"> </span><a href="#loc_106_17_106_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_17_106_21&#39;)"><span class="hl_varref"><span class="mpre">args</span></span></a><span class="mpre"> = (</span><a href="#loc_56_18_56_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_18_56_21&#39;)"><span class="hl_conref"><span class="mpre">Arg</span></span></a><span class="mpre">,</span><a href="#loc_106_23_106_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_23_106_27&#39;)"><span class="hl_varref"><span class="mpre">word</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_98_5_98_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_5_98_16&#39;)"><span class="hl_varref"><span class="mpre">classifyRhs</span></span></a><span class="mpre"> </span><a href="#loc_106_17_106_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_17_106_21&#39;)"><span class="hl_varref"><span class="mpre">args</span></span></a><span class="mpre"> </span><a href="#loc_106_28_106_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_28_106_30&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
                          | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">        = (</span><a href="#loc_56_24_56_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_24_56_28&#39;)"><span class="hl_conref"><span class="mpre">Text</span></span></a><span class="mpre">,</span><a href="#loc_106_23_106_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_23_106_27&#39;)"><span class="hl_varref"><span class="mpre">word</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_98_5_98_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_5_98_16&#39;)"><span class="hl_varref"><span class="mpre">classifyRhs</span></span></a><span class="mpre"> </span><a href="#loc_106_17_106_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_17_106_21&#39;)"><span class="hl_varref"><span class="mpre">args</span></span></a><span class="mpre"> </span><a href="#loc_106_28_106_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_28_106_30&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
    </span><a href="#loc_98_5_98_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_5_98_16&#39;)"><span class="hl_fundecl"><span class="mpre">classifyRhs</span></span></a><span class="mpre"> _    []                      = []
    </span><span class="hl_vardecl"><span class="mpre">count</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">filter</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">==</span></span><span class="hl_char"><span class="mpre">&#39;\n&#39;</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">concat</span></span><span class="mpre">
    </span><span class="hl_vardecl"><span class="mpre">chop</span></span><span class="mpre">  = </span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">dropWhile</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">all</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">isSpace</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Pretty-print hash defines to a simpler format, as key-value pairs.</span></span><span class="mpre">
</span><a href="#loc_115_1_115_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_1_115_20&#39;)"><span class="mpre">simplifyHashDefines</span></a><span class="mpre"> :: [</span><a href="#loc_25_6_25_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_6_25_16&#39;)"><span class="hl_tyconref"><span class="mpre">HashDefine</span></span></a><span class="mpre">] -&gt; [(</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">)]
</span><a name="loc_115_1_115_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_115_1_115_20&#39;)"><span class="hl_vardecl"><span class="mpre">simplifyHashDefines</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">concatMap</span></span><span class="mpre"> </span><a href="#loc_117_5_117_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_5_117_9&#39;)"><span class="hl_varref"><span class="mpre">simp</span></span></a><span class="mpre">
  where
    </span><a name="loc_117_5_117_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_5_117_9&#39;)"><span class="hl_fundecl"><span class="mpre">simp</span></span></a><span class="mpre"> </span><span class="hl_specname"><span class="mpre">hd</span></span><span class="mpre">@</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cpphs-1.18.5/Language/Preprocessor/Cpphs/HashDefine.hs&quot;, srcSpanStartLine = 117, srcSpanStartColumn = 13, srcSpanEndLine = 117, srcSpanEndColumn = 23}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cpphs-1.18.5/Language/Preprocessor/Cpphs/HashDefine.hs&quot;, srcSpanStartLine = 117, srcSpanStartColumn = 21, srcSpanEndLine = 117, srcSpanEndColumn = 22},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cpphs-1.18.5/La"><span class="mpre">LineDrop{}</span></span><span class="mpre">    = []
    </span><a href="#loc_117_5_117_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_5_117_9&#39;)"><span class="hl_fundecl"><span class="mpre">simp</span></span></a><span class="mpre"> </span><span class="hl_specname"><span class="mpre">hd</span></span><span class="mpre">@</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cpphs-1.18.5/Language/Preprocessor/Cpphs/HashDefine.hs&quot;, srcSpanStartLine = 118, srcSpanStartColumn = 13, srcSpanEndLine = 118, srcSpanEndColumn = 21}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cpphs-1.18.5/Language/Preprocessor/Cpphs/HashDefine.hs&quot;, srcSpanStartLine = 118, srcSpanStartColumn = 19, srcSpanEndLine = 118, srcSpanEndColumn = 20},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cpphs-1.18.5/La"><span class="mpre">Pragma{}</span></span><span class="mpre">      = []
    </span><a href="#loc_117_5_117_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_5_117_9&#39;)"><span class="hl_fundecl"><span class="mpre">simp</span></span></a><span class="mpre"> </span><span class="hl_specname"><span class="mpre">hd</span></span><span class="mpre">@</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cpphs-1.18.5/Language/Preprocessor/Cpphs/HashDefine.hs&quot;, srcSpanStartLine = 119, srcSpanStartColumn = 13, srcSpanEndLine = 119, srcSpanEndColumn = 26}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cpphs-1.18.5/Language/Preprocessor/Cpphs/HashDefine.hs&quot;, srcSpanStartLine = 119, srcSpanStartColumn = 24, srcSpanEndLine = 119, srcSpanEndColumn = 25},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cpphs-1.18.5/La"><span class="mpre">AntiDefined{}</span></span><span class="mpre"> = []
    </span><a href="#loc_117_5_117_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_5_117_9&#39;)"><span class="hl_fundecl"><span class="mpre">simp</span></span></a><span class="mpre"> </span><a name="loc_120_10_120_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_10_120_12&#39;)"><span class="hl_specname"><span class="mpre">hd</span></span></a><span class="mpre">@</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cpphs-1.18.5/Language/Preprocessor/Cpphs/HashDefine.hs&quot;, srcSpanStartLine = 120, srcSpanStartColumn = 13, srcSpanEndLine = 120, srcSpanEndColumn = 32}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cpphs-1.18.5/Language/Preprocessor/Cpphs/HashDefine.hs&quot;, srcSpanStartLine = 120, srcSpanStartColumn = 30, srcSpanEndLine = 120, srcSpanEndColumn = 31},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cpphs-1.18.5/La"><span class="mpre">SymbolReplacement{}</span></span><span class="mpre"> = [(</span><a href="#loc_27_19_27_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_19_27_23&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre"> </span><a href="#loc_120_10_120_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_10_120_12&#39;)"><span class="hl_varref"><span class="mpre">hd</span></span></a><span class="mpre">, </span><a href="#loc_36_19_36_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_19_36_30&#39;)"><span class="hl_varref"><span class="mpre">replacement</span></span></a><span class="mpre"> </span><a href="#loc_120_10_120_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_10_120_12&#39;)"><span class="hl_varref"><span class="mpre">hd</span></span></a><span class="mpre">)]
    </span><a href="#loc_117_5_117_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_5_117_9&#39;)"><span class="hl_fundecl"><span class="mpre">simp</span></span></a><span class="mpre"> </span><a name="loc_121_10_121_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_10_121_12&#39;)"><span class="hl_specname"><span class="mpre">hd</span></span></a><span class="mpre">@</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cpphs-1.18.5/Language/Preprocessor/Cpphs/HashDefine.hs&quot;, srcSpanStartLine = 121, srcSpanStartColumn = 13, srcSpanEndLine = 121, srcSpanEndColumn = 29}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cpphs-1.18.5/Language/Preprocessor/Cpphs/HashDefine.hs&quot;, srcSpanStartLine = 121, srcSpanStartColumn = 27, srcSpanEndLine = 121, srcSpanEndColumn = 28},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cpphs-1.18.5/La"><span class="mpre">MacroExpansion{}</span></span><span class="mpre">    = [(</span><a href="#loc_27_19_27_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_19_27_23&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre"> </span><a href="#loc_121_10_121_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_10_121_12&#39;)"><span class="hl_varref"><span class="mpre">hd</span></span></a><span class="hl_infix"><span class="mpre">++</span></span><span class="hl_string"><span class="mpre">&quot;(&quot;</span></span><span class="hl_infix"><span class="mpre">++</span></span><span class="hl_varref"><span class="mpre">intercalate</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;,&quot;</span></span><span class="mpre"> (</span><a href="#loc_41_19_41_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_19_41_28&#39;)"><span class="hl_varref"><span class="mpre">arguments</span></span></a><span class="mpre"> </span><a href="#loc_121_10_121_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_10_121_12&#39;)"><span class="hl_varref"><span class="mpre">hd</span></span></a><span class="mpre">)
                                           </span><span class="hl_infix"><span class="mpre">++</span></span><span class="hl_string"><span class="mpre">&quot;)&quot;</span></span><span class="mpre">
                                   ,</span><span class="hl_varref"><span class="mpre">concatMap</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">snd</span></span><span class="mpre"> (</span><a href="#loc_42_19_42_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_19_42_28&#39;)"><span class="hl_varref"><span class="mpre">expansion</span></span></a><span class="mpre"> </span><a href="#loc_121_10_121_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_10_121_12&#39;)"><span class="hl_varref"><span class="mpre">hd</span></span></a><span class="mpre">))]
</span></div></body></html>