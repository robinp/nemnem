<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      : Crypto.Cipher.Types.Block</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     : BSD-style</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  : Vincent Hanquez &lt;vincent@snarc.org&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   : Stable</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability : Excellent</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- block cipher basic types</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
{-# LANGUAGE MultiParamTypeClasses #-}
{-# LANGUAGE ExistentialQuantification #-}
{-# LANGUAGE ViewPatterns #-}
module Crypto.Cipher.Types.Block
    (
    </span><span class="hl_comment"><span class="mpre">-- * BlockCipher</span></span><span class="mpre">
      BlockCipher(..)
    </span><span class="hl_comment"><span class="mpre">-- * initialization vector (IV)</span></span><span class="mpre">
    , IV
    , makeIV
    , nullIV
    , ivAdd
    </span><span class="hl_comment"><span class="mpre">-- * XTS</span></span><span class="mpre">
    , XTS
    </span><span class="hl_comment"><span class="mpre">-- * AEAD</span></span><span class="mpre">
    , AEAD(..)
    , AEADState(..)
    , AEADModeImpl(..)
    </span><span class="hl_comment"><span class="mpre">-- * CFB 8 bits</span></span><span class="mpre">
    , cfb8Encrypt
    , cfb8Decrypt
    ) where

import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/Block.hs&quot;, srcSpanStartLine = 33, srcSpanStartColumn = 8, srcSpanEndLine = 33, srcSpanEndColumn = 23}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> (ByteString)
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/Block.hs&quot;, srcSpanStartLine = 34, srcSpanStartColumn = 18, srcSpanEndLine = 34, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> as B
import qualified Data.ByteString.Internal as B (</span><a href="Data.ByteString.Internal.html#loc_411_1_411_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_411_1_411_13&#39;)"><span class="mpre">unsafeCreate</span></a><span class="mpre">)
import Data.Byteable
import Data.Word
import Data.Bits (</span><a href="Data.Bits.html#loc_226_5_226_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_226_5_226_11&#39;)"><span class="mpre">shiftR</span></a><span class="mpre">, </span><a href="Data.Bits.html#loc_79_15_79_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_79_15_79_19&#39;)"><span class="mpre">Bits</span></a><span class="mpre">)
import Crypto.Cipher.Types.Base
import Crypto.Cipher.Types.GF
import Crypto.Cipher.Types.Utils
import Foreign.Ptr
import Foreign.Storable

</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/Block.hs&quot;, srcSpanStartLine = 45, srcSpanStartColumn = 1, srcSpanEndLine = 49, srcSpanEndColumn = 29}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/Block.hs&quot;, srcSpanStartLine = 45, srcSpanStartColumn = 1, srcSpanEndLine = 45, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-type"><span class="mpre">type XTS cipher = (cipher, cipher)
               -&gt; IV cipher        </span><span class="hl_comment"><span class="mpre">-- ^ Usually represent the Data Unit (e.g. disk sector)</span></span><span class="mpre">
               -&gt; DataUnitOffset   </span><span class="hl_comment"><span class="mpre">-- ^ Offset in the data unit in number of blocks</span></span><span class="mpre">
               -&gt; ByteString       </span><span class="hl_comment"><span class="mpre">-- ^ Data</span></span><span class="mpre">
               -&gt; ByteString</span></span><span class="mpre">       </span><span class="hl_comment"><span class="mpre">-- ^ Processed Data</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Symmetric block cipher class</span></span><span class="mpre">
class </span><span class="warning" data-warning="ClassDecl ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/Block.hs&quot;, srcSpanStartLine = 52, srcSpanStartColumn = 7, srcSpanEndLine = 52, srcSpanEndColumn = 23}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/Block.hs&quot;, srcSpanStartLine = 52, srcSpanStartColumn = 21, srcSpanEndLine = 52, srcSpanEndColumn = 23}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/ho"><span class="mpre">Cipher cipher =&gt;</span></span><span class="mpre"> </span><a name="loc_52_24_52_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_24_52_35&#39;)"><span class="hl_classdecl"><span class="mpre">BlockCipher</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">cipher</span></span><span class="mpre"> where
    </span><span class="hl_comment"><span class="mpre">-- | Return the size of block required for this block cipher</span></span><span class="mpre">
    </span><a name="loc_54_5_54_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_5_54_14&#39;)"><span class="mpre">blockSize</span></a><span class="mpre">    :: </span><span class="hl_tyvar"><span class="mpre">cipher</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">

    </span><span class="hl_comment"><span class="mpre">-- | Encrypt blocks</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- the input string need to be multiple of the block size</span></span><span class="mpre">
    </span><a name="loc_59_5_59_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_5_59_15&#39;)"><span class="mpre">ecbEncrypt</span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">cipher</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">

    </span><span class="hl_comment"><span class="mpre">-- | Decrypt blocks</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- the input string need to be multiple of the block size</span></span><span class="mpre">
    </span><a name="loc_64_5_64_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_5_64_15&#39;)"><span class="mpre">ecbDecrypt</span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">cipher</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">

    </span><span class="hl_comment"><span class="mpre">-- | encrypt using the CBC mode.</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- input need to be a multiple of the blocksize</span></span><span class="mpre">
    </span><a name="loc_69_5_69_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_5_69_15&#39;)"><span class="mpre">cbcEncrypt</span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">cipher</span></span><span class="mpre"> -&gt; </span><a href="Crypto.Cipher.Types.Base.html#loc_52_9_52_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Base.html#loc_52_9_52_11&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">cipher</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
    </span><a href="#loc_69_5_69_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_5_69_15&#39;)"><span class="hl_vardecl"><span class="mpre">cbcEncrypt</span></span></a><span class="mpre"> = </span><a href="#loc_168_1_168_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_1_168_18&#39;)"><span class="hl_varref"><span class="mpre">cbcEncryptGeneric</span></span></a><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- | decrypt using the CBC mode.</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- input need to be a multiple of the blocksize</span></span><span class="mpre">
    </span><a name="loc_74_5_74_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_5_74_15&#39;)"><span class="mpre">cbcDecrypt</span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">cipher</span></span><span class="mpre"> -&gt; </span><a href="Crypto.Cipher.Types.Base.html#loc_52_9_52_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Base.html#loc_52_9_52_11&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">cipher</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
    </span><a href="#loc_74_5_74_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_5_74_15&#39;)"><span class="hl_vardecl"><span class="mpre">cbcDecrypt</span></span></a><span class="mpre"> = </span><a href="#loc_175_1_175_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_1_175_18&#39;)"><span class="hl_varref"><span class="mpre">cbcDecryptGeneric</span></span></a><span class="mpre">

    </span><span class="hl_comment"><span class="mpre">-- | encrypt using the CFB mode.</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- input need to be a multiple of the blocksize</span></span><span class="mpre">
    </span><a name="loc_80_5_80_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_5_80_15&#39;)"><span class="mpre">cfbEncrypt</span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">cipher</span></span><span class="mpre"> -&gt; </span><a href="Crypto.Cipher.Types.Base.html#loc_52_9_52_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Base.html#loc_52_9_52_11&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">cipher</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
    </span><a href="#loc_80_5_80_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_5_80_15&#39;)"><span class="hl_vardecl"><span class="mpre">cfbEncrypt</span></span></a><span class="mpre"> = </span><a href="#loc_182_1_182_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_1_182_18&#39;)"><span class="hl_varref"><span class="mpre">cfbEncryptGeneric</span></span></a><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- | decrypt using the CFB mode.</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- input need to be a multiple of the blocksize</span></span><span class="mpre">
    </span><a name="loc_85_5_85_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_5_85_15&#39;)"><span class="mpre">cfbDecrypt</span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">cipher</span></span><span class="mpre"> -&gt; </span><a href="Crypto.Cipher.Types.Base.html#loc_52_9_52_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Base.html#loc_52_9_52_11&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">cipher</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
    </span><a href="#loc_85_5_85_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_5_85_15&#39;)"><span class="hl_vardecl"><span class="mpre">cfbDecrypt</span></span></a><span class="mpre"> = </span><a href="#loc_189_1_189_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_1_189_18&#39;)"><span class="hl_varref"><span class="mpre">cfbDecryptGeneric</span></span></a><span class="mpre">

    </span><span class="hl_comment"><span class="mpre">-- | combine using the CTR mode.</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- CTR mode produce a stream of randomized data that is combined</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- (by XOR operation) with the input stream.</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- encryption and decryption are the same operation.</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- input can be of any size</span></span><span class="mpre">
    </span><a name="loc_96_5_96_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_5_96_15&#39;)"><span class="mpre">ctrCombine</span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">cipher</span></span><span class="mpre"> -&gt; </span><a href="Crypto.Cipher.Types.Base.html#loc_52_9_52_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Base.html#loc_52_9_52_11&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">cipher</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
    </span><a href="#loc_96_5_96_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_5_96_15&#39;)"><span class="hl_vardecl"><span class="mpre">ctrCombine</span></span></a><span class="mpre"> = </span><a href="#loc_196_1_196_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_1_196_18&#39;)"><span class="hl_varref"><span class="mpre">ctrCombineGeneric</span></span></a><span class="mpre">

    </span><span class="hl_comment"><span class="mpre">-- | encrypt using the XTS mode.</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- input need to be a multiple of the blocksize, and the cipher</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- need to process 128 bits block only</span></span><span class="mpre">
    </span><a name="loc_103_5_103_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_5_103_15&#39;)"><span class="mpre">xtsEncrypt</span></a><span class="mpre"> :: (</span><span class="hl_tyvar"><span class="mpre">cipher</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">cipher</span></span><span class="mpre">)
               -&gt; </span><a href="Crypto.Cipher.Types.Base.html#loc_52_9_52_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Base.html#loc_52_9_52_11&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">cipher</span></span><span class="mpre">        </span><span class="hl_comment"><span class="mpre">-- ^ Usually represent the Data Unit (e.g. disk sector)</span></span><span class="mpre">
               -&gt; </span><span class="hl_tyconref"><span class="mpre">DataUnitOffset</span></span><span class="mpre">   </span><span class="hl_comment"><span class="mpre">-- ^ Offset in the data unit in number of blocks</span></span><span class="mpre">
               -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">       </span><span class="hl_comment"><span class="mpre">-- ^ Plaintext</span></span><span class="mpre">
               -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">       </span><span class="hl_comment"><span class="mpre">-- ^ Ciphertext</span></span><span class="mpre">
    </span><a href="#loc_103_5_103_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_5_103_15&#39;)"><span class="hl_vardecl"><span class="mpre">xtsEncrypt</span></span></a><span class="mpre"> = </span><a href="#loc_203_1_203_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_1_203_18&#39;)"><span class="hl_varref"><span class="mpre">xtsEncryptGeneric</span></span></a><span class="mpre">

    </span><span class="hl_comment"><span class="mpre">-- | decrypt using the XTS mode.</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- input need to be a multiple of the blocksize, and the cipher</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- need to process 128 bits block only</span></span><span class="mpre">
    </span><a name="loc_114_5_114_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_5_114_15&#39;)"><span class="mpre">xtsDecrypt</span></a><span class="mpre"> :: (</span><span class="hl_tyvar"><span class="mpre">cipher</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">cipher</span></span><span class="mpre">)
               -&gt; </span><a href="Crypto.Cipher.Types.Base.html#loc_52_9_52_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Base.html#loc_52_9_52_11&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">cipher</span></span><span class="mpre">        </span><span class="hl_comment"><span class="mpre">-- ^ Usually represent the Data Unit (e.g. disk sector)</span></span><span class="mpre">
               -&gt; </span><span class="hl_tyconref"><span class="mpre">DataUnitOffset</span></span><span class="mpre">   </span><span class="hl_comment"><span class="mpre">-- ^ Offset in the data unit in number of blocks</span></span><span class="mpre">
               -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">       </span><span class="hl_comment"><span class="mpre">-- ^ Ciphertext</span></span><span class="mpre">
               -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">       </span><span class="hl_comment"><span class="mpre">-- ^ Plaintext</span></span><span class="mpre">
    </span><a href="#loc_114_5_114_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_5_114_15&#39;)"><span class="hl_vardecl"><span class="mpre">xtsDecrypt</span></span></a><span class="mpre"> = </span><a href="#loc_206_1_206_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_1_206_18&#39;)"><span class="hl_varref"><span class="mpre">xtsDecryptGeneric</span></span></a><span class="mpre">

    </span><span class="hl_comment"><span class="mpre">-- | Initialize a new AEAD State</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
    </span><span class="hl_comment"><span class="mpre">-- When Nothing is returns, it means the mode is not handled.</span></span><span class="mpre">
    </span><a name="loc_124_5_124_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_5_124_13&#39;)"><span class="mpre">aeadInit</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/Block.hs&quot;, srcSpanStartLine = 124, srcSpanStartColumn = 17, srcSpanEndLine = 124, srcSpanEndColumn = 31}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/Block.hs&quot;, srcSpanStartLine = 124, srcSpanStartColumn = 29, srcSpanEndLine = 124, srcSpanEndColumn = 31}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename ="><span class="mpre">Byteable iv =&gt;</span></span><span class="mpre"> </span><a href="Crypto.Cipher.Types.Base.html#loc_67_6_67_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Base.html#loc_67_6_67_14&#39;)"><span class="hl_tyconref"><span class="mpre">AEADMode</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">cipher</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">iv</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> (</span><a href="#loc_128_6_128_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_6_128_10&#39;)"><span class="hl_tyconref"><span class="mpre">AEAD</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">cipher</span></span><span class="mpre">)
    </span><a href="#loc_124_5_124_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_5_124_13&#39;)"><span class="hl_fundecl"><span class="mpre">aeadInit</span></span></a><span class="mpre"> _ _ _ = </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Authenticated Encryption with Associated Data algorithms</span></span><span class="mpre">
data </span><a name="loc_128_6_128_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_6_128_10&#39;)"><span class="hl_tycondecl"><span class="mpre">AEAD</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">cipher</span></span><span class="mpre"> = </span><a name="loc_128_20_128_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_128_20_128_24&#39;)"><span class="hl_condecl"><span class="mpre">AEAD</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">cipher</span></span><span class="mpre"> (</span><a href="#loc_131_6_131_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_6_131_15&#39;)"><span class="hl_tyconref"><span class="mpre">AEADState</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">cipher</span></span><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Wrapper for any AEADState</span></span><span class="mpre">
data </span><a name="loc_131_6_131_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_6_131_15&#39;)"><span class="hl_tycondecl"><span class="mpre">AEADState</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">cipher</span></span><span class="mpre"> = forall st . AEADModeImpl cipher st =&gt; </span><a name="loc_131_63_131_72" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_63_131_72&#39;)"><span class="hl_condecl"><span class="mpre">AEADState</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">st</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Class of AEAD Mode implementation</span></span><span class="mpre">
class </span><span class="warning" data-warning="ClassDecl ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/Block.hs&quot;, srcSpanStartLine = 134, srcSpanStartColumn = 7, srcSpanEndLine = 134, srcSpanEndColumn = 28}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/Block.hs&quot;, srcSpanStartLine = 134, srcSpanStartColumn = 26, srcSpanEndLine = 134, srcSpanEndColumn = 28}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = "><span class="mpre">BlockCipher cipher =&gt;</span></span><span class="mpre"> </span><a name="loc_134_29_134_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_29_134_41&#39;)"><span class="hl_classdecl"><span class="mpre">AEADModeImpl</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">cipher</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">state</span></span><span class="mpre"> where
    </span><a name="loc_135_5_135_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_5_135_26&#39;)"><span class="mpre">aeadStateAppendHeader</span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">cipher</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">state</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">state</span></span><span class="mpre">
    </span><a name="loc_136_5_136_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_5_136_21&#39;)"><span class="mpre">aeadStateEncrypt</span></a><span class="mpre">      :: </span><span class="hl_tyvar"><span class="mpre">cipher</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">state</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">state</span></span><span class="mpre">)
    </span><a name="loc_137_5_137_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_5_137_21&#39;)"><span class="mpre">aeadStateDecrypt</span></a><span class="mpre">      :: </span><span class="hl_tyvar"><span class="mpre">cipher</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">state</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">state</span></span><span class="mpre">)
    </span><a name="loc_138_5_138_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_5_138_22&#39;)"><span class="mpre">aeadStateFinalize</span></a><span class="mpre">     :: </span><span class="hl_tyvar"><span class="mpre">cipher</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">state</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><a href="Crypto.Cipher.Types.Base.html#loc_58_9_58_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Base.html#loc_58_9_58_16&#39;)"><span class="hl_tyconref"><span class="mpre">AuthTag</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Create an IV for a specified block cipher</span></span><span class="mpre">
</span><a href="#loc_142_1_142_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_1_142_7&#39;)"><span class="mpre">makeIV</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/Block.hs&quot;, srcSpanStartLine = 141, srcSpanStartColumn = 11, srcSpanEndLine = 141, srcSpanEndColumn = 41}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/Block.hs&quot;, srcSpanStartLine = 141, srcSpanStartColumn = 11, srcSpanEndLine = 141, srcSpanEndColumn = 12},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-ciphe"><span class="mpre">(Byteable b, BlockCipher c) =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> (</span><a href="Crypto.Cipher.Types.Base.html#loc_52_9_52_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Base.html#loc_52_9_52_11&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">c</span></span><span class="mpre">)
</span><a name="loc_142_1_142_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_1_142_7&#39;)"><span class="hl_fundecl"><span class="mpre">makeIV</span></span></a><span class="mpre"> </span><a name="loc_142_8_142_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_8_142_9&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> = </span><a href="#loc_144_9_144_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_9_144_13&#39;)"><span class="hl_varref"><span class="mpre">toIV</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">undefined</span></span><span class="mpre">
  where </span><a href="#loc_144_9_144_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_9_144_13&#39;)"><span class="mpre">toIV</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/Block.hs&quot;, srcSpanStartLine = 143, srcSpanStartColumn = 17, srcSpanEndLine = 143, srcSpanEndColumn = 33}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/Block.hs&quot;, srcSpanStartLine = 143, srcSpanStartColumn = 31, srcSpanEndLine = 143, srcSpanEndColumn = 33}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename ="><span class="mpre">BlockCipher c =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">c</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> (</span><a href="Crypto.Cipher.Types.Base.html#loc_52_9_52_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Base.html#loc_52_9_52_11&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">c</span></span><span class="mpre">)
        </span><a name="loc_144_9_144_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_9_144_13&#39;)"><span class="hl_fundecl"><span class="mpre">toIV</span></span></a><span class="mpre"> </span><a name="loc_144_14_144_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_14_144_20&#39;)"><span class="hl_vardecl"><span class="mpre">cipher</span></span></a><span class="mpre">
          | </span><a href="Data.Byteable.html#loc_27_5_27_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Byteable.html#loc_27_5_27_19&#39;)"><span class="hl_varref"><span class="mpre">byteableLength</span></span></a><span class="mpre"> </span><a href="#loc_142_8_142_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_8_142_9&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_147_17_147_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_17_147_19&#39;)"><span class="hl_varref"><span class="mpre">sz</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><a href="Crypto.Cipher.Types.Base.html#loc_52_16_52_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Base.html#loc_52_16_52_18&#39;)"><span class="hl_conref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.Byteable.html#loc_24_5_24_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Byteable.html#loc_24_5_24_12&#39;)"><span class="hl_varref"><span class="mpre">toBytes</span></span></a><span class="mpre"> </span><a href="#loc_142_8_142_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_8_142_9&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">)
          | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">              = </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
          where </span><a name="loc_147_17_147_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_147_17_147_19&#39;)"><span class="hl_vardecl"><span class="mpre">sz</span></span></a><span class="mpre"> = </span><a href="#loc_54_5_54_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_5_54_14&#39;)"><span class="hl_varref"><span class="mpre">blockSize</span></span></a><span class="mpre"> </span><a href="#loc_144_14_144_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_14_144_20&#39;)"><span class="hl_varref"><span class="mpre">cipher</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Create an IV that is effectively representing the number 0</span></span><span class="mpre">
</span><a href="#loc_151_1_151_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_1_151_7&#39;)"><span class="mpre">nullIV</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/Block.hs&quot;, srcSpanStartLine = 150, srcSpanStartColumn = 11, srcSpanEndLine = 150, srcSpanEndColumn = 27}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/Block.hs&quot;, srcSpanStartLine = 150, srcSpanStartColumn = 25, srcSpanEndLine = 150, srcSpanEndColumn = 27}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename ="><span class="mpre">BlockCipher c =&gt;</span></span><span class="mpre"> </span><a href="Crypto.Cipher.Types.Base.html#loc_52_9_52_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Base.html#loc_52_9_52_11&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">c</span></span><span class="mpre">
</span><a name="loc_151_1_151_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_151_1_151_7&#39;)"><span class="hl_vardecl"><span class="mpre">nullIV</span></span></a><span class="mpre"> = </span><a href="#loc_153_9_153_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_9_153_13&#39;)"><span class="hl_varref"><span class="mpre">toIV</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">undefined</span></span><span class="mpre">
  where </span><a href="#loc_153_9_153_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_9_153_13&#39;)"><span class="mpre">toIV</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/Block.hs&quot;, srcSpanStartLine = 152, srcSpanStartColumn = 17, srcSpanEndLine = 152, srcSpanEndColumn = 33}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/Block.hs&quot;, srcSpanStartLine = 152, srcSpanStartColumn = 31, srcSpanEndLine = 152, srcSpanEndColumn = 33}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename ="><span class="mpre">BlockCipher c =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">c</span></span><span class="mpre"> -&gt; </span><a href="Crypto.Cipher.Types.Base.html#loc_52_9_52_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Base.html#loc_52_9_52_11&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">c</span></span><span class="mpre">
        </span><a name="loc_153_9_153_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_9_153_13&#39;)"><span class="hl_fundecl"><span class="mpre">toIV</span></span></a><span class="mpre"> </span><a name="loc_153_14_153_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_14_153_20&#39;)"><span class="hl_vardecl"><span class="mpre">cipher</span></span></a><span class="mpre"> = </span><a href="Crypto.Cipher.Types.Base.html#loc_52_16_52_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Base.html#loc_52_16_52_18&#39;)"><span class="hl_conref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.replicate</span></span><span class="mpre"> (</span><a href="#loc_54_5_54_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_5_54_14&#39;)"><span class="hl_varref"><span class="mpre">blockSize</span></span></a><span class="mpre"> </span><a href="#loc_153_14_153_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_14_153_20&#39;)"><span class="hl_varref"><span class="mpre">cipher</span></span></a><span class="mpre">) </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Increment an IV by a number.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Assume the IV is in Big Endian format.</span></span><span class="mpre">
</span><a href="#loc_159_1_159_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_1_159_6&#39;)"><span class="mpre">ivAdd</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/Block.hs&quot;, srcSpanStartLine = 158, srcSpanStartColumn = 10, srcSpanEndLine = 158, srcSpanEndColumn = 26}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/Block.hs&quot;, srcSpanStartLine = 158, srcSpanStartColumn = 24, srcSpanEndLine = 158, srcSpanEndColumn = 26}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename ="><span class="mpre">BlockCipher c =&gt;</span></span><span class="mpre"> </span><a href="Crypto.Cipher.Types.Base.html#loc_52_9_52_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Base.html#loc_52_9_52_11&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">c</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><a href="Crypto.Cipher.Types.Base.html#loc_52_9_52_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Base.html#loc_52_9_52_11&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">c</span></span><span class="mpre">
</span><a name="loc_159_1_159_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_1_159_6&#39;)"><span class="hl_fundecl"><span class="mpre">ivAdd</span></span></a><span class="mpre"> (</span><a href="Crypto.Cipher.Types.Base.html#loc_52_16_52_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Base.html#loc_52_16_52_18&#39;)"><span class="hl_conref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><a name="loc_159_11_159_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_11_159_12&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">) </span><a name="loc_159_14_159_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_14_159_15&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> = </span><a href="Crypto.Cipher.Types.Base.html#loc_52_16_52_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Base.html#loc_52_16_52_18&#39;)"><span class="hl_conref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">snd</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.mapAccumR</span></span><span class="mpre"> </span><a href="#loc_161_9_161_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_9_161_17&#39;)"><span class="hl_varref"><span class="mpre">addCarry</span></span></a><span class="mpre"> </span><a href="#loc_159_14_159_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_14_159_15&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><a href="#loc_159_11_159_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_11_159_12&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">
  where </span><a href="#loc_161_9_161_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_9_161_17&#39;)"><span class="mpre">addCarry</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">)
        </span><a name="loc_161_9_161_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_9_161_17&#39;)"><span class="hl_fundecl"><span class="mpre">addCarry</span></span></a><span class="mpre"> </span><a name="loc_161_18_161_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_18_161_21&#39;)"><span class="hl_vardecl"><span class="mpre">acc</span></span></a><span class="mpre"> </span><a name="loc_161_22_161_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_22_161_23&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre">
            | </span><a href="#loc_161_18_161_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_18_161_21&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">  = (</span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">, </span><a href="#loc_161_22_161_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_22_161_23&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">)
            | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = let (</span><a name="loc_163_32_163_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_32_163_34&#39;)"><span class="hl_vardecl"><span class="mpre">hi</span></span></a><span class="mpre">,</span><a name="loc_163_35_163_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_35_163_37&#39;)"><span class="hl_vardecl"><span class="mpre">lo</span></span></a><span class="mpre">) = </span><a href="#loc_161_18_161_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_18_161_21&#39;)"><span class="hl_varref"><span class="mpre">acc</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`divMod`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">256</span></span><span class="mpre">
                              </span><a name="loc_164_31_164_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_31_164_33&#39;)"><span class="hl_vardecl"><span class="mpre">nw</span></span></a><span class="mpre">      = </span><a href="#loc_163_35_163_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_35_163_37&#39;)"><span class="hl_varref"><span class="mpre">lo</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_161_22_161_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_22_161_23&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">)
                           in (</span><a href="#loc_163_32_163_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_32_163_34&#39;)"><span class="hl_varref"><span class="mpre">hi</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> (</span><a href="#loc_164_31_164_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_31_164_33&#39;)"><span class="hl_varref"><span class="mpre">nw</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_226_5_226_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_226_5_226_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftR`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">), </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_164_31_164_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_31_164_33&#39;)"><span class="hl_varref"><span class="mpre">nw</span></span></a><span class="mpre">)

</span><a href="#loc_168_1_168_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_1_168_18&#39;)"><span class="mpre">cbcEncryptGeneric</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/Block.hs&quot;, srcSpanStartLine = 167, srcSpanStartColumn = 22, srcSpanEndLine = 167, srcSpanEndColumn = 43}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/Block.hs&quot;, srcSpanStartLine = 167, srcSpanStartColumn = 41, srcSpanEndLine = 167, srcSpanEndColumn = 43}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename ="><span class="mpre">BlockCipher cipher =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">cipher</span></span><span class="mpre"> -&gt; </span><a href="Crypto.Cipher.Types.Base.html#loc_52_9_52_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Base.html#loc_52_9_52_11&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">cipher</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
</span><a name="loc_168_1_168_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_1_168_18&#39;)"><span class="hl_fundecl"><span class="mpre">cbcEncryptGeneric</span></span></a><span class="mpre"> </span><a name="loc_168_19_168_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_19_168_25&#39;)"><span class="hl_vardecl"><span class="mpre">cipher</span></span></a><span class="mpre"> (</span><a href="Crypto.Cipher.Types.Base.html#loc_52_16_52_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Base.html#loc_52_16_52_18&#39;)"><span class="hl_conref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><a name="loc_168_30_168_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_30_168_35&#39;)"><span class="hl_vardecl"><span class="mpre">ivini</span></span></a><span class="mpre">) </span><a name="loc_168_37_168_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_37_168_42&#39;)"><span class="hl_vardecl"><span class="mpre">input</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">B.concat</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_169_9_169_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_9_169_14&#39;)"><span class="hl_varref"><span class="mpre">doEnc</span></span></a><span class="mpre"> </span><a href="#loc_168_30_168_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_30_168_35&#39;)"><span class="hl_varref"><span class="mpre">ivini</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Crypto.Cipher.Types.Utils.html#loc_17_1_17_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Utils.html#loc_17_1_17_6&#39;)"><span class="hl_varref"><span class="mpre">chunk</span></span></a><span class="mpre"> (</span><a href="#loc_54_5_54_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_5_54_14&#39;)"><span class="hl_varref"><span class="mpre">blockSize</span></span></a><span class="mpre"> </span><a href="#loc_168_19_168_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_19_168_25&#39;)"><span class="hl_varref"><span class="mpre">cipher</span></span></a><span class="mpre">) </span><a href="#loc_168_37_168_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_37_168_42&#39;)"><span class="hl_varref"><span class="mpre">input</span></span></a><span class="mpre">
  where </span><a name="loc_169_9_169_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_9_169_14&#39;)"><span class="hl_fundecl"><span class="mpre">doEnc</span></span></a><span class="mpre"> _  []     = []
        </span><a href="#loc_169_9_169_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_9_169_14&#39;)"><span class="hl_fundecl"><span class="mpre">doEnc</span></span></a><span class="mpre"> </span><a name="loc_170_15_170_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_15_170_17&#39;)"><span class="hl_vardecl"><span class="mpre">iv</span></span></a><span class="mpre"> (</span><a name="loc_170_19_170_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_19_170_20&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_170_21_170_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_21_170_23&#39;)"><span class="hl_vardecl"><span class="mpre">is</span></span></a><span class="mpre">) =
            let </span><a name="loc_171_17_171_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_17_171_18&#39;)"><span class="hl_vardecl"><span class="mpre">o</span></span></a><span class="mpre"> = </span><a href="#loc_59_5_59_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_5_59_15&#39;)"><span class="hl_varref"><span class="mpre">ecbEncrypt</span></span></a><span class="mpre"> </span><a href="#loc_168_19_168_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_168_19_168_25&#39;)"><span class="hl_varref"><span class="mpre">cipher</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Crypto.Cipher.Types.Utils.html#loc_24_1_24_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Utils.html#loc_24_1_24_5&#39;)"><span class="hl_varref"><span class="mpre">bxor</span></span></a><span class="mpre"> </span><a href="#loc_170_15_170_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_15_170_17&#39;)"><span class="hl_varref"><span class="mpre">iv</span></span></a><span class="mpre"> </span><a href="#loc_170_19_170_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_19_170_20&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">
             in </span><a href="#loc_171_17_171_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_17_171_18&#39;)"><span class="hl_varref"><span class="mpre">o</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_169_9_169_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_9_169_14&#39;)"><span class="hl_varref"><span class="mpre">doEnc</span></span></a><span class="mpre"> </span><a href="#loc_171_17_171_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_171_17_171_18&#39;)"><span class="hl_varref"><span class="mpre">o</span></span></a><span class="mpre"> </span><a href="#loc_170_21_170_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_21_170_23&#39;)"><span class="hl_varref"><span class="mpre">is</span></span></a><span class="mpre">

</span><a href="#loc_175_1_175_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_1_175_18&#39;)"><span class="mpre">cbcDecryptGeneric</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/Block.hs&quot;, srcSpanStartLine = 174, srcSpanStartColumn = 22, srcSpanEndLine = 174, srcSpanEndColumn = 43}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/Block.hs&quot;, srcSpanStartLine = 174, srcSpanStartColumn = 41, srcSpanEndLine = 174, srcSpanEndColumn = 43}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename ="><span class="mpre">BlockCipher cipher =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">cipher</span></span><span class="mpre"> -&gt; </span><a href="Crypto.Cipher.Types.Base.html#loc_52_9_52_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Base.html#loc_52_9_52_11&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">cipher</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
</span><a name="loc_175_1_175_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_1_175_18&#39;)"><span class="hl_fundecl"><span class="mpre">cbcDecryptGeneric</span></span></a><span class="mpre"> </span><a name="loc_175_19_175_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_19_175_25&#39;)"><span class="hl_vardecl"><span class="mpre">cipher</span></span></a><span class="mpre"> (</span><a href="Crypto.Cipher.Types.Base.html#loc_52_16_52_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Base.html#loc_52_16_52_18&#39;)"><span class="hl_conref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><a name="loc_175_30_175_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_30_175_35&#39;)"><span class="hl_vardecl"><span class="mpre">ivini</span></span></a><span class="mpre">) </span><a name="loc_175_37_175_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_37_175_42&#39;)"><span class="hl_vardecl"><span class="mpre">input</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">B.concat</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_176_9_176_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_9_176_14&#39;)"><span class="hl_varref"><span class="mpre">doDec</span></span></a><span class="mpre"> </span><a href="#loc_175_30_175_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_30_175_35&#39;)"><span class="hl_varref"><span class="mpre">ivini</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Crypto.Cipher.Types.Utils.html#loc_17_1_17_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Utils.html#loc_17_1_17_6&#39;)"><span class="hl_varref"><span class="mpre">chunk</span></span></a><span class="mpre"> (</span><a href="#loc_54_5_54_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_5_54_14&#39;)"><span class="hl_varref"><span class="mpre">blockSize</span></span></a><span class="mpre"> </span><a href="#loc_175_19_175_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_19_175_25&#39;)"><span class="hl_varref"><span class="mpre">cipher</span></span></a><span class="mpre">) </span><a href="#loc_175_37_175_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_37_175_42&#39;)"><span class="hl_varref"><span class="mpre">input</span></span></a><span class="mpre">
  where </span><a name="loc_176_9_176_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_9_176_14&#39;)"><span class="hl_fundecl"><span class="mpre">doDec</span></span></a><span class="mpre"> _  []     = []
        </span><a href="#loc_176_9_176_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_9_176_14&#39;)"><span class="hl_fundecl"><span class="mpre">doDec</span></span></a><span class="mpre"> </span><a name="loc_177_15_177_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_177_15_177_17&#39;)"><span class="hl_vardecl"><span class="mpre">iv</span></span></a><span class="mpre"> (</span><a name="loc_177_19_177_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_177_19_177_20&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_177_21_177_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_177_21_177_23&#39;)"><span class="hl_vardecl"><span class="mpre">is</span></span></a><span class="mpre">) =
            let </span><a name="loc_178_17_178_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_17_178_18&#39;)"><span class="hl_vardecl"><span class="mpre">o</span></span></a><span class="mpre"> = </span><a href="Crypto.Cipher.Types.Utils.html#loc_24_1_24_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Utils.html#loc_24_1_24_5&#39;)"><span class="hl_varref"><span class="mpre">bxor</span></span></a><span class="mpre"> </span><a href="#loc_177_15_177_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_177_15_177_17&#39;)"><span class="hl_varref"><span class="mpre">iv</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_64_5_64_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_5_64_15&#39;)"><span class="hl_varref"><span class="mpre">ecbDecrypt</span></span></a><span class="mpre"> </span><a href="#loc_175_19_175_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_19_175_25&#39;)"><span class="hl_varref"><span class="mpre">cipher</span></span></a><span class="mpre"> </span><a href="#loc_177_19_177_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_177_19_177_20&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">
             in </span><a href="#loc_178_17_178_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_17_178_18&#39;)"><span class="hl_varref"><span class="mpre">o</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_176_9_176_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_9_176_14&#39;)"><span class="hl_varref"><span class="mpre">doDec</span></span></a><span class="mpre"> </span><a href="#loc_177_19_177_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_177_19_177_20&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><a href="#loc_177_21_177_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_177_21_177_23&#39;)"><span class="hl_varref"><span class="mpre">is</span></span></a><span class="mpre">

</span><a href="#loc_182_1_182_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_1_182_18&#39;)"><span class="mpre">cfbEncryptGeneric</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/Block.hs&quot;, srcSpanStartLine = 181, srcSpanStartColumn = 22, srcSpanEndLine = 181, srcSpanEndColumn = 43}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/Block.hs&quot;, srcSpanStartLine = 181, srcSpanStartColumn = 41, srcSpanEndLine = 181, srcSpanEndColumn = 43}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename ="><span class="mpre">BlockCipher cipher =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">cipher</span></span><span class="mpre"> -&gt; </span><a href="Crypto.Cipher.Types.Base.html#loc_52_9_52_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Base.html#loc_52_9_52_11&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">cipher</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
</span><a name="loc_182_1_182_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_1_182_18&#39;)"><span class="hl_fundecl"><span class="mpre">cfbEncryptGeneric</span></span></a><span class="mpre"> </span><a name="loc_182_19_182_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_19_182_25&#39;)"><span class="hl_vardecl"><span class="mpre">cipher</span></span></a><span class="mpre"> (</span><a href="Crypto.Cipher.Types.Base.html#loc_52_16_52_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Base.html#loc_52_16_52_18&#39;)"><span class="hl_conref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><a name="loc_182_30_182_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_30_182_35&#39;)"><span class="hl_vardecl"><span class="mpre">ivini</span></span></a><span class="mpre">) </span><a name="loc_182_37_182_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_37_182_42&#39;)"><span class="hl_vardecl"><span class="mpre">input</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">B.concat</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_183_9_183_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_9_183_14&#39;)"><span class="hl_varref"><span class="mpre">doEnc</span></span></a><span class="mpre"> </span><a href="#loc_182_30_182_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_30_182_35&#39;)"><span class="hl_varref"><span class="mpre">ivini</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Crypto.Cipher.Types.Utils.html#loc_17_1_17_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Utils.html#loc_17_1_17_6&#39;)"><span class="hl_varref"><span class="mpre">chunk</span></span></a><span class="mpre"> (</span><a href="#loc_54_5_54_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_5_54_14&#39;)"><span class="hl_varref"><span class="mpre">blockSize</span></span></a><span class="mpre"> </span><a href="#loc_182_19_182_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_19_182_25&#39;)"><span class="hl_varref"><span class="mpre">cipher</span></span></a><span class="mpre">) </span><a href="#loc_182_37_182_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_37_182_42&#39;)"><span class="hl_varref"><span class="mpre">input</span></span></a><span class="mpre">
  where </span><a name="loc_183_9_183_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_9_183_14&#39;)"><span class="hl_fundecl"><span class="mpre">doEnc</span></span></a><span class="mpre"> _  []     = []
        </span><a href="#loc_183_9_183_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_9_183_14&#39;)"><span class="hl_fundecl"><span class="mpre">doEnc</span></span></a><span class="mpre"> </span><a name="loc_184_15_184_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_184_15_184_17&#39;)"><span class="hl_vardecl"><span class="mpre">iv</span></span></a><span class="mpre"> (</span><a name="loc_184_19_184_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_184_19_184_20&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_184_21_184_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_184_21_184_23&#39;)"><span class="hl_vardecl"><span class="mpre">is</span></span></a><span class="mpre">) =
            let </span><a name="loc_185_17_185_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_17_185_18&#39;)"><span class="hl_vardecl"><span class="mpre">o</span></span></a><span class="mpre"> = </span><a href="Crypto.Cipher.Types.Utils.html#loc_24_1_24_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Utils.html#loc_24_1_24_5&#39;)"><span class="hl_varref"><span class="mpre">bxor</span></span></a><span class="mpre"> </span><a href="#loc_184_19_184_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_184_19_184_20&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_59_5_59_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_5_59_15&#39;)"><span class="hl_varref"><span class="mpre">ecbEncrypt</span></span></a><span class="mpre"> </span><a href="#loc_182_19_182_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_19_182_25&#39;)"><span class="hl_varref"><span class="mpre">cipher</span></span></a><span class="mpre"> </span><a href="#loc_184_15_184_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_184_15_184_17&#39;)"><span class="hl_varref"><span class="mpre">iv</span></span></a><span class="mpre">
             in </span><a href="#loc_185_17_185_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_17_185_18&#39;)"><span class="hl_varref"><span class="mpre">o</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_183_9_183_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_9_183_14&#39;)"><span class="hl_varref"><span class="mpre">doEnc</span></span></a><span class="mpre"> </span><a href="#loc_185_17_185_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_17_185_18&#39;)"><span class="hl_varref"><span class="mpre">o</span></span></a><span class="mpre"> </span><a href="#loc_184_21_184_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_184_21_184_23&#39;)"><span class="hl_varref"><span class="mpre">is</span></span></a><span class="mpre">

</span><a href="#loc_189_1_189_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_1_189_18&#39;)"><span class="mpre">cfbDecryptGeneric</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/Block.hs&quot;, srcSpanStartLine = 188, srcSpanStartColumn = 22, srcSpanEndLine = 188, srcSpanEndColumn = 43}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/Block.hs&quot;, srcSpanStartLine = 188, srcSpanStartColumn = 41, srcSpanEndLine = 188, srcSpanEndColumn = 43}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename ="><span class="mpre">BlockCipher cipher =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">cipher</span></span><span class="mpre"> -&gt; </span><a href="Crypto.Cipher.Types.Base.html#loc_52_9_52_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Base.html#loc_52_9_52_11&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">cipher</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
</span><a name="loc_189_1_189_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_1_189_18&#39;)"><span class="hl_fundecl"><span class="mpre">cfbDecryptGeneric</span></span></a><span class="mpre"> </span><a name="loc_189_19_189_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_19_189_25&#39;)"><span class="hl_vardecl"><span class="mpre">cipher</span></span></a><span class="mpre"> (</span><a href="Crypto.Cipher.Types.Base.html#loc_52_16_52_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Base.html#loc_52_16_52_18&#39;)"><span class="hl_conref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><a name="loc_189_30_189_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_30_189_35&#39;)"><span class="hl_vardecl"><span class="mpre">ivini</span></span></a><span class="mpre">) </span><a name="loc_189_37_189_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_37_189_42&#39;)"><span class="hl_vardecl"><span class="mpre">input</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">B.concat</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_190_9_190_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_9_190_14&#39;)"><span class="hl_varref"><span class="mpre">doDec</span></span></a><span class="mpre"> </span><a href="#loc_189_30_189_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_30_189_35&#39;)"><span class="hl_varref"><span class="mpre">ivini</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Crypto.Cipher.Types.Utils.html#loc_17_1_17_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Utils.html#loc_17_1_17_6&#39;)"><span class="hl_varref"><span class="mpre">chunk</span></span></a><span class="mpre"> (</span><a href="#loc_54_5_54_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_5_54_14&#39;)"><span class="hl_varref"><span class="mpre">blockSize</span></span></a><span class="mpre"> </span><a href="#loc_189_19_189_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_19_189_25&#39;)"><span class="hl_varref"><span class="mpre">cipher</span></span></a><span class="mpre">) </span><a href="#loc_189_37_189_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_37_189_42&#39;)"><span class="hl_varref"><span class="mpre">input</span></span></a><span class="mpre">
  where </span><a name="loc_190_9_190_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_9_190_14&#39;)"><span class="hl_fundecl"><span class="mpre">doDec</span></span></a><span class="mpre"> _  []     = []
        </span><a href="#loc_190_9_190_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_9_190_14&#39;)"><span class="hl_fundecl"><span class="mpre">doDec</span></span></a><span class="mpre"> </span><a name="loc_191_15_191_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_15_191_17&#39;)"><span class="hl_vardecl"><span class="mpre">iv</span></span></a><span class="mpre"> (</span><a name="loc_191_19_191_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_19_191_20&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_191_21_191_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_21_191_23&#39;)"><span class="hl_vardecl"><span class="mpre">is</span></span></a><span class="mpre">) =
            let </span><a name="loc_192_17_192_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_17_192_18&#39;)"><span class="hl_vardecl"><span class="mpre">o</span></span></a><span class="mpre"> = </span><a href="Crypto.Cipher.Types.Utils.html#loc_24_1_24_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Utils.html#loc_24_1_24_5&#39;)"><span class="hl_varref"><span class="mpre">bxor</span></span></a><span class="mpre"> </span><a href="#loc_191_19_191_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_19_191_20&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_59_5_59_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_5_59_15&#39;)"><span class="hl_varref"><span class="mpre">ecbEncrypt</span></span></a><span class="mpre"> </span><a href="#loc_189_19_189_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_189_19_189_25&#39;)"><span class="hl_varref"><span class="mpre">cipher</span></span></a><span class="mpre"> </span><a href="#loc_191_15_191_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_15_191_17&#39;)"><span class="hl_varref"><span class="mpre">iv</span></span></a><span class="mpre">
             in </span><a href="#loc_192_17_192_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_192_17_192_18&#39;)"><span class="hl_varref"><span class="mpre">o</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_190_9_190_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_9_190_14&#39;)"><span class="hl_varref"><span class="mpre">doDec</span></span></a><span class="mpre"> </span><a href="#loc_191_19_191_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_19_191_20&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><a href="#loc_191_21_191_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_191_21_191_23&#39;)"><span class="hl_varref"><span class="mpre">is</span></span></a><span class="mpre">

</span><a href="#loc_196_1_196_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_1_196_18&#39;)"><span class="mpre">ctrCombineGeneric</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/Block.hs&quot;, srcSpanStartLine = 195, srcSpanStartColumn = 22, srcSpanEndLine = 195, srcSpanEndColumn = 43}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/Block.hs&quot;, srcSpanStartLine = 195, srcSpanStartColumn = 41, srcSpanEndLine = 195, srcSpanEndColumn = 43}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename ="><span class="mpre">BlockCipher cipher =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">cipher</span></span><span class="mpre"> -&gt; </span><a href="Crypto.Cipher.Types.Base.html#loc_52_9_52_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Base.html#loc_52_9_52_11&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">cipher</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
</span><a name="loc_196_1_196_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_1_196_18&#39;)"><span class="hl_fundecl"><span class="mpre">ctrCombineGeneric</span></span></a><span class="mpre"> </span><a name="loc_196_19_196_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_19_196_25&#39;)"><span class="hl_vardecl"><span class="mpre">cipher</span></span></a><span class="mpre"> </span><a name="loc_196_26_196_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_26_196_31&#39;)"><span class="hl_vardecl"><span class="mpre">ivini</span></span></a><span class="mpre"> </span><a name="loc_196_32_196_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_32_196_37&#39;)"><span class="hl_vardecl"><span class="mpre">input</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">B.concat</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_197_9_197_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_9_197_14&#39;)"><span class="hl_varref"><span class="mpre">doCnt</span></span></a><span class="mpre"> </span><a href="#loc_196_26_196_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_26_196_31&#39;)"><span class="hl_varref"><span class="mpre">ivini</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Crypto.Cipher.Types.Utils.html#loc_17_1_17_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Utils.html#loc_17_1_17_6&#39;)"><span class="hl_varref"><span class="mpre">chunk</span></span></a><span class="mpre"> (</span><a href="#loc_54_5_54_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_5_54_14&#39;)"><span class="hl_varref"><span class="mpre">blockSize</span></span></a><span class="mpre"> </span><a href="#loc_196_19_196_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_19_196_25&#39;)"><span class="hl_varref"><span class="mpre">cipher</span></span></a><span class="mpre">) </span><a href="#loc_196_32_196_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_32_196_37&#39;)"><span class="hl_varref"><span class="mpre">input</span></span></a><span class="mpre">
  where </span><a name="loc_197_9_197_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_9_197_14&#39;)"><span class="hl_fundecl"><span class="mpre">doCnt</span></span></a><span class="mpre"> _  [] = []
        </span><a href="#loc_197_9_197_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_9_197_14&#39;)"><span class="hl_fundecl"><span class="mpre">doCnt</span></span></a><span class="mpre"> </span><a name="loc_198_15_198_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_15_198_17&#39;)"><span class="hl_vardecl"><span class="mpre">iv</span></span></a><span class="mpre"> (</span><a name="loc_198_19_198_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_19_198_20&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_198_21_198_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_21_198_23&#39;)"><span class="hl_vardecl"><span class="mpre">is</span></span></a><span class="mpre">) =
            let </span><a name="loc_199_17_199_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_17_199_22&#39;)"><span class="hl_vardecl"><span class="mpre">ivEnc</span></span></a><span class="mpre"> = </span><a href="#loc_59_5_59_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_5_59_15&#39;)"><span class="hl_varref"><span class="mpre">ecbEncrypt</span></span></a><span class="mpre"> </span><a href="#loc_196_19_196_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_19_196_25&#39;)"><span class="hl_varref"><span class="mpre">cipher</span></span></a><span class="mpre"> (</span><a href="Data.Byteable.html#loc_24_5_24_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Byteable.html#loc_24_5_24_12&#39;)"><span class="hl_varref"><span class="mpre">toBytes</span></span></a><span class="mpre"> </span><a href="#loc_198_15_198_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_15_198_17&#39;)"><span class="hl_varref"><span class="mpre">iv</span></span></a><span class="mpre">)
             in </span><a href="Crypto.Cipher.Types.Utils.html#loc_24_1_24_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Utils.html#loc_24_1_24_5&#39;)"><span class="hl_varref"><span class="mpre">bxor</span></span></a><span class="mpre"> </span><a href="#loc_198_19_198_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_19_198_20&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><a href="#loc_199_17_199_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_199_17_199_22&#39;)"><span class="hl_varref"><span class="mpre">ivEnc</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_197_9_197_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_9_197_14&#39;)"><span class="hl_varref"><span class="mpre">doCnt</span></span></a><span class="mpre"> (</span><a href="#loc_159_1_159_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_1_159_6&#39;)"><span class="hl_varref"><span class="mpre">ivAdd</span></span></a><span class="mpre"> </span><a href="#loc_198_15_198_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_15_198_17&#39;)"><span class="hl_varref"><span class="mpre">iv</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_198_21_198_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_21_198_23&#39;)"><span class="hl_varref"><span class="mpre">is</span></span></a><span class="mpre">

</span><a href="#loc_203_1_203_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_1_203_18&#39;)"><span class="mpre">xtsEncryptGeneric</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/Block.hs&quot;, srcSpanStartLine = 202, srcSpanStartColumn = 22, srcSpanEndLine = 202, srcSpanEndColumn = 43}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/Block.hs&quot;, srcSpanStartLine = 202, srcSpanStartColumn = 41, srcSpanEndLine = 202, srcSpanEndColumn = 43}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename ="><span class="mpre">BlockCipher cipher =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">XTS</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">cipher</span></span><span class="mpre">
</span><a name="loc_203_1_203_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_1_203_18&#39;)"><span class="hl_vardecl"><span class="mpre">xtsEncryptGeneric</span></span></a><span class="mpre"> = </span><a href="#loc_215_1_215_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_1_215_11&#39;)"><span class="hl_varref"><span class="mpre">xtsGeneric</span></span></a><span class="mpre"> </span><a href="#loc_59_5_59_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_5_59_15&#39;)"><span class="hl_varref"><span class="mpre">ecbEncrypt</span></span></a><span class="mpre">

</span><a href="#loc_206_1_206_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_1_206_18&#39;)"><span class="mpre">xtsDecryptGeneric</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/Block.hs&quot;, srcSpanStartLine = 205, srcSpanStartColumn = 22, srcSpanEndLine = 205, srcSpanEndColumn = 43}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/Block.hs&quot;, srcSpanStartLine = 205, srcSpanStartColumn = 41, srcSpanEndLine = 205, srcSpanEndColumn = 43}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename ="><span class="mpre">BlockCipher cipher =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">XTS</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">cipher</span></span><span class="mpre">
</span><a name="loc_206_1_206_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_1_206_18&#39;)"><span class="hl_vardecl"><span class="mpre">xtsDecryptGeneric</span></span></a><span class="mpre"> = </span><a href="#loc_215_1_215_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_1_215_11&#39;)"><span class="hl_varref"><span class="mpre">xtsGeneric</span></span></a><span class="mpre"> </span><a href="#loc_64_5_64_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_5_64_15&#39;)"><span class="hl_varref"><span class="mpre">ecbDecrypt</span></span></a><span class="mpre">

</span><a href="#loc_215_1_215_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_1_215_11&#39;)"><span class="mpre">xtsGeneric</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/Block.hs&quot;, srcSpanStartLine = 208, srcSpanStartColumn = 15, srcSpanEndLine = 209, srcSpanEndColumn = 14}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/Block.hs&quot;, srcSpanStartLine = 209, srcSpanStartColumn = 12, srcSpanEndLine = 209, srcSpanEndColumn = 14}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename ="><span class="mpre">BlockCipher cipher
           =&gt;</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">cipher</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">)
           -&gt; (</span><span class="hl_tyvar"><span class="mpre">cipher</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">cipher</span></span><span class="mpre">)
           -&gt; </span><a href="Crypto.Cipher.Types.Base.html#loc_52_9_52_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Base.html#loc_52_9_52_11&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">cipher</span></span><span class="mpre">
           -&gt; </span><span class="hl_tyconref"><span class="mpre">DataUnitOffset</span></span><span class="mpre">
           -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
           -&gt; </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
</span><a name="loc_215_1_215_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_1_215_11&#39;)"><span class="hl_fundecl"><span class="mpre">xtsGeneric</span></span></a><span class="mpre"> </span><a name="loc_215_12_215_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_12_215_13&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a name="loc_215_15_215_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_15_215_21&#39;)"><span class="hl_vardecl"><span class="mpre">cipher</span></span></a><span class="mpre">, </span><a name="loc_215_23_215_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_23_215_34&#39;)"><span class="hl_vardecl"><span class="mpre">tweakCipher</span></span></a><span class="mpre">) </span><a name="loc_215_36_215_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_36_215_38&#39;)"><span class="hl_vardecl"><span class="mpre">iv</span></span></a><span class="mpre"> </span><a name="loc_215_39_215_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_39_215_45&#39;)"><span class="hl_vardecl"><span class="mpre">sPoint</span></span></a><span class="mpre"> </span><a name="loc_215_46_215_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_46_215_51&#39;)"><span class="hl_vardecl"><span class="mpre">input</span></span></a><span class="mpre">
    | </span><a href="#loc_54_5_54_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_5_54_14&#39;)"><span class="hl_varref"><span class="mpre">blockSize</span></span></a><span class="mpre"> </span><a href="#loc_215_15_215_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_15_215_21&#39;)"><span class="hl_varref"><span class="mpre">cipher</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">16</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;XTS mode is only available with cipher that have a block size of 128 bits&quot;</span></span><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">B.concat</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_220_9_220_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_220_9_220_14&#39;)"><span class="hl_varref"><span class="mpre">doXts</span></span></a><span class="mpre"> </span><a href="#loc_219_9_219_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_219_9_219_17&#39;)"><span class="hl_varref"><span class="mpre">iniTweak</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Crypto.Cipher.Types.Utils.html#loc_17_1_17_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Utils.html#loc_17_1_17_6&#39;)"><span class="hl_varref"><span class="mpre">chunk</span></span></a><span class="mpre"> (</span><a href="#loc_54_5_54_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_5_54_14&#39;)"><span class="hl_varref"><span class="mpre">blockSize</span></span></a><span class="mpre"> </span><a href="#loc_215_15_215_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_15_215_21&#39;)"><span class="hl_varref"><span class="mpre">cipher</span></span></a><span class="mpre">) </span><a href="#loc_215_46_215_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_46_215_51&#39;)"><span class="hl_varref"><span class="mpre">input</span></span></a><span class="mpre">
  where </span><a name="loc_218_9_218_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_9_218_17&#39;)"><span class="hl_vardecl"><span class="mpre">encTweak</span></span></a><span class="mpre"> = </span><a href="#loc_59_5_59_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_5_59_15&#39;)"><span class="hl_varref"><span class="mpre">ecbEncrypt</span></span></a><span class="mpre"> </span><a href="#loc_215_23_215_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_23_215_34&#39;)"><span class="hl_varref"><span class="mpre">tweakCipher</span></span></a><span class="mpre"> (</span><a href="Data.Byteable.html#loc_24_5_24_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Byteable.html#loc_24_5_24_12&#39;)"><span class="hl_varref"><span class="mpre">toBytes</span></span></a><span class="mpre"> </span><a href="#loc_215_36_215_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_36_215_38&#39;)"><span class="hl_varref"><span class="mpre">iv</span></span></a><span class="mpre">)
        </span><a name="loc_219_9_219_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_219_9_219_17&#39;)"><span class="hl_vardecl"><span class="mpre">iniTweak</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">iterate</span></span><span class="mpre"> </span><a href="Crypto.Cipher.Types.GF.html#loc_30_1_30_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.GF.html#loc_30_1_30_9&#39;)"><span class="hl_varref"><span class="mpre">xtsGFMul</span></span></a><span class="mpre"> </span><a href="#loc_218_9_218_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_218_9_218_17&#39;)"><span class="hl_varref"><span class="mpre">encTweak</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">!!</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_215_39_215_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_39_215_45&#39;)"><span class="hl_varref"><span class="mpre">sPoint</span></span></a><span class="mpre">
        </span><a name="loc_220_9_220_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_220_9_220_14&#39;)"><span class="hl_fundecl"><span class="mpre">doXts</span></span></a><span class="mpre"> _     []     = []
        </span><a href="#loc_220_9_220_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_220_9_220_14&#39;)"><span class="hl_fundecl"><span class="mpre">doXts</span></span></a><span class="mpre"> </span><a name="loc_221_15_221_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_221_15_221_20&#39;)"><span class="hl_vardecl"><span class="mpre">tweak</span></span></a><span class="mpre"> (</span><a name="loc_221_22_221_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_221_22_221_23&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_221_24_221_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_221_24_221_26&#39;)"><span class="hl_vardecl"><span class="mpre">is</span></span></a><span class="mpre">) =
            let </span><a name="loc_222_17_222_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_17_222_18&#39;)"><span class="hl_vardecl"><span class="mpre">o</span></span></a><span class="mpre"> = </span><a href="Crypto.Cipher.Types.Utils.html#loc_24_1_24_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Utils.html#loc_24_1_24_5&#39;)"><span class="hl_varref"><span class="mpre">bxor</span></span></a><span class="mpre"> (</span><a href="#loc_215_12_215_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_12_215_13&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_215_15_215_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_215_15_215_21&#39;)"><span class="hl_varref"><span class="mpre">cipher</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Crypto.Cipher.Types.Utils.html#loc_24_1_24_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Utils.html#loc_24_1_24_5&#39;)"><span class="hl_varref"><span class="mpre">bxor</span></span></a><span class="mpre"> </span><a href="#loc_221_22_221_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_221_22_221_23&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><a href="#loc_221_15_221_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_221_15_221_20&#39;)"><span class="hl_varref"><span class="mpre">tweak</span></span></a><span class="mpre">) </span><a href="#loc_221_15_221_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_221_15_221_20&#39;)"><span class="hl_varref"><span class="mpre">tweak</span></span></a><span class="mpre">
             in </span><a href="#loc_222_17_222_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_222_17_222_18&#39;)"><span class="hl_varref"><span class="mpre">o</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_220_9_220_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_220_9_220_14&#39;)"><span class="hl_varref"><span class="mpre">doXts</span></span></a><span class="mpre"> (</span><a href="Crypto.Cipher.Types.GF.html#loc_30_1_30_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.GF.html#loc_30_1_30_9&#39;)"><span class="hl_varref"><span class="mpre">xtsGFMul</span></span></a><span class="mpre"> </span><a href="#loc_221_15_221_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_221_15_221_20&#39;)"><span class="hl_varref"><span class="mpre">tweak</span></span></a><span class="mpre">) </span><a href="#loc_221_24_221_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_221_24_221_26&#39;)"><span class="hl_varref"><span class="mpre">is</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Encrypt using CFB mode in 8 bit output</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Effectively turn a Block cipher in CFB mode into a Stream cipher</span></span><span class="mpre">
</span><a href="#loc_229_1_229_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_1_229_12&#39;)"><span class="mpre">cfb8Encrypt</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/Block.hs&quot;, srcSpanStartLine = 228, srcSpanStartColumn = 16, srcSpanEndLine = 228, srcSpanEndColumn = 32}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/Block.hs&quot;, srcSpanStartLine = 228, srcSpanStartColumn = 30, srcSpanEndLine = 228, srcSpanEndColumn = 32}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename ="><span class="mpre">BlockCipher a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="Crypto.Cipher.Types.Base.html#loc_52_9_52_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Base.html#loc_52_9_52_11&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">
</span><a name="loc_229_1_229_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_1_229_12&#39;)"><span class="hl_fundecl"><span class="mpre">cfb8Encrypt</span></span></a><span class="mpre"> </span><a name="loc_229_13_229_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_13_229_16&#39;)"><span class="hl_vardecl"><span class="mpre">ctx</span></span></a><span class="mpre"> </span><a name="loc_229_17_229_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_17_229_23&#39;)"><span class="hl_vardecl"><span class="mpre">origIv</span></span></a><span class="mpre"> </span><a name="loc_229_24_229_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_24_229_27&#39;)"><span class="hl_vardecl"><span class="mpre">msg</span></span></a><span class="mpre"> = </span><a href="Data.ByteString.Internal.html#loc_411_1_411_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_411_1_411_13&#39;)"><span class="hl_varref"><span class="mpre">B.unsafeCreate</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_229_24_229_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_24_229_27&#39;)"><span class="hl_varref"><span class="mpre">msg</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_229_63_229_66" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_63_229_66&#39;)"><span class="hl_vardecl"><span class="mpre">dst</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_230_9_230_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_9_230_13&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a href="#loc_229_63_229_66" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_63_229_66&#39;)"><span class="hl_varref"><span class="mpre">dst</span></span></a><span class="mpre"> </span><a href="#loc_229_17_229_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_17_229_23&#39;)"><span class="hl_varref"><span class="mpre">origIv</span></span></a><span class="mpre"> </span><a href="#loc_229_24_229_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_24_229_27&#39;)"><span class="hl_varref"><span class="mpre">msg</span></span></a><span class="mpre">
  where </span><a name="loc_230_9_230_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_9_230_13&#39;)"><span class="hl_fundecl"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a name="loc_230_14_230_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_14_230_15&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre"> </span><a name="loc_230_16_230_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_16_230_18&#39;)"><span class="hl_specname"><span class="mpre">iv</span></span></a><span class="mpre">@(</span><a href="Crypto.Cipher.Types.Base.html#loc_52_16_52_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Base.html#loc_52_16_52_18&#39;)"><span class="hl_conref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><a name="loc_230_23_230_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_23_230_24&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre">) </span><a name="loc_230_26_230_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_26_230_27&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre">
            | </span><span class="hl_varref"><span class="mpre">B.null</span></span><span class="mpre"> </span><a href="#loc_230_26_230_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_26_230_27&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">  = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">
            | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> </span><a href="#loc_230_14_230_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_14_230_15&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><a href="#loc_237_17_237_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_237_17_237_20&#39;)"><span class="hl_varref"><span class="mpre">out</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="#loc_230_9_230_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_9_230_13&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> (</span><a href="#loc_230_14_230_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_14_230_15&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_238_17_238_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_17_238_19&#39;)"><span class="hl_varref"><span class="mpre">ni</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">B.drop</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><a href="#loc_230_26_230_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_26_230_27&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">)
          where </span><a name="loc_233_17_233_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_233_17_233_19&#39;)"><span class="hl_vardecl"><span class="mpre">m&#39;</span></span></a><span class="mpre">  = if </span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_230_26_230_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_26_230_27&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_54_5_54_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_5_54_14&#39;)"><span class="hl_varref"><span class="mpre">blockSize</span></span></a><span class="mpre"> </span><a href="#loc_229_13_229_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_13_229_16&#39;)"><span class="hl_varref"><span class="mpre">ctx</span></span></a><span class="mpre">
                            then </span><a href="#loc_230_26_230_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_26_230_27&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`B.append`</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.replicate</span></span><span class="mpre"> (</span><a href="#loc_54_5_54_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_5_54_14&#39;)"><span class="hl_varref"><span class="mpre">blockSize</span></span></a><span class="mpre"> </span><a href="#loc_229_13_229_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_13_229_16&#39;)"><span class="hl_varref"><span class="mpre">ctx</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_230_26_230_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_26_230_27&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">) </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
                            else </span><span class="hl_varref"><span class="mpre">B.take</span></span><span class="mpre"> (</span><a href="#loc_54_5_54_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_5_54_14&#39;)"><span class="hl_varref"><span class="mpre">blockSize</span></span></a><span class="mpre"> </span><a href="#loc_229_13_229_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_13_229_16&#39;)"><span class="hl_varref"><span class="mpre">ctx</span></span></a><span class="mpre">) </span><a href="#loc_230_26_230_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_26_230_27&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">
                </span><a name="loc_236_17_236_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_17_236_18&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">   = </span><a href="#loc_80_5_80_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_5_80_15&#39;)"><span class="hl_varref"><span class="mpre">cfbEncrypt</span></span></a><span class="mpre"> </span><a href="#loc_229_13_229_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_229_13_229_16&#39;)"><span class="hl_varref"><span class="mpre">ctx</span></span></a><span class="mpre"> </span><a href="#loc_230_16_230_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_16_230_18&#39;)"><span class="hl_varref"><span class="mpre">iv</span></span></a><span class="mpre"> </span><a href="#loc_233_17_233_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_233_17_233_19&#39;)"><span class="hl_varref"><span class="mpre">m&#39;</span></span></a><span class="mpre">
                </span><a name="loc_237_17_237_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_237_17_237_20&#39;)"><span class="hl_vardecl"><span class="mpre">out</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">B.head</span></span><span class="mpre"> </span><a href="#loc_236_17_236_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_236_17_236_18&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">
                </span><a name="loc_238_17_238_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_238_17_238_19&#39;)"><span class="hl_vardecl"><span class="mpre">ni</span></span></a><span class="mpre">  = </span><a href="Crypto.Cipher.Types.Base.html#loc_52_16_52_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Base.html#loc_52_16_52_18&#39;)"><span class="hl_conref"><span class="mpre">IV</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">B.drop</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><a href="#loc_230_23_230_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_23_230_24&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`B.snoc`</span></span><span class="mpre"> </span><a href="#loc_237_17_237_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_237_17_237_20&#39;)"><span class="hl_varref"><span class="mpre">out</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Decrypt using CFB mode in 8 bit output</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Effectively turn a Block cipher in CFB mode into a Stream cipher</span></span><span class="mpre">
</span><a href="#loc_244_1_244_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_244_1_244_12&#39;)"><span class="mpre">cfb8Decrypt</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/Block.hs&quot;, srcSpanStartLine = 243, srcSpanStartColumn = 16, srcSpanEndLine = 243, srcSpanEndColumn = 32}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types/Block.hs&quot;, srcSpanStartLine = 243, srcSpanStartColumn = 30, srcSpanEndLine = 243, srcSpanEndColumn = 32}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename ="><span class="mpre">BlockCipher a =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="Crypto.Cipher.Types.Base.html#loc_52_9_52_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Base.html#loc_52_9_52_11&#39;)"><span class="hl_tyconref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">
</span><a name="loc_244_1_244_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_244_1_244_12&#39;)"><span class="hl_fundecl"><span class="mpre">cfb8Decrypt</span></span></a><span class="mpre"> </span><a name="loc_244_13_244_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_244_13_244_16&#39;)"><span class="hl_vardecl"><span class="mpre">ctx</span></span></a><span class="mpre"> </span><a name="loc_244_17_244_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_244_17_244_23&#39;)"><span class="hl_vardecl"><span class="mpre">origIv</span></span></a><span class="mpre"> </span><a name="loc_244_24_244_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_244_24_244_27&#39;)"><span class="hl_vardecl"><span class="mpre">msg</span></span></a><span class="mpre"> = </span><a href="Data.ByteString.Internal.html#loc_411_1_411_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_411_1_411_13&#39;)"><span class="hl_varref"><span class="mpre">B.unsafeCreate</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_244_24_244_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_244_24_244_27&#39;)"><span class="hl_varref"><span class="mpre">msg</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_244_63_244_66" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_244_63_244_66&#39;)"><span class="hl_vardecl"><span class="mpre">dst</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_245_9_245_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_9_245_13&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a href="#loc_244_63_244_66" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_244_63_244_66&#39;)"><span class="hl_varref"><span class="mpre">dst</span></span></a><span class="mpre"> </span><a href="#loc_244_17_244_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_244_17_244_23&#39;)"><span class="hl_varref"><span class="mpre">origIv</span></span></a><span class="mpre"> </span><a href="#loc_244_24_244_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_244_24_244_27&#39;)"><span class="hl_varref"><span class="mpre">msg</span></span></a><span class="mpre">
  where </span><a name="loc_245_9_245_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_9_245_13&#39;)"><span class="hl_fundecl"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a name="loc_245_14_245_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_14_245_15&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre"> </span><a name="loc_245_16_245_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_16_245_18&#39;)"><span class="hl_specname"><span class="mpre">iv</span></span></a><span class="mpre">@(</span><a href="Crypto.Cipher.Types.Base.html#loc_52_16_52_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Base.html#loc_52_16_52_18&#39;)"><span class="hl_conref"><span class="mpre">IV</span></span></a><span class="mpre"> </span><a name="loc_245_23_245_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_23_245_24&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre">) </span><a name="loc_245_26_245_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_26_245_27&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre">
            | </span><span class="hl_varref"><span class="mpre">B.null</span></span><span class="mpre"> </span><a href="#loc_245_26_245_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_26_245_27&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">  = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">
            | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> </span><a href="#loc_245_14_245_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_14_245_15&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><a href="#loc_252_17_252_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_252_17_252_20&#39;)"><span class="hl_varref"><span class="mpre">out</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="#loc_245_9_245_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_9_245_13&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> (</span><a href="#loc_245_14_245_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_14_245_15&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_253_17_253_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_253_17_253_19&#39;)"><span class="hl_varref"><span class="mpre">ni</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">B.drop</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><a href="#loc_245_26_245_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_26_245_27&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">)
          where </span><a name="loc_248_17_248_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_17_248_19&#39;)"><span class="hl_vardecl"><span class="mpre">m&#39;</span></span></a><span class="mpre">  = if </span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_245_26_245_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_26_245_27&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_54_5_54_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_5_54_14&#39;)"><span class="hl_varref"><span class="mpre">blockSize</span></span></a><span class="mpre"> </span><a href="#loc_244_13_244_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_244_13_244_16&#39;)"><span class="hl_varref"><span class="mpre">ctx</span></span></a><span class="mpre">
                            then </span><a href="#loc_245_26_245_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_26_245_27&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`B.append`</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.replicate</span></span><span class="mpre"> (</span><a href="#loc_54_5_54_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_5_54_14&#39;)"><span class="hl_varref"><span class="mpre">blockSize</span></span></a><span class="mpre"> </span><a href="#loc_244_13_244_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_244_13_244_16&#39;)"><span class="hl_varref"><span class="mpre">ctx</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_245_26_245_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_26_245_27&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">) </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
                            else </span><span class="hl_varref"><span class="mpre">B.take</span></span><span class="mpre"> (</span><a href="#loc_54_5_54_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_5_54_14&#39;)"><span class="hl_varref"><span class="mpre">blockSize</span></span></a><span class="mpre"> </span><a href="#loc_244_13_244_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_244_13_244_16&#39;)"><span class="hl_varref"><span class="mpre">ctx</span></span></a><span class="mpre">) </span><a href="#loc_245_26_245_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_26_245_27&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">
                </span><a name="loc_251_17_251_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_251_17_251_18&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">   = </span><a href="#loc_85_5_85_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_5_85_15&#39;)"><span class="hl_varref"><span class="mpre">cfbDecrypt</span></span></a><span class="mpre"> </span><a href="#loc_244_13_244_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_244_13_244_16&#39;)"><span class="hl_varref"><span class="mpre">ctx</span></span></a><span class="mpre"> </span><a href="#loc_245_16_245_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_16_245_18&#39;)"><span class="hl_varref"><span class="mpre">iv</span></span></a><span class="mpre"> </span><a href="#loc_248_17_248_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_17_248_19&#39;)"><span class="hl_varref"><span class="mpre">m&#39;</span></span></a><span class="mpre">
                </span><a name="loc_252_17_252_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_252_17_252_20&#39;)"><span class="hl_vardecl"><span class="mpre">out</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">B.head</span></span><span class="mpre"> </span><a href="#loc_251_17_251_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_251_17_251_18&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">
                </span><a name="loc_253_17_253_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_253_17_253_19&#39;)"><span class="hl_vardecl"><span class="mpre">ni</span></span></a><span class="mpre">  = </span><a href="Crypto.Cipher.Types.Base.html#loc_52_16_52_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Base.html#loc_52_16_52_18&#39;)"><span class="hl_conref"><span class="mpre">IV</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">B.drop</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><a href="#loc_245_23_245_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_245_23_245_24&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`B.snoc`</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.head</span></span><span class="mpre"> </span><a href="#loc_248_17_248_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_17_248_19&#39;)"><span class="hl_varref"><span class="mpre">m&#39;</span></span></a><span class="mpre">)
</span></div></body></html>