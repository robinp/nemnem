<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE OverloadedStrings #-}
module Network.PublicSuffixList.Lookup (effectiveTLDPlusOne, effectiveTLDPlusOne&#39;, isSuffix, isSuffix&#39;) where

import qualified Data.Map          as M
import           Data.Maybe (</span><a href="Data.Maybe.html#loc_85_1_85_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_85_1_85_10&#39;)"><span class="mpre">isNothing</span></a><span class="mpre">)
import qualified Data.Text         as T

import qualified Network.PublicSuffixList.DataStructure as DS
import           Network.PublicSuffixList.Types

</span><span class="hl_comment"><span class="mpre">{-|
OffEnd&#39;s Bool argument represents whether we fell off a
leaf or whether we fell off a non-leaf. True means that
we fell off a leaf. Its Text argument is the component
that pushed us off the end, along with all the components
to the right of that one, interspersed with &quot;.&quot;s
-}</span></span><span class="mpre">
data </span><a name="loc_18_6_18_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_6_18_18&#39;)"><span class="hl_tycondecl"><span class="mpre">LookupResult</span></span></a><span class="mpre"> = </span><a name="loc_18_21_18_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_21_18_27&#39;)"><span class="hl_condecl"><span class="mpre">Inside</span></span></a><span class="mpre"> | </span><a name="loc_18_30_18_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_30_18_36&#39;)"><span class="hl_condecl"><span class="mpre">AtLeaf</span></span></a><span class="mpre"> | </span><a name="loc_18_39_18_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_39_18_45&#39;)"><span class="hl_condecl"><span class="mpre">OffEnd</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre"> </span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">T.Text</span></span></a><span class="mpre">
  </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/publicsuffixlist-0.1/Network/PublicSuffixList/Lookup.hs&quot;, srcSpanStartLine = 19, srcSpanStartColumn = 3, srcSpanEndLine = 19, srcSpanEndColumn = 16}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/publicsuffixlist-0.1/Network/PublicSuffixList/Lookup.hs&quot;, srcSpanStartLine = 19, srcSpanStartColumn = 3, srcSpanEndLine = 19, srcSpanEndColumn = 11},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/publicsuffixlis"><span class="mpre">deriving (Eq)</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">{-|
This function returns whether or not this domain is owned by a
registrar or a regular person. &#39;Nothing&#39; means that this is a registrar
domain; &#39;Just x&#39; means it&#39;s owned by a person. This is used to determine
if a cookie is allowed to bet set for a particular domain. For
example, you shouldn&#39;t be able to set a cookie for \&quot;com\&quot;.

If the value is &#39;Just x&#39;, then the x value is what is known as the
effective TLD plus one. This is one segment more than the suffix of the
domain. For example, the eTLD+1 for &quot;this.is.a.subdom.com&quot; is Just
&quot;subdom.com&quot;

Note that this function expects lowercase ASCII strings. These strings
should be gotten from the toASCII algorithm as described in RFC 3490.
These strings should not start or end with the \&#39;.\&#39; character, and should
not have two \&#39;.\&#39; characters next to each other.
(The toASCII algorithm is implemented in the \&#39;idna\&#39; hackage package,
though that package doesn&#39;t always map strings to lowercase)
-}</span></span><span class="mpre">
</span><a href="#loc_41_1_41_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_1_41_21&#39;)"><span class="mpre">effectiveTLDPlusOne&#39;</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">DataStructure</span></span><span class="mpre"> -&gt; </span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">T.Text</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">T.Text</span></span></a><span class="mpre">
</span><a name="loc_41_1_41_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_1_41_21&#39;)"><span class="hl_fundecl"><span class="mpre">effectiveTLDPlusOne&#39;</span></span></a><span class="mpre"> </span><a name="loc_41_22_41_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_22_41_35&#39;)"><span class="hl_vardecl"><span class="mpre">dataStructure</span></span></a><span class="mpre"> </span><a name="loc_41_36_41_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_36_41_37&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">
  </span><span class="hl_comment"><span class="mpre">-- Any TLD is a suffix</span></span><span class="mpre">
  | </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_45_9_45_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_9_45_11&#39;)"><span class="hl_varref"><span class="mpre">ss</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
  | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="#loc_66_9_66_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_9_66_15&#39;)"><span class="hl_varref"><span class="mpre">output</span></span></a><span class="mpre"> </span><a href="#loc_48_9_48_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_9_48_20&#39;)"><span class="hl_varref"><span class="mpre">rulesResult</span></span></a><span class="mpre"> </span><a href="#loc_47_9_47_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_9_47_24&#39;)"><span class="hl_varref"><span class="mpre">exceptionResult</span></span></a><span class="mpre">
  where </span><a name="loc_45_9_45_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_9_45_11&#39;)"><span class="hl_vardecl"><span class="mpre">ss</span></span></a><span class="mpre"> = </span><a href="Data.Text.html#loc_1258_1_1258_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.html#loc_1258_1_1258_8&#39;)"><span class="hl_varref"><span class="mpre">T.splitOn</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;.&quot;</span></span><span class="mpre"> </span><a href="#loc_41_36_41_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_36_41_37&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
        </span><a name="loc_46_9_46_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_9_46_11&#39;)"><span class="hl_vardecl"><span class="mpre">ps</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><a href="#loc_45_9_45_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_9_45_11&#39;)"><span class="hl_varref"><span class="mpre">ss</span></span></a><span class="mpre">
        </span><a name="loc_47_9_47_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_9_47_24&#39;)"><span class="hl_vardecl"><span class="mpre">exceptionResult</span></span></a><span class="mpre"> = </span><a href="#loc_59_9_59_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_9_59_16&#39;)"><span class="hl_varref"><span class="mpre">recurse</span></span></a><span class="mpre"> </span><a href="#loc_46_9_46_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_9_46_11&#39;)"><span class="hl_varref"><span class="mpre">ps</span></span></a><span class="mpre"> [] </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">snd</span></span><span class="mpre"> </span><a href="#loc_41_22_41_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_22_41_35&#39;)"><span class="hl_varref"><span class="mpre">dataStructure</span></span></a><span class="mpre">
        </span><a name="loc_48_9_48_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_9_48_20&#39;)"><span class="hl_vardecl"><span class="mpre">rulesResult</span></span></a><span class="mpre"> = </span><a href="#loc_59_9_59_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_9_59_16&#39;)"><span class="hl_varref"><span class="mpre">recurse</span></span></a><span class="mpre"> </span><a href="#loc_46_9_46_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_9_46_11&#39;)"><span class="hl_varref"><span class="mpre">ps</span></span></a><span class="mpre"> [] </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fst</span></span><span class="mpre"> </span><a href="#loc_41_22_41_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_22_41_35&#39;)"><span class="hl_varref"><span class="mpre">dataStructure</span></span></a><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">-- If we fell off, did we do it at a leaf? Otherwise, what&#39;s the</span></span><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">-- subtree that we&#39;re at</span></span><span class="mpre">
        </span><a href="#loc_52_9_52_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_9_52_16&#39;)"><span class="mpre">getNext</span></a><span class="mpre"> :: </span><a href="Network.PublicSuffixList.Types.html#loc_12_9_12_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.PublicSuffixList.Types.html#loc_12_9_12_13&#39;)"><span class="hl_tyconref"><span class="mpre">Tree</span></span></a><span class="mpre"> </span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">T.Text</span></span></a><span class="mpre"> -&gt; </span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">T.Text</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre"> (</span><a href="Network.PublicSuffixList.Types.html#loc_12_9_12_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.PublicSuffixList.Types.html#loc_12_9_12_13&#39;)"><span class="hl_tyconref"><span class="mpre">Tree</span></span></a><span class="mpre"> </span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">T.Text</span></span></a><span class="mpre">)
        </span><a name="loc_52_9_52_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_9_52_16&#39;)"><span class="hl_fundecl"><span class="mpre">getNext</span></span></a><span class="mpre"> </span><a name="loc_52_17_52_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_17_52_18&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> </span><a name="loc_52_19_52_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_19_52_21&#39;)"><span class="hl_vardecl"><span class="mpre">s&#39;</span></span></a><span class="mpre"> = case </span><span class="hl_varref"><span class="mpre">M.lookup</span></span><span class="mpre"> </span><a href="#loc_52_19_52_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_19_52_21&#39;)"><span class="hl_varref"><span class="mpre">s&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.PublicSuffixList.Types.html#loc_12_25_12_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.PublicSuffixList.Types.html#loc_12_25_12_33&#39;)"><span class="hl_varref"><span class="mpre">children</span></span></a><span class="mpre"> </span><a href="#loc_52_17_52_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_17_52_18&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> of
          </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt; </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">M.null</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.PublicSuffixList.Types.html#loc_12_25_12_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.PublicSuffixList.Types.html#loc_12_25_12_33&#39;)"><span class="hl_varref"><span class="mpre">children</span></span></a><span class="mpre"> </span><a href="#loc_52_17_52_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_17_52_18&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre">)
          </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_54_16_54_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_16_54_18&#39;)"><span class="hl_vardecl"><span class="mpre">t&#39;</span></span></a><span class="mpre"> -&gt; </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><a href="#loc_54_16_54_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_16_54_18&#39;)"><span class="hl_varref"><span class="mpre">t&#39;</span></span></a><span class="mpre">
        </span><a name="loc_55_9_55_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_9_55_24&#39;)"><span class="hl_fundecl"><span class="mpre">getNextWithStar</span></span></a><span class="mpre"> </span><a name="loc_55_25_55_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_25_55_26&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> </span><a name="loc_55_27_55_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_27_55_29&#39;)"><span class="hl_vardecl"><span class="mpre">s&#39;</span></span></a><span class="mpre"> = case </span><a href="#loc_52_9_52_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_9_52_16&#39;)"><span class="hl_varref"><span class="mpre">getNext</span></span></a><span class="mpre"> </span><a href="#loc_55_25_55_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_25_55_26&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> </span><a href="#loc_55_27_55_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_27_55_29&#39;)"><span class="hl_varref"><span class="mpre">s&#39;</span></span></a><span class="mpre"> of
          </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> _ -&gt; </span><a href="#loc_52_9_52_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_9_52_16&#39;)"><span class="hl_varref"><span class="mpre">getNext</span></span></a><span class="mpre"> </span><a href="#loc_55_25_55_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_25_55_26&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;*&quot;</span></span><span class="mpre">
          </span><a name="loc_57_11_57_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_11_57_12&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_57_11_57_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_11_57_12&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">
        </span><a href="#loc_59_9_59_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_9_59_16&#39;)"><span class="mpre">recurse</span></a><span class="mpre"> :: [</span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">T.Text</span></span></a><span class="mpre">] -&gt; [</span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">T.Text</span></span></a><span class="mpre">] -&gt; </span><a href="Network.PublicSuffixList.Types.html#loc_12_9_12_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.PublicSuffixList.Types.html#loc_12_9_12_13&#39;)"><span class="hl_tyconref"><span class="mpre">Tree</span></span></a><span class="mpre"> </span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">T.Text</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_18_6_18_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_6_18_18&#39;)"><span class="hl_tyconref"><span class="mpre">LookupResult</span></span></a><span class="mpre">
        </span><a name="loc_59_9_59_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_9_59_16&#39;)"><span class="hl_fundecl"><span class="mpre">recurse</span></span></a><span class="mpre"> [] _ </span><a name="loc_59_22_59_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_22_59_23&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre">
          | </span><span class="hl_varref"><span class="mpre">M.null</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.PublicSuffixList.Types.html#loc_12_25_12_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.PublicSuffixList.Types.html#loc_12_25_12_33&#39;)"><span class="hl_varref"><span class="mpre">children</span></span></a><span class="mpre"> </span><a href="#loc_59_22_59_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_22_59_23&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> = </span><a href="#loc_18_30_18_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_30_18_36&#39;)"><span class="hl_conref"><span class="mpre">AtLeaf</span></span></a><span class="mpre">
          | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="#loc_18_21_18_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_21_18_27&#39;)"><span class="hl_conref"><span class="mpre">Inside</span></span></a><span class="mpre">
        </span><a href="#loc_59_9_59_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_9_59_16&#39;)"><span class="hl_fundecl"><span class="mpre">recurse</span></span></a><span class="mpre"> (</span><a name="loc_62_18_62_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_18_62_19&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a name="loc_62_22_62_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_22_62_24&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre">) </span><a name="loc_62_26_62_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_26_62_30&#39;)"><span class="hl_vardecl"><span class="mpre">prev</span></span></a><span class="mpre"> </span><a name="loc_62_31_62_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_31_62_32&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> = case </span><a href="#loc_55_9_55_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_9_55_24&#39;)"><span class="hl_varref"><span class="mpre">getNextWithStar</span></span></a><span class="mpre"> </span><a href="#loc_62_31_62_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_31_62_32&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> </span><a href="#loc_62_18_62_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_18_62_19&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> of
          </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><a name="loc_63_16_63_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_16_63_17&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_18_39_18_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_39_18_45&#39;)"><span class="hl_conref"><span class="mpre">OffEnd</span></span></a><span class="mpre"> </span><a href="#loc_63_16_63_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_16_63_17&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.Text.html#loc_615_1_615_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.html#loc_615_1_615_12&#39;)"><span class="hl_varref"><span class="mpre">T.intercalate</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;.&quot;</span></span><span class="mpre"> (</span><a href="#loc_62_18_62_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_18_62_19&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_62_26_62_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_26_62_30&#39;)"><span class="hl_varref"><span class="mpre">prev</span></span></a><span class="mpre">)
          </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><a name="loc_64_17_64_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_17_64_19&#39;)"><span class="hl_vardecl"><span class="mpre">t&#39;</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_59_9_59_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_9_59_16&#39;)"><span class="hl_varref"><span class="mpre">recurse</span></span></a><span class="mpre"> </span><a href="#loc_62_22_62_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_22_62_24&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre"> (</span><a href="#loc_62_18_62_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_18_62_19&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_62_26_62_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_26_62_30&#39;)"><span class="hl_varref"><span class="mpre">prev</span></span></a><span class="mpre">) </span><a href="#loc_64_17_64_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_17_64_19&#39;)"><span class="hl_varref"><span class="mpre">t&#39;</span></span></a><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">-- Only match against the exception rules if we have a full match</span></span><span class="mpre">
        </span><a name="loc_66_9_66_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_9_66_15&#39;)"><span class="hl_fundecl"><span class="mpre">output</span></span></a><span class="mpre"> _ </span><a href="#loc_18_30_18_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_30_18_36&#39;)"><span class="hl_conref"><span class="mpre">AtLeaf</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="#loc_41_36_41_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_36_41_37&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
        </span><a href="#loc_66_9_66_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_9_66_15&#39;)"><span class="hl_fundecl"><span class="mpre">output</span></span></a><span class="mpre"> _ (</span><a href="#loc_18_39_18_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_39_18_45&#39;)"><span class="hl_conref"><span class="mpre">OffEnd</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> </span><a name="loc_67_31_67_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_31_67_32&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">) = </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.Text.html#loc_615_1_615_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.html#loc_615_1_615_12&#39;)"><span class="hl_varref"><span class="mpre">T.intercalate</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;.&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">tail</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.Text.html#loc_1258_1_1258_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.html#loc_1258_1_1258_8&#39;)"><span class="hl_varref"><span class="mpre">T.splitOn</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;.&quot;</span></span><span class="mpre"> </span><a href="#loc_67_31_67_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_31_67_32&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">-- If we have a subdomain on an existing rule, we&#39;re not a suffix</span></span><span class="mpre">
        </span><a href="#loc_66_9_66_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_9_66_15&#39;)"><span class="hl_fundecl"><span class="mpre">output</span></span></a><span class="mpre"> (</span><a href="#loc_18_39_18_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_39_18_45&#39;)"><span class="hl_conref"><span class="mpre">OffEnd</span></span></a><span class="mpre"> _ </span><a name="loc_69_26_69_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_26_69_27&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">) _
          </span><span class="hl_comment"><span class="mpre">-- A single level domain can never be a eTLD+1</span></span><span class="mpre">
          | </span><a href="Data.Maybe.html#loc_85_1_85_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_85_1_85_10&#39;)"><span class="hl_varref"><span class="mpre">isNothing</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.Text.html#loc_1311_1_1311_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.html#loc_1311_1_1311_5&#39;)"><span class="hl_varref"><span class="mpre">T.find</span></span></a><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;.&#39;</span></span><span class="mpre">) </span><a href="#loc_69_26_69_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_26_69_27&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.Text.html#loc_615_1_615_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.html#loc_615_1_615_12&#39;)"><span class="hl_varref"><span class="mpre">T.intercalate</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;.&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">drop</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_45_9_45_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_9_45_11&#39;)"><span class="hl_varref"><span class="mpre">ss</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">) </span><a href="#loc_45_9_45_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_9_45_11&#39;)"><span class="hl_varref"><span class="mpre">ss</span></span></a><span class="mpre">
          | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="#loc_69_26_69_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_26_69_27&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">-- Otherwise, we&#39;re a suffix of a suffix, which is a suffix</span></span><span class="mpre">
        </span><a href="#loc_66_9_66_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_9_66_15&#39;)"><span class="hl_fundecl"><span class="mpre">output</span></span></a><span class="mpre"> _ _ = </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | &gt;&gt;&gt; effectiveTLDPlusOne = effectiveTLDPlusOne&#39; Network.PublicSuffixList.DataStructure.dataStructure</span></span><span class="mpre">
</span><a href="#loc_78_1_78_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_1_78_20&#39;)"><span class="mpre">effectiveTLDPlusOne</span></a><span class="mpre"> :: </span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">T.Text</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">T.Text</span></span></a><span class="mpre">
</span><a name="loc_78_1_78_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_1_78_20&#39;)"><span class="hl_vardecl"><span class="mpre">effectiveTLDPlusOne</span></span></a><span class="mpre"> = </span><a href="#loc_41_1_41_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_1_41_21&#39;)"><span class="hl_varref"><span class="mpre">effectiveTLDPlusOne&#39;</span></span></a><span class="mpre"> </span><a href="Network.PublicSuffixList.DataStructure.html#loc_32_1_32_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.PublicSuffixList.DataStructure.html#loc_32_1_32_14&#39;)"><span class="hl_varref"><span class="mpre">DS.dataStructure</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | &gt;&gt;&gt; isSuffix&#39; dataStructure = isNothing . effectiveTLDPlusOne&#39; dataStructure</span></span><span class="mpre">
</span><a href="#loc_82_1_82_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_1_82_10&#39;)"><span class="mpre">isSuffix&#39;</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">DataStructure</span></span><span class="mpre"> -&gt; </span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">T.Text</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_82_1_82_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_1_82_10&#39;)"><span class="hl_fundecl"><span class="mpre">isSuffix&#39;</span></span></a><span class="mpre"> </span><a name="loc_82_11_82_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_11_82_24&#39;)"><span class="hl_vardecl"><span class="mpre">dataStructure</span></span></a><span class="mpre"> = </span><a href="Data.Maybe.html#loc_85_1_85_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_85_1_85_10&#39;)"><span class="hl_varref"><span class="mpre">isNothing</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_41_1_41_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_1_41_21&#39;)"><span class="hl_varref"><span class="mpre">effectiveTLDPlusOne&#39;</span></span></a><span class="mpre"> </span><a href="#loc_82_11_82_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_11_82_24&#39;)"><span class="hl_varref"><span class="mpre">dataStructure</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | &gt;&gt;&gt; isSuffix = isSuffix&#39; Network.PublicSuffixList.DataStructure.dataStructure</span></span><span class="mpre">
</span><a href="#loc_86_1_86_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_1_86_9&#39;)"><span class="mpre">isSuffix</span></a><span class="mpre"> :: </span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">T.Text</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_86_1_86_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_1_86_9&#39;)"><span class="hl_vardecl"><span class="mpre">isSuffix</span></span></a><span class="mpre"> = </span><a href="Data.Maybe.html#loc_85_1_85_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_85_1_85_10&#39;)"><span class="hl_varref"><span class="mpre">isNothing</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_78_1_78_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_1_78_20&#39;)"><span class="hl_varref"><span class="mpre">effectiveTLDPlusOne</span></span></a><span class="mpre">
</span></div></body></html>