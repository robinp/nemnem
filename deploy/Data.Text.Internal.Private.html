<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE BangPatterns, Rank2Types, UnboxedTuples #-}

</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      : Data.Text.Internal.Private</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright   : (c) 2011 Bryan O&#39;Sullivan</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     : BSD-style</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  : bos@serpentine.com</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   : experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability : GHC</span></span><span class="mpre">

module Data.Text.Internal.Private
    (
      runText
    , span_
    ) where

import Control.Monad.ST (ST, runST)
import Data.Text.Internal (</span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="mpre">Text</span></a><span class="mpre">(..), </span><a href="Data.Text.Internal.html#loc_78_1_78_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_78_1_78_5&#39;)"><span class="mpre">text</span></a><span class="mpre">)
import Data.Text.Unsafe (</span><a href="Data.Text.Unsafe.html#loc_62_6_62_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Unsafe.html#loc_62_6_62_10&#39;)"><span class="mpre">Iter</span></a><span class="mpre">(..), </span><a href="Data.Text.Unsafe.html#loc_68_1_68_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Unsafe.html#loc_68_1_68_5&#39;)"><span class="mpre">iter</span></a><span class="mpre">)
import qualified Data.Text.Array as A

</span><a href="#loc_24_1_24_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_1_24_6&#39;)"><span class="mpre">span_</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">) -&gt; </span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre"> -&gt; (# </span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre">, </span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre"> #)
</span><a name="loc_24_1_24_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_1_24_6&#39;)"><span class="hl_fundecl"><span class="mpre">span_</span></span></a><span class="mpre"> </span><a name="loc_24_7_24_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_7_24_8&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_24_9_24_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_9_24_10&#39;)"><span class="hl_specname"><span class="mpre">t</span></span></a><span class="mpre">@(</span><a href="Data.Text.Internal.html#loc_50_13_50_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_13_50_17&#39;)"><span class="hl_conref"><span class="mpre">Text</span></span></a><span class="mpre"> </span><a name="loc_24_17_24_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_17_24_20&#39;)"><span class="hl_vardecl"><span class="mpre">arr</span></span></a><span class="mpre"> </span><a name="loc_24_21_24_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_21_24_24&#39;)"><span class="hl_vardecl"><span class="mpre">off</span></span></a><span class="mpre"> </span><a name="loc_24_25_24_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_25_24_28&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre">) = (# </span><a href="#loc_25_9_25_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_9_25_11&#39;)"><span class="hl_varref"><span class="mpre">hd</span></span></a><span class="mpre">,</span><a href="#loc_26_9_26_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_9_26_11&#39;)"><span class="hl_varref"><span class="mpre">tl</span></span></a><span class="mpre"> #)
  where </span><a name="loc_25_9_25_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_9_25_11&#39;)"><span class="hl_vardecl"><span class="mpre">hd</span></span></a><span class="mpre"> = </span><a href="Data.Text.Internal.html#loc_78_1_78_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_78_1_78_5&#39;)"><span class="hl_varref"><span class="mpre">text</span></span></a><span class="mpre"> </span><a href="#loc_24_17_24_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_17_24_20&#39;)"><span class="hl_varref"><span class="mpre">arr</span></span></a><span class="mpre"> </span><a href="#loc_24_21_24_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_21_24_24&#39;)"><span class="hl_varref"><span class="mpre">off</span></span></a><span class="mpre"> </span><a href="#loc_27_10_27_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_10_27_11&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">
        </span><a name="loc_26_9_26_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_9_26_11&#39;)"><span class="hl_vardecl"><span class="mpre">tl</span></span></a><span class="mpre"> = </span><a href="Data.Text.Internal.html#loc_78_1_78_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_78_1_78_5&#39;)"><span class="hl_varref"><span class="mpre">text</span></span></a><span class="mpre"> </span><a href="#loc_24_17_24_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_17_24_20&#39;)"><span class="hl_varref"><span class="mpre">arr</span></span></a><span class="mpre"> (</span><a href="#loc_24_21_24_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_21_24_24&#39;)"><span class="hl_varref"><span class="mpre">off</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><a href="#loc_27_10_27_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_10_27_11&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">) (</span><a href="#loc_24_25_24_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_25_24_28&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><a href="#loc_27_10_27_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_10_27_11&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">)
        !</span><a name="loc_27_10_27_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_10_27_11&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> = </span><a href="#loc_28_9_28_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_9_28_13&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
        </span><a name="loc_28_9_28_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_9_28_13&#39;)"><span class="hl_fundecl"><span class="mpre">loop</span></span></a><span class="mpre"> !</span><a name="loc_28_15_28_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_15_28_16&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> | </span><a href="#loc_28_15_28_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_15_28_16&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_24_25_24_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_25_24_28&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_24_7_24_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_7_24_8&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_30_24_30_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_24_30_25&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> = </span><a href="#loc_28_9_28_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_9_28_13&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> (</span><a href="#loc_28_15_28_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_15_28_16&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><a href="#loc_30_26_30_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_26_30_27&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre">)
                | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">      = </span><a href="#loc_28_15_28_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_15_28_16&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">
            where </span><a href="Data.Text.Unsafe.html#loc_62_13_62_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Unsafe.html#loc_62_13_62_17&#39;)"><span class="hl_conref"><span class="mpre">Iter</span></span></a><span class="mpre"> </span><a name="loc_30_24_30_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_24_30_25&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> </span><a name="loc_30_26_30_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_26_30_27&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre">       = </span><a href="Data.Text.Unsafe.html#loc_68_1_68_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Unsafe.html#loc_68_1_68_5&#39;)"><span class="hl_varref"><span class="mpre">iter</span></span></a><span class="mpre"> </span><a href="#loc_24_9_24_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_9_24_10&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> </span><a href="#loc_28_15_28_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_15_28_16&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_24_1_24_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_1_24_6&#39;)"><span class="mpre">span_</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><a href="#loc_34_1_34_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_1_34_8&#39;)"><span class="mpre">runText</span></a><span class="mpre"> :: (forall </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">. (</span><a href="Data.Text.Array.html#loc_91_6_91_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Array.html#loc_91_6_91_12&#39;)"><span class="hl_tyconref"><span class="mpre">A.MArray</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ST</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">ST</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre">) -&gt; </span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre">
</span><a name="loc_34_1_34_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_1_34_8&#39;)"><span class="hl_fundecl"><span class="mpre">runText</span></span></a><span class="mpre"> </span><a name="loc_34_9_34_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_9_34_12&#39;)"><span class="hl_vardecl"><span class="mpre">act</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">runST</span></span><span class="mpre"> (</span><a href="#loc_34_9_34_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_9_34_12&#39;)"><span class="hl_varref"><span class="mpre">act</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \ !</span><a name="loc_34_31_34_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_31_34_35&#39;)"><span class="hl_vardecl"><span class="mpre">marr</span></span></a><span class="mpre"> !</span><a name="loc_34_37_34_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_37_34_40&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre"> -&gt; do
                             </span><a name="loc_35_30_35_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_30_35_33&#39;)"><span class="hl_vardecl"><span class="mpre">arr</span></span></a><span class="mpre"> &lt;- </span><a href="Data.Text.Array.html#loc_133_1_133_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Array.html#loc_133_1_133_13&#39;)"><span class="hl_varref"><span class="mpre">A.unsafeFreeze</span></span></a><span class="mpre"> </span><a href="#loc_34_31_34_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_31_34_35&#39;)"><span class="hl_varref"><span class="mpre">marr</span></span></a><span class="mpre">
                             </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$!</span></span><span class="mpre"> </span><a href="Data.Text.Internal.html#loc_78_1_78_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_78_1_78_5&#39;)"><span class="hl_varref"><span class="mpre">text</span></span></a><span class="mpre"> </span><a href="#loc_35_30_35_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_30_35_33&#39;)"><span class="hl_varref"><span class="mpre">arr</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a href="#loc_34_37_34_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_37_34_40&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre">)
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_34_1_34_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_1_34_8&#39;)"><span class="mpre">runText</span></a><span class="mpre"> #-}</span></span><span class="mpre">
</span></div></body></html>