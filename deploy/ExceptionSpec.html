<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE OverloadedStrings #-}

module ExceptionSpec (main, spec) where

import Control.Applicative
import Control.Monad
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/test/ExceptionSpec.hs&quot;, srcSpanStartLine = 7, srcSpanStartColumn = 8, srcSpanEndLine = 7, srcSpanEndColumn = 26}, srcInfoPoints = []}) &quot;Control.Concurrent&quot;"><span class="mpre">Control.Concurrent</span></span><span class="mpre"> (forkIO, threadDelay)
import Network.HTTP
import Network.Stream
import Network.HTTP.Types hiding (Header)
import Network.Wai hiding (</span><a href="Network.Wai.Internal.html#loc_74_6_74_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Internal.html#loc_74_6_74_14&#39;)"><span class="mpre">Response</span></a><span class="mpre">)
import Network.Wai.Internal (</span><a href="Network.Wai.Internal.html#loc_20_6_20_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Internal.html#loc_20_6_20_13&#39;)"><span class="mpre">Request</span></a><span class="mpre">(..))
import Network.Wai.Handler.Warp
import System.IO.Unsafe (</span><a href="GHC.IO.html#loc_165_1_165_16" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_165_1_165_16&#39;)"><span class="mpre">unsafePerformIO</span></a><span class="mpre">)
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/test/ExceptionSpec.hs&quot;, srcSpanStartLine = 15, srcSpanStartColumn = 8, srcSpanEndLine = 15, srcSpanEndColumn = 18}, srcInfoPoints = []}) &quot;Test.Hspec&quot;"><span class="mpre">Test.Hspec</span></span><span class="mpre">
import Control.Exception
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/test/ExceptionSpec.hs&quot;, srcSpanStartLine = 17, srcSpanStartColumn = 18, srcSpanEndLine = 17, srcSpanEndColumn = 40}, srcInfoPoints = []}) &quot;Data.Streaming.Network&quot;"><span class="mpre">Data.Streaming.Network</span></span><span class="mpre"> as N
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/test/ExceptionSpec.hs&quot;, srcSpanStartLine = 18, srcSpanStartColumn = 8, srcSpanEndLine = 18, srcSpanEndColumn = 32}, srcInfoPoints = []}) &quot;Control.Concurrent.Async&quot;"><span class="mpre">Control.Concurrent.Async</span></span><span class="mpre"> (withAsync)
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/test/ExceptionSpec.hs&quot;, srcSpanStartLine = 19, srcSpanStartColumn = 8, srcSpanEndLine = 19, srcSpanEndColumn = 22}, srcInfoPoints = []}) &quot;Network.Socket&quot;"><span class="mpre">Network.Socket</span></span><span class="mpre"> (sClose)

</span><a href="#loc_22_1_22_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_1_22_5&#39;)"><span class="mpre">main</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_22_1_22_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_1_22_5&#39;)"><span class="hl_vardecl"><span class="mpre">main</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">hspec</span></span><span class="mpre"> </span><a href="#loc_49_1_49_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_1_49_5&#39;)"><span class="hl_varref"><span class="mpre">spec</span></span></a><span class="mpre">

</span><a href="#loc_25_1_25_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_1_25_15&#39;)"><span class="mpre">withTestServer</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_25_1_25_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_1_25_15&#39;)"><span class="hl_fundecl"><span class="mpre">withTestServer</span></span></a><span class="mpre"> </span><a name="loc_25_16_25_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_16_25_21&#39;)"><span class="hl_vardecl"><span class="mpre">inner</span></span></a><span class="mpre"> = </span><a href="Control.Exception.Base.html#loc_259_1_259_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Exception.Base.html#loc_259_1_259_8&#39;)"><span class="hl_varref"><span class="mpre">bracket</span></span></a><span class="mpre">
    (</span><span class="hl_varref"><span class="mpre">N.bindRandomPortTCP</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;*4&quot;</span></span><span class="mpre">)
    (</span><span class="hl_varref"><span class="mpre">sClose</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">snd</span></span><span class="mpre">)
    </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \(</span><a name="loc_28_9_28_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_9_28_13&#39;)"><span class="hl_vardecl"><span class="mpre">port</span></span></a><span class="mpre">, </span><a name="loc_28_15_28_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_15_28_22&#39;)"><span class="hl_vardecl"><span class="mpre">lsocket</span></span></a><span class="mpre">) -&gt; do
        </span><span class="hl_varref"><span class="mpre">withAsync</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">runSettingsSocket</span></span><span class="mpre"> </span><a href="Network.Wai.Handler.Warp.Settings.html#loc_65_1_65_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Handler.Warp.Settings.html#loc_65_1_65_16&#39;)"><span class="hl_varref"><span class="mpre">defaultSettings</span></span></a><span class="mpre"> </span><a href="#loc_28_15_28_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_15_28_22&#39;)"><span class="hl_varref"><span class="mpre">lsocket</span></span></a><span class="mpre"> </span><a href="#loc_33_1_33_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_1_33_8&#39;)"><span class="hl_varref"><span class="mpre">testApp</span></span></a><span class="mpre">)
            </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \_ -&gt; </span><a href="#loc_25_16_25_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_16_25_21&#39;)"><span class="hl_varref"><span class="mpre">inner</span></span></a><span class="mpre"> </span><a href="#loc_28_9_28_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_9_28_13&#39;)"><span class="hl_varref"><span class="mpre">port</span></span></a><span class="mpre">

</span><a href="#loc_33_1_33_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_1_33_8&#39;)"><span class="mpre">testApp</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Application</span></span><span class="mpre">
</span><a name="loc_33_1_33_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_1_33_8&#39;)"><span class="hl_fundecl"><span class="mpre">testApp</span></span></a><span class="mpre"> (</span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/test/ExceptionSpec.hs&quot;, srcSpanStartLine = 33, srcSpanStartColumn = 10, srcSpanEndLine = 33, srcSpanEndColumn = 55}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/test/ExceptionSpec.hs&quot;, srcSpanStartLine = 33, srcSpanStartColumn = 39, srcSpanEndLine = 33, srcSpanEndColumn = 40},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/test/ExceptionSpec.hs&quot;, srcSpanStartLine = 33,"><span class="mpre">Network.Wai.Internal.Request {pathInfo = [x]}</span></span><span class="mpre">) </span><a name="loc_33_57_33_58" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_57_33_58&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">x</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;statusError&quot;</span></span><span class="mpre"> =
        </span><a href="#loc_33_57_33_58" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_57_33_58&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.Wai.html#loc_130_1_130_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.html#loc_130_1_130_12&#39;)"><span class="hl_varref"><span class="mpre">responseLBS</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">undefined</span></span><span class="mpre"> [] </span><span class="hl_string"><span class="mpre">&quot;foo&quot;</span></span><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">x</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;headersError&quot;</span></span><span class="mpre"> =
        </span><a href="#loc_33_57_33_58" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_57_33_58&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.Wai.html#loc_130_1_130_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.html#loc_130_1_130_12&#39;)"><span class="hl_varref"><span class="mpre">responseLBS</span></span></a><span class="mpre"> </span><a href="Network.HTTP.Types.Status.html#loc_197_1_197_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Types.Status.html#loc_197_1_197_6&#39;)"><span class="hl_varref"><span class="mpre">ok200</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">undefined</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;foo&quot;</span></span><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">x</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;headerError&quot;</span></span><span class="mpre"> =
        </span><a href="#loc_33_57_33_58" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_57_33_58&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.Wai.html#loc_130_1_130_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.html#loc_130_1_130_12&#39;)"><span class="hl_varref"><span class="mpre">responseLBS</span></span></a><span class="mpre"> </span><a href="Network.HTTP.Types.Status.html#loc_197_1_197_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Types.Status.html#loc_197_1_197_6&#39;)"><span class="hl_varref"><span class="mpre">ok200</span></span></a><span class="mpre"> [</span><span class="hl_varref"><span class="mpre">undefined</span></span><span class="mpre">] </span><span class="hl_string"><span class="mpre">&quot;foo&quot;</span></span><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">x</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;bodyError&quot;</span></span><span class="mpre"> =
        </span><a href="#loc_33_57_33_58" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_57_33_58&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.Wai.html#loc_130_1_130_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.html#loc_130_1_130_12&#39;)"><span class="hl_varref"><span class="mpre">responseLBS</span></span></a><span class="mpre"> </span><a href="Network.HTTP.Types.Status.html#loc_197_1_197_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Types.Status.html#loc_197_1_197_6&#39;)"><span class="hl_varref"><span class="mpre">ok200</span></span></a><span class="mpre"> [] </span><span class="hl_varref"><span class="mpre">undefined</span></span><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">x</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;ioException&quot;</span></span><span class="mpre"> = do
        </span><a href="Control.Monad.html#loc_195_1_195_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_195_1_195_5&#39;)"><span class="hl_varref"><span class="mpre">void</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fail</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;ioException&quot;</span></span><span class="mpre">
        </span><a href="#loc_33_57_33_58" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_57_33_58&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.Wai.html#loc_130_1_130_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.html#loc_130_1_130_12&#39;)"><span class="hl_varref"><span class="mpre">responseLBS</span></span></a><span class="mpre"> </span><a href="Network.HTTP.Types.Status.html#loc_197_1_197_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Types.Status.html#loc_197_1_197_6&#39;)"><span class="hl_varref"><span class="mpre">ok200</span></span></a><span class="mpre"> [] </span><span class="hl_string"><span class="mpre">&quot;foo&quot;</span></span><span class="mpre">
</span><a href="#loc_33_1_33_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_1_33_8&#39;)"><span class="hl_fundecl"><span class="mpre">testApp</span></span></a><span class="mpre"> _ </span><a name="loc_45_11_45_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_11_45_12&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> =
        </span><a href="#loc_45_11_45_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_11_45_12&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.Wai.html#loc_130_1_130_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.html#loc_130_1_130_12&#39;)"><span class="hl_varref"><span class="mpre">responseLBS</span></span></a><span class="mpre"> </span><a href="Network.HTTP.Types.Status.html#loc_197_1_197_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Types.Status.html#loc_197_1_197_6&#39;)"><span class="hl_varref"><span class="mpre">ok200</span></span></a><span class="mpre"> [] </span><span class="hl_string"><span class="mpre">&quot;foo&quot;</span></span><span class="mpre">

</span><a href="#loc_49_1_49_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_1_49_5&#39;)"><span class="mpre">spec</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Spec</span></span><span class="mpre">
</span><a name="loc_49_1_49_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_1_49_5&#39;)"><span class="hl_vardecl"><span class="mpre">spec</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">describe</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;responds even if there is an exception&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
        </span><span class="hl_comment"><span class="mpre">{- Disabling these tests. We can consider forcing evaluation in Warp.
        it &quot;statusError&quot; $ do
            sc &lt;- rspCode &lt;$&gt; sendGET &quot;http://localhost:2345/statusError&quot;
            sc `shouldBe` (5,0,0)
        it &quot;headersError&quot; $ do
            sc &lt;- rspCode &lt;$&gt; sendGET &quot;http://localhost:2345/headersError&quot;
            sc `shouldBe` (5,0,0)
        it &quot;headerError&quot; $ do
            sc &lt;- rspCode &lt;$&gt; sendGET &quot;http://localhost:2345/headerError&quot;
            sc `shouldBe` (5,0,0)
        it &quot;bodyError&quot; $ do
            sc &lt;- rspCode &lt;$&gt; sendGET &quot;http://localhost:2345/bodyError&quot;
            sc `shouldBe` (5,0,0)
        -}</span></span><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">it</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;ioException&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_25_1_25_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_1_25_15&#39;)"><span class="hl_varref"><span class="mpre">withTestServer</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_64_46_64_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_46_64_50&#39;)"><span class="hl_vardecl"><span class="mpre">port</span></span></a><span class="mpre"> -&gt; do
            </span><a name="loc_65_13_65_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_13_65_15&#39;)"><span class="hl_vardecl"><span class="mpre">sc</span></span></a><span class="mpre"> &lt;- </span><a href="Network.HTTP.Base.html#loc_340_16_340_23" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Base.html#loc_340_16_340_23&#39;)"><span class="hl_varref"><span class="mpre">rspCode</span></span></a><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="#loc_71_1_71_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_1_71_8&#39;)"><span class="hl_varref"><span class="mpre">sendGET</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">concat</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> [</span><span class="hl_string"><span class="mpre">&quot;http://localhost:&quot;</span></span><span class="mpre">, </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_64_46_64_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_46_64_50&#39;)"><span class="hl_varref"><span class="mpre">port</span></span></a><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;/ioException&quot;</span></span><span class="mpre">])
            </span><a href="#loc_65_13_65_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_13_65_15&#39;)"><span class="hl_varref"><span class="mpre">sc</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`shouldBe`</span></span><span class="mpre"> (</span><span class="hl_num"><span class="mpre">5</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------</span></span><span class="mpre">

</span><a href="#loc_71_1_71_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_1_71_8&#39;)"><span class="mpre">sendGET</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="Network.HTTP.Base.html#loc_339_6_339_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Base.html#loc_339_6_339_14&#39;)"><span class="hl_tyconref"><span class="mpre">Response</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">)
</span><a name="loc_71_1_71_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_1_71_8&#39;)"><span class="hl_fundecl"><span class="mpre">sendGET</span></span></a><span class="mpre"> </span><a name="loc_71_9_71_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_9_71_12&#39;)"><span class="hl_vardecl"><span class="mpre">url</span></span></a><span class="mpre"> = </span><a href="#loc_74_1_74_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_1_74_10&#39;)"><span class="hl_varref"><span class="mpre">sendGETwH</span></span></a><span class="mpre"> </span><a href="#loc_71_9_71_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_9_71_12&#39;)"><span class="hl_varref"><span class="mpre">url</span></span></a><span class="mpre"> []

</span><a href="#loc_74_1_74_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_1_74_10&#39;)"><span class="mpre">sendGETwH</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; [</span><a href="Network.HTTP.Headers.html#loc_49_6_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Headers.html#loc_49_6_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Header</span></span></a><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="Network.HTTP.Base.html#loc_339_6_339_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Base.html#loc_339_6_339_14&#39;)"><span class="hl_tyconref"><span class="mpre">Response</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">)
</span><a name="loc_74_1_74_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_1_74_10&#39;)"><span class="hl_fundecl"><span class="mpre">sendGETwH</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">url</span></span><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">hdr</span></span><span class="mpre"> = </span><a href="#loc_77_1_77_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_1_77_9&#39;)"><span class="hl_varref"><span class="mpre">unResult</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Network.HTTP.html#loc_106_1_106_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.html#loc_106_1_106_11&#39;)"><span class="hl_varref"><span class="mpre">simpleHTTP</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="warning" data-warning="ExpRecUpdate (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/test/ExceptionSpec.hs&quot;, srcSpanStartLine = 74, srcSpanStartColumn = 45, srcSpanEndLine = 74, srcSpanEndColumn = 81}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/test/ExceptionSpec.hs&quot;, srcSpanStartLine = 74, srcSpanStartColumn = 62, srcSpanEndLine = 74, srcSpanEndColumn = 63},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/warp-3.0.0.3/test/ExceptionSpec.hs&quot;, srcSpanStartLine "><span class="mpre">(getRequest url) { rqHeaders = hdr }</span></span><span class="mpre">

</span><a href="#loc_77_1_77_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_1_77_9&#39;)"><span class="mpre">unResult</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Result</span></span><span class="mpre"> (</span><a href="Network.HTTP.Base.html#loc_339_6_339_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Base.html#loc_339_6_339_14&#39;)"><span class="hl_tyconref"><span class="mpre">Response</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">)) -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="Network.HTTP.Base.html#loc_339_6_339_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.HTTP.Base.html#loc_339_6_339_14&#39;)"><span class="hl_tyconref"><span class="mpre">Response</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">)
</span><a name="loc_77_1_77_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_1_77_9&#39;)"><span class="hl_fundecl"><span class="mpre">unResult</span></span></a><span class="mpre"> </span><a name="loc_77_10_77_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_10_77_16&#39;)"><span class="hl_vardecl"><span class="mpre">action</span></span></a><span class="mpre"> = do
    </span><a name="loc_78_5_78_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_5_78_8&#39;)"><span class="hl_vardecl"><span class="mpre">res</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_77_10_77_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_10_77_16&#39;)"><span class="hl_varref"><span class="mpre">action</span></span></a><span class="mpre">
    case </span><a href="#loc_78_5_78_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_5_78_8&#39;)"><span class="hl_varref"><span class="mpre">res</span></span></a><span class="mpre"> of
        </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><a name="loc_80_15_80_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_15_80_18&#39;)"><span class="hl_vardecl"><span class="mpre">rsp</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_80_15_80_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_15_80_18&#39;)"><span class="hl_varref"><span class="mpre">rsp</span></span></a><span class="mpre">
        </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> _ -&gt; </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Connection error&quot;</span></span><span class="mpre">
</span></div></body></html>