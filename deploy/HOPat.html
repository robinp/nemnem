<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# OPTIONS -fglasgow-exts #-}

module HOPat (tests) where

</span><span class="hl_comment"><span class="mpre">{-

This module is in reply to an email by C. Barry Jay
received on March 15, and handled within hours. CBJ
raises the very interesting issue of higher-order patterns.
It turns out that some form of it is readily covered in
our setting.

-}</span></span><span class="mpre">

import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/HOPat.hs&quot;, srcSpanStartLine = 15, srcSpanStartColumn = 8, srcSpanEndLine = 15, srcSpanEndColumn = 18}, srcInfoPoints = []}) &quot;Test.HUnit&quot;"><span class="mpre">Test.HUnit</span></span><span class="mpre">

import Data.Generics


</span><span class="hl_comment"><span class="mpre">-- Sample datatypes</span></span><span class="mpre">
data </span><a name="loc_21_6_21_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_6_21_8&#39;)"><span class="hl_tycondecl"><span class="mpre">T1</span></span></a><span class="mpre"> = </span><a name="loc_21_11_21_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_11_21_14&#39;)"><span class="hl_condecl"><span class="mpre">T1a</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> | </span><a name="loc_21_21_21_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_21_21_24&#39;)"><span class="hl_condecl"><span class="mpre">T1b</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Float</span></span><span class="mpre">
        </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/HOPat.hs&quot;, srcSpanStartLine = 22, srcSpanStartColumn = 9, srcSpanEndLine = 22, srcSpanEndColumn = 44}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/HOPat.hs&quot;, srcSpanStartLine = 22, srcSpanStartColumn = 9, srcSpanEndLine = 22, srcSpanEndColumn = 17},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/HOPat.hs&quot;, srcSpanStartLine = 22, srcSpanStartColumn = 18, sr"><span class="mpre">deriving (Show, Eq, Typeable, Data)</span></span><span class="mpre">
data </span><a name="loc_23_6_23_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_6_23_8&#39;)"><span class="hl_tycondecl"><span class="mpre">T2</span></span></a><span class="mpre"> = </span><a name="loc_23_11_23_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_11_23_14&#39;)"><span class="hl_condecl"><span class="mpre">T2a</span></span></a><span class="mpre"> </span><a href="#loc_21_6_21_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_6_21_8&#39;)"><span class="hl_tyconref"><span class="mpre">T1</span></span></a><span class="mpre"> </span><a href="#loc_23_6_23_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_6_23_8&#39;)"><span class="hl_tyconref"><span class="mpre">T2</span></span></a><span class="mpre"> | </span><a name="loc_23_23_23_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_23_23_26&#39;)"><span class="hl_condecl"><span class="mpre">T2b</span></span></a><span class="mpre">
        </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/HOPat.hs&quot;, srcSpanStartLine = 24, srcSpanStartColumn = 9, srcSpanEndLine = 24, srcSpanEndColumn = 44}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/HOPat.hs&quot;, srcSpanStartLine = 24, srcSpanStartColumn = 9, srcSpanEndLine = 24, srcSpanEndColumn = 17},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/HOPat.hs&quot;, srcSpanStartLine = 24, srcSpanStartColumn = 18, sr"><span class="mpre">deriving (Show, Eq, Typeable, Data)</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- Eliminate a constructor if feasible</span></span><span class="mpre">
</span><a href="#loc_28_1_28_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_1_28_6&#39;)"><span class="mpre">elim&#39;</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/HOPat.hs&quot;, srcSpanStartLine = 27, srcSpanStartColumn = 10, srcSpanEndLine = 27, srcSpanEndColumn = 29}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/HOPat.hs&quot;, srcSpanStartLine = 27, srcSpanStartColumn = 10, srcSpanEndLine = 27, srcSpanEndColumn = 11},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/HOPat.hs&quot;, srcSpanStartLine = 27, srcSpanStartColumn = 17, s"><span class="mpre">(Data y, Data x) =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Constr</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">y</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">x</span></span><span class="mpre">
</span><a name="loc_28_1_28_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_1_28_6&#39;)"><span class="hl_fundecl"><span class="mpre">elim&#39;</span></span></a><span class="mpre"> </span><a name="loc_28_7_28_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_7_28_8&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> </span><a name="loc_28_9_28_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_9_28_10&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> = if </span><span class="hl_varref"><span class="mpre">toConstr</span></span><span class="mpre"> </span><a href="#loc_28_9_28_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_9_28_10&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_28_7_28_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_7_28_8&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">
                then </span><a href="#loc_35_1_35_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_1_35_7&#39;)"><span class="hl_varref"><span class="mpre">unwrap</span></span></a><span class="mpre"> </span><a href="#loc_28_9_28_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_9_28_10&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">
                else </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- Unwrap a term; Return its single component</span></span><span class="mpre">
</span><a href="#loc_35_1_35_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_1_35_7&#39;)"><span class="mpre">unwrap</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/HOPat.hs&quot;, srcSpanStartLine = 34, srcSpanStartColumn = 11, srcSpanEndLine = 34, srcSpanEndColumn = 30}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/HOPat.hs&quot;, srcSpanStartLine = 34, srcSpanStartColumn = 11, srcSpanEndLine = 34, srcSpanEndColumn = 12},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/HOPat.hs&quot;, srcSpanStartLine = 34, srcSpanStartColumn = 18, s"><span class="mpre">(Data y, Data x) =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">y</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">x</span></span><span class="mpre"> 
</span><a name="loc_35_1_35_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_1_35_7&#39;)"><span class="hl_fundecl"><span class="mpre">unwrap</span></span></a><span class="mpre"> </span><a name="loc_35_8_35_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_8_35_9&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> = case </span><span class="hl_varref"><span class="mpre">gmapQ</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> </span><a href="Data.Generics.Aliases.html#loc_100_4_100_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Generics.Aliases.html#loc_100_4_100_9&#39;)"><span class="hl_infix"><span class="mpre">`mkQ`</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre">) </span><a href="#loc_35_8_35_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_8_35_9&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> of
             [</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_36_20_36_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_20_36_21&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">] -&gt; </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="#loc_36_20_36_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_20_36_21&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
             _ -&gt; </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- Eliminate a constructor if feasible; 2nd try</span></span><span class="mpre">
</span><a href="#loc_42_1_42_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_1_42_5&#39;)"><span class="mpre">elim</span></a><span class="mpre"> :: forall </span><span class="hl_tyvar"><span class="mpre">x</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">y</span></span><span class="mpre">. </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/HOPat.hs&quot;, srcSpanStartLine = 41, srcSpanStartColumn = 21, srcSpanEndLine = 41, srcSpanEndColumn = 40}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/HOPat.hs&quot;, srcSpanStartLine = 41, srcSpanStartColumn = 21, srcSpanEndLine = 41, srcSpanEndColumn = 22},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/HOPat.hs&quot;, srcSpanStartLine = 41, srcSpanStartColumn = 28, s"><span class="mpre">(Data y, Data x) =&gt;</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">x</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">y</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">y</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">x</span></span><span class="mpre">
</span><a name="loc_42_1_42_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_1_42_5&#39;)"><span class="hl_fundecl"><span class="mpre">elim</span></span></a><span class="mpre"> </span><a name="loc_42_6_42_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_6_42_7&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> </span><a name="loc_42_8_42_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_8_42_9&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> = </span><a href="#loc_28_1_28_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_1_28_6&#39;)"><span class="hl_varref"><span class="mpre">elim&#39;</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">toConstr</span></span><span class="mpre"> (</span><a href="#loc_42_6_42_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_6_42_7&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">undefined</span></span><span class="mpre">::</span><span class="hl_tyvar"><span class="mpre">x</span></span><span class="mpre">))) </span><a href="#loc_42_8_42_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_8_42_9&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- Visit a data structure</span></span><span class="mpre">
</span><a href="#loc_48_1_48_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_8&#39;)"><span class="mpre">visitor</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/HOPat.hs&quot;, srcSpanStartLine = 46, srcSpanStartColumn = 12, srcSpanEndLine = 47, srcSpanEndColumn = 11}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/HOPat.hs&quot;, srcSpanStartLine = 46, srcSpanStartColumn = 12, srcSpanEndLine = 46, srcSpanEndColumn = 13},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/syb-0.4.2/tests/HOPat.hs&quot;, srcSpanStartLine = 46, srcSpanStartColumn = 19, s"><span class="mpre">(Data x, Data y, Data z)
        =&gt;</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">x</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">y</span></span><span class="mpre">) -&gt; (</span><span class="hl_tyvar"><span class="mpre">x</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">x</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">z</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">z</span></span><span class="mpre">
</span><a name="loc_48_1_48_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_8&#39;)"><span class="hl_fundecl"><span class="mpre">visitor</span></span></a><span class="mpre"> </span><a name="loc_48_9_48_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_9_48_10&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> </span><a name="loc_48_11_48_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_11_48_12&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><a href="Data.Generics.Schemes.html#loc_59_1_59_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Generics.Schemes.html#loc_59_1_59_11&#39;)"><span class="hl_varref"><span class="mpre">everywhere</span></span></a><span class="mpre"> (</span><a href="Data.Generics.Aliases.html#loc_86_1_86_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Generics.Aliases.html#loc_86_1_86_4&#39;)"><span class="hl_varref"><span class="mpre">mkT</span></span></a><span class="mpre"> </span><a href="#loc_50_5_50_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_5_50_6&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">)
  where
    </span><a name="loc_50_5_50_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_5_50_6&#39;)"><span class="hl_fundecl"><span class="mpre">g</span></span></a><span class="mpre"> </span><a name="loc_50_7_50_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_7_50_8&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> = case </span><a href="#loc_42_1_42_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_1_42_5&#39;)"><span class="hl_varref"><span class="mpre">elim</span></span></a><span class="mpre"> </span><a href="#loc_48_9_48_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_9_48_10&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><a href="#loc_50_7_50_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_7_50_8&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre"> of
            </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_51_18_51_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_18_51_19&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">  -&gt; </span><a href="#loc_48_9_48_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_9_48_10&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> (</span><a href="#loc_48_11_48_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_11_48_12&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_51_18_51_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_18_51_19&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">) 
            </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt; </span><a href="#loc_50_7_50_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_7_50_8&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- Main function for testing</span></span><span class="mpre">
</span><a name="loc_56_1_56_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_1_56_6&#39;)"><span class="hl_vardecl"><span class="mpre">tests</span></span></a><span class="mpre"> = ( (  </span><a href="#loc_28_1_28_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_1_28_6&#39;)"><span class="hl_varref"><span class="mpre">elim&#39;</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">toConstr</span></span><span class="mpre"> </span><a href="#loc_63_4_63_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_4_63_7&#39;)"><span class="hl_varref"><span class="mpre">t1a</span></span></a><span class="mpre">) </span><a href="#loc_63_4_63_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_4_63_7&#39;)"><span class="hl_varref"><span class="mpre">t1a</span></span></a><span class="mpre">) :: </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
        , ( (</span><a href="#loc_28_1_28_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_1_28_6&#39;)"><span class="hl_varref"><span class="mpre">elim&#39;</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">toConstr</span></span><span class="mpre"> </span><a href="#loc_63_4_63_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_4_63_7&#39;)"><span class="hl_varref"><span class="mpre">t1a</span></span></a><span class="mpre">) </span><a href="#loc_64_4_64_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_4_64_7&#39;)"><span class="hl_varref"><span class="mpre">t1b</span></span></a><span class="mpre">) :: </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
        , ( (</span><a href="#loc_42_1_42_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_1_42_5&#39;)"><span class="hl_varref"><span class="mpre">elim</span></span></a><span class="mpre">  </span><a href="#loc_21_11_21_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_11_21_14&#39;)"><span class="hl_conref"><span class="mpre">T1a</span></span></a><span class="mpre"> </span><a href="#loc_63_4_63_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_4_63_7&#39;)"><span class="hl_varref"><span class="mpre">t1a</span></span></a><span class="mpre">)            :: </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
        , ( (</span><a href="#loc_42_1_42_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_1_42_5&#39;)"><span class="hl_varref"><span class="mpre">elim</span></span></a><span class="mpre">  </span><a href="#loc_21_11_21_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_11_21_14&#39;)"><span class="hl_conref"><span class="mpre">T1a</span></span></a><span class="mpre"> </span><a href="#loc_64_4_64_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_4_64_7&#39;)"><span class="hl_varref"><span class="mpre">t1b</span></span></a><span class="mpre">)            :: </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
        , ( (</span><a href="#loc_48_1_48_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_8&#39;)"><span class="hl_varref"><span class="mpre">visitor</span></span></a><span class="mpre"> </span><a href="#loc_21_11_21_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_11_21_14&#39;)"><span class="hl_conref"><span class="mpre">T1a</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">(+)</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">46</span></span><span class="mpre">) </span><a href="#loc_65_4_65_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_4_65_6&#39;)"><span class="hl_varref"><span class="mpre">t2</span></span></a><span class="mpre">)  :: </span><a href="#loc_23_6_23_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_6_23_8&#39;)"><span class="hl_tyconref"><span class="mpre">T2</span></span></a><span class="mpre">
        ))))) </span><span class="hl_infix"><span class="mpre">~=?</span></span><span class="mpre"> </span><a href="#loc_67_1_67_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_1_67_7&#39;)"><span class="hl_varref"><span class="mpre">output</span></span></a><span class="mpre">
 where
   </span><a name="loc_63_4_63_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_4_63_7&#39;)"><span class="hl_vardecl"><span class="mpre">t1a</span></span></a><span class="mpre"> = </span><a href="#loc_21_11_21_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_11_21_14&#39;)"><span class="hl_conref"><span class="mpre">T1a</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">42</span></span><span class="mpre">
   </span><a name="loc_64_4_64_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_4_64_7&#39;)"><span class="hl_vardecl"><span class="mpre">t1b</span></span></a><span class="mpre"> = </span><a href="#loc_21_21_21_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_21_21_24&#39;)"><span class="hl_conref"><span class="mpre">T1b</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">3.14</span></span><span class="mpre">
   </span><a name="loc_65_4_65_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_4_65_6&#39;)"><span class="hl_vardecl"><span class="mpre">t2</span></span></a><span class="mpre">  = </span><a href="#loc_23_11_23_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_11_23_14&#39;)"><span class="hl_conref"><span class="mpre">T2a</span></span></a><span class="mpre"> </span><a href="#loc_63_4_63_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_4_63_7&#39;)"><span class="hl_varref"><span class="mpre">t1a</span></span></a><span class="mpre"> (</span><a href="#loc_23_11_23_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_11_23_14&#39;)"><span class="hl_conref"><span class="mpre">T2a</span></span></a><span class="mpre"> </span><a href="#loc_63_4_63_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_4_63_7&#39;)"><span class="hl_varref"><span class="mpre">t1a</span></span></a><span class="mpre"> </span><a href="#loc_23_23_23_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_23_23_26&#39;)"><span class="hl_conref"><span class="mpre">T2b</span></span></a><span class="mpre">)

</span><a name="loc_67_1_67_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_1_67_7&#39;)"><span class="hl_vardecl"><span class="mpre">output</span></span></a><span class="mpre"> = (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">42</span></span><span class="mpre">,(</span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">,(</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">42</span></span><span class="mpre">,(</span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">,</span><a href="#loc_23_11_23_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_11_23_14&#39;)"><span class="hl_conref"><span class="mpre">T2a</span></span></a><span class="mpre"> (</span><a href="#loc_21_11_21_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_11_21_14&#39;)"><span class="hl_conref"><span class="mpre">T1a</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">88</span></span><span class="mpre">) (</span><a href="#loc_23_11_23_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_11_23_14&#39;)"><span class="hl_conref"><span class="mpre">T2a</span></span></a><span class="mpre"> (</span><a href="#loc_21_11_21_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_11_21_14&#39;)"><span class="hl_conref"><span class="mpre">T1a</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">88</span></span><span class="mpre">) </span><a href="#loc_23_23_23_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_23_23_26&#39;)"><span class="hl_conref"><span class="mpre">T2b</span></span></a><span class="mpre">)))))</span></div></body></html>