<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-- (c) 1999 - 2002 by Martin Erwig [see file COPYRIGHT]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Basic Graph Algorithms</span></span><span class="mpre">
module Data.Graph.Inductive.Basic
(
    </span><span class="hl_comment"><span class="mpre">-- * Graph Operations</span></span><span class="mpre">
    grev,
    undir,unlab,
    gsel, gfold,
    </span><span class="hl_comment"><span class="mpre">-- * Filter Operations</span></span><span class="mpre">
    efilter,elfilter,
    </span><span class="hl_comment"><span class="mpre">-- * Predicates and Classifications</span></span><span class="mpre">
    hasLoop,isSimple,
    </span><span class="hl_comment"><span class="mpre">-- * Tree Operations</span></span><span class="mpre">
    postorder, postorderF, preorder, preorderF
) 
where


import Data.Graph.Inductive.Graph
import Data.Graph.Inductive.Internal.Thread (</span><a href="Data.Graph.Inductive.Internal.Thread.html#loc_120_1_120_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Internal.Thread.html#loc_120_1_120_12&#39;)"><span class="mpre">threadMaybe</span></a><span class="mpre">,</span><a href="Data.Graph.Inductive.Internal.Thread.html#loc_92_1_92_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Internal.Thread.html#loc_92_1_92_11&#39;)"><span class="mpre">threadList</span></a><span class="mpre">)

import Data.List (</span><a href="Data.List.html#loc_314_1_314_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_314_1_314_4&#39;)"><span class="mpre">nub</span></a><span class="mpre">)
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Basic.hs&quot;, srcSpanStartLine = 23, srcSpanStartColumn = 8, srcSpanEndLine = 23, srcSpanEndColumn = 17}, srcInfoPoints = []}) &quot;Data.Tree&quot;"><span class="mpre">Data.Tree</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Reverse the direction of all edges.</span></span><span class="mpre">
</span><a href="#loc_27_1_27_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_1_27_5&#39;)"><span class="mpre">grev</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Basic.hs&quot;, srcSpanStartLine = 26, srcSpanStartColumn = 9, srcSpanEndLine = 26, srcSpanEndColumn = 23}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Basic.hs&quot;, srcSpanStartLine = 26, srcSpanStartColumn = 21, srcSpanEndLine = 26, srcSpanEndColumn = 23}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl"><span class="mpre">DynGraph gr =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> 
</span><a name="loc_27_1_27_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_1_27_5&#39;)"><span class="hl_vardecl"><span class="mpre">grev</span></span></a><span class="mpre"> = </span><a href="Data.Graph.Inductive.Graph.html#loc_219_1_219_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Graph.html#loc_219_1_219_5&#39;)"><span class="hl_varref"><span class="mpre">gmap</span></span></a><span class="mpre"> (\(</span><a name="loc_27_16_27_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_16_27_17&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">,</span><a name="loc_27_18_27_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_18_27_19&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">,</span><a name="loc_27_20_27_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_20_27_21&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre">,</span><a name="loc_27_22_27_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_22_27_23&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">)-&gt;(</span><a href="#loc_27_22_27_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_22_27_23&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">,</span><a href="#loc_27_18_27_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_18_27_19&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">,</span><a href="#loc_27_20_27_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_20_27_21&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">,</span><a href="#loc_27_16_27_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_16_27_17&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">))

</span><span class="hl_comment"><span class="mpre">-- | Make the graph undirected, i.e. for every edge from A to B, there</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- exists an edge from B to A.</span></span><span class="mpre">
</span><a href="#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_1_32_6&#39;)"><span class="mpre">undir</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Basic.hs&quot;, srcSpanStartLine = 31, srcSpanStartColumn = 10, srcSpanEndLine = 31, srcSpanEndColumn = 31}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Basic.hs&quot;, srcSpanStartLine = 31, srcSpanStartColumn = 10, srcSpanEndLine = 31, srcSpanEndColumn = 11},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Basic.hs&quot;"><span class="mpre">(Eq b,DynGraph gr) =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">
</span><a name="loc_32_1_32_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_1_32_6&#39;)"><span class="hl_vardecl"><span class="mpre">undir</span></span></a><span class="mpre"> = </span><a href="Data.Graph.Inductive.Graph.html#loc_219_1_219_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Graph.html#loc_219_1_219_5&#39;)"><span class="hl_varref"><span class="mpre">gmap</span></span></a><span class="mpre"> (\(</span><a name="loc_32_17_32_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_17_32_18&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">,</span><a name="loc_32_19_32_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_19_32_20&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">,</span><a name="loc_32_21_32_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_21_32_22&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre">,</span><a name="loc_32_23_32_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_23_32_24&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">)-&gt;let </span><a name="loc_32_31_32_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_31_32_33&#39;)"><span class="hl_vardecl"><span class="mpre">ps</span></span></a><span class="mpre"> = </span><a href="Data.List.html#loc_314_1_314_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_314_1_314_4&#39;)"><span class="hl_varref"><span class="mpre">nub</span></span></a><span class="mpre"> (</span><a href="#loc_32_17_32_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_17_32_18&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="hl_infix"><span class="mpre">++</span></span><a href="#loc_32_23_32_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_23_32_24&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">) in (</span><a href="#loc_32_31_32_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_31_32_33&#39;)"><span class="hl_varref"><span class="mpre">ps</span></span></a><span class="mpre">,</span><a href="#loc_32_19_32_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_19_32_20&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">,</span><a href="#loc_32_21_32_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_21_32_22&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">,</span><a href="#loc_32_31_32_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_31_32_33&#39;)"><span class="hl_varref"><span class="mpre">ps</span></span></a><span class="mpre">))
</span><span class="hl_comment"><span class="mpre">-- this version of undir considers edge lables and keeps edges with</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- different labels, an alternative is the definition below:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   undir = gmap (\(p,v,l,s)-&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--           let ps = nubBy (\x y-&gt;snd x==snd y) (p++s) in (ps,v,l,ps))</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Remove all labels.</span></span><span class="mpre">
</span><a href="#loc_40_1_40_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_1_40_6&#39;)"><span class="mpre">unlab</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Basic.hs&quot;, srcSpanStartLine = 39, srcSpanStartColumn = 10, srcSpanEndLine = 39, srcSpanEndColumn = 24}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Basic.hs&quot;, srcSpanStartLine = 39, srcSpanStartColumn = 22, srcSpanEndLine = 39, srcSpanEndColumn = 24}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fg"><span class="mpre">DynGraph gr =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_40_1_40_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_1_40_6&#39;)"><span class="hl_vardecl"><span class="mpre">unlab</span></span></a><span class="mpre"> = </span><a href="Data.Graph.Inductive.Graph.html#loc_219_1_219_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Graph.html#loc_219_1_219_5&#39;)"><span class="hl_varref"><span class="mpre">gmap</span></span></a><span class="mpre"> (\(</span><a name="loc_40_17_40_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_17_40_18&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">,</span><a name="loc_40_19_40_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_19_40_20&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">,_,</span><a name="loc_40_23_40_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_23_40_24&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">)-&gt;(</span><a href="#loc_41_15_41_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_15_41_23&#39;)"><span class="hl_varref"><span class="mpre">unlabAdj</span></span></a><span class="mpre"> </span><a href="#loc_40_17_40_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_17_40_18&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">,</span><a href="#loc_40_19_40_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_19_40_20&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">,</span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">,</span><a href="#loc_41_15_41_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_15_41_23&#39;)"><span class="hl_varref"><span class="mpre">unlabAdj</span></span></a><span class="mpre"> </span><a href="#loc_40_23_40_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_23_40_24&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">))
        where </span><a name="loc_41_15_41_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_15_41_23&#39;)"><span class="hl_vardecl"><span class="mpre">unlabAdj</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (\(_,</span><a name="loc_41_35_41_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_35_41_36&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">)-&gt;(</span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">,</span><a href="#loc_41_35_41_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_35_41_36&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">))
</span><span class="hl_comment"><span class="mpre">-- alternative:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--    unlab = nmap (\_-&gt;()) . emap (\_-&gt;())</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Return all &#39;Context&#39;s for which the given function returns &#39;True&#39;.</span></span><span class="mpre">
</span><a href="#loc_47_1_47_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_1_47_5&#39;)"><span class="mpre">gsel</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Basic.hs&quot;, srcSpanStartLine = 46, srcSpanStartColumn = 9, srcSpanEndLine = 46, srcSpanEndColumn = 20}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Basic.hs&quot;, srcSpanStartLine = 46, srcSpanStartColumn = 18, srcSpanEndLine = 46, srcSpanEndColumn = 20}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl"><span class="mpre">Graph gr =&gt;</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Context</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Context</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">]
</span><a name="loc_47_1_47_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_1_47_5&#39;)"><span class="hl_fundecl"><span class="mpre">gsel</span></span></a><span class="mpre"> </span><a name="loc_47_6_47_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_6_47_7&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> = </span><a href="Data.Graph.Inductive.Graph.html#loc_213_1_213_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Graph.html#loc_213_1_213_6&#39;)"><span class="hl_varref"><span class="mpre">ufold</span></span></a><span class="mpre"> (\</span><a name="loc_47_18_47_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_18_47_19&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> </span><a name="loc_47_20_47_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_20_47_22&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre">-&gt;if </span><a href="#loc_47_6_47_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_6_47_7&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_47_18_47_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_18_47_19&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> then </span><a href="#loc_47_18_47_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_18_47_19&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_47_20_47_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_20_47_22&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre"> else </span><a href="#loc_47_20_47_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_20_47_22&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">) []


</span><span class="hl_comment"><span class="mpre">-- filter operations</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- efilter  : filter based on edge property</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- elfilter : filter based on edge label property</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Filter based on edge property.</span></span><span class="mpre">
</span><a href="#loc_58_1_58_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_1_58_8&#39;)"><span class="mpre">efilter</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Basic.hs&quot;, srcSpanStartLine = 57, srcSpanStartColumn = 12, srcSpanEndLine = 57, srcSpanEndColumn = 26}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Basic.hs&quot;, srcSpanStartLine = 57, srcSpanStartColumn = 24, srcSpanEndLine = 57, srcSpanEndColumn = 26}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fg"><span class="mpre">DynGraph gr =&gt;</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">LEdge</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">
</span><a name="loc_58_1_58_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_1_58_8&#39;)"><span class="hl_fundecl"><span class="mpre">efilter</span></span></a><span class="mpre"> </span><a name="loc_58_9_58_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_9_58_10&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><a href="Data.Graph.Inductive.Graph.html#loc_213_1_213_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Graph.html#loc_213_1_213_6&#39;)"><span class="hl_varref"><span class="mpre">ufold</span></span></a><span class="mpre"> </span><a href="#loc_59_19_59_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_19_59_26&#39;)"><span class="hl_varref"><span class="mpre">cfilter</span></span></a><span class="mpre"> </span><a href="Data.Graph.Inductive.Graph.html#loc_177_3_177_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Graph.html#loc_177_3_177_8&#39;)"><span class="hl_varref"><span class="mpre">empty</span></span></a><span class="mpre">
            where </span><a name="loc_59_19_59_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_19_59_26&#39;)"><span class="hl_fundecl"><span class="mpre">cfilter</span></span></a><span class="mpre"> (</span><a name="loc_59_28_59_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_28_59_29&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">,</span><a name="loc_59_30_59_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_30_59_31&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">,</span><a name="loc_59_32_59_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_32_59_33&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre">,</span><a name="loc_59_34_59_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_34_59_35&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">) </span><a name="loc_59_37_59_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_37_59_38&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> = (</span><a href="#loc_60_26_60_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_26_60_28&#39;)"><span class="hl_varref"><span class="mpre">p&#39;</span></span></a><span class="mpre">,</span><a href="#loc_59_30_59_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_30_59_31&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">,</span><a href="#loc_59_32_59_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_32_59_33&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">,</span><a href="#loc_61_26_61_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_26_61_28&#39;)"><span class="hl_varref"><span class="mpre">s&#39;</span></span></a><span class="mpre">) </span><a href="Data.Graph.Inductive.Graph.html#loc_208_3_208_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Graph.html#loc_208_3_208_6&#39;)"><span class="hl_infix"><span class="mpre">&amp;</span></span></a><span class="mpre"> </span><a href="#loc_59_37_59_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_37_59_38&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">
                   where </span><a name="loc_60_26_60_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_26_60_28&#39;)"><span class="hl_vardecl"><span class="mpre">p&#39;</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">filter</span></span><span class="mpre"> (\(</span><a name="loc_60_41_60_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_41_60_42&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">,</span><a name="loc_60_43_60_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_43_60_44&#39;)"><span class="hl_vardecl"><span class="mpre">u</span></span></a><span class="mpre">)-&gt;</span><a href="#loc_58_9_58_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_9_58_10&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_60_43_60_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_43_60_44&#39;)"><span class="hl_varref"><span class="mpre">u</span></span></a><span class="mpre">,</span><a href="#loc_59_30_59_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_30_59_31&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">,</span><a href="#loc_60_41_60_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_41_60_42&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">)) </span><a href="#loc_59_28_59_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_28_59_29&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">
                         </span><a name="loc_61_26_61_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_26_61_28&#39;)"><span class="hl_vardecl"><span class="mpre">s&#39;</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">filter</span></span><span class="mpre"> (\(</span><a name="loc_61_41_61_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_41_61_42&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">,</span><a name="loc_61_43_61_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_43_61_44&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre">)-&gt;</span><a href="#loc_58_9_58_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_9_58_10&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_59_30_59_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_30_59_31&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">,</span><a href="#loc_61_43_61_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_43_61_44&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">,</span><a href="#loc_61_41_61_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_41_61_42&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">)) </span><a href="#loc_59_34_59_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_34_59_35&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Filter based on edge label property.</span></span><span class="mpre">
</span><a href="#loc_65_1_65_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_1_65_9&#39;)"><span class="mpre">elfilter</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Basic.hs&quot;, srcSpanStartLine = 64, srcSpanStartColumn = 13, srcSpanEndLine = 64, srcSpanEndColumn = 27}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Basic.hs&quot;, srcSpanStartLine = 64, srcSpanStartColumn = 25, srcSpanEndLine = 64, srcSpanEndColumn = 27}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fg"><span class="mpre">DynGraph gr =&gt;</span></span><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">
</span><a name="loc_65_1_65_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_1_65_9&#39;)"><span class="hl_fundecl"><span class="mpre">elfilter</span></span></a><span class="mpre"> </span><a name="loc_65_10_65_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_10_65_11&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><a href="#loc_58_1_58_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_1_58_8&#39;)"><span class="hl_varref"><span class="mpre">efilter</span></span></a><span class="mpre"> (\(_,_,</span><a name="loc_65_29_65_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_29_65_30&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">)-&gt;</span><a href="#loc_65_10_65_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_10_65_11&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_65_29_65_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_29_65_30&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">)


</span><span class="hl_comment"><span class="mpre">-- some predicates and classifications</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | &#39;True&#39; if the graph has any edges of the form (A, A).</span></span><span class="mpre">
</span><a href="#loc_73_1_73_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_1_73_8&#39;)"><span class="mpre">hasLoop</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Basic.hs&quot;, srcSpanStartLine = 72, srcSpanStartColumn = 12, srcSpanEndLine = 72, srcSpanEndColumn = 23}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Basic.hs&quot;, srcSpanStartLine = 72, srcSpanStartColumn = 21, srcSpanEndLine = 72, srcSpanEndColumn = 23}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fg"><span class="mpre">Graph gr =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_73_1_73_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_1_73_8&#39;)"><span class="hl_vardecl"><span class="mpre">hasLoop</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">null</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> (</span><a href="#loc_47_1_47_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_1_47_5&#39;)"><span class="hl_varref"><span class="mpre">gsel</span></span></a><span class="mpre"> (\</span><a name="loc_73_32_73_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_32_73_33&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">-&gt;(</span><a href="Data.Graph.Inductive.Graph.html#loc_355_1_355_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Graph.html#loc_355_1_355_6&#39;)"><span class="hl_varref"><span class="mpre">node&#39;</span></span></a><span class="mpre"> </span><a href="#loc_73_32_73_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_32_73_33&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`elem`</span></span><span class="mpre"> </span><a href="Data.Graph.Inductive.Graph.html#loc_371_1_371_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Graph.html#loc_371_1_371_5&#39;)"><span class="hl_varref"><span class="mpre">suc&#39;</span></span></a><span class="mpre"> </span><a href="#loc_73_32_73_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_32_73_33&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">)))

</span><span class="hl_comment"><span class="mpre">-- | The inverse of &#39;hasLoop&#39;.</span></span><span class="mpre">
</span><a href="#loc_77_1_77_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_1_77_9&#39;)"><span class="mpre">isSimple</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Basic.hs&quot;, srcSpanStartLine = 76, srcSpanStartColumn = 13, srcSpanEndLine = 76, srcSpanEndColumn = 24}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Basic.hs&quot;, srcSpanStartLine = 76, srcSpanStartColumn = 22, srcSpanEndLine = 76, srcSpanEndColumn = 24}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fg"><span class="mpre">Graph gr =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_77_1_77_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_1_77_9&#39;)"><span class="hl_vardecl"><span class="mpre">isSimple</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_73_1_73_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_1_73_8&#39;)"><span class="hl_varref"><span class="mpre">hasLoop</span></span></a><span class="mpre">


</span><a name="loc_80_1_80_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_1_80_12&#39;)"><span class="hl_fundecl"><span class="mpre">threadGraph</span></span></a><span class="mpre"> </span><a name="loc_80_13_80_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_13_80_14&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_80_15_80_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_15_80_16&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> = </span><a href="Data.Graph.Inductive.Internal.Thread.html#loc_120_1_120_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Internal.Thread.html#loc_120_1_120_12&#39;)"><span class="hl_varref"><span class="mpre">threadMaybe</span></span></a><span class="mpre"> </span><a href="#loc_80_13_80_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_13_80_14&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_80_15_80_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_15_80_16&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><a href="Data.Graph.Inductive.Graph.html#loc_182_3_182_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Graph.html#loc_182_3_182_8&#39;)"><span class="hl_varref"><span class="mpre">match</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- gfold1 f d b u = threadGraph (\c-&gt;d (labNode&#39; c)) (\c-&gt;gfoldn f d b u (f c))</span></span><span class="mpre">
</span><a name="loc_83_1_83_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_1_83_7&#39;)"><span class="hl_fundecl"><span class="mpre">gfold1</span></span></a><span class="mpre"> </span><a name="loc_83_8_83_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_8_83_9&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_83_10_83_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_10_83_11&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre"> </span><a name="loc_83_12_83_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_12_83_13&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> = </span><a href="#loc_80_1_80_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_1_80_12&#39;)"><span class="hl_varref"><span class="mpre">threadGraph</span></span></a><span class="mpre"> </span><a href="#loc_83_10_83_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_10_83_11&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> (\</span><a name="loc_83_32_83_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_32_83_33&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">-&gt;</span><a href="#loc_84_1_84_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_1_84_7&#39;)"><span class="hl_varref"><span class="mpre">gfoldn</span></span></a><span class="mpre"> </span><a href="#loc_83_8_83_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_8_83_9&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_83_10_83_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_10_83_11&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><a href="#loc_83_12_83_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_12_83_13&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> (</span><a href="#loc_83_8_83_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_8_83_9&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_83_32_83_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_32_83_33&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">))
</span><a name="loc_84_1_84_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_1_84_7&#39;)"><span class="hl_fundecl"><span class="mpre">gfoldn</span></span></a><span class="mpre"> </span><a name="loc_84_8_84_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_8_84_9&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_84_10_84_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_10_84_11&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre"> </span><a name="loc_84_12_84_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_12_84_13&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> = </span><a href="Data.Graph.Inductive.Internal.Thread.html#loc_92_1_92_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Internal.Thread.html#loc_92_1_92_11&#39;)"><span class="hl_varref"><span class="mpre">threadList</span></span></a><span class="mpre"> </span><a href="#loc_84_12_84_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_12_84_13&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> (</span><a href="#loc_83_1_83_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_1_83_7&#39;)"><span class="hl_varref"><span class="mpre">gfold1</span></span></a><span class="mpre"> </span><a href="#loc_84_8_84_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_8_84_9&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_84_10_84_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_10_84_11&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><a href="#loc_84_12_84_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_12_84_13&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- gfold :: ((Context a b) -&gt; [Node]) -&gt; ((Node,a) -&gt; c -&gt; d) -&gt; </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--          (Maybe d -&gt; c -&gt; c) -&gt; c -&gt; [Node] -&gt; Graph a b -&gt; c</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- gfold f d b u l g = fst (gfoldn f d b u l g)</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- type Dir a b    = (Context a b) -&gt; [Node]  -- direction of fold</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- type Dagg a b c = (Node,a) -&gt; b -&gt; c       -- depth aggregation</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- type Bagg a b   = (Maybe a -&gt; b -&gt; b,b)    -- breadth/level aggregation</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- gfold :: (Dir a b) -&gt; (Dagg a c d) -&gt; (Bagg d c) -&gt; [Node] -&gt; Graph a b -&gt; c</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- gfold f d (b,u) l g = fst (gfoldn f d b u l g)</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Directed graph fold.</span></span><span class="mpre">
</span><a href="#loc_104_1_104_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_1_104_6&#39;)"><span class="mpre">gfold</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Basic.hs&quot;, srcSpanStartLine = 98, srcSpanStartColumn = 10, srcSpanEndLine = 98, srcSpanEndColumn = 21}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Basic.hs&quot;, srcSpanStartLine = 98, srcSpanStartColumn = 19, srcSpanEndLine = 98, srcSpanEndColumn = 21}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fg"><span class="mpre">Graph gr =&gt;</span></span><span class="mpre">   ((</span><span class="hl_tyconref"><span class="mpre">Context</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; [</span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre">])    </span><span class="hl_comment"><span class="mpre">-- ^ direction of fold</span></span><span class="mpre">
                    -&gt; ((</span><span class="hl_tyconref"><span class="mpre">Context</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">c</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">d</span></span><span class="mpre">)    </span><span class="hl_comment"><span class="mpre">-- ^ depth aggregation</span></span><span class="mpre">
                    -&gt; (</span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">d</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">c</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">c</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">c</span></span><span class="mpre">)            </span><span class="hl_comment"><span class="mpre">-- ^ breadth\/level aggregation</span></span><span class="mpre">
                    -&gt; [</span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre">]
                    -&gt; </span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">
                    -&gt; </span><span class="hl_tyvar"><span class="mpre">c</span></span><span class="mpre">
</span><a name="loc_104_1_104_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_1_104_6&#39;)"><span class="hl_fundecl"><span class="mpre">gfold</span></span></a><span class="mpre"> </span><a name="loc_104_7_104_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_7_104_8&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_104_9_104_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_9_104_10&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre"> </span><a name="loc_104_11_104_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_11_104_12&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> </span><a name="loc_104_13_104_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_13_104_14&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> </span><a name="loc_104_15_104_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_15_104_16&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fst</span></span><span class="mpre"> (</span><a href="#loc_84_1_84_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_1_84_7&#39;)"><span class="hl_varref"><span class="mpre">gfoldn</span></span></a><span class="mpre"> </span><a href="#loc_104_7_104_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_7_104_8&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_104_9_104_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_9_104_10&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><a href="#loc_104_11_104_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_11_104_12&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> </span><a href="#loc_104_13_104_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_13_104_14&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><a href="#loc_104_15_104_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_15_104_16&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- not finished yet ...</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- undirBy :: (b -&gt; b -&gt; b) -&gt; Graph a b -&gt; Graph a b</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- undirBy = gmap (\(p,v,l,s)-&gt;let ps = nub (p++s) in (ps,v,l,ps))</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Flatten a &#39;Tree&#39;, returning the elements in post-order.</span></span><span class="mpre">
</span><a href="#loc_113_1_113_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_1_113_10&#39;)"><span class="mpre">postorder</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Tree</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">]
</span><a name="loc_113_1_113_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_1_113_10&#39;)"><span class="hl_fundecl"><span class="mpre">postorder</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Node</span></span><span class="mpre"> </span><a name="loc_113_17_113_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_17_113_18&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> </span><a name="loc_113_19_113_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_19_113_21&#39;)"><span class="hl_vardecl"><span class="mpre">ts</span></span></a><span class="mpre">) = </span><a href="#loc_117_1_117_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_1_117_11&#39;)"><span class="hl_varref"><span class="mpre">postorderF</span></span></a><span class="mpre"> </span><a href="#loc_113_19_113_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_19_113_21&#39;)"><span class="hl_varref"><span class="mpre">ts</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> [</span><a href="#loc_113_17_113_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_17_113_18&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">]

</span><span class="hl_comment"><span class="mpre">-- | Flatten multiple &#39;Tree&#39;s in post-order.</span></span><span class="mpre">
</span><a href="#loc_117_1_117_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_1_117_11&#39;)"><span class="mpre">postorderF</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">Tree</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">] -&gt; [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">]
</span><a name="loc_117_1_117_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_117_1_117_11&#39;)"><span class="hl_vardecl"><span class="mpre">postorderF</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">concatMap</span></span><span class="mpre"> </span><a href="#loc_113_1_113_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_113_1_113_10&#39;)"><span class="hl_varref"><span class="mpre">postorder</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Flatten a &#39;Tree&#39;, returning the elements in pre-order.  Equivalent to</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--&#39;flatten&#39; in &#39;Data.Tree&#39;.</span></span><span class="mpre">
</span><a href="#loc_122_1_122_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_1_122_9&#39;)"><span class="mpre">preorder</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Tree</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">]
</span><a name="loc_122_1_122_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_1_122_9&#39;)"><span class="hl_vardecl"><span class="mpre">preorder</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">flatten</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Flatten multiple &#39;Tree&#39;s in pre-order.</span></span><span class="mpre">
</span><a href="#loc_126_1_126_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_1_126_10&#39;)"><span class="mpre">preorderF</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">Tree</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">] -&gt; [</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">]
</span><a name="loc_126_1_126_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_1_126_10&#39;)"><span class="hl_vardecl"><span class="mpre">preorderF</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">concatMap</span></span><span class="mpre"> </span><a href="#loc_122_1_122_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_1_122_9&#39;)"><span class="hl_varref"><span class="mpre">preorder</span></span></a><span class="mpre">
</span></div></body></html>