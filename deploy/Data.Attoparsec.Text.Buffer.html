<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE BangPatterns, MagicHash, RankNTypes, RecordWildCards,
    UnboxedTuples #-}

</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      :  Data.Attoparsec.Text.Buffer</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright   :  Bryan O&#39;Sullivan 2007-2014</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     :  BSD3</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  :  bos@serpentine.com</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   :  experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability :  GHC</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- An immutable buffer that supports cheap appends.</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- A Buffer is divided into an immutable read-only zone, followed by a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- mutable area that we&#39;ve preallocated, but not yet written to.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- We overallocate at the end of a Buffer so that we can cheaply</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- append.  Since a user of an existing Buffer cannot see past the end</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- of its immutable zone into the data that will change during an</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- append, this is safe.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Once we run out of space at the end of a Buffer, we do the usual</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- doubling of the buffer size.</span></span><span class="mpre">

module Data.Attoparsec.Text.Buffer
    (
      Buffer
    , buffer
    , unbuffer
    , length
    , pappend
    , iter
    , iter_
    , substring
    , dropWord16
    ) where

import Control.Exception (assert)
import Data.Bits (</span><a href="Data.Bits.html#loc_226_5_226_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_226_5_226_11&#39;)"><span class="mpre">shiftR</span></a><span class="mpre">)
import Data.List (</span><a href="Data.List.html#loc_1005_1_1005_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_1005_1_1005_8&#39;)"><span class="mpre">foldl1&#39;</span></a><span class="mpre">)
import Data.Monoid (</span><a href="Data.Monoid.html#loc_79_7_79_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_79_7_79_13&#39;)"><span class="mpre">Monoid</span></a><span class="mpre">(..))
import Data.Text ()
import Data.Text.Internal (</span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="mpre">Text</span></a><span class="mpre">(..))
import Data.Text.Internal.Encoding.Utf16 (</span><a href="Data.Text.Internal.Encoding.Utf16.html#loc_30_1_30_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Encoding.Utf16.html#loc_30_1_30_5&#39;)"><span class="mpre">chr2</span></a><span class="mpre">)
import Data.Text.Internal.Unsafe.Char (</span><a href="Data.Text.Internal.Unsafe.Char.html#loc_44_1_44_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Unsafe.Char.html#loc_44_1_44_10&#39;)"><span class="mpre">unsafeChr</span></a><span class="mpre">)
import Data.Text.Unsafe (</span><a href="Data.Text.Unsafe.html#loc_62_6_62_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Unsafe.html#loc_62_6_62_10&#39;)"><span class="mpre">Iter</span></a><span class="mpre">(..))
import Foreign.Storable (sizeOf)
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/attoparsec-0.12.1.0/Data/Attoparsec/Text/Buffer.hs&quot;, srcSpanStartLine = 49, srcSpanStartColumn = 8, srcSpanEndLine = 49, srcSpanEndColumn = 16}, srcInfoPoints = []}) &quot;GHC.Base&quot;"><span class="mpre">GHC.Base</span></span><span class="mpre"> (Int(..), indexIntArray#, unsafeCoerce#, writeIntArray#)
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/attoparsec-0.12.1.0/Data/Attoparsec/Text/Buffer.hs&quot;, srcSpanStartLine = 50, srcSpanStartColumn = 8, srcSpanEndLine = 50, srcSpanEndColumn = 14}, srcInfoPoints = []}) &quot;GHC.ST&quot;"><span class="mpre">GHC.ST</span></span><span class="mpre"> (ST(..), runST)
import Prelude hiding (length)
import qualified Data.Text.Array as A

data </span><a name="loc_54_6_54_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_6_54_12&#39;)"><span class="hl_tycondecl"><span class="mpre">Buffer</span></span></a><span class="mpre"> = </span><a name="loc_54_15_54_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_15_54_18&#39;)"><span class="hl_condecl"><span class="mpre">Buf</span></span></a><span class="mpre"> {
      </span><span class="hl_fielddecl"><span class="mpre">_arr</span></span><span class="mpre"> :: {-# UNPACK #-} !</span><a href="Data.Text.Array.html#loc_83_6_83_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Array.html#loc_83_6_83_11&#39;)"><span class="hl_tyconref"><span class="mpre">A.Array</span></span></a><span class="mpre">
    , </span><span class="hl_fielddecl"><span class="mpre">_off</span></span><span class="mpre"> :: {-# UNPACK #-} !</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
    , </span><span class="hl_fielddecl"><span class="mpre">_len</span></span><span class="mpre"> :: {-# UNPACK #-} !</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
    , </span><span class="hl_fielddecl"><span class="mpre">_cap</span></span><span class="mpre"> :: {-# UNPACK #-} !</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
    , </span><span class="hl_fielddecl"><span class="mpre">_gen</span></span><span class="mpre"> :: {-# UNPACK #-} !</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
    }

instance </span><span class="hl_classref"><span class="mpre">Show</span></span><span class="mpre"> </span><a href="#loc_54_6_54_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_6_54_12&#39;)"><span class="hl_tyconref"><span class="mpre">Buffer</span></span></a><span class="mpre"> where
    </span><span class="hl_fundecl"><span class="mpre">showsPrec</span></span><span class="mpre"> </span><a name="loc_63_15_63_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_15_63_16&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">showsPrec</span></span><span class="mpre"> </span><a href="#loc_63_15_63_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_15_63_16&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_72_1_72_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_1_72_9&#39;)"><span class="hl_varref"><span class="mpre">unbuffer</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | The initial &#39;Buffer&#39; has no mutable zone, so we can avoid all</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- copies in the (hopefully) common case of no further input being fed</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- to us.</span></span><span class="mpre">
</span><a href="#loc_69_1_69_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_7&#39;)"><span class="mpre">buffer</span></a><span class="mpre"> :: </span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_54_6_54_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_6_54_12&#39;)"><span class="hl_tyconref"><span class="mpre">Buffer</span></span></a><span class="mpre">
</span><a name="loc_69_1_69_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_1_69_7&#39;)"><span class="hl_fundecl"><span class="mpre">buffer</span></span></a><span class="mpre"> (</span><a href="Data.Text.Internal.html#loc_50_13_50_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_13_50_17&#39;)"><span class="hl_conref"><span class="mpre">Text</span></span></a><span class="mpre"> </span><a name="loc_69_14_69_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_14_69_17&#39;)"><span class="hl_vardecl"><span class="mpre">arr</span></span></a><span class="mpre"> </span><a name="loc_69_18_69_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_18_69_21&#39;)"><span class="hl_vardecl"><span class="mpre">off</span></span></a><span class="mpre"> </span><a name="loc_69_22_69_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_22_69_25&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre">) = </span><a href="#loc_54_15_54_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_15_54_18&#39;)"><span class="hl_conref"><span class="mpre">Buf</span></span></a><span class="mpre"> </span><a href="#loc_69_14_69_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_14_69_17&#39;)"><span class="hl_varref"><span class="mpre">arr</span></span></a><span class="mpre"> </span><a href="#loc_69_18_69_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_18_69_21&#39;)"><span class="hl_varref"><span class="mpre">off</span></span></a><span class="mpre"> </span><a href="#loc_69_22_69_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_22_69_25&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre"> </span><a href="#loc_69_22_69_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_22_69_25&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">

</span><a href="#loc_72_1_72_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_1_72_9&#39;)"><span class="mpre">unbuffer</span></a><span class="mpre"> :: </span><a href="#loc_54_6_54_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_6_54_12&#39;)"><span class="hl_tyconref"><span class="mpre">Buffer</span></span></a><span class="mpre"> -&gt; </span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre">
</span><a name="loc_72_1_72_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_1_72_9&#39;)"><span class="hl_fundecl"><span class="mpre">unbuffer</span></span></a><span class="mpre"> (</span><a href="#loc_54_15_54_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_15_54_18&#39;)"><span class="hl_conref"><span class="mpre">Buf</span></span></a><span class="mpre"> </span><a name="loc_72_15_72_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_15_72_18&#39;)"><span class="hl_vardecl"><span class="mpre">arr</span></span></a><span class="mpre"> </span><a name="loc_72_19_72_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_19_72_22&#39;)"><span class="hl_vardecl"><span class="mpre">off</span></span></a><span class="mpre"> </span><a name="loc_72_23_72_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_23_72_26&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre"> _ _) = </span><a href="Data.Text.Internal.html#loc_50_13_50_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_13_50_17&#39;)"><span class="hl_conref"><span class="mpre">Text</span></span></a><span class="mpre"> </span><a href="#loc_72_15_72_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_15_72_18&#39;)"><span class="hl_varref"><span class="mpre">arr</span></span></a><span class="mpre"> </span><a href="#loc_72_19_72_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_19_72_22&#39;)"><span class="hl_varref"><span class="mpre">off</span></span></a><span class="mpre"> </span><a href="#loc_72_23_72_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_23_72_26&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre">

instance </span><a href="Data.Monoid.html#loc_79_7_79_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_79_7_79_13&#39;)"><span class="hl_classref"><span class="mpre">Monoid</span></span></a><span class="mpre"> </span><a href="#loc_54_6_54_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_6_54_12&#39;)"><span class="hl_tyconref"><span class="mpre">Buffer</span></span></a><span class="mpre"> where
    </span><a href="Data.Monoid.html#loc_80_9_80_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_80_9_80_15&#39;)"><span class="hl_vardecl"><span class="mpre">mempty</span></span></a><span class="mpre"> = </span><a href="#loc_54_15_54_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_15_54_18&#39;)"><span class="hl_conref"><span class="mpre">Buf</span></span></a><span class="mpre"> </span><a href="Data.Text.Array.html#loc_172_1_172_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Array.html#loc_172_1_172_6&#39;)"><span class="hl_varref"><span class="mpre">A.empty</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">

    </span><a href="Data.Monoid.html#loc_82_9_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_82_9_82_16&#39;)"><span class="hl_fundecl"><span class="mpre">mappend</span></span></a><span class="mpre"> (</span><a href="#loc_54_15_54_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_15_54_18&#39;)"><span class="hl_conref"><span class="mpre">Buf</span></span></a><span class="mpre"> _ _ _ </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> _) </span><a name="loc_77_29_77_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_29_77_30&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> = </span><a href="#loc_77_29_77_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_29_77_30&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">
    </span><a href="Data.Monoid.html#loc_82_9_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_82_9_82_16&#39;)"><span class="hl_fundecl"><span class="mpre">mappend</span></span></a><span class="mpre"> </span><a name="loc_78_13_78_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_13_78_14&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> (</span><a href="#loc_54_15_54_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_15_54_18&#39;)"><span class="hl_conref"><span class="mpre">Buf</span></span></a><span class="mpre"> _ _ _ </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> _) = </span><a href="#loc_78_13_78_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_13_78_14&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">
    </span><a href="Data.Monoid.html#loc_82_9_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_82_9_82_16&#39;)"><span class="hl_fundecl"><span class="mpre">mappend</span></span></a><span class="mpre"> </span><a name="loc_79_13_79_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_13_79_16&#39;)"><span class="hl_vardecl"><span class="mpre">buf</span></span></a><span class="mpre"> (</span><a href="#loc_54_15_54_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_15_54_18&#39;)"><span class="hl_conref"><span class="mpre">Buf</span></span></a><span class="mpre"> </span><a name="loc_79_22_79_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_22_79_25&#39;)"><span class="hl_vardecl"><span class="mpre">arr</span></span></a><span class="mpre"> </span><a name="loc_79_26_79_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_26_79_29&#39;)"><span class="hl_vardecl"><span class="mpre">off</span></span></a><span class="mpre"> </span><a name="loc_79_30_79_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_30_79_33&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre"> _ _) = </span><a href="#loc_89_1_89_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_1_89_7&#39;)"><span class="hl_varref"><span class="mpre">append</span></span></a><span class="mpre"> </span><a href="#loc_79_13_79_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_13_79_16&#39;)"><span class="hl_varref"><span class="mpre">buf</span></span></a><span class="mpre"> </span><a href="#loc_79_22_79_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_22_79_25&#39;)"><span class="hl_varref"><span class="mpre">arr</span></span></a><span class="mpre"> </span><a href="#loc_79_26_79_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_26_79_29&#39;)"><span class="hl_varref"><span class="mpre">off</span></span></a><span class="mpre"> </span><a href="#loc_79_30_79_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_30_79_33&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre">

    </span><a href="Data.Monoid.html#loc_84_9_84_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_84_9_84_16&#39;)"><span class="hl_fundecl"><span class="mpre">mconcat</span></span></a><span class="mpre"> [] = </span><a href="Data.Monoid.html#loc_80_9_80_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_80_9_80_15&#39;)"><span class="hl_varref"><span class="mpre">mempty</span></span></a><span class="mpre">
    </span><a href="Data.Monoid.html#loc_84_9_84_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_84_9_84_16&#39;)"><span class="hl_fundecl"><span class="mpre">mconcat</span></span></a><span class="mpre"> </span><a name="loc_82_13_82_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_13_82_15&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> = </span><a href="Data.List.html#loc_1005_1_1005_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_1005_1_1005_8&#39;)"><span class="hl_varref"><span class="mpre">foldl1&#39;</span></span></a><span class="mpre"> </span><a href="Data.Monoid.html#loc_82_9_82_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Monoid.html#loc_82_9_82_16&#39;)"><span class="hl_varref"><span class="mpre">mappend</span></span></a><span class="mpre"> </span><a href="#loc_82_13_82_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_13_82_15&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">

</span><a href="#loc_85_1_85_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_1_85_8&#39;)"><span class="mpre">pappend</span></a><span class="mpre"> :: </span><a href="#loc_54_6_54_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_6_54_12&#39;)"><span class="hl_tyconref"><span class="mpre">Buffer</span></span></a><span class="mpre"> -&gt; </span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_54_6_54_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_6_54_12&#39;)"><span class="hl_tyconref"><span class="mpre">Buffer</span></span></a><span class="mpre">
</span><a name="loc_85_1_85_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_1_85_8&#39;)"><span class="hl_fundecl"><span class="mpre">pappend</span></span></a><span class="mpre"> (</span><a href="#loc_54_15_54_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_15_54_18&#39;)"><span class="hl_conref"><span class="mpre">Buf</span></span></a><span class="mpre"> _ _ _ </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> _) (</span><a href="Data.Text.Internal.html#loc_50_13_50_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_13_50_17&#39;)"><span class="hl_conref"><span class="mpre">Text</span></span></a><span class="mpre"> </span><a name="loc_85_31_85_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_31_85_34&#39;)"><span class="hl_vardecl"><span class="mpre">arr</span></span></a><span class="mpre"> </span><a name="loc_85_35_85_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_35_85_38&#39;)"><span class="hl_vardecl"><span class="mpre">off</span></span></a><span class="mpre"> </span><a name="loc_85_39_85_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_39_85_42&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre">) = </span><a href="#loc_54_15_54_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_15_54_18&#39;)"><span class="hl_conref"><span class="mpre">Buf</span></span></a><span class="mpre"> </span><a href="#loc_85_31_85_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_31_85_34&#39;)"><span class="hl_varref"><span class="mpre">arr</span></span></a><span class="mpre"> </span><a href="#loc_85_35_85_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_35_85_38&#39;)"><span class="hl_varref"><span class="mpre">off</span></span></a><span class="mpre"> </span><a href="#loc_85_39_85_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_39_85_42&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
</span><a href="#loc_85_1_85_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_1_85_8&#39;)"><span class="hl_fundecl"><span class="mpre">pappend</span></span></a><span class="mpre"> </span><a name="loc_86_9_86_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_9_86_12&#39;)"><span class="hl_vardecl"><span class="mpre">buf</span></span></a><span class="mpre"> (</span><a href="Data.Text.Internal.html#loc_50_13_50_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_13_50_17&#39;)"><span class="hl_conref"><span class="mpre">Text</span></span></a><span class="mpre"> </span><a name="loc_86_19_86_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_19_86_22&#39;)"><span class="hl_vardecl"><span class="mpre">arr</span></span></a><span class="mpre"> </span><a name="loc_86_23_86_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_23_86_26&#39;)"><span class="hl_vardecl"><span class="mpre">off</span></span></a><span class="mpre"> </span><a name="loc_86_27_86_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_27_86_30&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre">)             = </span><a href="#loc_89_1_89_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_1_89_7&#39;)"><span class="hl_varref"><span class="mpre">append</span></span></a><span class="mpre"> </span><a href="#loc_86_9_86_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_9_86_12&#39;)"><span class="hl_varref"><span class="mpre">buf</span></span></a><span class="mpre"> </span><a href="#loc_86_19_86_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_19_86_22&#39;)"><span class="hl_varref"><span class="mpre">arr</span></span></a><span class="mpre"> </span><a href="#loc_86_23_86_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_23_86_26&#39;)"><span class="hl_varref"><span class="mpre">off</span></span></a><span class="mpre"> </span><a href="#loc_86_27_86_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_27_86_30&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre">

</span><a href="#loc_89_1_89_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_1_89_7&#39;)"><span class="mpre">append</span></a><span class="mpre"> :: </span><a href="#loc_54_6_54_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_6_54_12&#39;)"><span class="hl_tyconref"><span class="mpre">Buffer</span></span></a><span class="mpre"> -&gt; </span><a href="Data.Text.Array.html#loc_83_6_83_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Array.html#loc_83_6_83_11&#39;)"><span class="hl_tyconref"><span class="mpre">A.Array</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><a href="#loc_54_6_54_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_6_54_12&#39;)"><span class="hl_tyconref"><span class="mpre">Buffer</span></span></a><span class="mpre">
</span><a name="loc_89_1_89_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_1_89_7&#39;)"><span class="hl_fundecl"><span class="mpre">append</span></span></a><span class="mpre"> (</span><a href="#loc_54_15_54_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_15_54_18&#39;)"><span class="hl_conref"><span class="mpre">Buf</span></span></a><span class="mpre"> </span><a name="loc_89_13_89_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_13_89_17&#39;)"><span class="hl_vardecl"><span class="mpre">arr0</span></span></a><span class="mpre"> </span><a name="loc_89_18_89_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_18_89_22&#39;)"><span class="hl_vardecl"><span class="mpre">off0</span></span></a><span class="mpre"> </span><a name="loc_89_23_89_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_23_89_27&#39;)"><span class="hl_vardecl"><span class="mpre">len0</span></span></a><span class="mpre"> </span><a name="loc_89_28_89_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_28_89_32&#39;)"><span class="hl_vardecl"><span class="mpre">cap0</span></span></a><span class="mpre"> </span><a name="loc_89_33_89_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_33_89_37&#39;)"><span class="hl_vardecl"><span class="mpre">gen0</span></span></a><span class="mpre">) !</span><a name="loc_89_40_89_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_40_89_44&#39;)"><span class="hl_vardecl"><span class="mpre">arr1</span></span></a><span class="mpre"> !</span><a name="loc_89_46_89_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_46_89_50&#39;)"><span class="hl_vardecl"><span class="mpre">off1</span></span></a><span class="mpre"> !</span><a name="loc_89_52_89_56" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_52_89_56&#39;)"><span class="hl_vardecl"><span class="mpre">len1</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">runST</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
  let </span><a name="loc_90_7_90_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_7_90_11&#39;)"><span class="hl_vardecl"><span class="mpre">woff</span></span></a><span class="mpre">    = </span><span class="hl_varref"><span class="mpre">sizeOf</span></span><span class="mpre"> (</span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">::</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">) </span><a href="Data.Bits.html#loc_226_5_226_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_226_5_226_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftR`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
      </span><a name="loc_91_7_91_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_7_91_13&#39;)"><span class="hl_vardecl"><span class="mpre">newlen</span></span></a><span class="mpre">  = </span><a href="#loc_89_23_89_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_23_89_27&#39;)"><span class="hl_varref"><span class="mpre">len0</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_89_52_89_56" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_52_89_56&#39;)"><span class="hl_varref"><span class="mpre">len1</span></span></a><span class="mpre">
      !</span><a name="loc_92_8_92_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_8_92_11&#39;)"><span class="hl_vardecl"><span class="mpre">gen</span></span></a><span class="mpre">    = if </span><a href="#loc_89_33_89_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_33_89_37&#39;)"><span class="hl_varref"><span class="mpre">gen0</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> then </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> else </span><a href="#loc_154_1_154_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_1_154_8&#39;)"><span class="hl_varref"><span class="mpre">readGen</span></span></a><span class="mpre"> </span><a href="#loc_89_13_89_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_13_89_17&#39;)"><span class="hl_varref"><span class="mpre">arr0</span></span></a><span class="mpre">
  if </span><a href="#loc_92_8_92_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_8_92_11&#39;)"><span class="hl_varref"><span class="mpre">gen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_89_33_89_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_33_89_37&#39;)"><span class="hl_varref"><span class="mpre">gen0</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_91_7_91_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_7_91_13&#39;)"><span class="hl_varref"><span class="mpre">newlen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><a href="#loc_89_28_89_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_28_89_32&#39;)"><span class="hl_varref"><span class="mpre">cap0</span></span></a><span class="mpre">
    then do
      let </span><a name="loc_95_11_95_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_11_95_17&#39;)"><span class="hl_vardecl"><span class="mpre">newgen</span></span></a><span class="mpre"> = </span><a href="#loc_92_8_92_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_8_92_11&#39;)"><span class="hl_varref"><span class="mpre">gen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
      </span><a name="loc_96_7_96_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_7_96_11&#39;)"><span class="hl_vardecl"><span class="mpre">marr</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_150_1_150_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_1_150_11&#39;)"><span class="hl_varref"><span class="mpre">unsafeThaw</span></span></a><span class="mpre"> </span><a href="#loc_89_13_89_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_13_89_17&#39;)"><span class="hl_varref"><span class="mpre">arr0</span></span></a><span class="mpre">
      </span><a href="#loc_157_1_157_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_1_157_9&#39;)"><span class="hl_varref"><span class="mpre">writeGen</span></span></a><span class="mpre"> </span><a href="#loc_96_7_96_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_7_96_11&#39;)"><span class="hl_varref"><span class="mpre">marr</span></span></a><span class="mpre"> </span><a href="#loc_95_11_95_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_11_95_17&#39;)"><span class="hl_varref"><span class="mpre">newgen</span></span></a><span class="mpre">
      </span><a href="Data.Text.Array.html#loc_215_1_215_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Array.html#loc_215_1_215_6&#39;)"><span class="hl_varref"><span class="mpre">A.copyI</span></span></a><span class="mpre"> </span><a href="#loc_96_7_96_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_7_96_11&#39;)"><span class="hl_varref"><span class="mpre">marr</span></span></a><span class="mpre"> (</span><a href="#loc_89_18_89_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_18_89_22&#39;)"><span class="hl_varref"><span class="mpre">off0</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><a href="#loc_89_23_89_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_23_89_27&#39;)"><span class="hl_varref"><span class="mpre">len0</span></span></a><span class="mpre">) </span><a href="#loc_89_40_89_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_40_89_44&#39;)"><span class="hl_varref"><span class="mpre">arr1</span></span></a><span class="mpre"> </span><a href="#loc_89_46_89_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_46_89_50&#39;)"><span class="hl_varref"><span class="mpre">off1</span></span></a><span class="mpre"> (</span><a href="#loc_89_18_89_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_18_89_22&#39;)"><span class="hl_varref"><span class="mpre">off0</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><a href="#loc_91_7_91_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_7_91_13&#39;)"><span class="hl_varref"><span class="mpre">newlen</span></span></a><span class="mpre">)
      </span><a name="loc_99_7_99_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_7_99_11&#39;)"><span class="hl_vardecl"><span class="mpre">arr2</span></span></a><span class="mpre"> &lt;- </span><a href="Data.Text.Array.html#loc_133_1_133_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Array.html#loc_133_1_133_13&#39;)"><span class="hl_varref"><span class="mpre">A.unsafeFreeze</span></span></a><span class="mpre"> </span><a href="#loc_96_7_96_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_7_96_11&#39;)"><span class="hl_varref"><span class="mpre">marr</span></span></a><span class="mpre">
      </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_54_15_54_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_15_54_18&#39;)"><span class="hl_conref"><span class="mpre">Buf</span></span></a><span class="mpre"> </span><a href="#loc_99_7_99_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_7_99_11&#39;)"><span class="hl_varref"><span class="mpre">arr2</span></span></a><span class="mpre"> </span><a href="#loc_89_18_89_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_18_89_22&#39;)"><span class="hl_varref"><span class="mpre">off0</span></span></a><span class="mpre"> </span><a href="#loc_91_7_91_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_7_91_13&#39;)"><span class="hl_varref"><span class="mpre">newlen</span></span></a><span class="mpre"> </span><a href="#loc_89_28_89_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_28_89_32&#39;)"><span class="hl_varref"><span class="mpre">cap0</span></span></a><span class="mpre"> </span><a href="#loc_95_11_95_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_11_95_17&#39;)"><span class="hl_varref"><span class="mpre">newgen</span></span></a><span class="mpre">)
    else do
      let </span><a name="loc_102_11_102_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_11_102_17&#39;)"><span class="hl_vardecl"><span class="mpre">newcap</span></span></a><span class="mpre"> = </span><a href="#loc_91_7_91_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_7_91_13&#39;)"><span class="hl_varref"><span class="mpre">newlen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">
          </span><a name="loc_103_11_103_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_11_103_17&#39;)"><span class="hl_vardecl"><span class="mpre">newgen</span></span></a><span class="mpre"> = </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
      </span><a name="loc_104_7_104_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_7_104_11&#39;)"><span class="hl_vardecl"><span class="mpre">marr</span></span></a><span class="mpre"> &lt;- </span><a href="Data.Text.Array.html#loc_115_1_115_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Array.html#loc_115_1_115_4&#39;)"><span class="hl_varref"><span class="mpre">A.new</span></span></a><span class="mpre"> (</span><a href="#loc_102_11_102_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_11_102_17&#39;)"><span class="hl_varref"><span class="mpre">newcap</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_90_7_90_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_7_90_11&#39;)"><span class="hl_varref"><span class="mpre">woff</span></span></a><span class="mpre">)
      </span><a href="#loc_157_1_157_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_1_157_9&#39;)"><span class="hl_varref"><span class="mpre">writeGen</span></span></a><span class="mpre"> </span><a href="#loc_104_7_104_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_7_104_11&#39;)"><span class="hl_varref"><span class="mpre">marr</span></span></a><span class="mpre"> </span><a href="#loc_103_11_103_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_11_103_17&#39;)"><span class="hl_varref"><span class="mpre">newgen</span></span></a><span class="mpre">
      </span><a href="Data.Text.Array.html#loc_215_1_215_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Array.html#loc_215_1_215_6&#39;)"><span class="hl_varref"><span class="mpre">A.copyI</span></span></a><span class="mpre"> </span><a href="#loc_104_7_104_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_7_104_11&#39;)"><span class="hl_varref"><span class="mpre">marr</span></span></a><span class="mpre"> </span><a href="#loc_90_7_90_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_7_90_11&#39;)"><span class="hl_varref"><span class="mpre">woff</span></span></a><span class="mpre"> </span><a href="#loc_89_13_89_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_13_89_17&#39;)"><span class="hl_varref"><span class="mpre">arr0</span></span></a><span class="mpre"> </span><a href="#loc_89_18_89_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_18_89_22&#39;)"><span class="hl_varref"><span class="mpre">off0</span></span></a><span class="mpre"> (</span><a href="#loc_90_7_90_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_7_90_11&#39;)"><span class="hl_varref"><span class="mpre">woff</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><a href="#loc_89_23_89_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_23_89_27&#39;)"><span class="hl_varref"><span class="mpre">len0</span></span></a><span class="mpre">)
      </span><a href="Data.Text.Array.html#loc_215_1_215_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Array.html#loc_215_1_215_6&#39;)"><span class="hl_varref"><span class="mpre">A.copyI</span></span></a><span class="mpre"> </span><a href="#loc_104_7_104_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_7_104_11&#39;)"><span class="hl_varref"><span class="mpre">marr</span></span></a><span class="mpre"> (</span><a href="#loc_90_7_90_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_7_90_11&#39;)"><span class="hl_varref"><span class="mpre">woff</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><a href="#loc_89_23_89_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_23_89_27&#39;)"><span class="hl_varref"><span class="mpre">len0</span></span></a><span class="mpre">) </span><a href="#loc_89_40_89_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_40_89_44&#39;)"><span class="hl_varref"><span class="mpre">arr1</span></span></a><span class="mpre"> </span><a href="#loc_89_46_89_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_46_89_50&#39;)"><span class="hl_varref"><span class="mpre">off1</span></span></a><span class="mpre"> (</span><a href="#loc_90_7_90_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_7_90_11&#39;)"><span class="hl_varref"><span class="mpre">woff</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><a href="#loc_91_7_91_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_7_91_13&#39;)"><span class="hl_varref"><span class="mpre">newlen</span></span></a><span class="mpre">)
      </span><a name="loc_108_7_108_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_7_108_11&#39;)"><span class="hl_vardecl"><span class="mpre">arr2</span></span></a><span class="mpre"> &lt;- </span><a href="Data.Text.Array.html#loc_133_1_133_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Array.html#loc_133_1_133_13&#39;)"><span class="hl_varref"><span class="mpre">A.unsafeFreeze</span></span></a><span class="mpre"> </span><a href="#loc_104_7_104_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_7_104_11&#39;)"><span class="hl_varref"><span class="mpre">marr</span></span></a><span class="mpre">
      </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_54_15_54_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_15_54_18&#39;)"><span class="hl_conref"><span class="mpre">Buf</span></span></a><span class="mpre"> </span><a href="#loc_108_7_108_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_7_108_11&#39;)"><span class="hl_varref"><span class="mpre">arr2</span></span></a><span class="mpre"> </span><a href="#loc_90_7_90_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_7_90_11&#39;)"><span class="hl_varref"><span class="mpre">woff</span></span></a><span class="mpre"> </span><a href="#loc_91_7_91_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_7_91_13&#39;)"><span class="hl_varref"><span class="mpre">newlen</span></span></a><span class="mpre"> </span><a href="#loc_102_11_102_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_11_102_17&#39;)"><span class="hl_varref"><span class="mpre">newcap</span></span></a><span class="mpre"> </span><a href="#loc_103_11_103_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_11_103_17&#39;)"><span class="hl_varref"><span class="mpre">newgen</span></span></a><span class="mpre">)

</span><a href="#loc_112_1_112_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_1_112_7&#39;)"><span class="mpre">length</span></a><span class="mpre"> :: </span><a href="#loc_54_6_54_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_6_54_12&#39;)"><span class="hl_tyconref"><span class="mpre">Buffer</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><a name="loc_112_1_112_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_1_112_7&#39;)"><span class="hl_fundecl"><span class="mpre">length</span></span></a><span class="mpre"> (</span><a href="#loc_54_15_54_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_15_54_18&#39;)"><span class="hl_conref"><span class="mpre">Buf</span></span></a><span class="mpre"> _ _ </span><a name="loc_112_17_112_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_17_112_20&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre"> _ _) = </span><a href="#loc_112_17_112_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_17_112_20&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_112_1_112_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_1_112_7&#39;)"><span class="mpre">length</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><a href="#loc_116_1_116_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_1_116_10&#39;)"><span class="mpre">substring</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><a href="#loc_54_6_54_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_6_54_12&#39;)"><span class="hl_tyconref"><span class="mpre">Buffer</span></span></a><span class="mpre"> -&gt; </span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre">
</span><a name="loc_116_1_116_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_1_116_10&#39;)"><span class="hl_fundecl"><span class="mpre">substring</span></span></a><span class="mpre"> </span><a name="loc_116_11_116_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_11_116_12&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> </span><a name="loc_116_13_116_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_13_116_14&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> (</span><a href="#loc_54_15_54_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_15_54_18&#39;)"><span class="hl_conref"><span class="mpre">Buf</span></span></a><span class="mpre"> </span><a name="loc_116_20_116_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_20_116_23&#39;)"><span class="hl_vardecl"><span class="mpre">arr</span></span></a><span class="mpre"> </span><a name="loc_116_24_116_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_24_116_27&#39;)"><span class="hl_vardecl"><span class="mpre">off</span></span></a><span class="mpre"> </span><a name="loc_116_28_116_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_28_116_31&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre"> _ _) =
  </span><span class="hl_varref"><span class="mpre">assert</span></span><span class="mpre"> (</span><a href="#loc_116_11_116_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_11_116_12&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_116_11_116_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_11_116_12&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><a href="#loc_116_28_116_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_28_116_31&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre">
  </span><span class="hl_varref"><span class="mpre">assert</span></span><span class="mpre"> (</span><a href="#loc_116_13_116_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_13_116_14&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_116_13_116_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_13_116_14&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><a href="#loc_116_28_116_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_28_116_31&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><a href="#loc_116_11_116_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_11_116_12&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
  </span><a href="Data.Text.Internal.html#loc_50_13_50_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_13_50_17&#39;)"><span class="hl_conref"><span class="mpre">Text</span></span></a><span class="mpre"> </span><a href="#loc_116_20_116_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_20_116_23&#39;)"><span class="hl_varref"><span class="mpre">arr</span></span></a><span class="mpre"> (</span><a href="#loc_116_24_116_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_24_116_27&#39;)"><span class="hl_varref"><span class="mpre">off</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><a href="#loc_116_11_116_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_11_116_12&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">) </span><a href="#loc_116_13_116_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_13_116_14&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_116_1_116_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_1_116_10&#39;)"><span class="mpre">substring</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><a href="#loc_123_1_123_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_1_123_11&#39;)"><span class="mpre">dropWord16</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><a href="#loc_54_6_54_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_6_54_12&#39;)"><span class="hl_tyconref"><span class="mpre">Buffer</span></span></a><span class="mpre"> -&gt; </span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">Text</span></span></a><span class="mpre">
</span><a name="loc_123_1_123_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_1_123_11&#39;)"><span class="hl_fundecl"><span class="mpre">dropWord16</span></span></a><span class="mpre"> </span><a name="loc_123_12_123_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_12_123_13&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> (</span><a href="#loc_54_15_54_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_15_54_18&#39;)"><span class="hl_conref"><span class="mpre">Buf</span></span></a><span class="mpre"> </span><a name="loc_123_19_123_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_19_123_22&#39;)"><span class="hl_vardecl"><span class="mpre">arr</span></span></a><span class="mpre"> </span><a name="loc_123_23_123_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_23_123_26&#39;)"><span class="hl_vardecl"><span class="mpre">off</span></span></a><span class="mpre"> </span><a name="loc_123_27_123_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_27_123_30&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre"> _ _) =
  </span><span class="hl_varref"><span class="mpre">assert</span></span><span class="mpre"> (</span><a href="#loc_123_12_123_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_12_123_13&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_123_12_123_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_12_123_13&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><a href="#loc_123_27_123_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_27_123_30&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
  </span><a href="Data.Text.Internal.html#loc_50_13_50_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_13_50_17&#39;)"><span class="hl_conref"><span class="mpre">Text</span></span></a><span class="mpre"> </span><a href="#loc_123_19_123_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_19_123_22&#39;)"><span class="hl_varref"><span class="mpre">arr</span></span></a><span class="mpre"> (</span><a href="#loc_123_23_123_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_23_123_26&#39;)"><span class="hl_varref"><span class="mpre">off</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><a href="#loc_123_12_123_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_12_123_13&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">) (</span><a href="#loc_123_27_123_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_27_123_30&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><a href="#loc_123_12_123_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_12_123_13&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_123_1_123_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_1_123_11&#39;)"><span class="mpre">dropWord16</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | /O(1)/ Iterate (unsafely) one step forwards through a UTF-16</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- array, returning the current character and the delta to add to give</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the next offset to iterate at.</span></span><span class="mpre">
</span><a href="#loc_132_1_132_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_1_132_5&#39;)"><span class="mpre">iter</span></a><span class="mpre"> :: </span><a href="#loc_54_6_54_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_6_54_12&#39;)"><span class="hl_tyconref"><span class="mpre">Buffer</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><a href="Data.Text.Unsafe.html#loc_62_6_62_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Unsafe.html#loc_62_6_62_10&#39;)"><span class="hl_tyconref"><span class="mpre">Iter</span></span></a><span class="mpre">
</span><a name="loc_132_1_132_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_1_132_5&#39;)"><span class="hl_fundecl"><span class="mpre">iter</span></span></a><span class="mpre"> (</span><a href="#loc_54_15_54_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_15_54_18&#39;)"><span class="hl_conref"><span class="mpre">Buf</span></span></a><span class="mpre"> </span><a name="loc_132_11_132_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_11_132_14&#39;)"><span class="hl_vardecl"><span class="mpre">arr</span></span></a><span class="mpre"> </span><a name="loc_132_15_132_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_15_132_18&#39;)"><span class="hl_vardecl"><span class="mpre">off</span></span></a><span class="mpre"> _ _ _) </span><a name="loc_132_26_132_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_26_132_27&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre">
    | </span><a href="#loc_135_9_135_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_9_135_10&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xD800</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><a href="#loc_135_9_135_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_9_135_10&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xDBFF</span></span><span class="mpre"> = </span><a href="Data.Text.Unsafe.html#loc_62_13_62_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Unsafe.html#loc_62_13_62_17&#39;)"><span class="hl_conref"><span class="mpre">Iter</span></span></a><span class="mpre"> (</span><a href="Data.Text.Internal.Unsafe.Char.html#loc_44_1_44_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Unsafe.Char.html#loc_44_1_44_10&#39;)"><span class="hl_varref"><span class="mpre">unsafeChr</span></span></a><span class="mpre"> </span><a href="#loc_135_9_135_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_9_135_10&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">) </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">                = </span><a href="Data.Text.Unsafe.html#loc_62_13_62_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Unsafe.html#loc_62_13_62_17&#39;)"><span class="hl_conref"><span class="mpre">Iter</span></span></a><span class="mpre"> (</span><a href="Data.Text.Internal.Encoding.Utf16.html#loc_30_1_30_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Encoding.Utf16.html#loc_30_1_30_5&#39;)"><span class="hl_varref"><span class="mpre">chr2</span></span></a><span class="mpre"> </span><a href="#loc_135_9_135_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_9_135_10&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><a href="#loc_136_9_136_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_9_136_10&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">) </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">
  where </span><a name="loc_135_9_135_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_135_9_135_10&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> = </span><a href="Data.Text.Array.html#loc_150_1_150_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Array.html#loc_150_1_150_12&#39;)"><span class="hl_varref"><span class="mpre">A.unsafeIndex</span></span></a><span class="mpre"> </span><a href="#loc_132_11_132_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_11_132_14&#39;)"><span class="hl_varref"><span class="mpre">arr</span></span></a><span class="mpre"> </span><a href="#loc_137_9_137_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_9_137_10&#39;)"><span class="hl_varref"><span class="mpre">j</span></span></a><span class="mpre">
        </span><a name="loc_136_9_136_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_136_9_136_10&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> = </span><a href="Data.Text.Array.html#loc_150_1_150_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Array.html#loc_150_1_150_12&#39;)"><span class="hl_varref"><span class="mpre">A.unsafeIndex</span></span></a><span class="mpre"> </span><a href="#loc_132_11_132_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_11_132_14&#39;)"><span class="hl_varref"><span class="mpre">arr</span></span></a><span class="mpre"> </span><a href="#loc_138_9_138_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_9_138_10&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre">
        </span><a name="loc_137_9_137_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_9_137_10&#39;)"><span class="hl_vardecl"><span class="mpre">j</span></span></a><span class="mpre"> = </span><a href="#loc_132_15_132_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_15_132_18&#39;)"><span class="hl_varref"><span class="mpre">off</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_132_26_132_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_26_132_27&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">
        </span><a name="loc_138_9_138_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_9_138_10&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> = </span><a href="#loc_137_9_137_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_137_9_137_10&#39;)"><span class="hl_varref"><span class="mpre">j</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_132_1_132_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_1_132_5&#39;)"><span class="mpre">iter</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | /O(1)/ Iterate one step through a UTF-16 array, returning the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- delta to add to give the next offset to iterate at.</span></span><span class="mpre">
</span><a href="#loc_144_1_144_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_1_144_6&#39;)"><span class="mpre">iter_</span></a><span class="mpre"> :: </span><a href="#loc_54_6_54_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_6_54_12&#39;)"><span class="hl_tyconref"><span class="mpre">Buffer</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><a name="loc_144_1_144_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_1_144_6&#39;)"><span class="hl_fundecl"><span class="mpre">iter_</span></span></a><span class="mpre"> (</span><a href="#loc_54_15_54_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_15_54_18&#39;)"><span class="hl_conref"><span class="mpre">Buf</span></span></a><span class="mpre"> </span><a name="loc_144_12_144_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_12_144_15&#39;)"><span class="hl_vardecl"><span class="mpre">arr</span></span></a><span class="mpre"> </span><a name="loc_144_16_144_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_16_144_19&#39;)"><span class="hl_vardecl"><span class="mpre">off</span></span></a><span class="mpre"> _ _ _) </span><a name="loc_144_27_144_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_27_144_28&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> | </span><a href="#loc_146_9_146_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_9_146_10&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xD800</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><a href="#loc_146_9_146_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_9_146_10&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xDBFF</span></span><span class="mpre"> = </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
                                | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">                = </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">
  where </span><a name="loc_146_9_146_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_146_9_146_10&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> = </span><a href="Data.Text.Array.html#loc_150_1_150_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Array.html#loc_150_1_150_12&#39;)"><span class="hl_varref"><span class="mpre">A.unsafeIndex</span></span></a><span class="mpre"> </span><a href="#loc_144_12_144_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_12_144_15&#39;)"><span class="hl_varref"><span class="mpre">arr</span></span></a><span class="mpre"> (</span><a href="#loc_144_16_144_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_16_144_19&#39;)"><span class="hl_varref"><span class="mpre">off</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><a href="#loc_144_27_144_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_27_144_28&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">)
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_144_1_144_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_1_144_6&#39;)"><span class="mpre">iter_</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><a href="#loc_150_1_150_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_1_150_11&#39;)"><span class="mpre">unsafeThaw</span></a><span class="mpre"> :: </span><a href="Data.Text.Array.html#loc_83_6_83_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Array.html#loc_83_6_83_11&#39;)"><span class="hl_tyconref"><span class="mpre">A.Array</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ST</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> (</span><a href="Data.Text.Array.html#loc_91_6_91_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Array.html#loc_91_6_91_12&#39;)"><span class="hl_tyconref"><span class="mpre">A.MArray</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">)
</span><a name="loc_150_1_150_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_1_150_11&#39;)"><span class="hl_fundecl"><span class="mpre">unsafeThaw</span></span></a><span class="mpre"> </span><span class="warning" data-warning="PatPRec (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/attoparsec-0.12.1.0/Data/Attoparsec/Text/Buffer.hs&quot;, srcSpanStartLine = 150, srcSpanStartColumn = 12, srcSpanEndLine = 150, srcSpanEndColumn = 23}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/attoparsec-0.12.1.0/Data/Attoparsec/Text/Buffer.hs&quot;, srcSpanStartLine = 150, srcSpanStartColumn = 19, srcSpanEndLine = 150, srcSpanEndColumn = 20},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/attoparsec-0.12.1.0/Dat"><span class="mpre">A.Array{..}</span></span><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">ST</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_150_32_150_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_32_150_34&#39;)"><span class="hl_vardecl"><span class="mpre">s#</span></span></a><span class="mpre"> -&gt;
                          (# </span><a href="#loc_150_32_150_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_32_150_34&#39;)"><span class="hl_varref"><span class="mpre">s#</span></span></a><span class="mpre">, </span><a href="Data.Text.Array.html#loc_91_17_91_23" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Array.html#loc_91_17_91_23&#39;)"><span class="hl_conref"><span class="mpre">A.MArray</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">unsafeCoerce#</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">aBA</span></span><span class="mpre">) #)

</span><a href="#loc_154_1_154_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_1_154_8&#39;)"><span class="mpre">readGen</span></a><span class="mpre"> :: </span><a href="Data.Text.Array.html#loc_83_6_83_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Array.html#loc_83_6_83_11&#39;)"><span class="hl_tyconref"><span class="mpre">A.Array</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><a name="loc_154_1_154_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_1_154_8&#39;)"><span class="hl_fundecl"><span class="mpre">readGen</span></span></a><span class="mpre"> </span><a name="loc_154_9_154_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_9_154_10&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> = case </span><span class="hl_varref"><span class="mpre">indexIntArray#</span></span><span class="mpre"> (</span><a href="Data.Text.Array.html#loc_84_7_84_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Array.html#loc_84_7_84_10&#39;)"><span class="hl_varref"><span class="mpre">A.aBA</span></span></a><span class="mpre"> </span><a href="#loc_154_9_154_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_9_154_10&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">) 0# of </span><a name="loc_154_49_154_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_49_154_51&#39;)"><span class="hl_vardecl"><span class="mpre">r#</span></span></a><span class="mpre"> -&gt; </span><span class="hl_conref"><span class="mpre">I#</span></span><span class="mpre"> </span><a href="#loc_154_49_154_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_49_154_51&#39;)"><span class="hl_varref"><span class="mpre">r#</span></span></a><span class="mpre">

</span><a href="#loc_157_1_157_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_1_157_9&#39;)"><span class="mpre">writeGen</span></a><span class="mpre"> :: </span><a href="Data.Text.Array.html#loc_91_6_91_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Array.html#loc_91_6_91_12&#39;)"><span class="hl_tyconref"><span class="mpre">A.MArray</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">ST</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_157_1_157_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_1_157_9&#39;)"><span class="hl_fundecl"><span class="mpre">writeGen</span></span></a><span class="mpre"> </span><a name="loc_157_10_157_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_10_157_11&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">I#</span></span><span class="mpre"> </span><a name="loc_157_16_157_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_16_157_20&#39;)"><span class="hl_vardecl"><span class="mpre">gen#</span></span></a><span class="mpre">) = </span><span class="hl_conref"><span class="mpre">ST</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_157_30_157_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_30_157_33&#39;)"><span class="hl_vardecl"><span class="mpre">s0#</span></span></a><span class="mpre"> -&gt;
  case </span><span class="hl_varref"><span class="mpre">writeIntArray#</span></span><span class="mpre"> (</span><a href="Data.Text.Array.html#loc_92_7_92_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Array.html#loc_92_7_92_11&#39;)"><span class="hl_varref"><span class="mpre">A.maBA</span></span></a><span class="mpre"> </span><a href="#loc_157_10_157_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_10_157_11&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">) 0# </span><a href="#loc_157_16_157_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_16_157_20&#39;)"><span class="hl_varref"><span class="mpre">gen#</span></span></a><span class="mpre"> </span><a href="#loc_157_30_157_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_30_157_33&#39;)"><span class="hl_varref"><span class="mpre">s0#</span></span></a><span class="mpre"> of
    </span><a name="loc_159_5_159_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_5_159_8&#39;)"><span class="hl_vardecl"><span class="mpre">s1#</span></span></a><span class="mpre"> -&gt; (# </span><a href="#loc_159_5_159_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_5_159_8&#39;)"><span class="hl_varref"><span class="mpre">s1#</span></span></a><span class="mpre">, </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre"> #)
</span></div></body></html>