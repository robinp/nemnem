<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      : Crypto.Cipher.DES.Serialization</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     : BSD-style</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  : Vincent Hanquez &lt;vincent@snarc.org&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   : stable</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability : good</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- basic routine to convert between W64 and bytestring for DES.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
{-# LANGUAGE CPP #-}
module Crypto.Cipher.DES.Serialization
    ( toW64
    , toBS
    , blockify
    , unblockify
    ) where

import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/cipher-des-0.0.6/Crypto/Cipher/DES/Serialization.hs&quot;, srcSpanStartLine = 18, srcSpanStartColumn = 18, srcSpanEndLine = 18, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> as B
import Crypto.Cipher.DES.Primitive (</span><a href="Crypto.Cipher.DES.Primitive.html#loc_19_9_19_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.DES.Primitive.html#loc_19_9_19_14&#39;)"><span class="mpre">Block</span></a><span class="mpre">(..))

#ifdef ARCH_IS_LITTLE_ENDIAN
import Data.Word (Word64)
import Data.Byteable (</span><a href="Data.Byteable.html#loc_31_5_31_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Byteable.html#loc_31_5_31_16&#39;)"><span class="mpre">withBytePtr</span></a><span class="mpre">)
import qualified Data.ByteString.Internal as B (</span><a href="Data.ByteString.Internal.html#loc_592_1_592_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_592_1_592_16&#39;)"><span class="mpre">inlinePerformIO</span></a><span class="mpre">, </span><a href="Data.ByteString.Internal.html#loc_411_1_411_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_411_1_411_13&#39;)"><span class="mpre">unsafeCreate</span></a><span class="mpre">)
import Foreign.Storable
import Foreign.Ptr (castPtr, plusPtr, Ptr)
import Data.Bits (</span><a href="Data.Bits.html#loc_200_5_200_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_200_5_200_11&#39;)"><span class="mpre">shiftL</span></a><span class="mpre">, </span><a href="Data.Bits.html#loc_226_5_226_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_226_5_226_11&#39;)"><span class="mpre">shiftR</span></a><span class="mpre">, (.|.), (.&amp;.))
#else
import Data.Bits (</span><a href="Data.Bits.html#loc_200_5_200_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_200_5_200_11&#39;)"><span class="mpre">shiftL</span></a><span class="mpre">, </span><a href="Data.Bits.html#loc_226_5_226_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_226_5_226_11&#39;)"><span class="mpre">shiftR</span></a><span class="mpre">, (.|.))
#endif

#ifdef ARCH_IS_LITTLE_ENDIAN
</span><span class="hl_comment"><span class="mpre">-- | convert a 8 byte bytestring big endian to a host one</span></span><span class="mpre">
</span><a href="#loc_35_1_35_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_1_35_6&#39;)"><span class="mpre">toW64</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; </span><a href="Crypto.Cipher.DES.Primitive.html#loc_19_9_19_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.DES.Primitive.html#loc_19_9_19_14&#39;)"><span class="hl_tyconref"><span class="mpre">Block</span></span></a><span class="mpre">
</span><a name="loc_35_1_35_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_1_35_6&#39;)"><span class="hl_fundecl"><span class="mpre">toW64</span></span></a><span class="mpre"> </span><a name="loc_35_7_35_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_7_35_8&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> = </span><a href="Crypto.Cipher.DES.Primitive.html#loc_19_17_19_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.DES.Primitive.html#loc_19_17_19_22&#39;)"><span class="hl_conref"><span class="mpre">Block</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.ByteString.Internal.html#loc_592_1_592_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_592_1_592_16&#39;)"><span class="hl_varref"><span class="mpre">B.inlinePerformIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.Byteable.html#loc_31_5_31_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Byteable.html#loc_31_5_31_16&#39;)"><span class="hl_varref"><span class="mpre">withBytePtr</span></span></a><span class="mpre"> </span><a href="#loc_35_7_35_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_7_35_8&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_35_56_35_59" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_56_35_59&#39;)"><span class="hl_vardecl"><span class="mpre">ptr</span></span></a><span class="mpre"> -&gt; (</span><a href="#loc_50_1_50_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_1_50_5&#39;)"><span class="hl_varref"><span class="mpre">be64</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`fmap`</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">peek</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">castPtr</span></span><span class="mpre"> </span><a href="#loc_35_56_35_59" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_56_35_59&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre">))

</span><span class="hl_comment"><span class="mpre">-- | convert a word64 to a bytestring in big endian format</span></span><span class="mpre">
</span><a href="#loc_39_1_39_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_1_39_5&#39;)"><span class="mpre">toBS</span></a><span class="mpre"> :: </span><a href="Crypto.Cipher.DES.Primitive.html#loc_19_9_19_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.DES.Primitive.html#loc_19_9_19_14&#39;)"><span class="hl_tyconref"><span class="mpre">Block</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">
</span><a name="loc_39_1_39_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_1_39_5&#39;)"><span class="hl_fundecl"><span class="mpre">toBS</span></span></a><span class="mpre"> (</span><a href="Crypto.Cipher.DES.Primitive.html#loc_19_17_19_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.DES.Primitive.html#loc_19_17_19_22&#39;)"><span class="hl_conref"><span class="mpre">Block</span></span></a><span class="mpre"> </span><a name="loc_39_13_39_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_13_39_14&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre">) = </span><a href="Data.ByteString.Internal.html#loc_411_1_411_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_411_1_411_13&#39;)"><span class="hl_varref"><span class="mpre">B.unsafeCreate</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_39_38_39_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_38_39_41&#39;)"><span class="hl_vardecl"><span class="mpre">ptr</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">castPtr</span></span><span class="mpre"> </span><a href="#loc_39_38_39_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_38_39_41&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre">) (</span><a href="#loc_50_1_50_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_1_50_5&#39;)"><span class="hl_varref"><span class="mpre">be64</span></span></a><span class="mpre"> </span><a href="#loc_39_13_39_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_13_39_14&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Create a strict bytestring out of DES blocks</span></span><span class="mpre">
</span><a href="#loc_43_1_43_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_1_43_11&#39;)"><span class="mpre">unblockify</span></a><span class="mpre"> :: [</span><a href="Crypto.Cipher.DES.Primitive.html#loc_19_9_19_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.DES.Primitive.html#loc_19_9_19_14&#39;)"><span class="hl_tyconref"><span class="mpre">Block</span></span></a><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">
</span><a name="loc_43_1_43_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_1_43_11&#39;)"><span class="hl_fundecl"><span class="mpre">unblockify</span></span></a><span class="mpre"> </span><a name="loc_43_12_43_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_12_43_18&#39;)"><span class="hl_vardecl"><span class="mpre">blocks</span></span></a><span class="mpre"> = </span><a href="Data.ByteString.Internal.html#loc_411_1_411_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_411_1_411_13&#39;)"><span class="hl_varref"><span class="mpre">B.unsafeCreate</span></span></a><span class="mpre"> (</span><a href="#loc_44_9_44_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_9_44_17&#39;)"><span class="hl_varref"><span class="mpre">nbBlocks</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_43_54_43_61" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_54_43_61&#39;)"><span class="hl_vardecl"><span class="mpre">initPtr</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_46_9_46_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_9_46_15&#39;)"><span class="hl_varref"><span class="mpre">pokeTo</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">castPtr</span></span><span class="mpre"> </span><a href="#loc_43_54_43_61" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_54_43_61&#39;)"><span class="hl_varref"><span class="mpre">initPtr</span></span></a><span class="mpre">) </span><a href="#loc_43_12_43_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_12_43_18&#39;)"><span class="hl_varref"><span class="mpre">blocks</span></span></a><span class="mpre">
  where </span><a name="loc_44_9_44_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_9_44_17&#39;)"><span class="hl_vardecl"><span class="mpre">nbBlocks</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_43_12_43_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_12_43_18&#39;)"><span class="hl_varref"><span class="mpre">blocks</span></span></a><span class="mpre">
        </span><a href="#loc_46_9_46_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_9_46_15&#39;)"><span class="mpre">pokeTo</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Ptr</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word64</span></span><span class="mpre"> -&gt; [</span><a href="Crypto.Cipher.DES.Primitive.html#loc_19_9_19_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.DES.Primitive.html#loc_19_9_19_14&#39;)"><span class="hl_tyconref"><span class="mpre">Block</span></span></a><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
        </span><a name="loc_46_9_46_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_9_46_15&#39;)"><span class="hl_fundecl"><span class="mpre">pokeTo</span></span></a><span class="mpre"> _   []           = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">
        </span><a href="#loc_46_9_46_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_9_46_15&#39;)"><span class="hl_fundecl"><span class="mpre">pokeTo</span></span></a><span class="mpre"> </span><a name="loc_47_16_47_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_16_47_19&#39;)"><span class="hl_vardecl"><span class="mpre">ptr</span></span></a><span class="mpre"> (</span><a href="Crypto.Cipher.DES.Primitive.html#loc_19_17_19_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.DES.Primitive.html#loc_19_17_19_22&#39;)"><span class="hl_conref"><span class="mpre">Block</span></span></a><span class="mpre"> </span><a name="loc_47_27_47_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_27_47_28&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_47_29_47_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_29_47_31&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">poke</span></span><span class="mpre"> </span><a href="#loc_47_16_47_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_16_47_19&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre"> (</span><a href="#loc_50_1_50_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_1_50_5&#39;)"><span class="hl_varref"><span class="mpre">be64</span></span></a><span class="mpre"> </span><a href="#loc_47_27_47_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_27_47_28&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="#loc_46_9_46_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_9_46_15&#39;)"><span class="hl_varref"><span class="mpre">pokeTo</span></span></a><span class="mpre"> (</span><a href="#loc_47_16_47_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_16_47_19&#39;)"><span class="hl_varref"><span class="mpre">ptr</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`plusPtr`</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">) </span><a href="#loc_47_29_47_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_29_47_31&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">

</span><a href="#loc_50_1_50_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_1_50_5&#39;)"><span class="mpre">be64</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Word64</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word64</span></span><span class="mpre">
</span><a name="loc_50_1_50_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_1_50_5&#39;)"><span class="hl_fundecl"><span class="mpre">be64</span></span></a><span class="mpre"> </span><a name="loc_50_6_50_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_6_50_7&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> =
        (</span><a href="#loc_50_6_50_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_6_50_7&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_226_5_226_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_226_5_226_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftR`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">56</span></span><span class="mpre">)                  </span><span class="hl_infix"><span class="mpre">.|.</span></span><span class="mpre"> (</span><a href="#loc_50_6_50_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_6_50_7&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_200_5_200_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_200_5_200_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftL`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">56</span></span><span class="mpre">)
    </span><span class="hl_infix"><span class="mpre">.|.</span></span><span class="mpre"> ((</span><a href="#loc_50_6_50_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_6_50_7&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_226_5_226_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_226_5_226_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftR`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">40</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xff00</span></span><span class="mpre">)     </span><span class="hl_infix"><span class="mpre">.|.</span></span><span class="mpre"> ((</span><a href="#loc_50_6_50_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_6_50_7&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xff00</span></span><span class="mpre">) </span><a href="Data.Bits.html#loc_200_5_200_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_200_5_200_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftL`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">40</span></span><span class="mpre">)
    </span><span class="hl_infix"><span class="mpre">.|.</span></span><span class="mpre"> ((</span><a href="#loc_50_6_50_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_6_50_7&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_226_5_226_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_226_5_226_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftR`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">24</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xff0000</span></span><span class="mpre">)   </span><span class="hl_infix"><span class="mpre">.|.</span></span><span class="mpre"> ((</span><a href="#loc_50_6_50_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_6_50_7&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xff0000</span></span><span class="mpre">) </span><a href="Data.Bits.html#loc_200_5_200_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_200_5_200_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftL`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">24</span></span><span class="mpre">)
    </span><span class="hl_infix"><span class="mpre">.|.</span></span><span class="mpre"> ((</span><a href="#loc_50_6_50_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_6_50_7&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_226_5_226_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_226_5_226_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftR`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">)  </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xff000000</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.|.</span></span><span class="mpre"> ((</span><a href="#loc_50_6_50_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_6_50_7&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.&amp;.</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0xff000000</span></span><span class="mpre">) </span><a href="Data.Bits.html#loc_200_5_200_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_200_5_200_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftL`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">)
#else
</span><span class="hl_comment"><span class="mpre">-- | convert a 8 byte bytestring to a little endian word64</span></span><span class="mpre">
</span><a href="#loc_35_1_35_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_1_35_6&#39;)"><span class="mpre">toW64</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; </span><a href="Crypto.Cipher.DES.Primitive.html#loc_19_9_19_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.DES.Primitive.html#loc_19_9_19_14&#39;)"><span class="hl_tyconref"><span class="mpre">Block</span></span></a><span class="mpre">
</span><span class="hl_fundecl"><span class="mpre">toW64</span></span><span class="mpre"> </span><a name="loc_58_7_58_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_7_58_9&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> = </span><a href="Crypto.Cipher.DES.Primitive.html#loc_19_17_19_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.DES.Primitive.html#loc_19_17_19_22&#39;)"><span class="hl_conref"><span class="mpre">Block</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> case </span><span class="hl_varref"><span class="mpre">B.unpack</span></span><span class="mpre"> </span><a href="#loc_58_7_58_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_7_58_9&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> of
            [</span><a name="loc_59_14_59_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_14_59_15&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">,</span><a name="loc_59_16_59_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_16_59_17&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">,</span><a name="loc_59_18_59_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_18_59_19&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">,</span><a name="loc_59_20_59_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_20_59_21&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre">,</span><a name="loc_59_22_59_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_22_59_23&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre">,</span><a name="loc_59_24_59_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_24_59_25&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre">,</span><a name="loc_59_26_59_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_26_59_27&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre">,</span><a name="loc_59_28_59_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_28_59_29&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="mpre">] -&gt; </span><a href="#loc_62_9_62_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_9_62_12&#39;)"><span class="hl_varref"><span class="mpre">shl</span></span></a><span class="mpre"> </span><a href="#loc_59_28_59_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_28_59_29&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">  </span><span class="hl_infix"><span class="mpre">.|.</span></span><span class="mpre"> </span><a href="#loc_62_9_62_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_9_62_12&#39;)"><span class="hl_varref"><span class="mpre">shl</span></span></a><span class="mpre"> </span><a href="#loc_59_26_59_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_26_59_27&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.|.</span></span><span class="mpre"> </span><a href="#loc_62_9_62_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_9_62_12&#39;)"><span class="hl_varref"><span class="mpre">shl</span></span></a><span class="mpre"> </span><a href="#loc_59_24_59_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_24_59_25&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">16</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.|.</span></span><span class="mpre"> </span><a href="#loc_62_9_62_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_9_62_12&#39;)"><span class="hl_varref"><span class="mpre">shl</span></span></a><span class="mpre"> </span><a href="#loc_59_22_59_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_22_59_23&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">24</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.|.</span></span><span class="mpre">
                                 </span><a href="#loc_62_9_62_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_9_62_12&#39;)"><span class="hl_varref"><span class="mpre">shl</span></span></a><span class="mpre"> </span><a href="#loc_59_20_59_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_20_59_21&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">32</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.|.</span></span><span class="mpre"> </span><a href="#loc_62_9_62_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_9_62_12&#39;)"><span class="hl_varref"><span class="mpre">shl</span></span></a><span class="mpre"> </span><a href="#loc_59_18_59_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_18_59_19&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">40</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.|.</span></span><span class="mpre"> </span><a href="#loc_62_9_62_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_9_62_12&#39;)"><span class="hl_varref"><span class="mpre">shl</span></span></a><span class="mpre"> </span><a href="#loc_59_16_59_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_16_59_17&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">48</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.|.</span></span><span class="mpre"> </span><a href="#loc_62_9_62_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_9_62_12&#39;)"><span class="hl_varref"><span class="mpre">shl</span></span></a><span class="mpre"> </span><a href="#loc_59_14_59_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_14_59_15&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">56</span></span><span class="mpre">
            _                 -&gt; </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
  where </span><a name="loc_62_9_62_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_9_62_12&#39;)"><span class="hl_fundecl"><span class="mpre">shl</span></span></a><span class="mpre"> </span><a name="loc_62_13_62_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_13_62_14&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> </span><a name="loc_62_15_62_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_15_62_16&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_62_13_62_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_13_62_14&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_200_5_200_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_200_5_200_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftL`</span></span></a><span class="mpre"> </span><a href="#loc_62_15_62_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_15_62_16&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | convert a word64 to a bytestring in little endian format</span></span><span class="mpre">
</span><a href="#loc_39_1_39_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_1_39_5&#39;)"><span class="mpre">toBS</span></a><span class="mpre"> :: </span><a href="Crypto.Cipher.DES.Primitive.html#loc_19_9_19_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.DES.Primitive.html#loc_19_9_19_14&#39;)"><span class="hl_tyconref"><span class="mpre">Block</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">
</span><span class="hl_fundecl"><span class="mpre">toBS</span></span><span class="mpre"> (</span><a href="Crypto.Cipher.DES.Primitive.html#loc_19_17_19_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.DES.Primitive.html#loc_19_17_19_22&#39;)"><span class="hl_conref"><span class="mpre">Block</span></span></a><span class="mpre"> </span><a name="loc_66_13_66_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_13_66_14&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">B.pack</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><a href="#loc_67_9_67_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_9_67_12&#39;)"><span class="hl_varref"><span class="mpre">shr</span></span></a><span class="mpre"> </span><a href="#loc_66_13_66_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_13_66_14&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">) [</span><span class="hl_num"><span class="mpre">56</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">48</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">40</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">32</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">24</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">16</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">,</span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">]
  where </span><a name="loc_67_9_67_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_9_67_12&#39;)"><span class="hl_fundecl"><span class="mpre">shr</span></span></a><span class="mpre"> </span><a name="loc_67_13_67_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_13_67_14&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre"> </span><a name="loc_67_15_67_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_15_67_16&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> (</span><a href="#loc_67_13_67_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_13_67_14&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre"> </span><a href="Data.Bits.html#loc_226_5_226_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Bits.html#loc_226_5_226_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftR`</span></span></a><span class="mpre"> </span><a href="#loc_67_15_67_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_15_67_16&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Create a strict bytestring out of DES blocks</span></span><span class="mpre">
</span><a href="#loc_43_1_43_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_1_43_11&#39;)"><span class="mpre">unblockify</span></a><span class="mpre"> :: [</span><a href="Crypto.Cipher.DES.Primitive.html#loc_19_9_19_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.DES.Primitive.html#loc_19_9_19_14&#39;)"><span class="hl_tyconref"><span class="mpre">Block</span></span></a><span class="mpre">] -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">
</span><span class="hl_vardecl"><span class="mpre">unblockify</span></span><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">B.concat</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="#loc_39_1_39_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_1_39_5&#39;)"><span class="hl_varref"><span class="mpre">toBS</span></span></a><span class="mpre">
#endif

</span><span class="hl_comment"><span class="mpre">-- | create DES blocks from a strict bytestring</span></span><span class="mpre">
</span><a href="#loc_76_1_76_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_1_76_9&#39;)"><span class="mpre">blockify</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; [</span><a href="Crypto.Cipher.DES.Primitive.html#loc_19_9_19_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.DES.Primitive.html#loc_19_9_19_14&#39;)"><span class="hl_tyconref"><span class="mpre">Block</span></span></a><span class="mpre">]
</span><a name="loc_76_1_76_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_1_76_9&#39;)"><span class="hl_fundecl"><span class="mpre">blockify</span></span></a><span class="mpre"> </span><a name="loc_76_10_76_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_10_76_11&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> | </span><span class="hl_varref"><span class="mpre">B.null</span></span><span class="mpre"> </span><a href="#loc_76_10_76_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_10_76_11&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">  = []
           | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = let (</span><a name="loc_77_31_77_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_31_77_33&#39;)"><span class="hl_vardecl"><span class="mpre">s1</span></span></a><span class="mpre">,</span><a name="loc_77_34_77_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_34_77_36&#39;)"><span class="hl_vardecl"><span class="mpre">s2</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">B.splitAt</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre"> </span><a href="#loc_76_10_76_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_10_76_11&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
                          in </span><a href="#loc_35_1_35_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_1_35_6&#39;)"><span class="hl_varref"><span class="mpre">toW64</span></span></a><span class="mpre"> </span><a href="#loc_77_31_77_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_31_77_33&#39;)"><span class="hl_varref"><span class="mpre">s1</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_76_1_76_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_1_76_9&#39;)"><span class="hl_varref"><span class="mpre">blockify</span></span></a><span class="mpre"> </span><a href="#loc_77_34_77_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_34_77_36&#39;)"><span class="hl_varref"><span class="mpre">s2</span></span></a><span class="mpre">
</span></div></body></html>