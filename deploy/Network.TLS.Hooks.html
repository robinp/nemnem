<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      : Network.TLS.Context</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     : BSD-style</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  : Vincent Hanquez &lt;vincent@snarc.org&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   : experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability : unknown</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
module Network.TLS.Hooks
    ( Logging(..)
    , Hooks(..)
    , defaultHooks
    ) where

import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Hooks.hs&quot;, srcSpanStartLine = 14, srcSpanStartColumn = 18, srcSpanEndLine = 14, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> as B
import Network.TLS.Struct (</span><a href="Network.TLS.Struct.html#loc_157_6_157_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_157_6_157_12&#39;)"><a href="Network.TLS.Struct.html#loc_157_15_157_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_157_15_157_21&#39;)"><span class="mpre">Header</span></a></a><span class="mpre">, </span><a href="Network.TLS.Struct.html#loc_252_6_252_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_252_6_252_15&#39;)"><span class="mpre">Handshake</span></a><span class="mpre">(..))
import Network.TLS.X509 (</span><a href="Data.X509.CertificateChain.html#loc_21_9_21_25" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.CertificateChain.html#loc_21_9_21_25&#39;)"><span class="mpre">CertificateChain</span></a><span class="mpre">)
import Data.Default.Class

</span><span class="hl_comment"><span class="mpre">-- | Hooks for logging</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This is called when sending and receiving packets and IO</span></span><span class="mpre">
data </span><a name="loc_22_6_22_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_6_22_13&#39;)"><span class="hl_tycondecl"><span class="mpre">Logging</span></span></a><span class="mpre"> = </span><span class="hl_condecl"><span class="mpre">Logging</span></span><span class="mpre">
    { </span><a name="loc_23_7_23_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_7_23_24&#39;)"><span class="hl_fielddecl"><span class="mpre">loggingPacketSent</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
    , </span><a name="loc_24_7_24_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_7_24_24&#39;)"><span class="hl_fielddecl"><span class="mpre">loggingPacketRecv</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
    , </span><a name="loc_25_7_25_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_7_25_20&#39;)"><span class="hl_fielddecl"><span class="mpre">loggingIOSent</span></span></a><span class="mpre">     :: </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
    , </span><a name="loc_26_7_26_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_7_26_20&#39;)"><span class="hl_fielddecl"><span class="mpre">loggingIORecv</span></span></a><span class="mpre">     :: </span><a href="Network.TLS.Struct.html#loc_157_6_157_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_157_6_157_12&#39;)"><span class="hl_tyconref"><span class="mpre">Header</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
    }

</span><a href="#loc_30_1_30_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_1_30_15&#39;)"><span class="mpre">defaultLogging</span></a><span class="mpre"> :: </span><a href="#loc_22_6_22_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_6_22_13&#39;)"><span class="hl_tyconref"><span class="mpre">Logging</span></span></a><span class="mpre">
</span><a name="loc_30_1_30_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_1_30_15&#39;)"><span class="hl_vardecl"><span class="mpre">defaultLogging</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Hooks.hs&quot;, srcSpanStartLine = 30, srcSpanStartColumn = 18, srcSpanEndLine = 35, srcSpanEndColumn = 6}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Hooks.hs&quot;, srcSpanStartLine = 31, srcSpanStartColumn = 5, srcSpanEndLine = 31, srcSpanEndColumn = 6},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Hooks.hs&quot;, srcSpanStartLine = 32, srcSpanSt"><span class="mpre">Logging
    { loggingPacketSent = (\_ -&gt; return ())
    , loggingPacketRecv = (\_ -&gt; return ())
    , loggingIOSent     = (\_ -&gt; return ())
    , loggingIORecv     = (\_ _ -&gt; return ())
    }</span></span><span class="mpre">

instance </span><a href="Data.Default.Class.html#loc_38_7_38_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Default.Class.html#loc_38_7_38_14&#39;)"><span class="hl_classref"><span class="mpre">Default</span></span></a><span class="mpre"> </span><a href="#loc_22_6_22_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_6_22_13&#39;)"><span class="hl_tyconref"><span class="mpre">Logging</span></span></a><span class="mpre"> where
    </span><a href="Data.Default.Class.html#loc_40_5_40_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Default.Class.html#loc_40_5_40_8&#39;)"><span class="hl_vardecl"><span class="mpre">def</span></span></a><span class="mpre"> = </span><a href="#loc_30_1_30_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_1_30_15&#39;)"><span class="hl_varref"><span class="mpre">defaultLogging</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | A collection of hooks actions.</span></span><span class="mpre">
data </span><a name="loc_41_6_41_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_6_41_11&#39;)"><span class="hl_tycondecl"><span class="mpre">Hooks</span></span></a><span class="mpre"> = </span><span class="hl_condecl"><span class="mpre">Hooks</span></span><span class="mpre">
    { </span><span class="hl_comment"><span class="mpre">-- | called at each handshake message received</span></span><span class="mpre">
      </span><a name="loc_43_7_43_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_7_43_24&#39;)"><span class="hl_fielddecl"><span class="mpre">hookRecvHandshake</span></span></a><span class="mpre">    :: </span><a href="Network.TLS.Struct.html#loc_252_6_252_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_252_6_252_15&#39;)"><span class="hl_tyconref"><span class="mpre">Handshake</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><a href="Network.TLS.Struct.html#loc_252_6_252_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_252_6_252_15&#39;)"><span class="hl_tyconref"><span class="mpre">Handshake</span></span></a><span class="mpre">
      </span><span class="hl_comment"><span class="mpre">-- | called at each certificate chain message received</span></span><span class="mpre">
    , </span><a name="loc_45_7_45_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_7_45_27&#39;)"><span class="hl_fielddecl"><span class="mpre">hookRecvCertificates</span></span></a><span class="mpre"> :: </span><a href="Data.X509.CertificateChain.html#loc_21_9_21_25" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.CertificateChain.html#loc_21_9_21_25&#39;)"><span class="hl_tyconref"><span class="mpre">CertificateChain</span></span></a><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
      </span><span class="hl_comment"><span class="mpre">-- | hooks on IO and packets, receiving and sending.</span></span><span class="mpre">
    , </span><a name="loc_47_7_47_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_7_47_18&#39;)"><span class="hl_fielddecl"><span class="mpre">hookLogging</span></span></a><span class="mpre">          :: </span><a href="#loc_22_6_22_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_6_22_13&#39;)"><span class="hl_tyconref"><span class="mpre">Logging</span></span></a><span class="mpre">
    }

</span><a href="#loc_51_1_51_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_1_51_13&#39;)"><span class="mpre">defaultHooks</span></a><span class="mpre"> :: </span><a href="#loc_41_6_41_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_6_41_11&#39;)"><span class="hl_tyconref"><span class="mpre">Hooks</span></span></a><span class="mpre">
</span><a name="loc_51_1_51_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_1_51_13&#39;)"><span class="hl_vardecl"><span class="mpre">defaultHooks</span></span></a><span class="mpre"> = </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Hooks.hs&quot;, srcSpanStartLine = 51, srcSpanStartColumn = 16, srcSpanEndLine = 55, srcSpanEndColumn = 6}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Hooks.hs&quot;, srcSpanStartLine = 52, srcSpanStartColumn = 5, srcSpanEndLine = 52, srcSpanEndColumn = 6},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Hooks.hs&quot;, srcSpanStartLine = 53, srcSpanSt"><span class="mpre">Hooks
    { hookRecvHandshake    = \hs -&gt; return hs
    , hookRecvCertificates = return . const ()
    , hookLogging          = def
    }</span></span><span class="mpre">

instance </span><a href="Data.Default.Class.html#loc_38_7_38_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Default.Class.html#loc_38_7_38_14&#39;)"><span class="hl_classref"><span class="mpre">Default</span></span></a><span class="mpre"> </span><a href="#loc_41_6_41_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_6_41_11&#39;)"><span class="hl_tyconref"><span class="mpre">Hooks</span></span></a><span class="mpre"> where
    </span><a href="Data.Default.Class.html#loc_40_5_40_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Default.Class.html#loc_40_5_40_8&#39;)"><span class="hl_vardecl"><span class="mpre">def</span></span></a><span class="mpre"> = </span><a href="#loc_51_1_51_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_1_51_13&#39;)"><span class="hl_varref"><span class="mpre">defaultHooks</span></span></a><span class="mpre">
</span></div></body></html>