<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-- | Generic stream manipulations</span></span><span class="mpre">

{-# LANGUAGE BangPatterns       #-}
{-# LANGUAGE DeriveDataTypeable #-}

module System.IO.Streams.Combinators
 ( </span><span class="hl_comment"><span class="mpre">-- * Folds</span></span><span class="mpre">
   inputFoldM
 , outputFoldM
 , fold
 , foldM
 , any
 , all
 , maximum
 , minimum

   </span><span class="hl_comment"><span class="mpre">-- * Unfolds</span></span><span class="mpre">
 , unfoldM

   </span><span class="hl_comment"><span class="mpre">-- * Maps</span></span><span class="mpre">
 , map
 , mapM
 , mapM_
 , contramap
 , contramapM
 , contramapM_

   </span><span class="hl_comment"><span class="mpre">-- * Filter</span></span><span class="mpre">
 , filter
 , filterM
 , filterOutput
 , filterOutputM

   </span><span class="hl_comment"><span class="mpre">-- * Takes and drops</span></span><span class="mpre">
 , give
 , take
 , drop
 , ignore

   </span><span class="hl_comment"><span class="mpre">-- * Zip and unzip</span></span><span class="mpre">
 , zip
 , zipWith
 , zipWithM
 , unzip

   </span><span class="hl_comment"><span class="mpre">-- * Utility</span></span><span class="mpre">
 , intersperse
 , skipToEof
 , ignoreEof
 , atEndOfInput
 , atEndOfOutput
 ) where

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
import           Control.Concurrent.MVar    (</span><a href="GHC.MVar.html#loc_70_1_70_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.MVar.html#loc_70_1_70_8&#39;)"><span class="mpre">newMVar</span></a><span class="mpre">, </span><a href="Control.Concurrent.MVar.html#loc_185_1_185_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Concurrent.MVar.html#loc_185_1_185_9&#39;)"><span class="mpre">withMVar</span></a><span class="mpre">)
import           Control.Monad              (</span><a href="Control.Monad.html#loc_274_1_274_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_274_1_274_6&#39;)"><span class="mpre">liftM</span></a><span class="mpre">, </span><a href="Control.Monad.html#loc_195_1_195_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_195_1_195_5&#39;)"><span class="mpre">void</span></a><span class="mpre">, </span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="mpre">when</span></a><span class="mpre">)
import           Control.Monad.IO.Class     (</span><a href="Control.Monad.IO.Class.html#loc_32_5_32_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.IO.Class.html#loc_32_5_32_11&#39;)"><span class="mpre">liftIO</span></a><span class="mpre">)
import           Data.Int                   (</span><a href="GHC.Int.html#loc_551_30_551_35" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Int.html#loc_551_30_551_35&#39;)"><span class="mpre">Int64</span></a><span class="mpre">)
import           Data.IORef                 (</span><a href="Data.IORef.html#loc_101_1_101_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.IORef.html#loc_101_1_101_18&#39;)"><span class="mpre">atomicModifyIORef</span></a><span class="mpre">, </span><a href="Data.IORef.html#loc_70_1_70_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.IORef.html#loc_70_1_70_12&#39;)"><span class="mpre">modifyIORef</span></a><span class="mpre">, </span><a href="GHC.IORef.html#loc_42_1_42_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_42_1_42_9&#39;)"><span class="mpre">newIORef</span></a><span class="mpre">, </span><a href="GHC.IORef.html#loc_46_1_46_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_46_1_46_10&#39;)"><span class="mpre">readIORef</span></a><span class="mpre">, </span><a href="GHC.IORef.html#loc_50_1_50_11" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_50_1_50_11&#39;)"><span class="mpre">writeIORef</span></a><span class="mpre">)
import           Data.Maybe                 (</span><a href="Data.Maybe.html#loc_80_1_80_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_80_1_80_7&#39;)"><span class="mpre">isJust</span></a><span class="mpre">)
import           Prelude                    hiding (all, any, drop, filter, map, </span><a href="Control.Monad.html#loc_111_1_111_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_111_1_111_5&#39;)"><span class="mpre">mapM</span></a><span class="mpre">, </span><a href="Control.Monad.html#loc_116_1_116_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_116_1_116_6&#39;)"><span class="mpre">mapM_</span></a><span class="mpre">, </span><a href="Data.List.html#loc_523_1_523_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_523_1_523_8&#39;)"><span class="mpre">maximum</span></a><span class="mpre">, </span><a href="Data.List.html#loc_544_1_544_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_544_1_544_8&#39;)"><span class="mpre">minimum</span></a><span class="mpre">, </span><a href="Text.Read.html#loc_91_1_91_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Text.Read.html#loc_91_1_91_5&#39;)"><span class="mpre">read</span></a><span class="mpre">, take, unzip, zip, zipWith)
</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
import           System.IO.Streams.Internal (</span><a href="System.IO.Streams.Internal.html#loc_107_6_107_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_107_6_107_17&#39;)"><span class="mpre">InputStream</span></a><span class="mpre"> (..), </span><a href="System.IO.Streams.Internal.html#loc_126_6_126_18" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_126_6_126_18&#39;)"><span class="mpre">OutputStream</span></a><span class="mpre">, </span><a href="System.IO.Streams.Internal.html#loc_599_1_599_14" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_599_1_599_14&#39;)"><span class="mpre">fromGenerator</span></a><span class="mpre">, </span><a href="System.IO.Streams.Internal.html#loc_247_1_247_16" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_247_1_247_16&#39;)"><span class="mpre">makeInputStream</span></a><span class="mpre">, </span><a href="System.IO.Streams.Internal.html#loc_273_1_273_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_273_1_273_17&#39;)"><span class="mpre">makeOutputStream</span></a><span class="mpre">, </span><a href="System.IO.Streams.Internal.html#loc_137_1_137_5" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_137_1_137_5&#39;)"><span class="mpre">read</span></a><span class="mpre">, </span><a href="System.IO.Streams.Internal.html#loc_178_1_178_7" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_178_1_178_7&#39;)"><span class="mpre">unRead</span></a><span class="mpre">, </span><a href="System.IO.Streams.Internal.html#loc_147_1_147_6" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_147_1_147_6&#39;)"><span class="mpre">write</span></a><span class="mpre">, </span><a href="System.IO.Streams.Internal.html#loc_593_1_593_6" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_593_1_593_6&#39;)"><span class="mpre">yield</span></a><span class="mpre">)


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | A side-effecting fold over an &#39;OutputStream&#39;, as a stream transformer.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The IO action returned by &#39;outputFoldM&#39; can be used to fetch the updated</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- seed value. Example:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ghci&gt; is &lt;- Streams.&#39;System.IO.Streams.List.fromList&#39; [1, 2, 3::Int]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ghci&gt; (os, getList) &lt;- Streams.&#39;System.IO.Streams.List.listOutputStream&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ghci&gt; (os&#39;, getSeed) \&lt;- Streams.&#39;outputFoldM&#39; (\\x y -&gt; return (x+y)) 0 os</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ghci&gt; Streams.&#39;System.IO.Streams.connect&#39; is os&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ghci&gt; getList</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- [1,2,3]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ghci&gt; getSeed</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- 6</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><a href="#loc_88_1_88_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_1_88_12&#39;)"><span class="mpre">outputFoldM</span></a><span class="mpre"> :: (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)           </span><span class="hl_comment"><span class="mpre">-- ^ fold function</span></span><span class="mpre">
            -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">                          </span><span class="hl_comment"><span class="mpre">-- ^ initial seed</span></span><span class="mpre">
            -&gt; </span><a href="System.IO.Streams.Internal.html#loc_126_6_126_18" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_126_6_126_18&#39;)"><span class="hl_tyconref"><span class="mpre">OutputStream</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">             </span><span class="hl_comment"><span class="mpre">-- ^ output stream</span></span><span class="mpre">
            -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="System.IO.Streams.Internal.html#loc_126_6_126_18" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_126_6_126_18&#39;)"><span class="hl_tyconref"><span class="mpre">OutputStream</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)  </span><span class="hl_comment"><span class="mpre">-- ^ returns a new stream as well as</span></span><span class="mpre">
                                          </span><span class="hl_comment"><span class="mpre">-- an IO action to fetch the updated</span></span><span class="mpre">
                                          </span><span class="hl_comment"><span class="mpre">-- seed value.</span></span><span class="mpre">
</span><a name="loc_88_1_88_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_1_88_12&#39;)"><span class="hl_fundecl"><span class="mpre">outputFoldM</span></span></a><span class="mpre"> </span><a name="loc_88_13_88_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_13_88_14&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_88_15_88_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_15_88_22&#39;)"><span class="hl_vardecl"><span class="mpre">initial</span></span></a><span class="mpre"> </span><a name="loc_88_23_88_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_23_88_29&#39;)"><span class="hl_vardecl"><span class="mpre">stream</span></span></a><span class="mpre"> = do
    </span><a name="loc_89_5_89_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_5_89_8&#39;)"><span class="hl_vardecl"><span class="mpre">ref</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IORef.html#loc_42_1_42_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_42_1_42_9&#39;)"><span class="hl_varref"><span class="mpre">newIORef</span></span></a><span class="mpre"> </span><a href="#loc_88_15_88_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_15_88_22&#39;)"><span class="hl_varref"><span class="mpre">initial</span></span></a><span class="mpre">
    </span><a name="loc_90_5_90_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_5_90_7&#39;)"><span class="hl_vardecl"><span class="mpre">os</span></span></a><span class="mpre">  &lt;- </span><a href="System.IO.Streams.Internal.html#loc_273_1_273_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_273_1_273_17&#39;)"><span class="hl_varref"><span class="mpre">makeOutputStream</span></span></a><span class="mpre"> (</span><a href="#loc_94_5_94_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_5_94_7&#39;)"><span class="hl_varref"><span class="mpre">wr</span></span></a><span class="mpre"> </span><a href="#loc_89_5_89_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_5_89_8&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre">)
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_90_5_90_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_5_90_7&#39;)"><span class="hl_varref"><span class="mpre">os</span></span></a><span class="mpre">, </span><a href="#loc_101_5_101_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_5_101_10&#39;)"><span class="hl_varref"><span class="mpre">fetch</span></span></a><span class="mpre"> </span><a href="#loc_89_5_89_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_5_89_8&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre">)

  where
    </span><a name="loc_94_5_94_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_5_94_7&#39;)"><span class="hl_fundecl"><span class="mpre">wr</span></span></a><span class="mpre"> _ </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">       = </span><a href="System.IO.Streams.Internal.html#loc_147_1_147_6" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_147_1_147_6&#39;)"><span class="hl_varref"><span class="mpre">write</span></span></a><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> </span><a href="#loc_88_23_88_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_23_88_29&#39;)"><span class="hl_varref"><span class="mpre">stream</span></span></a><span class="mpre">
    </span><a href="#loc_94_5_94_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_5_94_7&#39;)"><span class="hl_fundecl"><span class="mpre">wr</span></span></a><span class="mpre"> </span><a name="loc_95_8_95_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_8_95_11&#39;)"><span class="hl_vardecl"><span class="mpre">ref</span></span></a><span class="mpre"> </span><a name="loc_95_12_95_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_12_95_14&#39;)"><span class="hl_specname"><span class="mpre">mb</span></span></a><span class="mpre">@(</span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a name="loc_95_21_95_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_21_95_22&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">) = do
        !</span><a name="loc_96_10_96_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_10_96_11&#39;)"><span class="hl_vardecl"><span class="mpre">z</span></span></a><span class="mpre">  &lt;- </span><a href="GHC.IORef.html#loc_46_1_46_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_46_1_46_10&#39;)"><span class="hl_varref"><span class="mpre">readIORef</span></span></a><span class="mpre"> </span><a href="#loc_95_8_95_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_8_95_11&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre">
        !</span><a name="loc_97_10_97_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_10_97_12&#39;)"><span class="hl_vardecl"><span class="mpre">z&#39;</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_88_13_88_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_13_88_14&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_96_10_96_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_10_96_11&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre"> </span><a href="#loc_95_21_95_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_21_95_22&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
        </span><a href="GHC.IORef.html#loc_50_1_50_11" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_50_1_50_11&#39;)"><span class="hl_varref"><span class="mpre">writeIORef</span></span></a><span class="mpre"> </span><a href="#loc_95_8_95_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_8_95_11&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre"> </span><a href="#loc_97_10_97_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_10_97_12&#39;)"><span class="hl_varref"><span class="mpre">z&#39;</span></span></a><span class="mpre">
        </span><a href="System.IO.Streams.Internal.html#loc_147_1_147_6" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_147_1_147_6&#39;)"><span class="hl_varref"><span class="mpre">write</span></span></a><span class="mpre"> </span><a href="#loc_95_12_95_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_95_12_95_14&#39;)"><span class="hl_varref"><span class="mpre">mb</span></span></a><span class="mpre"> </span><a href="#loc_88_23_88_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_23_88_29&#39;)"><span class="hl_varref"><span class="mpre">stream</span></span></a><span class="mpre">

    </span><a name="loc_101_5_101_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_5_101_10&#39;)"><span class="hl_fundecl"><span class="mpre">fetch</span></span></a><span class="mpre"> </span><a name="loc_101_11_101_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_11_101_14&#39;)"><span class="hl_vardecl"><span class="mpre">ref</span></span></a><span class="mpre"> = </span><a href="Data.IORef.html#loc_101_1_101_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.IORef.html#loc_101_1_101_18&#39;)"><span class="hl_varref"><span class="mpre">atomicModifyIORef</span></span></a><span class="mpre"> </span><a href="#loc_101_11_101_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_11_101_14&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_101_42_101_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_42_101_43&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> -&gt; (</span><a href="#loc_88_15_88_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_15_88_22&#39;)"><span class="hl_varref"><span class="mpre">initial</span></span></a><span class="mpre">, </span><a href="#loc_101_42_101_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_42_101_43&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | A side-effecting fold over an &#39;InputStream&#39;, as a stream transformer.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The IO action returned by &#39;inputFoldM&#39; can be used to fetch the updated seed</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- value. Example:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ghci&gt; is &lt;- Streams.&#39;System.IO.Streams.List.fromList&#39; [1, 2, 3::Int]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ghci&gt; (is&#39;, getSeed) \&lt;- Streams.&#39;inputFoldM&#39; (\\x y -&gt; return (x+y)) 0 is</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ghci&gt; Streams.&#39;System.IO.Streams.List.toList&#39; is&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- [1,2,3]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ghci&gt; getSeed</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- 6</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><a href="#loc_124_1_124_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_1_124_11&#39;)"><span class="mpre">inputFoldM</span></a><span class="mpre"> :: (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)          </span><span class="hl_comment"><span class="mpre">-- ^ fold function</span></span><span class="mpre">
           -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">                         </span><span class="hl_comment"><span class="mpre">-- ^ initial seed</span></span><span class="mpre">
           -&gt; </span><a href="System.IO.Streams.Internal.html#loc_107_6_107_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_107_6_107_17&#39;)"><span class="hl_tyconref"><span class="mpre">InputStream</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">             </span><span class="hl_comment"><span class="mpre">-- ^ input stream</span></span><span class="mpre">
           -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="System.IO.Streams.Internal.html#loc_107_6_107_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_107_6_107_17&#39;)"><span class="hl_tyconref"><span class="mpre">InputStream</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)  </span><span class="hl_comment"><span class="mpre">-- ^ returns a new stream as well as an</span></span><span class="mpre">
                                        </span><span class="hl_comment"><span class="mpre">-- IO action to fetch the updated seed</span></span><span class="mpre">
                                        </span><span class="hl_comment"><span class="mpre">-- value.</span></span><span class="mpre">
</span><a name="loc_124_1_124_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_1_124_11&#39;)"><span class="hl_fundecl"><span class="mpre">inputFoldM</span></span></a><span class="mpre"> </span><a name="loc_124_12_124_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_12_124_13&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_124_14_124_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_14_124_21&#39;)"><span class="hl_vardecl"><span class="mpre">initial</span></span></a><span class="mpre"> </span><a name="loc_124_22_124_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_22_124_28&#39;)"><span class="hl_vardecl"><span class="mpre">stream</span></span></a><span class="mpre"> = do
    </span><a name="loc_125_5_125_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_5_125_8&#39;)"><span class="hl_vardecl"><span class="mpre">ref</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IORef.html#loc_42_1_42_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_42_1_42_9&#39;)"><span class="hl_varref"><span class="mpre">newIORef</span></span></a><span class="mpre"> </span><a href="#loc_124_14_124_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_14_124_21&#39;)"><span class="hl_varref"><span class="mpre">initial</span></span></a><span class="mpre">
    </span><a name="loc_126_5_126_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_5_126_7&#39;)"><span class="hl_vardecl"><span class="mpre">is</span></span></a><span class="mpre">  &lt;- </span><a href="System.IO.Streams.Internal.html#loc_247_1_247_16" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_247_1_247_16&#39;)"><span class="hl_varref"><span class="mpre">makeInputStream</span></span></a><span class="mpre"> (</span><a href="#loc_138_5_138_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_5_138_7&#39;)"><span class="hl_varref"><span class="mpre">rd</span></span></a><span class="mpre"> </span><a href="#loc_125_5_125_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_5_125_8&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre">)
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_126_5_126_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_5_126_7&#39;)"><span class="hl_varref"><span class="mpre">is</span></span></a><span class="mpre">, </span><a href="#loc_140_5_140_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_5_140_10&#39;)"><span class="hl_varref"><span class="mpre">fetch</span></span></a><span class="mpre"> </span><a href="#loc_125_5_125_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_5_125_8&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre">)

  where
    </span><a name="loc_130_5_130_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_5_130_12&#39;)"><span class="hl_fundecl"><span class="mpre">twiddle</span></span></a><span class="mpre"> _ </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">

    </span><a href="#loc_130_5_130_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_5_130_12&#39;)"><span class="hl_fundecl"><span class="mpre">twiddle</span></span></a><span class="mpre"> </span><a name="loc_132_13_132_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_13_132_16&#39;)"><span class="hl_vardecl"><span class="mpre">ref</span></span></a><span class="mpre"> </span><a name="loc_132_17_132_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_17_132_19&#39;)"><span class="hl_specname"><span class="mpre">mb</span></span></a><span class="mpre">@(</span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a name="loc_132_26_132_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_26_132_27&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">) = do
        !</span><a name="loc_133_10_133_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_10_133_11&#39;)"><span class="hl_vardecl"><span class="mpre">z</span></span></a><span class="mpre">  &lt;- </span><a href="GHC.IORef.html#loc_46_1_46_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_46_1_46_10&#39;)"><span class="hl_varref"><span class="mpre">readIORef</span></span></a><span class="mpre"> </span><a href="#loc_132_13_132_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_13_132_16&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre">
        !</span><a name="loc_134_10_134_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_10_134_12&#39;)"><span class="hl_vardecl"><span class="mpre">z&#39;</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_124_12_124_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_12_124_13&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_133_10_133_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_10_133_11&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre"> </span><a href="#loc_132_26_132_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_26_132_27&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
        </span><a href="GHC.IORef.html#loc_50_1_50_11" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_50_1_50_11&#39;)"><span class="hl_varref"><span class="mpre">writeIORef</span></span></a><span class="mpre"> </span><a href="#loc_132_13_132_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_13_132_16&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre"> </span><a href="#loc_134_10_134_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_10_134_12&#39;)"><span class="hl_varref"><span class="mpre">z&#39;</span></span></a><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_132_17_132_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_17_132_19&#39;)"><span class="hl_varref"><span class="mpre">mb</span></span></a><span class="mpre">

    </span><a name="loc_138_5_138_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_5_138_7&#39;)"><span class="hl_fundecl"><span class="mpre">rd</span></span></a><span class="mpre"> </span><a name="loc_138_8_138_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_8_138_11&#39;)"><span class="hl_vardecl"><span class="mpre">ref</span></span></a><span class="mpre"> = </span><a href="System.IO.Streams.Internal.html#loc_137_1_137_5" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_137_1_137_5&#39;)"><span class="hl_varref"><span class="mpre">read</span></span></a><span class="mpre"> </span><a href="#loc_124_22_124_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_22_124_28&#39;)"><span class="hl_varref"><span class="mpre">stream</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="#loc_130_5_130_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_5_130_12&#39;)"><span class="hl_varref"><span class="mpre">twiddle</span></span></a><span class="mpre"> </span><a href="#loc_138_8_138_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_8_138_11&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre">

    </span><a name="loc_140_5_140_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_5_140_10&#39;)"><span class="hl_fundecl"><span class="mpre">fetch</span></span></a><span class="mpre"> </span><a name="loc_140_11_140_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_11_140_14&#39;)"><span class="hl_vardecl"><span class="mpre">ref</span></span></a><span class="mpre"> = </span><a href="Data.IORef.html#loc_101_1_101_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.IORef.html#loc_101_1_101_18&#39;)"><span class="hl_varref"><span class="mpre">atomicModifyIORef</span></span></a><span class="mpre"> </span><a href="#loc_140_11_140_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_11_140_14&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_140_42_140_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_42_140_43&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> -&gt; (</span><a href="#loc_124_14_124_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_14_124_21&#39;)"><span class="hl_varref"><span class="mpre">initial</span></span></a><span class="mpre">, </span><a href="#loc_140_42_140_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_42_140_43&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | A left fold over an input stream. The input stream is fully consumed. See</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;Prelude.foldl&#39;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Example:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ghci&gt; Streams.&#39;System.IO.Streams.fromList&#39; [1..10] &gt;&gt;= Streams.&#39;fold&#39; (+) 0</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- 55</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><a href="#loc_157_1_157_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_1_157_5&#39;)"><span class="mpre">fold</span></a><span class="mpre"> :: (</span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">)       </span><span class="hl_comment"><span class="mpre">-- ^ fold function</span></span><span class="mpre">
     -&gt; </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">                   </span><span class="hl_comment"><span class="mpre">-- ^ initial seed</span></span><span class="mpre">
     -&gt; </span><a href="System.IO.Streams.Internal.html#loc_107_6_107_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_107_6_107_17&#39;)"><span class="hl_tyconref"><span class="mpre">InputStream</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">       </span><span class="hl_comment"><span class="mpre">-- ^ input stream</span></span><span class="mpre">
     -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">
</span><a name="loc_157_1_157_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_1_157_5&#39;)"><span class="hl_fundecl"><span class="mpre">fold</span></span></a><span class="mpre"> </span><a name="loc_157_6_157_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_6_157_7&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_157_8_157_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_8_157_12&#39;)"><span class="hl_vardecl"><span class="mpre">seed</span></span></a><span class="mpre"> </span><a name="loc_157_13_157_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_13_157_19&#39;)"><span class="hl_vardecl"><span class="mpre">stream</span></span></a><span class="mpre"> = </span><a href="#loc_159_5_159_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_5_159_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_157_8_157_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_8_157_12&#39;)"><span class="hl_varref"><span class="mpre">seed</span></span></a><span class="mpre">
  where
    </span><a name="loc_159_5_159_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_5_159_7&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> !</span><a name="loc_159_9_159_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_9_159_10&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = </span><a href="System.IO.Streams.Internal.html#loc_137_1_137_5" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_137_1_137_5&#39;)"><span class="hl_varref"><span class="mpre">read</span></span></a><span class="mpre"> </span><a href="#loc_157_13_157_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_13_157_19&#39;)"><span class="hl_varref"><span class="mpre">stream</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_74_1_74_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_74_1_74_6&#39;)"><span class="hl_varref"><span class="mpre">maybe</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_159_9_159_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_9_159_10&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">) (</span><a href="#loc_159_5_159_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_5_159_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_157_6_157_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_6_157_7&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_159_9_159_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_9_159_10&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | A side-effecting left fold over an input stream. The input stream is fully</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- consumed. See &#39;Prelude.foldl&#39;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Example:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ghci&gt; Streams.&#39;System.IO.Streams.fromList&#39; [1..10] &gt;&gt;= Streams.&#39;foldM&#39; (\x y -&gt; &#39;return&#39; (x + y)) 0</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- 55</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><a href="#loc_176_1_176_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_1_176_6&#39;)"><span class="mpre">foldM</span></a><span class="mpre"> :: (</span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">)       </span><span class="hl_comment"><span class="mpre">-- ^ fold function</span></span><span class="mpre">
      -&gt; </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">                      </span><span class="hl_comment"><span class="mpre">-- ^ initial seed</span></span><span class="mpre">
      -&gt; </span><a href="System.IO.Streams.Internal.html#loc_107_6_107_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_107_6_107_17&#39;)"><span class="hl_tyconref"><span class="mpre">InputStream</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">          </span><span class="hl_comment"><span class="mpre">-- ^ input stream</span></span><span class="mpre">
      -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">
</span><a name="loc_176_1_176_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_1_176_6&#39;)"><span class="hl_fundecl"><span class="mpre">foldM</span></span></a><span class="mpre"> </span><a name="loc_176_7_176_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_7_176_8&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_176_9_176_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_9_176_13&#39;)"><span class="hl_vardecl"><span class="mpre">seed</span></span></a><span class="mpre"> </span><a name="loc_176_14_176_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_14_176_20&#39;)"><span class="hl_vardecl"><span class="mpre">stream</span></span></a><span class="mpre"> = </span><a href="#loc_178_5_178_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_5_178_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_176_9_176_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_9_176_13&#39;)"><span class="hl_varref"><span class="mpre">seed</span></span></a><span class="mpre">
  where
    </span><a name="loc_178_5_178_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_5_178_7&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> !</span><a name="loc_178_9_178_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_9_178_10&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = </span><a href="System.IO.Streams.Internal.html#loc_137_1_137_5" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_137_1_137_5&#39;)"><span class="hl_varref"><span class="mpre">read</span></span></a><span class="mpre"> </span><a href="#loc_176_14_176_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_14_176_20&#39;)"><span class="hl_varref"><span class="mpre">stream</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_74_1_74_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_74_1_74_6&#39;)"><span class="hl_varref"><span class="mpre">maybe</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_178_9_178_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_9_178_10&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">) ((</span><a href="#loc_178_5_178_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_5_178_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="Control.Monad.html#loc_92_3_92_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_92_3_92_6&#39;)"><span class="hl_infix"><span class="mpre">=&lt;&lt;</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_176_7_176_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_7_176_8&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_178_9_178_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_178_9_178_10&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | @any predicate stream@ returns &#39;True&#39; if any element in @stream@ matches</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the predicate.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;any&#39; consumes as few elements as possible, ending consumption if an element</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- satisfies the predicate.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ghci&gt; is &lt;- Streams.&#39;System.IO.Streams.List.fromList&#39; [1, 2, 3]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ghci&gt; Streams.&#39;System.IO.Streams.Combinators.any&#39; (&gt; 0) is    -- Consumes one element</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- True</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ghci&gt; Streams.&#39;System.IO.Streams.read&#39; is</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Just 2</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ghci&gt; Streams.&#39;System.IO.Streams.Combinators.any&#39; even is     -- Only 3 remains</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- False</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><a href="#loc_198_1_198_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_1_198_4&#39;)"><span class="mpre">any</span></a><span class="mpre"> :: (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">) -&gt; </span><a href="System.IO.Streams.Internal.html#loc_107_6_107_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_107_6_107_17&#39;)"><span class="hl_tyconref"><span class="mpre">InputStream</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_198_1_198_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_1_198_4&#39;)"><span class="hl_fundecl"><span class="mpre">any</span></span></a><span class="mpre"> </span><a name="loc_198_5_198_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_5_198_14&#39;)"><span class="hl_vardecl"><span class="mpre">predicate</span></span></a><span class="mpre"> </span><a name="loc_198_15_198_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_15_198_21&#39;)"><span class="hl_vardecl"><span class="mpre">stream</span></span></a><span class="mpre"> = </span><a href="#loc_200_5_200_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_5_200_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre">
  where
    </span><a name="loc_200_5_200_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_5_200_7&#39;)"><span class="hl_vardecl"><span class="mpre">go</span></span></a><span class="mpre"> = do
        </span><a name="loc_201_9_201_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_9_201_14&#39;)"><span class="hl_vardecl"><span class="mpre">mElem</span></span></a><span class="mpre"> &lt;- </span><a href="System.IO.Streams.Internal.html#loc_137_1_137_5" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_137_1_137_5&#39;)"><span class="hl_varref"><span class="mpre">read</span></span></a><span class="mpre"> </span><a href="#loc_198_15_198_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_15_198_21&#39;)"><span class="hl_varref"><span class="mpre">stream</span></span></a><span class="mpre">
        case </span><a href="#loc_201_9_201_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_201_9_201_14&#39;)"><span class="hl_varref"><span class="mpre">mElem</span></span></a><span class="mpre"> of
            </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
            </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a name="loc_204_18_204_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_18_204_19&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre">  -&gt; if </span><a href="#loc_198_5_198_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_198_5_198_14&#39;)"><span class="hl_varref"><span class="mpre">predicate</span></span></a><span class="mpre"> </span><a href="#loc_204_18_204_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_204_18_204_19&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre"> then </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre"> else </span><a href="#loc_200_5_200_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_200_5_200_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | @all predicate stream@ returns &#39;True&#39; if every element in @stream@ matches</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the predicate.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;all&#39; consumes as few elements as possible, ending consumption if any element</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- fails the predicate.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ghci&gt; is &lt;- Streams.&#39;System.IO.Streams.List.fromList&#39; [1, 2, 3]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ghci&gt; Streams.&#39;System.IO.Streams.Combinators.all&#39; (&lt; 0) is    -- Consumes one element</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- False</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ghci&gt; Streams.&#39;System.IO.Streams.read&#39; is</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Just 2</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ghci&gt; Streams.&#39;System.IO.Streams.Combinators.all&#39; odd is      -- Only 3 remains</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- True</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><a href="#loc_224_1_224_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_1_224_4&#39;)"><span class="mpre">all</span></a><span class="mpre"> :: (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">) -&gt; </span><a href="System.IO.Streams.Internal.html#loc_107_6_107_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_107_6_107_17&#39;)"><span class="hl_tyconref"><span class="mpre">InputStream</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">
</span><a name="loc_224_1_224_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_1_224_4&#39;)"><span class="hl_fundecl"><span class="mpre">all</span></span></a><span class="mpre"> </span><a name="loc_224_5_224_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_5_224_14&#39;)"><span class="hl_vardecl"><span class="mpre">predicate</span></span></a><span class="mpre"> </span><a name="loc_224_15_224_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_15_224_21&#39;)"><span class="hl_vardecl"><span class="mpre">stream</span></span></a><span class="mpre"> = </span><a href="#loc_226_5_226_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_5_226_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre">
  where
    </span><a name="loc_226_5_226_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_5_226_7&#39;)"><span class="hl_vardecl"><span class="mpre">go</span></span></a><span class="mpre"> = do
        </span><a name="loc_227_9_227_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_9_227_14&#39;)"><span class="hl_vardecl"><span class="mpre">mElem</span></span></a><span class="mpre"> &lt;- </span><a href="System.IO.Streams.Internal.html#loc_137_1_137_5" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_137_1_137_5&#39;)"><span class="hl_varref"><span class="mpre">read</span></span></a><span class="mpre"> </span><a href="#loc_224_15_224_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_15_224_21&#39;)"><span class="hl_varref"><span class="mpre">stream</span></span></a><span class="mpre">
        case </span><a href="#loc_227_9_227_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_227_9_227_14&#39;)"><span class="hl_varref"><span class="mpre">mElem</span></span></a><span class="mpre"> of
            </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
            </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a name="loc_230_18_230_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_18_230_19&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre">  -&gt; if </span><a href="#loc_224_5_224_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_224_5_224_14&#39;)"><span class="hl_varref"><span class="mpre">predicate</span></span></a><span class="mpre"> </span><a href="#loc_230_18_230_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_230_18_230_19&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre"> then </span><a href="#loc_226_5_226_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_226_5_226_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> else </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | @maximum stream@ returns the greatest element in @stream@ or &#39;Nothing&#39; if</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the stream is empty.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;maximum&#39; consumes the entire stream.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ghci&gt; is &lt;- Streams.&#39;System.IO.Streams.List.fromList&#39; [1, 2, 3]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ghci&gt; Streams.&#39;System.IO.Streams.Combinators.maximum&#39; is</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- 3</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ghci&gt; Streams.&#39;System.IO.Streams.read&#39; is     -- The stream is now empty</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Nothing</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><a href="#loc_247_1_247_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_247_1_247_8&#39;)"><span class="mpre">maximum</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxParen (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/io-streams-1.1.4.6/src/System/IO/Streams/Combinators.hs&quot;, srcSpanStartLine = 246, srcSpanStartColumn = 12, srcSpanEndLine = 246, srcSpanEndColumn = 22}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/io-streams-1.1.4.6/src/System/IO/Streams/Combinators.hs&quot;, srcSpanStartLine = 246, srcSpanStartColumn = 12, srcSpanEndLine = 246, srcSpanEndColumn = 13},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/io-streams"><span class="mpre">(Ord a) =&gt;</span></span><span class="mpre"> </span><a href="System.IO.Streams.Internal.html#loc_107_6_107_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_107_6_107_17&#39;)"><span class="hl_tyconref"><span class="mpre">InputStream</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
</span><a name="loc_247_1_247_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_247_1_247_8&#39;)"><span class="hl_fundecl"><span class="mpre">maximum</span></span></a><span class="mpre"> </span><a name="loc_247_9_247_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_247_9_247_15&#39;)"><span class="hl_vardecl"><span class="mpre">stream</span></span></a><span class="mpre"> = do
    </span><a name="loc_248_5_248_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_5_248_11&#39;)"><span class="hl_vardecl"><span class="mpre">mElem0</span></span></a><span class="mpre"> &lt;- </span><a href="System.IO.Streams.Internal.html#loc_137_1_137_5" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_137_1_137_5&#39;)"><span class="hl_varref"><span class="mpre">read</span></span></a><span class="mpre"> </span><a href="#loc_247_9_247_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_247_9_247_15&#39;)"><span class="hl_varref"><span class="mpre">stream</span></span></a><span class="mpre">
    case </span><a href="#loc_248_5_248_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_248_5_248_11&#39;)"><span class="hl_varref"><span class="mpre">mElem0</span></span></a><span class="mpre"> of
        </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">
        </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a name="loc_251_14_251_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_251_14_251_15&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre">  -&gt; </span><a href="#loc_253_5_253_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_253_5_253_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_251_14_251_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_251_14_251_15&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">
  where
    </span><a name="loc_253_5_253_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_253_5_253_7&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a name="loc_253_8_253_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_253_8_253_15&#39;)"><span class="hl_vardecl"><span class="mpre">oldElem</span></span></a><span class="mpre"> = do
        </span><a name="loc_254_9_254_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_9_254_14&#39;)"><span class="hl_vardecl"><span class="mpre">mElem</span></span></a><span class="mpre"> &lt;- </span><a href="System.IO.Streams.Internal.html#loc_137_1_137_5" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_137_1_137_5&#39;)"><span class="hl_varref"><span class="mpre">read</span></span></a><span class="mpre"> </span><a href="#loc_247_9_247_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_247_9_247_15&#39;)"><span class="hl_varref"><span class="mpre">stream</span></span></a><span class="mpre">
        case </span><a href="#loc_254_9_254_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_254_9_254_14&#39;)"><span class="hl_varref"><span class="mpre">mElem</span></span></a><span class="mpre"> of
            </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">      -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a href="#loc_253_8_253_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_253_8_253_15&#39;)"><span class="hl_varref"><span class="mpre">oldElem</span></span></a><span class="mpre">)
            </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a name="loc_257_18_257_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_257_18_257_25&#39;)"><span class="hl_vardecl"><span class="mpre">newElem</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_253_5_253_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_253_5_253_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">max</span></span><span class="mpre"> </span><a href="#loc_253_8_253_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_253_8_253_15&#39;)"><span class="hl_varref"><span class="mpre">oldElem</span></span></a><span class="mpre"> </span><a href="#loc_257_18_257_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_257_18_257_25&#39;)"><span class="hl_varref"><span class="mpre">newElem</span></span></a><span class="mpre">)


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | @minimum stream@ returns the greatest element in @stream@</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;minimum&#39; consumes the entire stream.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ghci&gt; is &lt;- Streams.&#39;System.IO.Streams.List.fromList&#39; [1, 2, 3]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ghci&gt; Streams.&#39;System.IO.Streams.Combinators.minimum&#39; is</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- 1</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ghci&gt; Streams.&#39;System.IO.Streams.read&#39; is    -- The stream is now empty</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Nothing</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><a href="#loc_273_1_273_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_273_1_273_8&#39;)"><span class="mpre">minimum</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxParen (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/io-streams-1.1.4.6/src/System/IO/Streams/Combinators.hs&quot;, srcSpanStartLine = 272, srcSpanStartColumn = 12, srcSpanEndLine = 272, srcSpanEndColumn = 22}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/io-streams-1.1.4.6/src/System/IO/Streams/Combinators.hs&quot;, srcSpanStartLine = 272, srcSpanStartColumn = 12, srcSpanEndLine = 272, srcSpanEndColumn = 13},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/io-streams"><span class="mpre">(Ord a) =&gt;</span></span><span class="mpre"> </span><a href="System.IO.Streams.Internal.html#loc_107_6_107_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_107_6_107_17&#39;)"><span class="hl_tyconref"><span class="mpre">InputStream</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
</span><a name="loc_273_1_273_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_273_1_273_8&#39;)"><span class="hl_fundecl"><span class="mpre">minimum</span></span></a><span class="mpre"> </span><a name="loc_273_9_273_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_273_9_273_15&#39;)"><span class="hl_vardecl"><span class="mpre">stream</span></span></a><span class="mpre"> = do
    </span><a name="loc_274_5_274_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_274_5_274_11&#39;)"><span class="hl_vardecl"><span class="mpre">mElem0</span></span></a><span class="mpre"> &lt;- </span><a href="System.IO.Streams.Internal.html#loc_137_1_137_5" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_137_1_137_5&#39;)"><span class="hl_varref"><span class="mpre">read</span></span></a><span class="mpre"> </span><a href="#loc_273_9_273_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_273_9_273_15&#39;)"><span class="hl_varref"><span class="mpre">stream</span></span></a><span class="mpre">
    case </span><a href="#loc_274_5_274_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_274_5_274_11&#39;)"><span class="hl_varref"><span class="mpre">mElem0</span></span></a><span class="mpre"> of
        </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">
        </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a name="loc_277_14_277_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_277_14_277_15&#39;)"><span class="hl_vardecl"><span class="mpre">e</span></span></a><span class="mpre">  -&gt; </span><a href="#loc_279_5_279_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_279_5_279_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_277_14_277_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_277_14_277_15&#39;)"><span class="hl_varref"><span class="mpre">e</span></span></a><span class="mpre">
  where
    </span><a name="loc_279_5_279_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_279_5_279_7&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a name="loc_279_8_279_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_279_8_279_15&#39;)"><span class="hl_vardecl"><span class="mpre">oldElem</span></span></a><span class="mpre"> = do
        </span><a name="loc_280_9_280_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_280_9_280_14&#39;)"><span class="hl_vardecl"><span class="mpre">mElem</span></span></a><span class="mpre"> &lt;- </span><a href="System.IO.Streams.Internal.html#loc_137_1_137_5" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_137_1_137_5&#39;)"><span class="hl_varref"><span class="mpre">read</span></span></a><span class="mpre"> </span><a href="#loc_273_9_273_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_273_9_273_15&#39;)"><span class="hl_varref"><span class="mpre">stream</span></span></a><span class="mpre">
        case </span><a href="#loc_280_9_280_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_280_9_280_14&#39;)"><span class="hl_varref"><span class="mpre">mElem</span></span></a><span class="mpre"> of
            </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">      -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a href="#loc_279_8_279_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_279_8_279_15&#39;)"><span class="hl_varref"><span class="mpre">oldElem</span></span></a><span class="mpre">)
            </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a name="loc_283_18_283_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_283_18_283_25&#39;)"><span class="hl_vardecl"><span class="mpre">newElem</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_279_5_279_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_279_5_279_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">min</span></span><span class="mpre"> </span><a href="#loc_279_8_279_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_279_8_279_15&#39;)"><span class="hl_varref"><span class="mpre">oldElem</span></span></a><span class="mpre"> </span><a href="#loc_283_18_283_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_283_18_283_25&#39;)"><span class="hl_varref"><span class="mpre">newElem</span></span></a><span class="mpre">)


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | @unfoldM f seed@ builds an &#39;InputStream&#39; from successively applying @f@ to</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the @seed@ value, continuing if @f@ produces &#39;Just&#39; and halting on</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- &#39;Nothing&#39;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ghci&gt; is \&lt;- Streams.&#39;System.IO.Streams.Combinators.unfoldM&#39; (\n -&gt; return $ if n &lt; 3 then Just (n, n + 1) else Nothing) 0</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ghci&gt; Streams.&#39;System.IO.Streams.List.toList&#39; is</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- [0,1,2]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><a href="#loc_297_1_297_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_297_1_297_8&#39;)"><span class="mpre">unfoldM</span></a><span class="mpre"> :: (</span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="Data.Maybe.html#loc_49_7_49_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_7_49_12&#39;)"><span class="hl_tyconref"><span class="mpre">Maybe</span></span></a><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">))) -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="System.IO.Streams.Internal.html#loc_107_6_107_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_107_6_107_17&#39;)"><span class="hl_tyconref"><span class="mpre">InputStream</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
</span><a name="loc_297_1_297_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_297_1_297_8&#39;)"><span class="hl_fundecl"><span class="mpre">unfoldM</span></span></a><span class="mpre"> </span><a name="loc_297_9_297_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_297_9_297_10&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_297_11_297_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_297_11_297_15&#39;)"><span class="hl_vardecl"><span class="mpre">seed</span></span></a><span class="mpre"> = </span><a href="System.IO.Streams.Internal.html#loc_599_1_599_14" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_599_1_599_14&#39;)"><span class="hl_varref"><span class="mpre">fromGenerator</span></span></a><span class="mpre"> (</span><a href="#loc_299_5_299_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_299_5_299_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_297_11_297_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_297_11_297_15&#39;)"><span class="hl_varref"><span class="mpre">seed</span></span></a><span class="mpre">)
  where
    </span><a name="loc_299_5_299_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_299_5_299_7&#39;)"><span class="hl_fundecl"><span class="mpre">go</span></span></a><span class="mpre"> </span><a name="loc_299_8_299_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_299_8_299_15&#39;)"><span class="hl_vardecl"><span class="mpre">oldSeed</span></span></a><span class="mpre"> = do
       </span><a name="loc_300_8_300_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_300_8_300_9&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> &lt;- </span><a href="Control.Monad.IO.Class.html#loc_32_5_32_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.IO.Class.html#loc_32_5_32_11&#39;)"><span class="hl_varref"><span class="mpre">liftIO</span></span></a><span class="mpre"> (</span><a href="#loc_297_9_297_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_297_9_297_10&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_299_8_299_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_299_8_299_15&#39;)"><span class="hl_varref"><span class="mpre">oldSeed</span></span></a><span class="mpre">)
       case </span><a href="#loc_300_8_300_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_300_8_300_9&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> of
           </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">           -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="Prelude.html#loc_160_3_160_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Prelude.html#loc_160_3_160_5&#39;)"><span class="hl_infix"><span class="mpre">$!</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">
           </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> (</span><a name="loc_303_18_303_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_303_18_303_19&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">, </span><a name="loc_303_21_303_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_303_21_303_28&#39;)"><span class="hl_vardecl"><span class="mpre">newSeed</span></span></a><span class="mpre">) -&gt; do
               </span><a href="System.IO.Streams.Internal.html#loc_593_1_593_6" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_593_1_593_6&#39;)"><span class="hl_varref"><span class="mpre">yield</span></span></a><span class="mpre"> </span><a href="#loc_303_18_303_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_303_18_303_19&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">
               </span><a href="#loc_299_5_299_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_299_5_299_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre"> </span><a href="#loc_303_21_303_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_303_21_303_28&#39;)"><span class="hl_varref"><span class="mpre">newSeed</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Maps a pure function over an &#39;InputStream&#39;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @map f s@ passes all output from @s@ through the function @f@.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Satisfies the following laws:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Streams.&#39;map&#39; (g . f) === Streams.&#39;map&#39; f &gt;=&gt; Streams.&#39;map&#39; g</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Streams.&#39;map&#39; &#39;id&#39; === Streams.&#39;makeInputStream&#39; . Streams.&#39;read&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><a href="#loc_319_1_319_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_319_1_319_4&#39;)"><span class="mpre">map</span></a><span class="mpre"> :: (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; </span><a href="System.IO.Streams.Internal.html#loc_107_6_107_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_107_6_107_17&#39;)"><span class="hl_tyconref"><span class="mpre">InputStream</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="System.IO.Streams.Internal.html#loc_107_6_107_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_107_6_107_17&#39;)"><span class="hl_tyconref"><span class="mpre">InputStream</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">)
</span><a name="loc_319_1_319_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_319_1_319_4&#39;)"><span class="hl_fundecl"><span class="mpre">map</span></span></a><span class="mpre"> </span><a name="loc_319_5_319_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_319_5_319_6&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_319_7_319_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_319_7_319_8&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = </span><a href="System.IO.Streams.Internal.html#loc_247_1_247_16" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_247_1_247_16&#39;)"><span class="hl_varref"><span class="mpre">makeInputStream</span></span></a><span class="mpre"> </span><a href="#loc_321_5_321_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_321_5_321_6&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">
  where
    </span><a name="loc_321_5_321_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_321_5_321_6&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> = </span><a href="System.IO.Streams.Internal.html#loc_137_1_137_5" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_137_1_137_5&#39;)"><span class="hl_varref"><span class="mpre">read</span></span></a><span class="mpre"> </span><a href="#loc_319_7_319_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_319_7_319_8&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> </span><a href="#loc_319_5_319_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_319_5_319_6&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Maps an impure function over an &#39;InputStream&#39;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @mapM f s@ passes all output from @s@ through the IO action @f@.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Satisfies the following laws:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Streams.&#39;mapM&#39; (f &gt;=&gt; g) === Streams.&#39;mapM&#39; f &gt;=&gt; Streams.&#39;mapM&#39; g</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Streams.&#39;mapM&#39; &#39;return&#39; === Streams.&#39;makeInputStream&#39; . Streams.&#39;read&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_337_1_337_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_337_1_337_5&#39;)"><span class="mpre">mapM</span></a><span class="mpre"> :: (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; </span><a href="System.IO.Streams.Internal.html#loc_107_6_107_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_107_6_107_17&#39;)"><span class="hl_tyconref"><span class="mpre">InputStream</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="System.IO.Streams.Internal.html#loc_107_6_107_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_107_6_107_17&#39;)"><span class="hl_tyconref"><span class="mpre">InputStream</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">)
</span><a name="loc_337_1_337_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_337_1_337_5&#39;)"><span class="hl_fundecl"><span class="mpre">mapM</span></span></a><span class="mpre"> </span><a name="loc_337_6_337_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_337_6_337_7&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_337_8_337_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_337_8_337_9&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = </span><a href="System.IO.Streams.Internal.html#loc_247_1_247_16" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_247_1_247_16&#39;)"><span class="hl_varref"><span class="mpre">makeInputStream</span></span></a><span class="mpre"> </span><a href="#loc_339_5_339_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_339_5_339_6&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">
  where
    </span><a name="loc_339_5_339_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_339_5_339_6&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> = do
        </span><a name="loc_340_9_340_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_340_9_340_11&#39;)"><span class="hl_vardecl"><span class="mpre">mb</span></span></a><span class="mpre"> &lt;- </span><a href="System.IO.Streams.Internal.html#loc_137_1_137_5" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_137_1_137_5&#39;)"><span class="hl_varref"><span class="mpre">read</span></span></a><span class="mpre"> </span><a href="#loc_337_8_337_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_337_8_337_9&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_74_1_74_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_74_1_74_6&#39;)"><span class="hl_varref"><span class="mpre">maybe</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">)
                               (\</span><a name="loc_341_34_341_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_341_34_341_35&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> -&gt; </span><a href="Control.Monad.html#loc_274_1_274_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_274_1_274_6&#39;)"><span class="hl_varref"><span class="mpre">liftM</span></span></a><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_337_6_337_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_337_6_337_7&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_341_34_341_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_341_34_341_35&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)

        </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_340_9_340_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_340_9_340_11&#39;)"><span class="hl_varref"><span class="mpre">mb</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Maps a side effect over an &#39;InputStream&#39;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @mapM_ f s@ produces a new input stream that passes all output from @s@</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- through the side-effecting IO action @f@.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Example:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ghci&gt; Streams.&#39;System.IO.Streams.fromList&#39; [1,2,3] &gt;&gt;=</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--       Streams.&#39;mapM_&#39; (&#39;putStrLn&#39; . &#39;show&#39; . (*2)) &gt;&gt;=</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--       Streams.&#39;System.IO.Streams.toList&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- 2</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- 4</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- 6</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- [1,2,3]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_365_1_365_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_365_1_365_6&#39;)"><span class="mpre">mapM_</span></a><span class="mpre"> :: (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; </span><a href="System.IO.Streams.Internal.html#loc_107_6_107_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_107_6_107_17&#39;)"><span class="hl_tyconref"><span class="mpre">InputStream</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="System.IO.Streams.Internal.html#loc_107_6_107_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_107_6_107_17&#39;)"><span class="hl_tyconref"><span class="mpre">InputStream</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
</span><a name="loc_365_1_365_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_365_1_365_6&#39;)"><span class="hl_fundecl"><span class="mpre">mapM_</span></span></a><span class="mpre"> </span><a name="loc_365_7_365_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_365_7_365_8&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_365_9_365_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_365_9_365_10&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = </span><a href="System.IO.Streams.Internal.html#loc_247_1_247_16" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_247_1_247_16&#39;)"><span class="hl_varref"><span class="mpre">makeInputStream</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
    </span><a name="loc_366_5_366_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_366_5_366_7&#39;)"><span class="hl_vardecl"><span class="mpre">mb</span></span></a><span class="mpre"> &lt;- </span><a href="System.IO.Streams.Internal.html#loc_137_1_137_5" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_137_1_137_5&#39;)"><span class="hl_varref"><span class="mpre">read</span></span></a><span class="mpre"> </span><a href="#loc_365_9_365_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_365_9_365_10&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
    _  &lt;- </span><a href="Data.Maybe.html#loc_74_1_74_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_74_1_74_6&#39;)"><span class="hl_varref"><span class="mpre">maybe</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="Prelude.html#loc_160_3_160_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Prelude.html#loc_160_3_160_5&#39;)"><span class="hl_infix"><span class="mpre">$!</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">) (</span><a href="Control.Monad.html#loc_195_1_195_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_195_1_195_5&#39;)"><span class="hl_varref"><span class="mpre">void</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_365_7_365_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_365_7_365_8&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">) </span><a href="#loc_366_5_366_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_366_5_366_7&#39;)"><span class="hl_varref"><span class="mpre">mb</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_366_5_366_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_366_5_366_7&#39;)"><span class="hl_varref"><span class="mpre">mb</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Contravariant counterpart to &#39;map&#39;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @contramap f s@ passes all input to @s@ through the function @f@.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Satisfies the following laws:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Streams.&#39;contramap&#39; (g . f) === Streams.&#39;contramap&#39; g &gt;=&gt; Streams.&#39;contramap&#39; f</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Streams.&#39;contramap&#39; &#39;id&#39; === &#39;return&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><a href="#loc_383_1_383_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_383_1_383_10&#39;)"><span class="mpre">contramap</span></a><span class="mpre"> :: (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; </span><a href="System.IO.Streams.Internal.html#loc_126_6_126_18" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_126_6_126_18&#39;)"><span class="hl_tyconref"><span class="mpre">OutputStream</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="System.IO.Streams.Internal.html#loc_126_6_126_18" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_126_6_126_18&#39;)"><span class="hl_tyconref"><span class="mpre">OutputStream</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
</span><a name="loc_383_1_383_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_383_1_383_10&#39;)"><span class="hl_fundecl"><span class="mpre">contramap</span></span></a><span class="mpre"> </span><a name="loc_383_11_383_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_383_11_383_12&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_383_13_383_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_383_13_383_14&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = </span><a href="System.IO.Streams.Internal.html#loc_273_1_273_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_273_1_273_17&#39;)"><span class="hl_varref"><span class="mpre">makeOutputStream</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">flip</span></span><span class="mpre"> </span><a href="System.IO.Streams.Internal.html#loc_147_1_147_6" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_147_1_147_6&#39;)"><span class="hl_varref"><span class="mpre">write</span></span></a><span class="mpre"> </span><a href="#loc_383_13_383_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_383_13_383_14&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fmap</span></span><span class="mpre"> </span><a href="#loc_383_11_383_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_383_11_383_12&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Contravariant counterpart to &#39;mapM&#39;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @contramapM f s@ passes all input to @s@ through the IO action @f@</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Satisfies the following laws:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Streams.&#39;contramapM&#39; (f &gt;=&gt; g) = Streams.&#39;contramapM&#39; g &gt;=&gt; Streams.&#39;contramapM&#39; f</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Streams.&#39;contramapM&#39; &#39;return&#39; = &#39;return&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><a href="#loc_398_1_398_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_398_1_398_11&#39;)"><span class="mpre">contramapM</span></a><span class="mpre"> :: (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; </span><a href="System.IO.Streams.Internal.html#loc_126_6_126_18" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_126_6_126_18&#39;)"><span class="hl_tyconref"><span class="mpre">OutputStream</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="System.IO.Streams.Internal.html#loc_126_6_126_18" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_126_6_126_18&#39;)"><span class="hl_tyconref"><span class="mpre">OutputStream</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
</span><a name="loc_398_1_398_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_398_1_398_11&#39;)"><span class="hl_fundecl"><span class="mpre">contramapM</span></span></a><span class="mpre"> </span><a name="loc_398_12_398_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_398_12_398_13&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_398_14_398_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_398_14_398_15&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = </span><a href="System.IO.Streams.Internal.html#loc_273_1_273_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_273_1_273_17&#39;)"><span class="hl_varref"><span class="mpre">makeOutputStream</span></span></a><span class="mpre"> </span><a href="#loc_400_5_400_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_400_5_400_6&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">
  where
    </span><a name="loc_400_5_400_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_400_5_400_6&#39;)"><span class="hl_fundecl"><span class="mpre">g</span></span></a><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> = </span><a href="System.IO.Streams.Internal.html#loc_147_1_147_6" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_147_1_147_6&#39;)"><span class="hl_varref"><span class="mpre">write</span></span></a><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> </span><a href="#loc_398_14_398_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_398_14_398_15&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">

    </span><a href="#loc_400_5_400_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_400_5_400_6&#39;)"><span class="hl_fundecl"><span class="mpre">g</span></span></a><span class="mpre"> (</span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a name="loc_402_13_402_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_402_13_402_14&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">) = do
        !</span><a name="loc_403_10_403_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_403_10_403_11&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_398_12_398_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_398_12_398_13&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_402_13_402_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_402_13_402_14&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
        </span><a href="System.IO.Streams.Internal.html#loc_147_1_147_6" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_147_1_147_6&#39;)"><span class="hl_varref"><span class="mpre">write</span></span></a><span class="mpre"> (</span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a href="#loc_403_10_403_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_403_10_403_11&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">) </span><a href="#loc_398_14_398_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_398_14_398_15&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Equivalent to &#39;mapM_&#39; for output.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @contramapM f s@ passes all input to @s@ through the side-effecting IO</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- action @f@.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_414_1_414_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_414_1_414_12&#39;)"><span class="mpre">contramapM_</span></a><span class="mpre"> :: (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; </span><a href="System.IO.Streams.Internal.html#loc_126_6_126_18" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_126_6_126_18&#39;)"><span class="hl_tyconref"><span class="mpre">OutputStream</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="System.IO.Streams.Internal.html#loc_126_6_126_18" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_126_6_126_18&#39;)"><span class="hl_tyconref"><span class="mpre">OutputStream</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
</span><a name="loc_414_1_414_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_414_1_414_12&#39;)"><span class="hl_fundecl"><span class="mpre">contramapM_</span></span></a><span class="mpre"> </span><a name="loc_414_13_414_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_414_13_414_14&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_414_15_414_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_414_15_414_16&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = </span><a href="System.IO.Streams.Internal.html#loc_273_1_273_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_273_1_273_17&#39;)"><span class="hl_varref"><span class="mpre">makeOutputStream</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_414_39_414_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_414_39_414_41&#39;)"><span class="hl_vardecl"><span class="mpre">mb</span></span></a><span class="mpre"> -&gt; do
    _ &lt;- </span><a href="Data.Maybe.html#loc_74_1_74_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_74_1_74_6&#39;)"><span class="hl_varref"><span class="mpre">maybe</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="Prelude.html#loc_160_3_160_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Prelude.html#loc_160_3_160_5&#39;)"><span class="hl_infix"><span class="mpre">$!</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">) (</span><a href="Control.Monad.html#loc_195_1_195_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_195_1_195_5&#39;)"><span class="hl_varref"><span class="mpre">void</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_414_13_414_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_414_13_414_14&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">) </span><a href="#loc_414_39_414_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_414_39_414_41&#39;)"><span class="hl_varref"><span class="mpre">mb</span></span></a><span class="mpre">
    </span><a href="System.IO.Streams.Internal.html#loc_147_1_147_6" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_147_1_147_6&#39;)"><span class="hl_varref"><span class="mpre">write</span></span></a><span class="mpre"> </span><a href="#loc_414_39_414_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_414_39_414_41&#39;)"><span class="hl_varref"><span class="mpre">mb</span></span></a><span class="mpre"> </span><a href="#loc_414_15_414_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_414_15_414_16&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Drives an &#39;InputStream&#39; to end-of-stream, discarding all of the yielded</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- values.</span></span><span class="mpre">
</span><a href="#loc_423_1_423_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_423_1_423_10&#39;)"><span class="mpre">skipToEof</span></a><span class="mpre"> :: </span><a href="System.IO.Streams.Internal.html#loc_107_6_107_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_107_6_107_17&#39;)"><span class="hl_tyconref"><span class="mpre">InputStream</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_423_1_423_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_423_1_423_10&#39;)"><span class="hl_fundecl"><span class="mpre">skipToEof</span></span></a><span class="mpre"> </span><a name="loc_423_11_423_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_423_11_423_14&#39;)"><span class="hl_vardecl"><span class="mpre">str</span></span></a><span class="mpre"> = </span><a href="#loc_425_5_425_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_425_5_425_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre">
  where
    </span><a name="loc_425_5_425_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_425_5_425_7&#39;)"><span class="hl_vardecl"><span class="mpre">go</span></span></a><span class="mpre"> = </span><a href="System.IO.Streams.Internal.html#loc_137_1_137_5" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_137_1_137_5&#39;)"><span class="hl_varref"><span class="mpre">read</span></span></a><span class="mpre"> </span><a href="#loc_423_11_423_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_423_11_423_14&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_74_1_74_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_74_1_74_6&#39;)"><span class="hl_varref"><span class="mpre">maybe</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="Prelude.html#loc_160_3_160_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Prelude.html#loc_160_3_160_5&#39;)"><span class="hl_infix"><span class="mpre">$!</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">const</span></span><span class="mpre"> </span><a href="#loc_425_5_425_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_425_5_425_7&#39;)"><span class="hl_varref"><span class="mpre">go</span></span></a><span class="mpre">)
</span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_423_1_423_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_423_1_423_10&#39;)"><span class="mpre">skipToEof</span></a><span class="mpre"> #-}</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Drops chunks from an input stream if they fail to match a given filter</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- predicate. See &#39;Prelude.filter&#39;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Items pushed back to the returned stream are propagated back upstream.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Example:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ghci&gt; Streams.&#39;System.IO.Streams.fromList&#39; [\&quot;the\&quot;, \&quot;quick\&quot;, \&quot;brown\&quot;, \&quot;fox\&quot;] &gt;&gt;=</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--       Streams.&#39;filterM&#39; (&#39;return&#39; . (/= \&quot;brown\&quot;)) &gt;&gt;= Streams.&#39;System.IO.Streams.toList&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- [\&quot;the\&quot;,\&quot;quick\&quot;,\&quot;fox\&quot;]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><a href="#loc_445_1_445_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_445_1_445_8&#39;)"><span class="mpre">filterM</span></a><span class="mpre"> :: (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">)
        -&gt; </span><a href="System.IO.Streams.Internal.html#loc_107_6_107_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_107_6_107_17&#39;)"><span class="hl_tyconref"><span class="mpre">InputStream</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
        -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="System.IO.Streams.Internal.html#loc_107_6_107_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_107_6_107_17&#39;)"><span class="hl_tyconref"><span class="mpre">InputStream</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
</span><a name="loc_445_1_445_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_445_1_445_8&#39;)"><span class="hl_fundecl"><span class="mpre">filterM</span></span></a><span class="mpre"> </span><a name="loc_445_9_445_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_445_9_445_10&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_445_11_445_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_445_11_445_14&#39;)"><span class="hl_vardecl"><span class="mpre">src</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="Prelude.html#loc_160_3_160_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Prelude.html#loc_160_3_160_5&#39;)"><span class="hl_infix"><span class="mpre">$!</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">InputStream</span></span><span class="mpre"> </span><a href="#loc_447_5_447_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_447_5_447_9&#39;)"><span class="hl_varref"><span class="mpre">prod</span></span></a><span class="mpre"> </span><a href="#loc_456_5_456_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_456_5_456_7&#39;)"><span class="hl_varref"><span class="mpre">pb</span></span></a><span class="mpre">
  where
    </span><a name="loc_447_5_447_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_447_5_447_9&#39;)"><span class="hl_vardecl"><span class="mpre">prod</span></span></a><span class="mpre"> = </span><a href="System.IO.Streams.Internal.html#loc_137_1_137_5" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_137_1_137_5&#39;)"><span class="hl_varref"><span class="mpre">read</span></span></a><span class="mpre"> </span><a href="#loc_445_11_445_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_445_11_445_14&#39;)"><span class="hl_varref"><span class="mpre">src</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_74_1_74_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_74_1_74_6&#39;)"><span class="hl_varref"><span class="mpre">maybe</span></span></a><span class="mpre"> </span><a href="#loc_454_5_454_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_454_5_454_8&#39;)"><span class="hl_varref"><span class="mpre">eof</span></span></a><span class="mpre"> </span><a href="#loc_449_5_449_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_449_5_449_10&#39;)"><span class="hl_varref"><span class="mpre">chunk</span></span></a><span class="mpre">

    </span><a name="loc_449_5_449_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_449_5_449_10&#39;)"><span class="hl_fundecl"><span class="mpre">chunk</span></span></a><span class="mpre"> </span><a name="loc_449_11_449_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_449_11_449_12&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = do
        </span><a name="loc_450_9_450_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_450_9_450_10&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_445_9_445_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_445_9_445_10&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_449_11_449_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_449_11_449_12&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
        if </span><a href="#loc_450_9_450_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_450_9_450_10&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> then </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="Prelude.html#loc_160_3_160_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Prelude.html#loc_160_3_160_5&#39;)"><span class="hl_infix"><span class="mpre">$!</span></span></a><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a href="#loc_449_11_449_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_449_11_449_12&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
             else </span><a href="#loc_447_5_447_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_447_5_447_9&#39;)"><span class="hl_varref"><span class="mpre">prod</span></span></a><span class="mpre">

    </span><a name="loc_454_5_454_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_454_5_454_8&#39;)"><span class="hl_vardecl"><span class="mpre">eof</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">

    </span><a name="loc_456_5_456_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_456_5_456_7&#39;)"><span class="hl_fundecl"><span class="mpre">pb</span></span></a><span class="mpre"> </span><a name="loc_456_8_456_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_456_8_456_9&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = </span><a href="System.IO.Streams.Internal.html#loc_178_1_178_7" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_178_1_178_7&#39;)"><span class="hl_varref"><span class="mpre">unRead</span></span></a><span class="mpre"> </span><a href="#loc_456_8_456_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_456_8_456_9&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><a href="#loc_445_11_445_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_445_11_445_14&#39;)"><span class="hl_varref"><span class="mpre">src</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Drops chunks from an input stream if they fail to match a given filter</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- predicate. See &#39;Prelude.filter&#39;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Items pushed back to the returned stream are propagated back upstream.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Example:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ghci&gt; Streams.&#39;System.IO.Streams.fromList&#39; [\&quot;the\&quot;, \&quot;quick\&quot;, \&quot;brown\&quot;, \&quot;fox\&quot;] &gt;&gt;=</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--       Streams.&#39;filter&#39; (/= \&quot;brown\&quot;) &gt;&gt;= Streams.&#39;System.IO.Streams.toList&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- [\&quot;the\&quot;,\&quot;quick\&quot;,\&quot;fox\&quot;]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><a href="#loc_475_1_475_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_475_1_475_7&#39;)"><span class="mpre">filter</span></a><span class="mpre"> :: (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">)
       -&gt; </span><a href="System.IO.Streams.Internal.html#loc_107_6_107_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_107_6_107_17&#39;)"><span class="hl_tyconref"><span class="mpre">InputStream</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
       -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="System.IO.Streams.Internal.html#loc_107_6_107_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_107_6_107_17&#39;)"><span class="hl_tyconref"><span class="mpre">InputStream</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
</span><a name="loc_475_1_475_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_475_1_475_7&#39;)"><span class="hl_fundecl"><span class="mpre">filter</span></span></a><span class="mpre"> </span><a name="loc_475_8_475_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_475_8_475_9&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_475_10_475_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_475_10_475_13&#39;)"><span class="hl_vardecl"><span class="mpre">src</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="Prelude.html#loc_160_3_160_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Prelude.html#loc_160_3_160_5&#39;)"><span class="hl_infix"><span class="mpre">$!</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">InputStream</span></span><span class="mpre"> </span><a href="#loc_477_5_477_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_477_5_477_9&#39;)"><span class="hl_varref"><span class="mpre">prod</span></span></a><span class="mpre"> </span><a href="#loc_485_5_485_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_485_5_485_7&#39;)"><span class="hl_varref"><span class="mpre">pb</span></span></a><span class="mpre">
  where
    </span><a name="loc_477_5_477_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_477_5_477_9&#39;)"><span class="hl_vardecl"><span class="mpre">prod</span></span></a><span class="mpre"> = </span><a href="System.IO.Streams.Internal.html#loc_137_1_137_5" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_137_1_137_5&#39;)"><span class="hl_varref"><span class="mpre">read</span></span></a><span class="mpre"> </span><a href="#loc_475_10_475_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_475_10_475_13&#39;)"><span class="hl_varref"><span class="mpre">src</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_74_1_74_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_74_1_74_6&#39;)"><span class="hl_varref"><span class="mpre">maybe</span></span></a><span class="mpre"> </span><a href="#loc_484_5_484_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_484_5_484_8&#39;)"><span class="hl_varref"><span class="mpre">eof</span></span></a><span class="mpre"> </span><a href="#loc_479_5_479_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_479_5_479_10&#39;)"><span class="hl_varref"><span class="mpre">chunk</span></span></a><span class="mpre">

    </span><a name="loc_479_5_479_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_479_5_479_10&#39;)"><span class="hl_fundecl"><span class="mpre">chunk</span></span></a><span class="mpre"> </span><a name="loc_479_11_479_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_479_11_479_12&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = do
        let </span><a name="loc_480_13_480_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_480_13_480_14&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> = </span><a href="#loc_475_8_475_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_475_8_475_9&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_479_11_479_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_479_11_479_12&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
        if </span><a href="#loc_480_13_480_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_480_13_480_14&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> then </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="Prelude.html#loc_160_3_160_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Prelude.html#loc_160_3_160_5&#39;)"><span class="hl_infix"><span class="mpre">$!</span></span></a><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a href="#loc_479_11_479_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_479_11_479_12&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
             else </span><a href="#loc_477_5_477_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_477_5_477_9&#39;)"><span class="hl_varref"><span class="mpre">prod</span></span></a><span class="mpre">

    </span><a name="loc_484_5_484_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_484_5_484_8&#39;)"><span class="hl_vardecl"><span class="mpre">eof</span></span></a><span class="mpre">  = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">
    </span><a name="loc_485_5_485_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_485_5_485_7&#39;)"><span class="hl_fundecl"><span class="mpre">pb</span></span></a><span class="mpre"> </span><a name="loc_485_8_485_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_485_8_485_9&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = </span><a href="System.IO.Streams.Internal.html#loc_178_1_178_7" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_178_1_178_7&#39;)"><span class="hl_varref"><span class="mpre">unRead</span></span></a><span class="mpre"> </span><a href="#loc_485_8_485_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_485_8_485_9&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><a href="#loc_475_10_475_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_475_10_475_13&#39;)"><span class="hl_varref"><span class="mpre">src</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | The function @intersperse v s@ wraps the &#39;OutputStream&#39; @s@, creating a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- new output stream that writes its input to @s@ interspersed with the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- provided value @v@. See &#39;Data.List.intersperse&#39;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Example:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ghci&gt; import Control.Monad ((&gt;=&gt;))</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ghci&gt; is &lt;- Streams.&#39;System.IO.Streams.List.fromList&#39; [\&quot;nom\&quot;, \&quot;nom\&quot;, \&quot;nom\&quot;::&#39;ByteString&#39;]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ghci&gt; Streams.&#39;System.IO.Streams.List.outputToList&#39; (Streams.&#39;intersperse&#39; \&quot;burp!\&quot; &gt;=&gt; Streams.&#39;System.IO.Streams.connect&#39; is)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- [\&quot;nom\&quot;,\&quot;burp!\&quot;,\&quot;nom\&quot;,\&quot;burp!\&quot;,\&quot;nom\&quot;]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><a href="#loc_502_1_502_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_502_1_502_12&#39;)"><span class="mpre">intersperse</span></a><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="System.IO.Streams.Internal.html#loc_126_6_126_18" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_126_6_126_18&#39;)"><span class="hl_tyconref"><span class="mpre">OutputStream</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="System.IO.Streams.Internal.html#loc_126_6_126_18" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_126_6_126_18&#39;)"><span class="hl_tyconref"><span class="mpre">OutputStream</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
</span><a name="loc_502_1_502_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_502_1_502_12&#39;)"><span class="hl_fundecl"><span class="mpre">intersperse</span></span></a><span class="mpre"> </span><a name="loc_502_13_502_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_502_13_502_16&#39;)"><span class="hl_vardecl"><span class="mpre">sep</span></span></a><span class="mpre"> </span><a name="loc_502_17_502_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_502_17_502_19&#39;)"><span class="hl_vardecl"><span class="mpre">os</span></span></a><span class="mpre"> = </span><a href="GHC.IORef.html#loc_42_1_42_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_42_1_42_9&#39;)"><span class="hl_varref"><span class="mpre">newIORef</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="System.IO.Streams.Internal.html#loc_273_1_273_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_273_1_273_17&#39;)"><span class="hl_varref"><span class="mpre">makeOutputStream</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_504_5_504_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_504_5_504_6&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">
  where
    </span><a name="loc_504_5_504_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_504_5_504_6&#39;)"><span class="hl_fundecl"><span class="mpre">f</span></span></a><span class="mpre"> _ </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> = </span><a href="System.IO.Streams.Internal.html#loc_147_1_147_6" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_147_1_147_6&#39;)"><span class="hl_varref"><span class="mpre">write</span></span></a><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> </span><a href="#loc_502_17_502_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_502_17_502_19&#39;)"><span class="hl_varref"><span class="mpre">os</span></span></a><span class="mpre">
    </span><a href="#loc_504_5_504_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_504_5_504_6&#39;)"><span class="hl_fundecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_505_7_505_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_505_7_505_14&#39;)"><span class="hl_vardecl"><span class="mpre">sendRef</span></span></a><span class="mpre"> </span><a name="loc_505_15_505_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_505_15_505_16&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">    = do
        </span><a name="loc_506_9_506_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_506_9_506_10&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IORef.html#loc_46_1_46_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_46_1_46_10&#39;)"><span class="hl_varref"><span class="mpre">readIORef</span></span></a><span class="mpre"> </span><a href="#loc_505_7_505_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_505_7_505_14&#39;)"><span class="hl_varref"><span class="mpre">sendRef</span></span></a><span class="mpre">
        </span><a href="GHC.IORef.html#loc_50_1_50_11" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_50_1_50_11&#39;)"><span class="hl_varref"><span class="mpre">writeIORef</span></span></a><span class="mpre"> </span><a href="#loc_505_7_505_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_505_7_505_14&#39;)"><span class="hl_varref"><span class="mpre">sendRef</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
        </span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="hl_varref"><span class="mpre">when</span></span></a><span class="mpre"> </span><a href="#loc_506_9_506_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_506_9_506_10&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="System.IO.Streams.Internal.html#loc_147_1_147_6" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_147_1_147_6&#39;)"><span class="hl_varref"><span class="mpre">write</span></span></a><span class="mpre"> (</span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a href="#loc_502_13_502_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_502_13_502_16&#39;)"><span class="hl_varref"><span class="mpre">sep</span></span></a><span class="mpre">) </span><a href="#loc_502_17_502_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_502_17_502_19&#39;)"><span class="hl_varref"><span class="mpre">os</span></span></a><span class="mpre">
        </span><a href="System.IO.Streams.Internal.html#loc_147_1_147_6" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_147_1_147_6&#39;)"><span class="hl_varref"><span class="mpre">write</span></span></a><span class="mpre"> </span><a href="#loc_505_15_505_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_505_15_505_16&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><a href="#loc_502_17_502_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_502_17_502_19&#39;)"><span class="hl_varref"><span class="mpre">os</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Combines two input streams. Continues yielding elements from both input</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- streams until one of them finishes.</span></span><span class="mpre">
</span><a href="#loc_516_1_516_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_516_1_516_4&#39;)"><span class="mpre">zip</span></a><span class="mpre"> :: </span><a href="System.IO.Streams.Internal.html#loc_107_6_107_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_107_6_107_17&#39;)"><span class="hl_tyconref"><span class="mpre">InputStream</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="System.IO.Streams.Internal.html#loc_107_6_107_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_107_6_107_17&#39;)"><span class="hl_tyconref"><span class="mpre">InputStream</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="System.IO.Streams.Internal.html#loc_107_6_107_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_107_6_107_17&#39;)"><span class="hl_tyconref"><span class="mpre">InputStream</span></span></a><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">))
</span><a name="loc_516_1_516_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_516_1_516_4&#39;)"><span class="hl_fundecl"><span class="mpre">zip</span></span></a><span class="mpre"> </span><a name="loc_516_5_516_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_516_5_516_9&#39;)"><span class="hl_vardecl"><span class="mpre">src1</span></span></a><span class="mpre"> </span><a name="loc_516_10_516_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_516_10_516_14&#39;)"><span class="hl_vardecl"><span class="mpre">src2</span></span></a><span class="mpre"> = </span><a href="System.IO.Streams.Internal.html#loc_247_1_247_16" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_247_1_247_16&#39;)"><span class="hl_varref"><span class="mpre">makeInputStream</span></span></a><span class="mpre"> </span><a href="#loc_518_5_518_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_518_5_518_8&#39;)"><span class="hl_varref"><span class="mpre">src</span></span></a><span class="mpre">
  where
    </span><a name="loc_518_5_518_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_518_5_518_8&#39;)"><span class="hl_vardecl"><span class="mpre">src</span></span></a><span class="mpre"> = </span><a href="System.IO.Streams.Internal.html#loc_137_1_137_5" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_137_1_137_5&#39;)"><span class="hl_varref"><span class="mpre">read</span></span></a><span class="mpre"> </span><a href="#loc_516_5_516_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_516_5_516_9&#39;)"><span class="hl_varref"><span class="mpre">src1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> (</span><a href="Data.Maybe.html#loc_74_1_74_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_74_1_74_6&#39;)"><span class="hl_varref"><span class="mpre">maybe</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_518_52_518_53" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_518_52_518_53&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> -&gt;
            </span><a href="System.IO.Streams.Internal.html#loc_137_1_137_5" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_137_1_137_5&#39;)"><span class="hl_varref"><span class="mpre">read</span></span></a><span class="mpre"> </span><a href="#loc_516_10_516_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_516_10_516_14&#39;)"><span class="hl_varref"><span class="mpre">src2</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> (</span><a href="Data.Maybe.html#loc_74_1_74_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_74_1_74_6&#39;)"><span class="hl_varref"><span class="mpre">maybe</span></span></a><span class="mpre"> (</span><a href="System.IO.Streams.Internal.html#loc_178_1_178_7" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_178_1_178_7&#39;)"><span class="hl_varref"><span class="mpre">unRead</span></span></a><span class="mpre"> </span><a href="#loc_518_52_518_53" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_518_52_518_53&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><a href="#loc_516_5_516_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_516_5_516_9&#39;)"><span class="hl_varref"><span class="mpre">src1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_519_71_519_72" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_519_71_519_72&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> -&gt;
              </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="Prelude.html#loc_160_3_160_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Prelude.html#loc_160_3_160_5&#39;)"><span class="hl_infix"><span class="mpre">$!</span></span></a><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a href="Prelude.html#loc_160_3_160_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Prelude.html#loc_160_3_160_5&#39;)"><span class="hl_infix"><span class="mpre">$!</span></span></a><span class="mpre"> (</span><a href="#loc_518_52_518_53" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_518_52_518_53&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">, </span><a href="#loc_519_71_519_72" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_519_71_519_72&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">)))


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Combines two input streams using the supplied function. Continues yielding</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- elements from both input streams until one of them finishes.</span></span><span class="mpre">
</span><a href="#loc_530_1_530_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_530_1_530_8&#39;)"><span class="mpre">zipWith</span></a><span class="mpre"> :: (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">c</span></span><span class="mpre">)
        -&gt; </span><a href="System.IO.Streams.Internal.html#loc_107_6_107_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_107_6_107_17&#39;)"><span class="hl_tyconref"><span class="mpre">InputStream</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
        -&gt; </span><a href="System.IO.Streams.Internal.html#loc_107_6_107_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_107_6_107_17&#39;)"><span class="hl_tyconref"><span class="mpre">InputStream</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">
        -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="System.IO.Streams.Internal.html#loc_107_6_107_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_107_6_107_17&#39;)"><span class="hl_tyconref"><span class="mpre">InputStream</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">c</span></span><span class="mpre">)
</span><a name="loc_530_1_530_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_530_1_530_8&#39;)"><span class="hl_fundecl"><span class="mpre">zipWith</span></span></a><span class="mpre"> </span><a name="loc_530_9_530_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_530_9_530_10&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_530_11_530_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_530_11_530_15&#39;)"><span class="hl_vardecl"><span class="mpre">src1</span></span></a><span class="mpre"> </span><a name="loc_530_16_530_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_530_16_530_20&#39;)"><span class="hl_vardecl"><span class="mpre">src2</span></span></a><span class="mpre"> = </span><a href="System.IO.Streams.Internal.html#loc_247_1_247_16" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_247_1_247_16&#39;)"><span class="hl_varref"><span class="mpre">makeInputStream</span></span></a><span class="mpre"> </span><a href="#loc_532_5_532_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_532_5_532_8&#39;)"><span class="hl_varref"><span class="mpre">src</span></span></a><span class="mpre">
  where
    </span><a name="loc_532_5_532_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_532_5_532_8&#39;)"><span class="hl_vardecl"><span class="mpre">src</span></span></a><span class="mpre"> = </span><a href="System.IO.Streams.Internal.html#loc_137_1_137_5" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_137_1_137_5&#39;)"><span class="hl_varref"><span class="mpre">read</span></span></a><span class="mpre"> </span><a href="#loc_530_11_530_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_530_11_530_15&#39;)"><span class="hl_varref"><span class="mpre">src1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> (</span><a href="Data.Maybe.html#loc_74_1_74_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_74_1_74_6&#39;)"><span class="hl_varref"><span class="mpre">maybe</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_532_52_532_53" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_532_52_532_53&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> -&gt;
            </span><a href="System.IO.Streams.Internal.html#loc_137_1_137_5" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_137_1_137_5&#39;)"><span class="hl_varref"><span class="mpre">read</span></span></a><span class="mpre"> </span><a href="#loc_530_16_530_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_530_16_530_20&#39;)"><span class="hl_varref"><span class="mpre">src2</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> (</span><a href="Data.Maybe.html#loc_74_1_74_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_74_1_74_6&#39;)"><span class="hl_varref"><span class="mpre">maybe</span></span></a><span class="mpre"> (</span><a href="System.IO.Streams.Internal.html#loc_178_1_178_7" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_178_1_178_7&#39;)"><span class="hl_varref"><span class="mpre">unRead</span></span></a><span class="mpre"> </span><a href="#loc_532_52_532_53" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_532_52_532_53&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><a href="#loc_530_11_530_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_530_11_530_15&#39;)"><span class="hl_varref"><span class="mpre">src1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_533_71_533_72" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_533_71_533_72&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> -&gt;
              </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="Prelude.html#loc_160_3_160_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Prelude.html#loc_160_3_160_5&#39;)"><span class="hl_infix"><span class="mpre">$!</span></span></a><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a href="Prelude.html#loc_160_3_160_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Prelude.html#loc_160_3_160_5&#39;)"><span class="hl_infix"><span class="mpre">$!</span></span></a><span class="mpre"> </span><a href="#loc_530_9_530_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_530_9_530_10&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_532_52_532_53" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_532_52_532_53&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><a href="#loc_533_71_533_72" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_533_71_533_72&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> ) )


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Combines two input streams using the supplied monadic function. Continues</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- yielding elements from both input streams until one of them finishes.</span></span><span class="mpre">
</span><a href="#loc_544_1_544_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_544_1_544_9&#39;)"><span class="mpre">zipWithM</span></a><span class="mpre"> :: (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">c</span></span><span class="mpre">)
         -&gt; </span><a href="System.IO.Streams.Internal.html#loc_107_6_107_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_107_6_107_17&#39;)"><span class="hl_tyconref"><span class="mpre">InputStream</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
         -&gt; </span><a href="System.IO.Streams.Internal.html#loc_107_6_107_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_107_6_107_17&#39;)"><span class="hl_tyconref"><span class="mpre">InputStream</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">
         -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="System.IO.Streams.Internal.html#loc_107_6_107_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_107_6_107_17&#39;)"><span class="hl_tyconref"><span class="mpre">InputStream</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">c</span></span><span class="mpre">)
</span><a name="loc_544_1_544_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_544_1_544_9&#39;)"><span class="hl_fundecl"><span class="mpre">zipWithM</span></span></a><span class="mpre"> </span><a name="loc_544_10_544_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_544_10_544_11&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_544_12_544_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_544_12_544_16&#39;)"><span class="hl_vardecl"><span class="mpre">src1</span></span></a><span class="mpre"> </span><a name="loc_544_17_544_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_544_17_544_21&#39;)"><span class="hl_vardecl"><span class="mpre">src2</span></span></a><span class="mpre"> = </span><a href="System.IO.Streams.Internal.html#loc_247_1_247_16" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_247_1_247_16&#39;)"><span class="hl_varref"><span class="mpre">makeInputStream</span></span></a><span class="mpre"> </span><a href="#loc_546_5_546_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_546_5_546_8&#39;)"><span class="hl_varref"><span class="mpre">src</span></span></a><span class="mpre">
  where
    </span><a name="loc_546_5_546_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_546_5_546_8&#39;)"><span class="hl_vardecl"><span class="mpre">src</span></span></a><span class="mpre"> = </span><a href="System.IO.Streams.Internal.html#loc_137_1_137_5" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_137_1_137_5&#39;)"><span class="hl_varref"><span class="mpre">read</span></span></a><span class="mpre"> </span><a href="#loc_544_12_544_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_544_12_544_16&#39;)"><span class="hl_varref"><span class="mpre">src1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> (</span><a href="Data.Maybe.html#loc_74_1_74_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_74_1_74_6&#39;)"><span class="hl_varref"><span class="mpre">maybe</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_546_52_546_53" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_546_52_546_53&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre"> -&gt;
            </span><a href="System.IO.Streams.Internal.html#loc_137_1_137_5" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_137_1_137_5&#39;)"><span class="hl_varref"><span class="mpre">read</span></span></a><span class="mpre"> </span><a href="#loc_544_17_544_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_544_17_544_21&#39;)"><span class="hl_varref"><span class="mpre">src2</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> (</span><a href="Data.Maybe.html#loc_74_1_74_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_74_1_74_6&#39;)"><span class="hl_varref"><span class="mpre">maybe</span></span></a><span class="mpre"> (</span><a href="System.IO.Streams.Internal.html#loc_178_1_178_7" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_178_1_178_7&#39;)"><span class="hl_varref"><span class="mpre">unRead</span></span></a><span class="mpre"> </span><a href="#loc_546_52_546_53" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_546_52_546_53&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><a href="#loc_544_12_544_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_544_12_544_16&#39;)"><span class="hl_varref"><span class="mpre">src1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_547_71_547_72" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_547_71_547_72&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> -&gt;
              </span><a href="#loc_544_10_544_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_544_10_544_11&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_546_52_546_53" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_546_52_546_53&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre"> </span><a href="#loc_547_71_547_72" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_547_71_547_72&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> \</span><a name="loc_548_26_548_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_548_26_548_27&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="Prelude.html#loc_160_3_160_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Prelude.html#loc_160_3_160_5&#39;)"><span class="hl_infix"><span class="mpre">$!</span></span></a><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a href="Prelude.html#loc_160_3_160_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Prelude.html#loc_160_3_160_5&#39;)"><span class="hl_infix"><span class="mpre">$!</span></span></a><span class="mpre"> </span><a href="#loc_548_26_548_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_548_26_548_27&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> ) )


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Filters output to be sent to the given &#39;OutputStream&#39; using a pure</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- function. See &#39;filter&#39;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Example:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ghci&gt; import qualified &quot;Data.ByteString.Char8&quot; as S</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ghci&gt; os1 \&lt;- Streams.&#39;System.IO.Streams.stdout&#39; &gt;&gt;= Streams.&#39;System.IO.Streams.unlines</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ghci&gt; os2 \&lt;- os1 &gt;&gt;= Streams.&#39;contramap&#39; (S.pack . show) &gt;&gt;= Streams.&#39;filterOutput&#39; even</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ghci&gt; Streams.&#39;write&#39; (Just 3) os2</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ghci&gt; Streams.&#39;write&#39; (Just 4) os2</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- 4</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">{- Note: The example is a lie, because unlines has weird behavior -}</span></span><span class="mpre">
</span><a href="#loc_567_1_567_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_567_1_567_13&#39;)"><span class="mpre">filterOutput</span></a><span class="mpre"> :: (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">) -&gt; </span><a href="System.IO.Streams.Internal.html#loc_126_6_126_18" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_126_6_126_18&#39;)"><span class="hl_tyconref"><span class="mpre">OutputStream</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="System.IO.Streams.Internal.html#loc_126_6_126_18" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_126_6_126_18&#39;)"><span class="hl_tyconref"><span class="mpre">OutputStream</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
</span><a name="loc_567_1_567_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_567_1_567_13&#39;)"><span class="hl_fundecl"><span class="mpre">filterOutput</span></span></a><span class="mpre"> </span><a name="loc_567_14_567_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_567_14_567_15&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_567_16_567_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_567_16_567_22&#39;)"><span class="hl_vardecl"><span class="mpre">output</span></span></a><span class="mpre"> = </span><a href="System.IO.Streams.Internal.html#loc_273_1_273_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_273_1_273_17&#39;)"><span class="hl_varref"><span class="mpre">makeOutputStream</span></span></a><span class="mpre"> </span><a href="#loc_569_5_569_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_569_5_569_10&#39;)"><span class="hl_varref"><span class="mpre">chunk</span></span></a><span class="mpre">
  where
    </span><a name="loc_569_5_569_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_569_5_569_10&#39;)"><span class="hl_fundecl"><span class="mpre">chunk</span></span></a><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">  = </span><a href="System.IO.Streams.Internal.html#loc_147_1_147_6" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_147_1_147_6&#39;)"><span class="hl_varref"><span class="mpre">write</span></span></a><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> </span><a href="#loc_567_16_567_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_567_16_567_22&#39;)"><span class="hl_varref"><span class="mpre">output</span></span></a><span class="mpre">
    </span><a href="#loc_569_5_569_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_569_5_569_10&#39;)"><span class="hl_fundecl"><span class="mpre">chunk</span></span></a><span class="mpre"> </span><a name="loc_570_11_570_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_570_11_570_13&#39;)"><span class="hl_specname"><span class="mpre">ch</span></span></a><span class="mpre">@(</span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a name="loc_570_20_570_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_570_20_570_21&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">) = </span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="hl_varref"><span class="mpre">when</span></span></a><span class="mpre"> (</span><a href="#loc_567_14_567_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_567_14_567_15&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_570_20_570_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_570_20_570_21&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="System.IO.Streams.Internal.html#loc_147_1_147_6" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_147_1_147_6&#39;)"><span class="hl_varref"><span class="mpre">write</span></span></a><span class="mpre"> </span><a href="#loc_570_11_570_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_570_11_570_13&#39;)"><span class="hl_varref"><span class="mpre">ch</span></span></a><span class="mpre"> </span><a href="#loc_567_16_567_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_567_16_567_22&#39;)"><span class="hl_varref"><span class="mpre">output</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Filters output to be sent to the given &#39;OutputStream&#39; using a predicate</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- function in IO. See &#39;filterM&#39;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Example:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ghci&gt; let check a = putStrLn a (&quot;Allow &quot; ++ show a ++ &quot;?&quot;) &gt;&gt; readLn :: IO Bool</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ghci&gt; import qualified Data.ByteString.Char8 as S</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ghci&gt; os1 &lt;- Streams.&#39;System.IO.Streams.unlines&#39; Streams.&#39;System.IO.Streams.stdout&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ghci&gt; os2 \&lt;- os1 &gt;&gt;= Streams.&#39;contramap&#39; (S.pack . show) &gt;&gt;= Streams.&#39;filterOutputM&#39; check</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ghci&gt; Streams.&#39;System.IO.Streams.write&#39; (Just 3) os2</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Allow 3?</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- False\&lt;Enter&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ghci&gt; Streams.&#39;System.IO.Streams.write&#39; (Just 4) os2</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Allow 4?</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- True\&lt;Enter&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- 4</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><a href="#loc_593_1_593_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_593_1_593_14&#39;)"><span class="mpre">filterOutputM</span></a><span class="mpre"> :: (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre">) -&gt; </span><a href="System.IO.Streams.Internal.html#loc_126_6_126_18" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_126_6_126_18&#39;)"><span class="hl_tyconref"><span class="mpre">OutputStream</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="System.IO.Streams.Internal.html#loc_126_6_126_18" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_126_6_126_18&#39;)"><span class="hl_tyconref"><span class="mpre">OutputStream</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
</span><a name="loc_593_1_593_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_593_1_593_14&#39;)"><span class="hl_fundecl"><span class="mpre">filterOutputM</span></span></a><span class="mpre"> </span><a name="loc_593_15_593_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_593_15_593_16&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> </span><a name="loc_593_17_593_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_593_17_593_23&#39;)"><span class="hl_vardecl"><span class="mpre">output</span></span></a><span class="mpre"> = </span><a href="System.IO.Streams.Internal.html#loc_273_1_273_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_273_1_273_17&#39;)"><span class="hl_varref"><span class="mpre">makeOutputStream</span></span></a><span class="mpre"> </span><a href="#loc_595_5_595_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_595_5_595_10&#39;)"><span class="hl_varref"><span class="mpre">chunk</span></span></a><span class="mpre">
  where
    </span><a name="loc_595_5_595_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_595_5_595_10&#39;)"><span class="hl_fundecl"><span class="mpre">chunk</span></span></a><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">  = </span><a href="System.IO.Streams.Internal.html#loc_147_1_147_6" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_147_1_147_6&#39;)"><span class="hl_varref"><span class="mpre">write</span></span></a><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> </span><a href="#loc_593_17_593_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_593_17_593_23&#39;)"><span class="hl_varref"><span class="mpre">output</span></span></a><span class="mpre">
    </span><a href="#loc_595_5_595_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_595_5_595_10&#39;)"><span class="hl_fundecl"><span class="mpre">chunk</span></span></a><span class="mpre"> </span><a name="loc_596_11_596_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_596_11_596_13&#39;)"><span class="hl_specname"><span class="mpre">ch</span></span></a><span class="mpre">@(</span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a name="loc_596_20_596_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_596_20_596_21&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">) = do
        </span><a name="loc_597_9_597_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_597_9_597_10&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_593_15_593_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_593_15_593_16&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_596_20_596_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_596_20_596_21&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
        if </span><a href="#loc_597_9_597_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_597_9_597_10&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> then </span><a href="System.IO.Streams.Internal.html#loc_147_1_147_6" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_147_1_147_6&#39;)"><span class="hl_varref"><span class="mpre">write</span></span></a><span class="mpre"> </span><a href="#loc_596_11_596_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_596_11_596_13&#39;)"><span class="hl_varref"><span class="mpre">ch</span></span></a><span class="mpre"> </span><a href="#loc_593_17_593_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_593_17_593_23&#39;)"><span class="hl_varref"><span class="mpre">output</span></span></a><span class="mpre"> else </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="Prelude.html#loc_160_3_160_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Prelude.html#loc_160_3_160_5&#39;)"><span class="hl_infix"><span class="mpre">$!</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Takes apart a stream of pairs, producing a pair of input streams. Reading</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- from either of the produced streams will cause a pair of values to be pulled</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- from the original stream if necessary. Note that reading @n@ values from one</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- of the returned streams will cause @n@ values to be buffered at the other</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- stream.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Access to the original stream is thread safe, i.e. guarded by a lock.</span></span><span class="mpre">
</span><a href="#loc_610_1_610_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_610_1_610_6&#39;)"><span class="mpre">unzip</span></a><span class="mpre"> :: </span><a href="System.IO.Streams.Internal.html#loc_107_6_107_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_107_6_107_17&#39;)"><span class="hl_tyconref"><span class="mpre">InputStream</span></span></a><span class="mpre"> (</span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="System.IO.Streams.Internal.html#loc_107_6_107_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_107_6_107_17&#39;)"><span class="hl_tyconref"><span class="mpre">InputStream</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">, </span><a href="System.IO.Streams.Internal.html#loc_107_6_107_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_107_6_107_17&#39;)"><span class="hl_tyconref"><span class="mpre">InputStream</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">)
</span><a name="loc_610_1_610_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_610_1_610_6&#39;)"><span class="hl_fundecl"><span class="mpre">unzip</span></span></a><span class="mpre"> </span><a name="loc_610_7_610_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_610_7_610_9&#39;)"><span class="hl_vardecl"><span class="mpre">os</span></span></a><span class="mpre"> = do
    </span><a name="loc_611_5_611_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_611_5_611_9&#39;)"><span class="hl_vardecl"><span class="mpre">lock</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.MVar.html#loc_70_1_70_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.MVar.html#loc_70_1_70_8&#39;)"><span class="hl_varref"><span class="mpre">newMVar</span></span></a><span class="mpre"> </span><a href="Prelude.html#loc_160_3_160_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Prelude.html#loc_160_3_160_5&#39;)"><span class="hl_infix"><span class="mpre">$!</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">
    </span><a name="loc_612_5_612_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_612_5_612_9&#39;)"><span class="hl_vardecl"><span class="mpre">buf1</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IORef.html#loc_42_1_42_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_42_1_42_9&#39;)"><span class="hl_varref"><span class="mpre">newIORef</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">
    </span><a name="loc_613_5_613_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_613_5_613_9&#39;)"><span class="hl_vardecl"><span class="mpre">buf2</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IORef.html#loc_42_1_42_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_42_1_42_9&#39;)"><span class="hl_varref"><span class="mpre">newIORef</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">

    </span><a name="loc_615_5_615_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_615_5_615_8&#39;)"><span class="hl_vardecl"><span class="mpre">is1</span></span></a><span class="mpre">  &lt;- </span><a href="System.IO.Streams.Internal.html#loc_247_1_247_16" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_247_1_247_16&#39;)"><span class="hl_varref"><span class="mpre">makeInputStream</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_623_5_623_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_623_5_623_8&#39;)"><span class="hl_varref"><span class="mpre">src</span></span></a><span class="mpre"> </span><a href="#loc_611_5_611_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_611_5_611_9&#39;)"><span class="hl_varref"><span class="mpre">lock</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre"> </span><a href="#loc_612_5_612_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_612_5_612_9&#39;)"><span class="hl_varref"><span class="mpre">buf1</span></span></a><span class="mpre"> </span><a href="#loc_613_5_613_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_613_5_613_9&#39;)"><span class="hl_varref"><span class="mpre">buf2</span></span></a><span class="mpre">
    </span><a name="loc_616_5_616_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_616_5_616_8&#39;)"><span class="hl_vardecl"><span class="mpre">is2</span></span></a><span class="mpre">  &lt;- </span><a href="System.IO.Streams.Internal.html#loc_247_1_247_16" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_247_1_247_16&#39;)"><span class="hl_varref"><span class="mpre">makeInputStream</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_623_5_623_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_623_5_623_8&#39;)"><span class="hl_varref"><span class="mpre">src</span></span></a><span class="mpre"> </span><a href="#loc_611_5_611_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_611_5_611_9&#39;)"><span class="hl_varref"><span class="mpre">lock</span></span></a><span class="mpre"> </span><a href="#loc_621_5_621_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_621_5_621_10&#39;)"><span class="hl_varref"><span class="mpre">twist</span></span></a><span class="mpre"> </span><a href="#loc_613_5_613_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_613_5_613_9&#39;)"><span class="hl_varref"><span class="mpre">buf2</span></span></a><span class="mpre"> </span><a href="#loc_612_5_612_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_612_5_612_9&#39;)"><span class="hl_varref"><span class="mpre">buf1</span></span></a><span class="mpre">

    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_615_5_615_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_615_5_615_8&#39;)"><span class="hl_varref"><span class="mpre">is1</span></span></a><span class="mpre">, </span><a href="#loc_616_5_616_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_616_5_616_8&#39;)"><span class="hl_varref"><span class="mpre">is2</span></span></a><span class="mpre">)

  where
    </span><a name="loc_621_5_621_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_621_5_621_10&#39;)"><span class="hl_fundecl"><span class="mpre">twist</span></span></a><span class="mpre"> (</span><a name="loc_621_12_621_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_621_12_621_13&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">, </span><a name="loc_621_15_621_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_621_15_621_16&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">) = (</span><a href="#loc_621_15_621_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_621_15_621_16&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">, </span><a href="#loc_621_12_621_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_621_12_621_13&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">)

    </span><a name="loc_623_5_623_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_623_5_623_8&#39;)"><span class="hl_fundecl"><span class="mpre">src</span></span></a><span class="mpre"> </span><a name="loc_623_9_623_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_623_9_623_13&#39;)"><span class="hl_vardecl"><span class="mpre">lock</span></span></a><span class="mpre"> </span><a name="loc_623_14_623_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_623_14_623_18&#39;)"><span class="hl_vardecl"><span class="mpre">proj</span></span></a><span class="mpre"> </span><a name="loc_623_19_623_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_623_19_623_24&#39;)"><span class="hl_vardecl"><span class="mpre">myBuf</span></span></a><span class="mpre"> </span><a name="loc_623_25_623_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_623_25_623_33&#39;)"><span class="hl_vardecl"><span class="mpre">theirBuf</span></span></a><span class="mpre"> = </span><a href="Control.Concurrent.MVar.html#loc_185_1_185_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Concurrent.MVar.html#loc_185_1_185_9&#39;)"><span class="hl_varref"><span class="mpre">withMVar</span></span></a><span class="mpre"> </span><a href="#loc_623_9_623_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_623_9_623_13&#39;)"><span class="hl_varref"><span class="mpre">lock</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">const</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
        </span><a name="loc_624_9_624_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_624_9_624_11&#39;)"><span class="hl_vardecl"><span class="mpre">dl</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IORef.html#loc_46_1_46_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_46_1_46_10&#39;)"><span class="hl_varref"><span class="mpre">readIORef</span></span></a><span class="mpre"> </span><a href="#loc_623_19_623_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_623_19_623_24&#39;)"><span class="hl_varref"><span class="mpre">myBuf</span></span></a><span class="mpre">

        case </span><a href="#loc_624_9_624_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_624_9_624_11&#39;)"><span class="hl_varref"><span class="mpre">dl</span></span></a><span class="mpre"> [] of
          []     -&gt; </span><a href="#loc_630_9_630_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_630_9_630_13&#39;)"><span class="hl_varref"><span class="mpre">more</span></span></a><span class="mpre">
          (</span><a name="loc_628_12_628_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_628_12_628_13&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_628_14_628_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_628_14_628_16&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) -&gt; </span><a href="GHC.IORef.html#loc_50_1_50_11" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_50_1_50_11&#39;)"><span class="hl_varref"><span class="mpre">writeIORef</span></span></a><span class="mpre"> </span><a href="#loc_623_19_623_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_623_19_623_24&#39;)"><span class="hl_varref"><span class="mpre">myBuf</span></span></a><span class="mpre"> (</span><a href="#loc_628_14_628_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_628_14_628_16&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="Prelude.html#loc_160_3_160_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Prelude.html#loc_160_3_160_5&#39;)"><span class="hl_infix"><span class="mpre">$!</span></span></a><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a href="#loc_628_12_628_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_628_12_628_13&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)
      where
        </span><a name="loc_630_9_630_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_630_9_630_13&#39;)"><span class="hl_vardecl"><span class="mpre">more</span></span></a><span class="mpre"> = </span><a href="System.IO.Streams.Internal.html#loc_137_1_137_5" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_137_1_137_5&#39;)"><span class="hl_varref"><span class="mpre">read</span></span></a><span class="mpre"> </span><a href="#loc_610_7_610_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_610_7_610_9&#39;)"><span class="hl_varref"><span class="mpre">os</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre">
               </span><a href="Data.Maybe.html#loc_74_1_74_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_74_1_74_6&#39;)"><span class="hl_varref"><span class="mpre">maybe</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">)
                     (\</span><a name="loc_632_24_632_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_632_24_632_25&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> -&gt; do
                          let (</span><a name="loc_633_32_633_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_633_32_633_33&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">, </span><a name="loc_633_35_633_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_633_35_633_36&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">) = </span><a href="#loc_623_14_623_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_623_14_623_18&#39;)"><span class="hl_varref"><span class="mpre">proj</span></span></a><span class="mpre"> </span><a href="#loc_632_24_632_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_632_24_632_25&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
                          </span><a href="Data.IORef.html#loc_70_1_70_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.IORef.html#loc_70_1_70_12&#39;)"><span class="hl_varref"><span class="mpre">modifyIORef</span></span></a><span class="mpre"> </span><a href="#loc_623_25_623_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_623_25_623_33&#39;)"><span class="hl_varref"><span class="mpre">theirBuf</span></span></a><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> (</span><a href="#loc_633_35_633_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_633_35_633_36&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">))
                          </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="Prelude.html#loc_160_3_160_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Prelude.html#loc_160_3_160_5&#39;)"><span class="hl_infix"><span class="mpre">$!</span></span></a><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a href="#loc_633_32_633_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_633_32_633_33&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">)


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Wraps an &#39;InputStream&#39;, producing a new &#39;InputStream&#39; that will produce at</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- most @n@ items, subsequently yielding end-of-stream forever.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Items pushed back to the returned &#39;InputStream&#39; will be propagated upstream,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- modifying the count of taken items accordingly.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Example:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ghci&gt; is &lt;- Streams.&#39;fromList&#39; [1..9::Int]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ghci&gt; is&#39; &lt;- Streams.&#39;take&#39; 1 is</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ghci&gt; Streams.&#39;read&#39; is&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Just 1</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ghci&gt; Streams.&#39;read&#39; is&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Nothing</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ghci&gt; Streams.&#39;System.IO.Streams.peek&#39; is</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Just 2</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ghci&gt; Streams.&#39;unRead&#39; 11 is&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ghci&gt; Streams.&#39;System.IO.Streams.peek&#39; is</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Just 11</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ghci&gt; Streams.&#39;System.IO.Streams.peek&#39; is&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Just 11</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ghci&gt; Streams.&#39;read&#39; is&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Just 11</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ghci&gt; Streams.&#39;read&#39; is&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Nothing</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ghci&gt; Streams.&#39;read&#39; is</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Just 2</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- ghci&gt; Streams.&#39;toList&#39; is</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- [3,4,5,6,7,8,9]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- @</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_672_1_672_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_672_1_672_5&#39;)"><span class="mpre">take</span></a><span class="mpre"> :: </span><a href="GHC.Int.html#loc_551_30_551_35" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Int.html#loc_551_30_551_35&#39;)"><span class="hl_tyconref"><span class="mpre">Int64</span></span></a><span class="mpre"> -&gt; </span><a href="System.IO.Streams.Internal.html#loc_107_6_107_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_107_6_107_17&#39;)"><span class="hl_tyconref"><span class="mpre">InputStream</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="System.IO.Streams.Internal.html#loc_107_6_107_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_107_6_107_17&#39;)"><span class="hl_tyconref"><span class="mpre">InputStream</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
</span><a name="loc_672_1_672_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_672_1_672_5&#39;)"><span class="hl_fundecl"><span class="mpre">take</span></span></a><span class="mpre"> </span><a name="loc_672_6_672_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_672_6_672_8&#39;)"><span class="hl_vardecl"><span class="mpre">k0</span></span></a><span class="mpre"> </span><a name="loc_672_9_672_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_672_9_672_14&#39;)"><span class="hl_vardecl"><span class="mpre">input</span></span></a><span class="mpre"> = do
    </span><a name="loc_673_5_673_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_673_5_673_9&#39;)"><span class="hl_vardecl"><span class="mpre">kref</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IORef.html#loc_42_1_42_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_42_1_42_9&#39;)"><span class="hl_varref"><span class="mpre">newIORef</span></span></a><span class="mpre"> </span><a href="#loc_672_6_672_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_672_6_672_8&#39;)"><span class="hl_varref"><span class="mpre">k0</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="Prelude.html#loc_160_3_160_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Prelude.html#loc_160_3_160_5&#39;)"><span class="hl_infix"><span class="mpre">$!</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">InputStream</span></span><span class="mpre"> (</span><a href="#loc_676_5_676_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_676_5_676_9&#39;)"><span class="hl_varref"><span class="mpre">prod</span></span></a><span class="mpre"> </span><a href="#loc_673_5_673_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_673_5_673_9&#39;)"><span class="hl_varref"><span class="mpre">kref</span></span></a><span class="mpre">) (</span><a href="#loc_685_5_685_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_685_5_685_7&#39;)"><span class="hl_varref"><span class="mpre">pb</span></span></a><span class="mpre"> </span><a href="#loc_673_5_673_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_673_5_673_9&#39;)"><span class="hl_varref"><span class="mpre">kref</span></span></a><span class="mpre">)
  where
    </span><a name="loc_676_5_676_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_676_5_676_9&#39;)"><span class="hl_fundecl"><span class="mpre">prod</span></span></a><span class="mpre"> </span><a name="loc_676_10_676_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_676_10_676_14&#39;)"><span class="hl_vardecl"><span class="mpre">kref</span></span></a><span class="mpre"> = do
        !</span><a name="loc_677_10_677_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_677_10_677_11&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IORef.html#loc_46_1_46_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_46_1_46_10&#39;)"><span class="hl_varref"><span class="mpre">readIORef</span></span></a><span class="mpre"> </span><a href="#loc_676_10_676_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_676_10_676_14&#39;)"><span class="hl_varref"><span class="mpre">kref</span></span></a><span class="mpre">
        if </span><a href="#loc_677_10_677_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_677_10_677_11&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
          then </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">
          else do
              </span><a name="loc_681_15_681_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_681_15_681_16&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> &lt;- </span><a href="System.IO.Streams.Internal.html#loc_137_1_137_5" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_137_1_137_5&#39;)"><span class="hl_varref"><span class="mpre">read</span></span></a><span class="mpre"> </span><a href="#loc_672_9_672_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_672_9_672_14&#39;)"><span class="hl_varref"><span class="mpre">input</span></span></a><span class="mpre">
              </span><a href="Control.Monad.html#loc_265_1_265_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_265_1_265_5&#39;)"><span class="hl_varref"><span class="mpre">when</span></span></a><span class="mpre"> (</span><a href="Data.Maybe.html#loc_80_1_80_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_80_1_80_7&#39;)"><span class="hl_varref"><span class="mpre">isJust</span></span></a><span class="mpre"> </span><a href="#loc_681_15_681_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_681_15_681_16&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.IORef.html#loc_70_1_70_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.IORef.html#loc_70_1_70_12&#39;)"><span class="hl_varref"><span class="mpre">modifyIORef</span></span></a><span class="mpre"> </span><a href="#loc_676_10_676_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_676_10_676_14&#39;)"><span class="hl_varref"><span class="mpre">kref</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_682_53_682_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_682_53_682_54&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_682_53_682_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_682_53_682_54&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
              </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_681_15_681_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_681_15_681_16&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">

    </span><a name="loc_685_5_685_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_685_5_685_7&#39;)"><span class="hl_fundecl"><span class="mpre">pb</span></span></a><span class="mpre"> </span><a name="loc_685_8_685_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_685_8_685_12&#39;)"><span class="hl_vardecl"><span class="mpre">kref</span></span></a><span class="mpre"> !</span><a name="loc_685_14_685_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_685_14_685_15&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = do
       </span><a href="System.IO.Streams.Internal.html#loc_178_1_178_7" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_178_1_178_7&#39;)"><span class="hl_varref"><span class="mpre">unRead</span></span></a><span class="mpre"> </span><a href="#loc_685_14_685_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_685_14_685_15&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><a href="#loc_672_9_672_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_672_9_672_14&#39;)"><span class="hl_varref"><span class="mpre">input</span></span></a><span class="mpre">
       </span><a href="Data.IORef.html#loc_70_1_70_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.IORef.html#loc_70_1_70_12&#39;)"><span class="hl_varref"><span class="mpre">modifyIORef</span></span></a><span class="mpre"> </span><a href="#loc_685_8_685_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_685_8_685_12&#39;)"><span class="hl_varref"><span class="mpre">kref</span></span></a><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Wraps an &#39;InputStream&#39;, producing a new &#39;InputStream&#39; that will drop the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- first @n@ items produced by the wrapped stream. See &#39;Prelude.drop&#39;.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Items pushed back to the returned &#39;InputStream&#39; will be propagated upstream,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- modifying the count of dropped items accordingly.</span></span><span class="mpre">
</span><a href="#loc_697_1_697_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_697_1_697_5&#39;)"><span class="mpre">drop</span></a><span class="mpre"> :: </span><a href="GHC.Int.html#loc_551_30_551_35" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Int.html#loc_551_30_551_35&#39;)"><span class="hl_tyconref"><span class="mpre">Int64</span></span></a><span class="mpre"> -&gt; </span><a href="System.IO.Streams.Internal.html#loc_107_6_107_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_107_6_107_17&#39;)"><span class="hl_tyconref"><span class="mpre">InputStream</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="System.IO.Streams.Internal.html#loc_107_6_107_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_107_6_107_17&#39;)"><span class="hl_tyconref"><span class="mpre">InputStream</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
</span><a name="loc_697_1_697_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_697_1_697_5&#39;)"><span class="hl_fundecl"><span class="mpre">drop</span></span></a><span class="mpre"> </span><a name="loc_697_6_697_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_697_6_697_8&#39;)"><span class="hl_vardecl"><span class="mpre">k0</span></span></a><span class="mpre"> </span><a name="loc_697_9_697_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_697_9_697_14&#39;)"><span class="hl_vardecl"><span class="mpre">input</span></span></a><span class="mpre"> = do
    </span><a name="loc_698_5_698_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_698_5_698_9&#39;)"><span class="hl_vardecl"><span class="mpre">kref</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IORef.html#loc_42_1_42_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_42_1_42_9&#39;)"><span class="hl_varref"><span class="mpre">newIORef</span></span></a><span class="mpre"> </span><a href="#loc_697_6_697_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_697_6_697_8&#39;)"><span class="hl_varref"><span class="mpre">k0</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="Prelude.html#loc_160_3_160_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Prelude.html#loc_160_3_160_5&#39;)"><span class="hl_infix"><span class="mpre">$!</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">InputStream</span></span><span class="mpre"> (</span><a href="#loc_701_5_701_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_701_5_701_9&#39;)"><span class="hl_varref"><span class="mpre">prod</span></span></a><span class="mpre"> </span><a href="#loc_698_5_698_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_698_5_698_9&#39;)"><span class="hl_varref"><span class="mpre">kref</span></span></a><span class="mpre">) (</span><a href="#loc_714_5_714_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_714_5_714_7&#39;)"><span class="hl_varref"><span class="mpre">pb</span></span></a><span class="mpre"> </span><a href="#loc_698_5_698_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_698_5_698_9&#39;)"><span class="hl_varref"><span class="mpre">kref</span></span></a><span class="mpre">)
  where
    </span><a name="loc_701_5_701_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_701_5_701_9&#39;)"><span class="hl_fundecl"><span class="mpre">prod</span></span></a><span class="mpre"> </span><a name="loc_701_10_701_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_701_10_701_14&#39;)"><span class="hl_vardecl"><span class="mpre">kref</span></span></a><span class="mpre"> = do
        !</span><a name="loc_702_10_702_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_702_10_702_11&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IORef.html#loc_46_1_46_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_46_1_46_10&#39;)"><span class="hl_varref"><span class="mpre">readIORef</span></span></a><span class="mpre"> </span><a href="#loc_701_10_701_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_701_10_701_14&#39;)"><span class="hl_varref"><span class="mpre">kref</span></span></a><span class="mpre">
        if </span><a href="#loc_702_10_702_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_702_10_702_11&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
          then </span><a href="#loc_707_5_707_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_707_5_707_13&#39;)"><span class="hl_varref"><span class="mpre">getInput</span></span></a><span class="mpre"> </span><a href="#loc_701_10_701_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_701_10_701_14&#39;)"><span class="hl_varref"><span class="mpre">kref</span></span></a><span class="mpre">
          else </span><a href="#loc_712_5_712_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_712_5_712_12&#39;)"><span class="hl_varref"><span class="mpre">discard</span></span></a><span class="mpre"> </span><a href="#loc_701_10_701_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_701_10_701_14&#39;)"><span class="hl_varref"><span class="mpre">kref</span></span></a><span class="mpre">

    </span><a name="loc_707_5_707_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_707_5_707_13&#39;)"><span class="hl_fundecl"><span class="mpre">getInput</span></span></a><span class="mpre"> </span><a name="loc_707_14_707_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_707_14_707_18&#39;)"><span class="hl_vardecl"><span class="mpre">kref</span></span></a><span class="mpre"> = do
        </span><a href="System.IO.Streams.Internal.html#loc_137_1_137_5" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_137_1_137_5&#39;)"><span class="hl_varref"><span class="mpre">read</span></span></a><span class="mpre"> </span><a href="#loc_697_9_697_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_697_9_697_14&#39;)"><span class="hl_varref"><span class="mpre">input</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_74_1_74_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_74_1_74_6&#39;)"><span class="hl_varref"><span class="mpre">maybe</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">) (\</span><a name="loc_708_49_708_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_708_49_708_50&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> -&gt; do
            </span><a href="Data.IORef.html#loc_70_1_70_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.IORef.html#loc_70_1_70_12&#39;)"><span class="hl_varref"><span class="mpre">modifyIORef</span></span></a><span class="mpre"> </span><a href="#loc_707_14_707_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_707_14_707_18&#39;)"><span class="hl_varref"><span class="mpre">kref</span></span></a><span class="mpre"> (\</span><a name="loc_709_32_709_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_709_32_709_33&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_709_32_709_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_709_32_709_33&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
            </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="Prelude.html#loc_160_3_160_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Prelude.html#loc_160_3_160_5&#39;)"><span class="hl_infix"><span class="mpre">$!</span></span></a><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a href="#loc_708_49_708_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_708_49_708_50&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">)

    </span><a name="loc_712_5_712_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_712_5_712_12&#39;)"><span class="hl_fundecl"><span class="mpre">discard</span></span></a><span class="mpre"> </span><a name="loc_712_13_712_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_712_13_712_17&#39;)"><span class="hl_vardecl"><span class="mpre">kref</span></span></a><span class="mpre"> = </span><a href="#loc_707_5_707_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_707_5_707_13&#39;)"><span class="hl_varref"><span class="mpre">getInput</span></span></a><span class="mpre"> </span><a href="#loc_712_13_712_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_712_13_712_17&#39;)"><span class="hl_varref"><span class="mpre">kref</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_74_1_74_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_74_1_74_6&#39;)"><span class="hl_varref"><span class="mpre">maybe</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">const</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_701_5_701_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_701_5_701_9&#39;)"><span class="hl_varref"><span class="mpre">prod</span></span></a><span class="mpre"> </span><a href="#loc_712_13_712_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_712_13_712_17&#39;)"><span class="hl_varref"><span class="mpre">kref</span></span></a><span class="mpre">)

    </span><a name="loc_714_5_714_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_714_5_714_7&#39;)"><span class="hl_fundecl"><span class="mpre">pb</span></span></a><span class="mpre"> </span><a name="loc_714_8_714_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_714_8_714_12&#39;)"><span class="hl_vardecl"><span class="mpre">kref</span></span></a><span class="mpre"> </span><a name="loc_714_13_714_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_714_13_714_14&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = do
        </span><a href="System.IO.Streams.Internal.html#loc_178_1_178_7" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_178_1_178_7&#39;)"><span class="hl_varref"><span class="mpre">unRead</span></span></a><span class="mpre"> </span><a href="#loc_714_13_714_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_714_13_714_14&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><a href="#loc_697_9_697_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_697_9_697_14&#39;)"><span class="hl_varref"><span class="mpre">input</span></span></a><span class="mpre">
        </span><a href="Data.IORef.html#loc_70_1_70_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.IORef.html#loc_70_1_70_12&#39;)"><span class="hl_varref"><span class="mpre">modifyIORef</span></span></a><span class="mpre"> </span><a href="#loc_714_8_714_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_714_8_714_12&#39;)"><span class="hl_varref"><span class="mpre">kref</span></span></a><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Wraps an &#39;OutputStream&#39;, producing a new &#39;OutputStream&#39; that will pass at</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- most @n@ items on to the wrapped stream, subsequently ignoring the rest of</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the input.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_725_1_725_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_725_1_725_5&#39;)"><span class="mpre">give</span></a><span class="mpre"> :: </span><a href="GHC.Int.html#loc_551_30_551_35" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Int.html#loc_551_30_551_35&#39;)"><span class="hl_tyconref"><span class="mpre">Int64</span></span></a><span class="mpre"> -&gt; </span><a href="System.IO.Streams.Internal.html#loc_126_6_126_18" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_126_6_126_18&#39;)"><span class="hl_tyconref"><span class="mpre">OutputStream</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="System.IO.Streams.Internal.html#loc_126_6_126_18" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_126_6_126_18&#39;)"><span class="hl_tyconref"><span class="mpre">OutputStream</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
</span><a name="loc_725_1_725_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_725_1_725_5&#39;)"><span class="hl_fundecl"><span class="mpre">give</span></span></a><span class="mpre"> </span><a name="loc_725_6_725_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_725_6_725_7&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> </span><a name="loc_725_8_725_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_725_8_725_14&#39;)"><span class="hl_vardecl"><span class="mpre">output</span></span></a><span class="mpre"> = </span><a href="GHC.IORef.html#loc_42_1_42_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_42_1_42_9&#39;)"><span class="hl_varref"><span class="mpre">newIORef</span></span></a><span class="mpre"> </span><a href="#loc_725_6_725_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_725_6_725_7&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="System.IO.Streams.Internal.html#loc_273_1_273_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_273_1_273_17&#39;)"><span class="hl_varref"><span class="mpre">makeOutputStream</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_727_5_727_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_727_5_727_10&#39;)"><span class="hl_varref"><span class="mpre">chunk</span></span></a><span class="mpre">
  where
    </span><a name="loc_727_5_727_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_727_5_727_10&#39;)"><span class="hl_fundecl"><span class="mpre">chunk</span></span></a><span class="mpre"> </span><a name="loc_727_11_727_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_727_11_727_14&#39;)"><span class="hl_vardecl"><span class="mpre">ref</span></span></a><span class="mpre"> = </span><a href="Data.Maybe.html#loc_74_1_74_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_74_1_74_6&#39;)"><span class="hl_varref"><span class="mpre">maybe</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="Prelude.html#loc_160_3_160_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Prelude.html#loc_160_3_160_5&#39;)"><span class="hl_infix"><span class="mpre">$!</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_727_41_727_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_727_41_727_42&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> -&gt; do
                    !</span><a name="loc_728_22_728_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_728_22_728_23&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IORef.html#loc_46_1_46_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_46_1_46_10&#39;)"><span class="hl_varref"><span class="mpre">readIORef</span></span></a><span class="mpre"> </span><a href="#loc_727_11_727_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_727_11_727_14&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre">
                    if </span><a href="#loc_728_22_728_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_728_22_728_23&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
                      then </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="Prelude.html#loc_160_3_160_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Prelude.html#loc_160_3_160_5&#39;)"><span class="hl_infix"><span class="mpre">$!</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">
                      else do
                          </span><a href="GHC.IORef.html#loc_50_1_50_11" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_50_1_50_11&#39;)"><span class="hl_varref"><span class="mpre">writeIORef</span></span></a><span class="mpre"> </span><a href="#loc_727_11_727_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_727_11_727_14&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre"> </span><a href="Prelude.html#loc_160_3_160_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Prelude.html#loc_160_3_160_5&#39;)"><span class="hl_infix"><span class="mpre">$!</span></span></a><span class="mpre"> </span><a href="#loc_728_22_728_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_728_22_728_23&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
                          </span><a href="System.IO.Streams.Internal.html#loc_147_1_147_6" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_147_1_147_6&#39;)"><span class="hl_varref"><span class="mpre">write</span></span></a><span class="mpre"> (</span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a href="#loc_727_41_727_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_727_41_727_42&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">) </span><a href="#loc_725_8_725_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_725_8_725_14&#39;)"><span class="hl_varref"><span class="mpre">output</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Wraps an &#39;OutputStream&#39;, producing a new &#39;OutputStream&#39; that will ignore</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the first @n@ items received, subsequently passing the rest of the input on</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- to the wrapped stream.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_742_1_742_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_742_1_742_7&#39;)"><span class="mpre">ignore</span></a><span class="mpre"> :: </span><a href="GHC.Int.html#loc_551_30_551_35" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Int.html#loc_551_30_551_35&#39;)"><span class="hl_tyconref"><span class="mpre">Int64</span></span></a><span class="mpre"> -&gt; </span><a href="System.IO.Streams.Internal.html#loc_126_6_126_18" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_126_6_126_18&#39;)"><span class="hl_tyconref"><span class="mpre">OutputStream</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="System.IO.Streams.Internal.html#loc_126_6_126_18" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_126_6_126_18&#39;)"><span class="hl_tyconref"><span class="mpre">OutputStream</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
</span><a name="loc_742_1_742_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_742_1_742_7&#39;)"><span class="hl_fundecl"><span class="mpre">ignore</span></span></a><span class="mpre"> </span><a name="loc_742_8_742_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_742_8_742_9&#39;)"><span class="hl_vardecl"><span class="mpre">k</span></span></a><span class="mpre"> </span><a name="loc_742_10_742_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_742_10_742_16&#39;)"><span class="hl_vardecl"><span class="mpre">output</span></span></a><span class="mpre"> = </span><a href="GHC.IORef.html#loc_42_1_42_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_42_1_42_9&#39;)"><span class="hl_varref"><span class="mpre">newIORef</span></span></a><span class="mpre"> </span><a href="#loc_742_8_742_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_742_8_742_9&#39;)"><span class="hl_varref"><span class="mpre">k</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="System.IO.Streams.Internal.html#loc_273_1_273_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_273_1_273_17&#39;)"><span class="hl_varref"><span class="mpre">makeOutputStream</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_744_5_744_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_744_5_744_10&#39;)"><span class="hl_varref"><span class="mpre">chunk</span></span></a><span class="mpre">
  where
    </span><a name="loc_744_5_744_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_744_5_744_10&#39;)"><span class="hl_fundecl"><span class="mpre">chunk</span></span></a><span class="mpre"> </span><a name="loc_744_11_744_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_744_11_744_14&#39;)"><span class="hl_vardecl"><span class="mpre">ref</span></span></a><span class="mpre"> = </span><a href="Data.Maybe.html#loc_74_1_74_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_74_1_74_6&#39;)"><span class="hl_varref"><span class="mpre">maybe</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="Prelude.html#loc_160_3_160_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Prelude.html#loc_160_3_160_5&#39;)"><span class="hl_infix"><span class="mpre">$!</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_744_41_744_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_744_41_744_42&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> -&gt; do
                    !</span><a name="loc_745_22_745_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_745_22_745_23&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IORef.html#loc_46_1_46_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_46_1_46_10&#39;)"><span class="hl_varref"><span class="mpre">readIORef</span></span></a><span class="mpre"> </span><a href="#loc_744_11_744_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_744_11_744_14&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre">
                    if </span><a href="#loc_745_22_745_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_745_22_745_23&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
                      then </span><a href="GHC.IORef.html#loc_50_1_50_11" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_50_1_50_11&#39;)"><span class="hl_varref"><span class="mpre">writeIORef</span></span></a><span class="mpre"> </span><a href="#loc_744_11_744_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_744_11_744_14&#39;)"><span class="hl_varref"><span class="mpre">ref</span></span></a><span class="mpre"> </span><a href="Prelude.html#loc_160_3_160_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Prelude.html#loc_160_3_160_5&#39;)"><span class="hl_infix"><span class="mpre">$!</span></span></a><span class="mpre"> </span><a href="#loc_745_22_745_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_745_22_745_23&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
                      else </span><a href="System.IO.Streams.Internal.html#loc_147_1_147_6" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_147_1_147_6&#39;)"><span class="hl_varref"><span class="mpre">write</span></span></a><span class="mpre"> (</span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre"> </span><a href="#loc_744_41_744_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_744_41_744_42&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">) </span><a href="#loc_742_10_742_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_742_10_742_16&#39;)"><span class="hl_varref"><span class="mpre">output</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Wraps an &#39;OutputStream&#39;, ignoring any end-of-stream &#39;Nothing&#39; values</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- written to the returned stream.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- /Since: 1.0.1.0/</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_758_1_758_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_758_1_758_10&#39;)"><span class="mpre">ignoreEof</span></a><span class="mpre"> :: </span><a href="System.IO.Streams.Internal.html#loc_126_6_126_18" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_126_6_126_18&#39;)"><span class="hl_tyconref"><span class="mpre">OutputStream</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="System.IO.Streams.Internal.html#loc_126_6_126_18" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_126_6_126_18&#39;)"><span class="hl_tyconref"><span class="mpre">OutputStream</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
</span><a name="loc_758_1_758_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_758_1_758_10&#39;)"><span class="hl_fundecl"><span class="mpre">ignoreEof</span></span></a><span class="mpre"> </span><a name="loc_758_11_758_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_758_11_758_12&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = </span><a href="System.IO.Streams.Internal.html#loc_273_1_273_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_273_1_273_17&#39;)"><span class="hl_varref"><span class="mpre">makeOutputStream</span></span></a><span class="mpre"> </span><a href="#loc_760_5_760_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_760_5_760_6&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">
  where
    </span><a name="loc_760_5_760_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_760_5_760_6&#39;)"><span class="hl_fundecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">  = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="Prelude.html#loc_160_3_160_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Prelude.html#loc_160_3_160_5&#39;)"><span class="hl_infix"><span class="mpre">$!</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">
    </span><a href="#loc_760_5_760_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_760_5_760_6&#39;)"><span class="hl_fundecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_761_7_761_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_761_7_761_8&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">        = </span><a href="System.IO.Streams.Internal.html#loc_147_1_147_6" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_147_1_147_6&#39;)"><span class="hl_varref"><span class="mpre">write</span></span></a><span class="mpre"> </span><a href="#loc_761_7_761_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_761_7_761_8&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_758_11_758_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_758_11_758_12&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Wraps an &#39;InputStream&#39;, running the specified action when the stream</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- yields end-of-file.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- /Since: 1.0.2.0/</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_771_1_771_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_771_1_771_13&#39;)"><span class="mpre">atEndOfInput</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><a href="System.IO.Streams.Internal.html#loc_107_6_107_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_107_6_107_17&#39;)"><span class="hl_tyconref"><span class="mpre">InputStream</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="System.IO.Streams.Internal.html#loc_107_6_107_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_107_6_107_17&#39;)"><span class="hl_tyconref"><span class="mpre">InputStream</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
</span><a name="loc_771_1_771_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_771_1_771_13&#39;)"><span class="hl_fundecl"><span class="mpre">atEndOfInput</span></span></a><span class="mpre"> </span><a name="loc_771_14_771_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_771_14_771_15&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> </span><a name="loc_771_16_771_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_771_16_771_18&#39;)"><span class="hl_vardecl"><span class="mpre">is</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="Prelude.html#loc_160_3_160_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Prelude.html#loc_160_3_160_5&#39;)"><span class="hl_infix"><span class="mpre">$!</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">InputStream</span></span><span class="mpre"> </span><a href="#loc_773_5_773_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_773_5_773_9&#39;)"><span class="hl_varref"><span class="mpre">prod</span></span></a><span class="mpre"> </span><a href="#loc_775_5_775_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_775_5_775_7&#39;)"><span class="hl_varref"><span class="mpre">pb</span></span></a><span class="mpre">
  where
    </span><a name="loc_773_5_773_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_773_5_773_9&#39;)"><span class="hl_vardecl"><span class="mpre">prod</span></span></a><span class="mpre">    = </span><a href="System.IO.Streams.Internal.html#loc_137_1_137_5" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_137_1_137_5&#39;)"><span class="hl_varref"><span class="mpre">read</span></span></a><span class="mpre"> </span><a href="#loc_771_16_771_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_771_16_771_18&#39;)"><span class="hl_varref"><span class="mpre">is</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_74_1_74_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_74_1_74_6&#39;)"><span class="hl_varref"><span class="mpre">maybe</span></span></a><span class="mpre"> </span><a href="#loc_774_5_774_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_774_5_774_8&#39;)"><span class="hl_varref"><span class="mpre">eof</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_29_49_33" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_29_49_33&#39;)"><span class="hl_conref"><span class="mpre">Just</span></span></a><span class="mpre">)
    </span><a name="loc_774_5_774_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_774_5_774_8&#39;)"><span class="hl_vardecl"><span class="mpre">eof</span></span></a><span class="mpre">     = </span><a href="Control.Monad.html#loc_195_1_195_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_195_1_195_5&#39;)"><span class="hl_varref"><span class="mpre">void</span></span></a><span class="mpre"> </span><a href="#loc_771_14_771_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_771_14_771_15&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre">
    </span><a name="loc_775_5_775_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_775_5_775_7&#39;)"><span class="hl_fundecl"><span class="mpre">pb</span></span></a><span class="mpre"> </span><a name="loc_775_8_775_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_775_8_775_9&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">    = </span><a href="System.IO.Streams.Internal.html#loc_178_1_178_7" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_178_1_178_7&#39;)"><span class="hl_varref"><span class="mpre">unRead</span></span></a><span class="mpre"> </span><a href="#loc_775_8_775_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_775_8_775_9&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><a href="#loc_771_16_771_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_771_16_771_18&#39;)"><span class="hl_varref"><span class="mpre">is</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">------------------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Wraps an &#39;OutputStream&#39;, running the specified action when the stream</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- receives end-of-file.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- /Since: 1.0.2.0/</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_785_1_785_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_785_1_785_14&#39;)"><span class="mpre">atEndOfOutput</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><a href="System.IO.Streams.Internal.html#loc_126_6_126_18" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_126_6_126_18&#39;)"><span class="hl_tyconref"><span class="mpre">OutputStream</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="System.IO.Streams.Internal.html#loc_126_6_126_18" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_126_6_126_18&#39;)"><span class="hl_tyconref"><span class="mpre">OutputStream</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
</span><a name="loc_785_1_785_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_785_1_785_14&#39;)"><span class="hl_fundecl"><span class="mpre">atEndOfOutput</span></span></a><span class="mpre"> </span><a name="loc_785_15_785_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_785_15_785_16&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> </span><a name="loc_785_17_785_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_785_17_785_19&#39;)"><span class="hl_vardecl"><span class="mpre">os</span></span></a><span class="mpre"> = </span><a href="System.IO.Streams.Internal.html#loc_273_1_273_17" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_273_1_273_17&#39;)"><span class="hl_varref"><span class="mpre">makeOutputStream</span></span></a><span class="mpre"> </span><a href="#loc_787_5_787_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_787_5_787_6&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">
  where
    </span><a name="loc_787_5_787_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_787_5_787_6&#39;)"><span class="hl_fundecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> = </span><a href="System.IO.Streams.Internal.html#loc_147_1_147_6" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_147_1_147_6&#39;)"><span class="hl_varref"><span class="mpre">write</span></span></a><span class="mpre"> </span><a href="Data.Maybe.html#loc_49_19_49_26" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Maybe.html#loc_49_19_49_26&#39;)"><span class="hl_conref"><span class="mpre">Nothing</span></span></a><span class="mpre"> </span><a href="#loc_785_17_785_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_785_17_785_19&#39;)"><span class="hl_varref"><span class="mpre">os</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="Control.Monad.html#loc_195_1_195_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_195_1_195_5&#39;)"><span class="hl_varref"><span class="mpre">void</span></span></a><span class="mpre"> </span><a href="#loc_785_15_785_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_785_15_785_16&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">
    </span><a href="#loc_787_5_787_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_787_5_787_6&#39;)"><span class="hl_fundecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_788_7_788_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_788_7_788_8&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">       = </span><a href="System.IO.Streams.Internal.html#loc_147_1_147_6" onmouseover="nemnem.highlightLocalToRemote(&#39;System.IO.Streams.Internal.html#loc_147_1_147_6&#39;)"><span class="hl_varref"><span class="mpre">write</span></span></a><span class="mpre"> </span><a href="#loc_788_7_788_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_788_7_788_8&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> </span><a href="#loc_785_17_785_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_785_17_785_19&#39;)"><span class="hl_varref"><span class="mpre">os</span></span></a><span class="mpre">
</span></div></body></html>