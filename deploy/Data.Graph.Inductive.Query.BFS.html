<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-- (c) 2000-2005 by Martin Erwig [see file COPYRIGHT]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Breadth-First Search Algorithms</span></span><span class="mpre">

module Data.Graph.Inductive.Query.BFS(
    </span><span class="hl_comment"><span class="mpre">-- * BFS Node List</span></span><span class="mpre">
    bfs,bfsn,bfsWith,bfsnWith,
    </span><span class="hl_comment"><span class="mpre">-- * Node List With Depth Info</span></span><span class="mpre">
    level,leveln,
    </span><span class="hl_comment"><span class="mpre">-- * BFS Edges</span></span><span class="mpre">
    bfe,bfen,
    </span><span class="hl_comment"><span class="mpre">-- * BFS Tree</span></span><span class="mpre">
    bft,lbft,
    </span><span class="hl_comment"><span class="mpre">-- * Shortest Path (Number of Edges)</span></span><span class="mpre">
    esp,lesp
) where


import Data.Graph.Inductive.Graph
import Data.Graph.Inductive.Internal.Queue
import Data.Graph.Inductive.Internal.RootPath

</span><span class="hl_comment"><span class="mpre">-- bfs (node list ordered by distance)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_25_1_25_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_1_25_13&#39;)"><span class="mpre">bfsnInternal</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/BFS.hs&quot;, srcSpanStartLine = 24, srcSpanStartColumn = 17, srcSpanEndLine = 24, srcSpanEndColumn = 28}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/BFS.hs&quot;, srcSpanStartLine = 24, srcSpanStartColumn = 26, srcSpanEndLine = 24, srcSpanEndColumn = 28}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem"><span class="mpre">Graph gr =&gt;</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Context</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">c</span></span><span class="mpre">) -&gt; </span><a href="Data.Graph.Inductive.Internal.Queue.html#loc_9_6_9_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Internal.Queue.html#loc_9_6_9_11&#39;)"><span class="hl_tyconref"><span class="mpre">Queue</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyvar"><span class="mpre">c</span></span><span class="mpre">]
</span><a name="loc_25_1_25_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_1_25_13&#39;)"><span class="hl_fundecl"><span class="mpre">bfsnInternal</span></span></a><span class="mpre"> </span><a name="loc_25_14_25_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_14_25_15&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_25_16_25_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_16_25_17&#39;)"><span class="hl_vardecl"><span class="mpre">q</span></span></a><span class="mpre"> </span><a name="loc_25_18_25_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_18_25_19&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> | </span><a href="Data.Graph.Inductive.Internal.Queue.html#loc_26_1_26_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Internal.Queue.html#loc_26_1_26_11&#39;)"><span class="hl_varref"><span class="mpre">queueEmpty</span></span></a><span class="mpre"> </span><a href="#loc_25_16_25_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_16_25_17&#39;)"><span class="hl_varref"><span class="mpre">q</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><a href="Data.Graph.Inductive.Graph.html#loc_179_3_179_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Graph.html#loc_179_3_179_10&#39;)"><span class="hl_varref"><span class="mpre">isEmpty</span></span></a><span class="mpre"> </span><a href="#loc_25_18_25_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_18_25_19&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> = []
                   | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">                 =
       case </span><a href="Data.Graph.Inductive.Graph.html#loc_182_3_182_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Graph.html#loc_182_3_182_8&#39;)"><span class="hl_varref"><span class="mpre">match</span></span></a><span class="mpre"> </span><a href="#loc_30_16_30_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_16_30_17&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><a href="#loc_25_18_25_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_18_25_19&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> of
        (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_28_15_28_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_15_28_16&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">, </span><a name="loc_28_18_28_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_18_28_20&#39;)"><span class="hl_vardecl"><span class="mpre">g&#39;</span></span></a><span class="mpre">)  -&gt; </span><a href="#loc_25_14_25_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_14_25_15&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_28_15_28_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_15_28_16&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_25_1_25_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_1_25_13&#39;)"><span class="hl_varref"><span class="mpre">bfsnInternal</span></span></a><span class="mpre"> </span><a href="#loc_25_14_25_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_14_25_15&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="Data.Graph.Inductive.Internal.Queue.html#loc_18_1_18_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Internal.Queue.html#loc_18_1_18_13&#39;)"><span class="hl_varref"><span class="mpre">queuePutList</span></span></a><span class="mpre"> (</span><a href="Data.Graph.Inductive.Graph.html#loc_371_1_371_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Graph.html#loc_371_1_371_5&#39;)"><span class="hl_varref"><span class="mpre">suc&#39;</span></span></a><span class="mpre"> </span><a href="#loc_28_15_28_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_15_28_16&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">) </span><a href="#loc_30_18_30_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_18_30_20&#39;)"><span class="hl_varref"><span class="mpre">q&#39;</span></span></a><span class="mpre">) </span><a href="#loc_28_18_28_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_18_28_20&#39;)"><span class="hl_varref"><span class="mpre">g&#39;</span></span></a><span class="mpre">
        (</span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">, </span><a name="loc_29_19_29_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_19_29_21&#39;)"><span class="hl_vardecl"><span class="mpre">g&#39;</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_25_1_25_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_1_25_13&#39;)"><span class="hl_varref"><span class="mpre">bfsnInternal</span></span></a><span class="mpre"> </span><a href="#loc_25_14_25_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_14_25_15&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_30_18_30_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_18_30_20&#39;)"><span class="hl_varref"><span class="mpre">q&#39;</span></span></a><span class="mpre"> </span><a href="#loc_29_19_29_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_19_29_21&#39;)"><span class="hl_varref"><span class="mpre">g&#39;</span></span></a><span class="mpre">
        where (</span><a name="loc_30_16_30_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_16_30_17&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">,</span><a name="loc_30_18_30_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_18_30_20&#39;)"><span class="hl_vardecl"><span class="mpre">q&#39;</span></span></a><span class="mpre">) = </span><a href="Data.Graph.Inductive.Internal.Queue.html#loc_22_1_22_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Internal.Queue.html#loc_22_1_22_9&#39;)"><span class="hl_varref"><span class="mpre">queueGet</span></span></a><span class="mpre"> </span><a href="#loc_25_16_25_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_16_25_17&#39;)"><span class="hl_varref"><span class="mpre">q</span></span></a><span class="mpre">

</span><a href="#loc_33_1_33_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_1_33_9&#39;)"><span class="mpre">bfsnWith</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/BFS.hs&quot;, srcSpanStartLine = 32, srcSpanStartColumn = 13, srcSpanEndLine = 32, srcSpanEndColumn = 24}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/BFS.hs&quot;, srcSpanStartLine = 32, srcSpanStartColumn = 22, srcSpanEndLine = 32, srcSpanEndColumn = 24}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem"><span class="mpre">Graph gr =&gt;</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Context</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">c</span></span><span class="mpre">) -&gt; [</span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre">] -&gt; </span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyvar"><span class="mpre">c</span></span><span class="mpre">]
</span><a name="loc_33_1_33_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_1_33_9&#39;)"><span class="hl_fundecl"><span class="mpre">bfsnWith</span></span></a><span class="mpre"> </span><a name="loc_33_10_33_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_10_33_11&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_33_12_33_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_12_33_14&#39;)"><span class="hl_vardecl"><span class="mpre">vs</span></span></a><span class="mpre"> = </span><a href="#loc_25_1_25_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_1_25_13&#39;)"><span class="hl_varref"><span class="mpre">bfsnInternal</span></span></a><span class="mpre"> </span><a href="#loc_33_10_33_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_10_33_11&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="Data.Graph.Inductive.Internal.Queue.html#loc_18_1_18_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Internal.Queue.html#loc_18_1_18_13&#39;)"><span class="hl_varref"><span class="mpre">queuePutList</span></span></a><span class="mpre"> </span><a href="#loc_33_12_33_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_12_33_14&#39;)"><span class="hl_varref"><span class="mpre">vs</span></span></a><span class="mpre"> </span><a href="Data.Graph.Inductive.Internal.Queue.html#loc_12_1_12_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Internal.Queue.html#loc_12_1_12_8&#39;)"><span class="hl_varref"><span class="mpre">mkQueue</span></span></a><span class="mpre">)

</span><a href="#loc_36_1_36_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_1_36_5&#39;)"><span class="mpre">bfsn</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/BFS.hs&quot;, srcSpanStartLine = 35, srcSpanStartColumn = 9, srcSpanEndLine = 35, srcSpanEndColumn = 20}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/BFS.hs&quot;, srcSpanStartLine = 35, srcSpanStartColumn = 18, srcSpanEndLine = 35, srcSpanEndColumn = 20}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/"><span class="mpre">Graph gr =&gt;</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre">] -&gt; </span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre">]
</span><a name="loc_36_1_36_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_1_36_5&#39;)"><span class="hl_vardecl"><span class="mpre">bfsn</span></span></a><span class="mpre"> = </span><a href="#loc_33_1_33_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_1_33_9&#39;)"><span class="hl_varref"><span class="mpre">bfsnWith</span></span></a><span class="mpre"> </span><a href="Data.Graph.Inductive.Graph.html#loc_355_1_355_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Graph.html#loc_355_1_355_6&#39;)"><span class="hl_varref"><span class="mpre">node&#39;</span></span></a><span class="mpre">

</span><a href="#loc_39_1_39_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_1_39_8&#39;)"><span class="mpre">bfsWith</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/BFS.hs&quot;, srcSpanStartLine = 38, srcSpanStartColumn = 12, srcSpanEndLine = 38, srcSpanEndColumn = 23}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/BFS.hs&quot;, srcSpanStartLine = 38, srcSpanStartColumn = 21, srcSpanEndLine = 38, srcSpanEndColumn = 23}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem"><span class="mpre">Graph gr =&gt;</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Context</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">c</span></span><span class="mpre">) -&gt; </span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyvar"><span class="mpre">c</span></span><span class="mpre">]
</span><a name="loc_39_1_39_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_1_39_8&#39;)"><span class="hl_fundecl"><span class="mpre">bfsWith</span></span></a><span class="mpre"> </span><a name="loc_39_9_39_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_9_39_10&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> </span><a name="loc_39_11_39_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_11_39_12&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> = </span><a href="#loc_25_1_25_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_1_25_13&#39;)"><span class="hl_varref"><span class="mpre">bfsnInternal</span></span></a><span class="mpre"> </span><a href="#loc_39_9_39_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_9_39_10&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="Data.Graph.Inductive.Internal.Queue.html#loc_15_1_15_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Internal.Queue.html#loc_15_1_15_9&#39;)"><span class="hl_varref"><span class="mpre">queuePut</span></span></a><span class="mpre"> </span><a href="#loc_39_11_39_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_11_39_12&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><a href="Data.Graph.Inductive.Internal.Queue.html#loc_12_1_12_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Internal.Queue.html#loc_12_1_12_8&#39;)"><span class="hl_varref"><span class="mpre">mkQueue</span></span></a><span class="mpre">)

</span><a href="#loc_42_1_42_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_1_42_4&#39;)"><span class="mpre">bfs</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/BFS.hs&quot;, srcSpanStartLine = 41, srcSpanStartColumn = 8, srcSpanEndLine = 41, srcSpanEndColumn = 19}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/BFS.hs&quot;, srcSpanStartLine = 41, srcSpanStartColumn = 17, srcSpanEndLine = 41, srcSpanEndColumn = 19}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/"><span class="mpre">Graph gr =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre">]
</span><a name="loc_42_1_42_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_1_42_4&#39;)"><span class="hl_vardecl"><span class="mpre">bfs</span></span></a><span class="mpre"> = </span><a href="#loc_39_1_39_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_39_1_39_8&#39;)"><span class="hl_varref"><span class="mpre">bfsWith</span></span></a><span class="mpre"> </span><a href="Data.Graph.Inductive.Graph.html#loc_355_1_355_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Graph.html#loc_355_1_355_6&#39;)"><span class="hl_varref"><span class="mpre">node&#39;</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- level (extension of bfs giving the depth of each node)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_48_1_48_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_6&#39;)"><span class="mpre">level</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/BFS.hs&quot;, srcSpanStartLine = 47, srcSpanStartColumn = 10, srcSpanEndLine = 47, srcSpanEndColumn = 21}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/BFS.hs&quot;, srcSpanStartLine = 47, srcSpanStartColumn = 19, srcSpanEndLine = 47, srcSpanEndColumn = 21}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem"><span class="mpre">Graph gr =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; [(</span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">)]
</span><a name="loc_48_1_48_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_1_48_6&#39;)"><span class="hl_fundecl"><span class="mpre">level</span></span></a><span class="mpre"> </span><a name="loc_48_7_48_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_7_48_8&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> = </span><a href="#loc_53_1_53_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_1_53_7&#39;)"><span class="hl_varref"><span class="mpre">leveln</span></span></a><span class="mpre"> [(</span><a href="#loc_48_7_48_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_48_7_48_8&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">,</span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">)]

</span><a name="loc_50_1_50_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_1_50_5&#39;)"><span class="hl_fundecl"><span class="mpre">suci</span></span></a><span class="mpre"> </span><a name="loc_50_6_50_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_6_50_7&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> </span><a name="loc_50_8_50_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_8_50_9&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">zip</span></span><span class="mpre"> (</span><a href="Data.Graph.Inductive.Graph.html#loc_371_1_371_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Graph.html#loc_371_1_371_5&#39;)"><span class="hl_varref"><span class="mpre">suc&#39;</span></span></a><span class="mpre"> </span><a href="#loc_50_6_50_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_6_50_7&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">repeat</span></span><span class="mpre"> </span><a href="#loc_50_8_50_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_8_50_9&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">)

</span><a href="#loc_53_1_53_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_1_53_7&#39;)"><span class="mpre">leveln</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/BFS.hs&quot;, srcSpanStartLine = 52, srcSpanStartColumn = 11, srcSpanEndLine = 52, srcSpanEndColumn = 22}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/BFS.hs&quot;, srcSpanStartLine = 52, srcSpanStartColumn = 20, srcSpanEndLine = 52, srcSpanEndColumn = 22}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem"><span class="mpre">Graph gr =&gt;</span></span><span class="mpre"> [(</span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">)] -&gt; </span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; [(</span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">)]
</span><a name="loc_53_1_53_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_1_53_7&#39;)"><span class="hl_fundecl"><span class="mpre">leveln</span></span></a><span class="mpre"> []         _             = []
</span><a href="#loc_53_1_53_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_1_53_7&#39;)"><span class="hl_fundecl"><span class="mpre">leveln</span></span></a><span class="mpre"> _          </span><a name="loc_54_19_54_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_19_54_20&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> | </span><a href="Data.Graph.Inductive.Graph.html#loc_179_3_179_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Graph.html#loc_179_3_179_10&#39;)"><span class="hl_varref"><span class="mpre">isEmpty</span></span></a><span class="mpre"> </span><a href="#loc_54_19_54_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_19_54_20&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> = []
</span><a href="#loc_53_1_53_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_1_53_7&#39;)"><span class="hl_fundecl"><span class="mpre">leveln</span></span></a><span class="mpre"> ((</span><a name="loc_55_10_55_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_10_55_11&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">,</span><a name="loc_55_12_55_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_12_55_13&#39;)"><span class="hl_vardecl"><span class="mpre">j</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_55_15_55_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_15_55_17&#39;)"><span class="hl_vardecl"><span class="mpre">vs</span></span></a><span class="mpre">) </span><a name="loc_55_19_55_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_19_55_20&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> = case </span><a href="Data.Graph.Inductive.Graph.html#loc_182_3_182_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Graph.html#loc_182_3_182_8&#39;)"><span class="hl_varref"><span class="mpre">match</span></span></a><span class="mpre"> </span><a href="#loc_55_10_55_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_10_55_11&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><a href="#loc_55_19_55_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_19_55_20&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> of
                        (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_56_31_56_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_31_56_32&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">,</span><a name="loc_56_33_56_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_33_56_35&#39;)"><span class="hl_vardecl"><span class="mpre">g&#39;</span></span></a><span class="mpre">)  -&gt; (</span><a href="#loc_55_10_55_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_10_55_11&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">,</span><a href="#loc_55_12_55_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_12_55_13&#39;)"><span class="hl_varref"><span class="mpre">j</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_53_1_53_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_1_53_7&#39;)"><span class="hl_varref"><span class="mpre">leveln</span></span></a><span class="mpre"> (</span><a href="#loc_55_15_55_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_15_55_17&#39;)"><span class="hl_varref"><span class="mpre">vs</span></span></a><span class="hl_infix"><span class="mpre">++</span></span><a href="#loc_50_1_50_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_1_50_5&#39;)"><span class="hl_varref"><span class="mpre">suci</span></span></a><span class="mpre"> </span><a href="#loc_56_31_56_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_31_56_32&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> (</span><a href="#loc_55_12_55_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_12_55_13&#39;)"><span class="hl_varref"><span class="mpre">j</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)) </span><a href="#loc_56_33_56_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_33_56_35&#39;)"><span class="hl_varref"><span class="mpre">g&#39;</span></span></a><span class="mpre">
                        (</span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">,</span><a name="loc_57_34_57_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_34_57_36&#39;)"><span class="hl_vardecl"><span class="mpre">g&#39;</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_53_1_53_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_1_53_7&#39;)"><span class="hl_varref"><span class="mpre">leveln</span></span></a><span class="mpre"> </span><a href="#loc_55_15_55_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_15_55_17&#39;)"><span class="hl_varref"><span class="mpre">vs</span></span></a><span class="mpre"> </span><a href="#loc_57_34_57_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_34_57_36&#39;)"><span class="hl_varref"><span class="mpre">g&#39;</span></span></a><span class="mpre">  


</span><span class="hl_comment"><span class="mpre">-- bfe (breadth first edges)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- remembers predecessor information</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_64_1_64_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_1_64_13&#39;)"><span class="mpre">bfenInternal</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/BFS.hs&quot;, srcSpanStartLine = 63, srcSpanStartColumn = 17, srcSpanEndLine = 63, srcSpanEndColumn = 28}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/BFS.hs&quot;, srcSpanStartLine = 63, srcSpanStartColumn = 26, srcSpanEndLine = 63, srcSpanEndColumn = 28}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem"><span class="mpre">Graph gr =&gt;</span></span><span class="mpre"> </span><a href="Data.Graph.Inductive.Internal.Queue.html#loc_9_6_9_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Internal.Queue.html#loc_9_6_9_11&#39;)"><span class="hl_tyconref"><span class="mpre">Queue</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Edge</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Edge</span></span><span class="mpre">]
</span><a name="loc_64_1_64_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_1_64_13&#39;)"><span class="hl_fundecl"><span class="mpre">bfenInternal</span></span></a><span class="mpre"> </span><a name="loc_64_14_64_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_14_64_15&#39;)"><span class="hl_vardecl"><span class="mpre">q</span></span></a><span class="mpre"> </span><a name="loc_64_16_64_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_16_64_17&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> | </span><a href="Data.Graph.Inductive.Internal.Queue.html#loc_26_1_26_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Internal.Queue.html#loc_26_1_26_11&#39;)"><span class="hl_varref"><span class="mpre">queueEmpty</span></span></a><span class="mpre"> </span><a href="#loc_64_14_64_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_14_64_15&#39;)"><span class="hl_varref"><span class="mpre">q</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><a href="Data.Graph.Inductive.Graph.html#loc_179_3_179_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Graph.html#loc_179_3_179_10&#39;)"><span class="hl_varref"><span class="mpre">isEmpty</span></span></a><span class="mpre"> </span><a href="#loc_64_16_64_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_16_64_17&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> = []
                 | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">                 = 
      case </span><a href="Data.Graph.Inductive.Graph.html#loc_182_3_182_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Graph.html#loc_182_3_182_8&#39;)"><span class="hl_varref"><span class="mpre">match</span></span></a><span class="mpre"> </span><a href="#loc_69_19_69_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_19_69_20&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><a href="#loc_64_16_64_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_16_64_17&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> of
        (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_67_15_67_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_15_67_16&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">, </span><a name="loc_67_18_67_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_18_67_20&#39;)"><span class="hl_vardecl"><span class="mpre">g&#39;</span></span></a><span class="mpre">)  -&gt; (</span><a href="#loc_69_17_69_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_17_69_18&#39;)"><span class="hl_varref"><span class="mpre">u</span></span></a><span class="mpre">,</span><a href="#loc_69_19_69_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_19_69_20&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_64_1_64_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_1_64_13&#39;)"><span class="hl_varref"><span class="mpre">bfenInternal</span></span></a><span class="mpre"> (</span><a href="Data.Graph.Inductive.Internal.Queue.html#loc_18_1_18_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Internal.Queue.html#loc_18_1_18_13&#39;)"><span class="hl_varref"><span class="mpre">queuePutList</span></span></a><span class="mpre"> (</span><a href="#loc_77_1_77_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_1_77_5&#39;)"><span class="hl_varref"><span class="mpre">outU</span></span></a><span class="mpre"> </span><a href="#loc_67_15_67_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_15_67_16&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">) </span><a href="#loc_69_22_69_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_22_69_24&#39;)"><span class="hl_varref"><span class="mpre">q&#39;</span></span></a><span class="mpre">) </span><a href="#loc_67_18_67_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_18_67_20&#39;)"><span class="hl_varref"><span class="mpre">g&#39;</span></span></a><span class="mpre">
        (</span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">, </span><a name="loc_68_19_68_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_19_68_21&#39;)"><span class="hl_vardecl"><span class="mpre">g&#39;</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_64_1_64_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_1_64_13&#39;)"><span class="hl_varref"><span class="mpre">bfenInternal</span></span></a><span class="mpre"> </span><a href="#loc_69_22_69_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_22_69_24&#39;)"><span class="hl_varref"><span class="mpre">q&#39;</span></span></a><span class="mpre"> </span><a href="#loc_68_19_68_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_19_68_21&#39;)"><span class="hl_varref"><span class="mpre">g&#39;</span></span></a><span class="mpre">
        where ((</span><a name="loc_69_17_69_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_17_69_18&#39;)"><span class="hl_vardecl"><span class="mpre">u</span></span></a><span class="mpre">,</span><a name="loc_69_19_69_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_19_69_20&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">),</span><a name="loc_69_22_69_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_22_69_24&#39;)"><span class="hl_vardecl"><span class="mpre">q&#39;</span></span></a><span class="mpre">) = </span><a href="Data.Graph.Inductive.Internal.Queue.html#loc_22_1_22_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Internal.Queue.html#loc_22_1_22_9&#39;)"><span class="hl_varref"><span class="mpre">queueGet</span></span></a><span class="mpre"> </span><a href="#loc_64_14_64_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_14_64_15&#39;)"><span class="hl_varref"><span class="mpre">q</span></span></a><span class="mpre">

</span><a href="#loc_72_1_72_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_1_72_5&#39;)"><span class="mpre">bfen</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/BFS.hs&quot;, srcSpanStartLine = 71, srcSpanStartColumn = 9, srcSpanEndLine = 71, srcSpanEndColumn = 20}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/BFS.hs&quot;, srcSpanStartLine = 71, srcSpanStartColumn = 18, srcSpanEndLine = 71, srcSpanEndColumn = 20}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/"><span class="mpre">Graph gr =&gt;</span></span><span class="mpre"> [</span><span class="hl_tyconref"><span class="mpre">Edge</span></span><span class="mpre">] -&gt; </span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Edge</span></span><span class="mpre">]
</span><a name="loc_72_1_72_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_1_72_5&#39;)"><span class="hl_fundecl"><span class="mpre">bfen</span></span></a><span class="mpre"> </span><a name="loc_72_6_72_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_6_72_8&#39;)"><span class="hl_vardecl"><span class="mpre">vs</span></span></a><span class="mpre"> </span><a name="loc_72_9_72_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_9_72_10&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> = </span><a href="#loc_64_1_64_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_1_64_13&#39;)"><span class="hl_varref"><span class="mpre">bfenInternal</span></span></a><span class="mpre"> (</span><a href="Data.Graph.Inductive.Internal.Queue.html#loc_18_1_18_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Internal.Queue.html#loc_18_1_18_13&#39;)"><span class="hl_varref"><span class="mpre">queuePutList</span></span></a><span class="mpre"> </span><a href="#loc_72_6_72_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_6_72_8&#39;)"><span class="hl_varref"><span class="mpre">vs</span></span></a><span class="mpre"> </span><a href="Data.Graph.Inductive.Internal.Queue.html#loc_12_1_12_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Internal.Queue.html#loc_12_1_12_8&#39;)"><span class="hl_varref"><span class="mpre">mkQueue</span></span></a><span class="mpre">) </span><a href="#loc_72_9_72_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_9_72_10&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">

</span><a href="#loc_75_1_75_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_1_75_4&#39;)"><span class="mpre">bfe</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/BFS.hs&quot;, srcSpanStartLine = 74, srcSpanStartColumn = 8, srcSpanEndLine = 74, srcSpanEndColumn = 19}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/BFS.hs&quot;, srcSpanStartLine = 74, srcSpanStartColumn = 17, srcSpanEndLine = 74, srcSpanEndColumn = 19}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/"><span class="mpre">Graph gr =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">Edge</span></span><span class="mpre">]
</span><a name="loc_75_1_75_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_1_75_4&#39;)"><span class="hl_fundecl"><span class="mpre">bfe</span></span></a><span class="mpre"> </span><a name="loc_75_5_75_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_5_75_6&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> = </span><a href="#loc_72_1_72_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_1_72_5&#39;)"><span class="hl_varref"><span class="mpre">bfen</span></span></a><span class="mpre"> [(</span><a href="#loc_75_5_75_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_5_75_6&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">,</span><a href="#loc_75_5_75_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_5_75_6&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">)]

</span><a name="loc_77_1_77_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_1_77_5&#39;)"><span class="hl_fundecl"><span class="mpre">outU</span></span></a><span class="mpre"> </span><a name="loc_77_6_77_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_6_77_7&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (\(</span><a name="loc_77_17_77_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_17_77_18&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">,</span><a name="loc_77_19_77_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_19_77_20&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre">,_)-&gt;(</span><a href="#loc_77_17_77_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_17_77_18&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">,</span><a href="#loc_77_19_77_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_19_77_20&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">)) (</span><a href="Data.Graph.Inductive.Graph.html#loc_387_1_387_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Graph.html#loc_387_1_387_5&#39;)"><span class="hl_varref"><span class="mpre">out&#39;</span></span></a><span class="mpre"> </span><a href="#loc_77_6_77_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_6_77_7&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">)


</span><span class="hl_comment"><span class="mpre">-- bft (breadth first search tree)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- here: with inward directed trees</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- bft :: Node -&gt; gr a b -&gt; IT.InTree Node</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- bft v g = IT.build $ map swap $ bfe v g</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--           where swap (x,y) = (y,x)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- sp (shortest path wrt to number of edges)</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- sp :: Node -&gt; Node -&gt; gr a b -&gt; [Node]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- sp s t g = reverse $ IT.rootPath (bft s g) t</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- faster shortest paths </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- here: with root path trees</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- </span></span><span class="mpre">
</span><a href="#loc_97_1_97_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_1_97_4&#39;)"><span class="mpre">bft</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/BFS.hs&quot;, srcSpanStartLine = 96, srcSpanStartColumn = 8, srcSpanEndLine = 96, srcSpanEndColumn = 19}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/BFS.hs&quot;, srcSpanStartLine = 96, srcSpanStartColumn = 17, srcSpanEndLine = 96, srcSpanEndColumn = 19}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/"><span class="mpre">Graph gr =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">RTree</span></span><span class="mpre">
</span><a name="loc_97_1_97_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_1_97_4&#39;)"><span class="hl_fundecl"><span class="mpre">bft</span></span></a><span class="mpre"> </span><a name="loc_97_5_97_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_5_97_6&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> = </span><a href="#loc_100_1_100_3" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_1_100_3&#39;)"><span class="hl_varref"><span class="mpre">bf</span></span></a><span class="mpre"> (</span><a href="Data.Graph.Inductive.Internal.Queue.html#loc_15_1_15_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Internal.Queue.html#loc_15_1_15_9&#39;)"><span class="hl_varref"><span class="mpre">queuePut</span></span></a><span class="mpre"> [</span><a href="#loc_97_5_97_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_5_97_6&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">] </span><a href="Data.Graph.Inductive.Internal.Queue.html#loc_12_1_12_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Internal.Queue.html#loc_12_1_12_8&#39;)"><span class="hl_varref"><span class="mpre">mkQueue</span></span></a><span class="mpre">)

</span><a href="#loc_100_1_100_3" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_1_100_3&#39;)"><span class="mpre">bf</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/BFS.hs&quot;, srcSpanStartLine = 99, srcSpanStartColumn = 7, srcSpanEndLine = 99, srcSpanEndColumn = 18}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/BFS.hs&quot;, srcSpanStartLine = 99, srcSpanStartColumn = 16, srcSpanEndLine = 99, srcSpanEndColumn = 18}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/"><span class="mpre">Graph gr =&gt;</span></span><span class="mpre"> </span><a href="Data.Graph.Inductive.Internal.Queue.html#loc_9_6_9_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Internal.Queue.html#loc_9_6_9_11&#39;)"><span class="hl_tyconref"><span class="mpre">Queue</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Path</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">RTree</span></span><span class="mpre">
</span><a name="loc_100_1_100_3" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_1_100_3&#39;)"><span class="hl_fundecl"><span class="mpre">bf</span></span></a><span class="mpre"> </span><a name="loc_100_4_100_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_4_100_5&#39;)"><span class="hl_vardecl"><span class="mpre">q</span></span></a><span class="mpre"> </span><a name="loc_100_6_100_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_6_100_7&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> | </span><a href="Data.Graph.Inductive.Internal.Queue.html#loc_26_1_26_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Internal.Queue.html#loc_26_1_26_11&#39;)"><span class="hl_varref"><span class="mpre">queueEmpty</span></span></a><span class="mpre"> </span><a href="#loc_100_4_100_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_4_100_5&#39;)"><span class="hl_varref"><span class="mpre">q</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><a href="Data.Graph.Inductive.Graph.html#loc_179_3_179_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Graph.html#loc_179_3_179_10&#39;)"><span class="hl_varref"><span class="mpre">isEmpty</span></span></a><span class="mpre"> </span><a href="#loc_100_6_100_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_6_100_7&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> = []
       | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">                 =
       case </span><a href="Data.Graph.Inductive.Graph.html#loc_182_3_182_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Graph.html#loc_182_3_182_8&#39;)"><span class="hl_varref"><span class="mpre">match</span></span></a><span class="mpre"> </span><a href="#loc_105_20_105_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_20_105_21&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><a href="#loc_100_6_100_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_6_100_7&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> of
         (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_103_16_103_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_16_103_17&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">, </span><a name="loc_103_19_103_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_19_103_21&#39;)"><span class="hl_vardecl"><span class="mpre">g&#39;</span></span></a><span class="mpre">)  -&gt; </span><a href="#loc_105_17_105_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_17_105_18&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_100_1_100_3" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_1_100_3&#39;)"><span class="hl_varref"><span class="mpre">bf</span></span></a><span class="mpre"> (</span><a href="Data.Graph.Inductive.Internal.Queue.html#loc_18_1_18_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Internal.Queue.html#loc_18_1_18_13&#39;)"><span class="hl_varref"><span class="mpre">queuePutList</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_105_17_105_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_17_105_18&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">) (</span><a href="Data.Graph.Inductive.Graph.html#loc_371_1_371_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Graph.html#loc_371_1_371_5&#39;)"><span class="hl_varref"><span class="mpre">suc&#39;</span></span></a><span class="mpre"> </span><a href="#loc_103_16_103_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_16_103_17&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">)) </span><a href="#loc_105_25_105_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_25_105_27&#39;)"><span class="hl_varref"><span class="mpre">q&#39;</span></span></a><span class="mpre">) </span><a href="#loc_103_19_103_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_103_19_103_21&#39;)"><span class="hl_varref"><span class="mpre">g&#39;</span></span></a><span class="mpre">
         (</span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">, </span><a name="loc_104_20_104_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_20_104_22&#39;)"><span class="hl_vardecl"><span class="mpre">g&#39;</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_100_1_100_3" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_1_100_3&#39;)"><span class="hl_varref"><span class="mpre">bf</span></span></a><span class="mpre"> </span><a href="#loc_105_25_105_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_25_105_27&#39;)"><span class="hl_varref"><span class="mpre">q&#39;</span></span></a><span class="mpre"> </span><a href="#loc_104_20_104_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_20_104_22&#39;)"><span class="hl_varref"><span class="mpre">g&#39;</span></span></a><span class="mpre">
         where (</span><a name="loc_105_17_105_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_17_105_18&#39;)"><span class="hl_specname"><span class="mpre">p</span></span></a><span class="mpre">@(</span><a name="loc_105_20_105_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_20_105_21&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_),</span><a name="loc_105_25_105_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_25_105_27&#39;)"><span class="hl_vardecl"><span class="mpre">q&#39;</span></span></a><span class="mpre">) = </span><a href="Data.Graph.Inductive.Internal.Queue.html#loc_22_1_22_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Internal.Queue.html#loc_22_1_22_9&#39;)"><span class="hl_varref"><span class="mpre">queueGet</span></span></a><span class="mpre"> </span><a href="#loc_100_4_100_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_4_100_5&#39;)"><span class="hl_varref"><span class="mpre">q</span></span></a><span class="mpre">

</span><a href="#loc_108_1_108_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_1_108_4&#39;)"><span class="mpre">esp</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/BFS.hs&quot;, srcSpanStartLine = 107, srcSpanStartColumn = 8, srcSpanEndLine = 107, srcSpanEndColumn = 19}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/BFS.hs&quot;, srcSpanStartLine = 107, srcSpanStartColumn = 17, srcSpanEndLine = 107, srcSpanEndColumn = 19}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nem"><span class="mpre">Graph gr =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Path</span></span><span class="mpre">
</span><a name="loc_108_1_108_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_1_108_4&#39;)"><span class="hl_fundecl"><span class="mpre">esp</span></span></a><span class="mpre"> </span><a name="loc_108_5_108_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_5_108_6&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> </span><a name="loc_108_7_108_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_7_108_8&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> = </span><a href="Data.Graph.Inductive.Internal.RootPath.html#loc_42_1_42_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Internal.RootPath.html#loc_42_1_42_8&#39;)"><span class="hl_varref"><span class="mpre">getPath</span></span></a><span class="mpre"> </span><a href="#loc_108_7_108_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_7_108_8&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_97_1_97_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_1_97_4&#39;)"><span class="hl_varref"><span class="mpre">bft</span></span></a><span class="mpre"> </span><a href="#loc_108_5_108_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_5_108_6&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- lesp is a version of esp that returns labeled paths</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Note that the label of the first node in a returned path is meaningless;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- all other nodes are paired with the label of their incoming edge. </span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_116_1_116_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_1_116_5&#39;)"><span class="mpre">lbft</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/BFS.hs&quot;, srcSpanStartLine = 115, srcSpanStartColumn = 9, srcSpanEndLine = 115, srcSpanEndColumn = 20}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/BFS.hs&quot;, srcSpanStartLine = 115, srcSpanStartColumn = 18, srcSpanEndLine = 115, srcSpanEndColumn = 20}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nem"><span class="mpre">Graph gr =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">LRTree</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">
</span><a name="loc_116_1_116_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_1_116_5&#39;)"><span class="hl_fundecl"><span class="mpre">lbft</span></span></a><span class="mpre"> </span><a name="loc_116_6_116_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_6_116_7&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> </span><a name="loc_116_8_116_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_8_116_9&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> = case (</span><a href="Data.Graph.Inductive.Graph.html#loc_335_1_335_4" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Graph.html#loc_335_1_335_4&#39;)"><span class="hl_varref"><span class="mpre">out</span></span></a><span class="mpre"> </span><a href="#loc_116_8_116_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_8_116_9&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> </span><a href="#loc_116_6_116_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_6_116_7&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">) of 
             []         -&gt; [</span><a href="Data.Graph.Inductive.Graph.html#loc_149_19_149_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Graph.html#loc_149_19_149_21&#39;)"><span class="hl_conref"><span class="mpre">LP</span></span></a><span class="mpre"> []]
             (</span><a name="loc_118_15_118_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_15_118_17&#39;)"><span class="hl_vardecl"><span class="mpre">v&#39;</span></span></a><span class="mpre">,_,</span><a name="loc_118_20_118_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_20_118_21&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_ -&gt; </span><a href="#loc_121_1_121_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_1_121_4&#39;)"><span class="hl_varref"><span class="mpre">lbf</span></span></a><span class="mpre"> (</span><a href="Data.Graph.Inductive.Internal.Queue.html#loc_15_1_15_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Internal.Queue.html#loc_15_1_15_9&#39;)"><span class="hl_varref"><span class="mpre">queuePut</span></span></a><span class="mpre"> (</span><a href="Data.Graph.Inductive.Graph.html#loc_149_19_149_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Graph.html#loc_149_19_149_21&#39;)"><span class="hl_conref"><span class="mpre">LP</span></span></a><span class="mpre"> [(</span><a href="#loc_118_15_118_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_15_118_17&#39;)"><span class="hl_varref"><span class="mpre">v&#39;</span></span></a><span class="mpre">,</span><a href="#loc_118_20_118_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_118_20_118_21&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">)]) </span><a href="Data.Graph.Inductive.Internal.Queue.html#loc_12_1_12_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Internal.Queue.html#loc_12_1_12_8&#39;)"><span class="hl_varref"><span class="mpre">mkQueue</span></span></a><span class="mpre">) </span><a href="#loc_116_8_116_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_8_116_9&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">

</span><a href="#loc_121_1_121_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_1_121_4&#39;)"><span class="mpre">lbf</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/BFS.hs&quot;, srcSpanStartLine = 120, srcSpanStartColumn = 8, srcSpanEndLine = 120, srcSpanEndColumn = 19}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/BFS.hs&quot;, srcSpanStartLine = 120, srcSpanStartColumn = 17, srcSpanEndLine = 120, srcSpanEndColumn = 19}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nem"><span class="mpre">Graph gr =&gt;</span></span><span class="mpre"> </span><a href="Data.Graph.Inductive.Internal.Queue.html#loc_9_6_9_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Internal.Queue.html#loc_9_6_9_11&#39;)"><span class="hl_tyconref"><span class="mpre">Queue</span></span></a><span class="mpre"> (</span><a href="Data.Graph.Inductive.Graph.html#loc_149_9_149_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Graph.html#loc_149_9_149_14&#39;)"><span class="hl_tyconref"><span class="mpre">LPath</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) -&gt; </span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">LRTree</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">
</span><a name="loc_121_1_121_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_1_121_4&#39;)"><span class="hl_fundecl"><span class="mpre">lbf</span></span></a><span class="mpre"> </span><a name="loc_121_5_121_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_5_121_6&#39;)"><span class="hl_vardecl"><span class="mpre">q</span></span></a><span class="mpre"> </span><a name="loc_121_7_121_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_7_121_8&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> | </span><a href="Data.Graph.Inductive.Internal.Queue.html#loc_26_1_26_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Internal.Queue.html#loc_26_1_26_11&#39;)"><span class="hl_varref"><span class="mpre">queueEmpty</span></span></a><span class="mpre"> </span><a href="#loc_121_5_121_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_5_121_6&#39;)"><span class="hl_varref"><span class="mpre">q</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><a href="Data.Graph.Inductive.Graph.html#loc_179_3_179_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Graph.html#loc_179_3_179_10&#39;)"><span class="hl_varref"><span class="mpre">isEmpty</span></span></a><span class="mpre"> </span><a href="#loc_121_7_121_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_7_121_8&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> = []
        | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">                 =
       case </span><a href="Data.Graph.Inductive.Graph.html#loc_182_3_182_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Graph.html#loc_182_3_182_8&#39;)"><span class="hl_varref"><span class="mpre">match</span></span></a><span class="mpre"> </span><a href="#loc_127_26_127_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_26_127_27&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><a href="#loc_121_7_121_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_7_121_8&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre"> of
         (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_124_16_124_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_16_124_17&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">, </span><a name="loc_124_19_124_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_19_124_21&#39;)"><span class="hl_vardecl"><span class="mpre">g&#39;</span></span></a><span class="mpre">) -&gt;
             </span><a href="Data.Graph.Inductive.Graph.html#loc_149_19_149_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Graph.html#loc_149_19_149_21&#39;)"><span class="hl_conref"><span class="mpre">LP</span></span></a><span class="mpre"> </span><a href="#loc_127_22_127_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_22_127_23&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_121_1_121_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_1_121_4&#39;)"><span class="hl_varref"><span class="mpre">lbf</span></span></a><span class="mpre"> (</span><a href="Data.Graph.Inductive.Internal.Queue.html#loc_18_1_18_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Internal.Queue.html#loc_18_1_18_13&#39;)"><span class="hl_varref"><span class="mpre">queuePutList</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (\</span><a name="loc_125_44_125_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_44_125_46&#39;)"><span class="hl_vardecl"><span class="mpre">v&#39;</span></span></a><span class="mpre"> -&gt; </span><a href="Data.Graph.Inductive.Graph.html#loc_149_19_149_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Graph.html#loc_149_19_149_21&#39;)"><span class="hl_conref"><span class="mpre">LP</span></span></a><span class="mpre"> (</span><a href="#loc_125_44_125_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_44_125_46&#39;)"><span class="hl_varref"><span class="mpre">v&#39;</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_127_22_127_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_22_127_23&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">)) (</span><a href="Data.Graph.Inductive.Graph.html#loc_379_1_379_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Graph.html#loc_379_1_379_6&#39;)"><span class="hl_varref"><span class="mpre">lsuc&#39;</span></span></a><span class="mpre"> </span><a href="#loc_124_16_124_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_16_124_17&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">)) </span><a href="#loc_127_36_127_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_36_127_38&#39;)"><span class="hl_varref"><span class="mpre">q&#39;</span></span></a><span class="mpre">) </span><a href="#loc_124_19_124_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_19_124_21&#39;)"><span class="hl_varref"><span class="mpre">g&#39;</span></span></a><span class="mpre">
         (</span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">, </span><a name="loc_126_20_126_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_20_126_22&#39;)"><span class="hl_vardecl"><span class="mpre">g&#39;</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_121_1_121_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_1_121_4&#39;)"><span class="hl_varref"><span class="mpre">lbf</span></span></a><span class="mpre"> </span><a href="#loc_127_36_127_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_36_127_38&#39;)"><span class="hl_varref"><span class="mpre">q&#39;</span></span></a><span class="mpre"> </span><a href="#loc_126_20_126_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_20_126_22&#39;)"><span class="hl_varref"><span class="mpre">g&#39;</span></span></a><span class="mpre">
         where ((</span><a href="Data.Graph.Inductive.Graph.html#loc_149_19_149_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Graph.html#loc_149_19_149_21&#39;)"><span class="hl_conref"><span class="mpre">LP</span></span></a><span class="mpre"> (</span><a name="loc_127_22_127_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_22_127_23&#39;)"><span class="hl_specname"><span class="mpre">p</span></span></a><span class="mpre">@((</span><a name="loc_127_26_127_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_26_127_27&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">,_)</span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_))),</span><a name="loc_127_36_127_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_127_36_127_38&#39;)"><span class="hl_vardecl"><span class="mpre">q&#39;</span></span></a><span class="mpre">) = </span><a href="Data.Graph.Inductive.Internal.Queue.html#loc_22_1_22_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Internal.Queue.html#loc_22_1_22_9&#39;)"><span class="hl_varref"><span class="mpre">queueGet</span></span></a><span class="mpre"> </span><a href="#loc_121_5_121_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_121_5_121_6&#39;)"><span class="hl_varref"><span class="mpre">q</span></span></a><span class="mpre">

</span><a href="#loc_130_1_130_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_1_130_5&#39;)"><span class="mpre">lesp</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/BFS.hs&quot;, srcSpanStartLine = 129, srcSpanStartColumn = 9, srcSpanEndLine = 129, srcSpanEndColumn = 20}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Query/BFS.hs&quot;, srcSpanStartLine = 129, srcSpanStartColumn = 18, srcSpanEndLine = 129, srcSpanEndColumn = 20}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nem"><span class="mpre">Graph gr =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre"> -&gt; </span><span class="hl_tyvar"><span class="mpre">gr</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><a href="Data.Graph.Inductive.Graph.html#loc_149_9_149_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Graph.html#loc_149_9_149_14&#39;)"><span class="hl_tyconref"><span class="mpre">LPath</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">
</span><a name="loc_130_1_130_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_1_130_5&#39;)"><span class="hl_fundecl"><span class="mpre">lesp</span></span></a><span class="mpre"> </span><a name="loc_130_6_130_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_6_130_7&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> </span><a name="loc_130_8_130_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_8_130_9&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre"> = </span><a href="Data.Graph.Inductive.Internal.RootPath.html#loc_45_1_45_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Internal.RootPath.html#loc_45_1_45_9&#39;)"><span class="hl_varref"><span class="mpre">getLPath</span></span></a><span class="mpre"> </span><a href="#loc_130_8_130_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_8_130_9&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_116_1_116_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_1_116_5&#39;)"><span class="hl_varref"><span class="mpre">lbft</span></span></a><span class="mpre"> </span><a href="#loc_130_6_130_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_6_130_7&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">

</span></div></body></html>