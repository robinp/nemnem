<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      : Data.X509.Signed</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     : BSD-style</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  : Vincent Hanquez &lt;vincent@snarc.org&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   : experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability : unknown</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Exposes helpers for X509 certificate and revocation list, signed structures.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Signed structures are of the form:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--      Sequence {</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--          object              a</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--          signatureAlgorithm  AlgorithmIdentifier</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--          signatureValue      BitString</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--      }</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Unfortunately as lots of signed objects published have been signed on an</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- arbitrary BER ASN1 encoding (instead of using the unique DER encoding) or in</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- a non-valid DER implementation, we need to keep the raw data being signed,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- as we can&#39;t recompute the bytestring used to sign for non compliant cases.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Signed represent the pure data type for compliant cases, and SignedExact</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- the real world situation of having to deal with compliant and non-compliant cases.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
module Data.X509.Signed
    (
    </span><span class="hl_comment"><span class="mpre">-- * Types</span></span><span class="mpre">
      Signed(..)
    , SignedExact
    </span><span class="hl_comment"><span class="mpre">-- * SignedExact to Signed</span></span><span class="mpre">
    , getSigned
    , getSignedData
    </span><span class="hl_comment"><span class="mpre">-- * Marshalling function</span></span><span class="mpre">
    , encodeSignedObject
    , decodeSignedObject
    </span><span class="hl_comment"><span class="mpre">-- * Object to Signed and SignedExact</span></span><span class="mpre">
    , objectToSignedExact
    , objectToSigned
    , signedToExact
    ) where

import Control.Arrow (</span><a href="Control.Arrow.html#loc_90_5_90_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Arrow.html#loc_90_5_90_10&#39;)"><span class="mpre">first</span></a><span class="mpre">)
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-1.4.11/Data/X509/Signed.hs&quot;, srcSpanStartLine = 43, srcSpanStartColumn = 8, srcSpanEndLine = 43, srcSpanEndColumn = 23}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> (ByteString)
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-1.4.11/Data/X509/Signed.hs&quot;, srcSpanStartLine = 44, srcSpanStartColumn = 18, srcSpanEndLine = 44, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> as B
import Data.X509.AlgorithmIdentifier
import Data.ASN1.Types
import Data.ASN1.Encoding
import Data.ASN1.BinaryEncoding
import Data.ASN1.Stream
import Data.ASN1.BitArray
import qualified Data.ASN1.BinaryEncoding.Raw as Raw (</span><a href="Data.ASN1.BinaryEncoding.Writer.html#loc_23_1_23_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.BinaryEncoding.Writer.html#loc_23_1_23_13&#39;)"><span class="mpre">toByteString</span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Represent a signed object using a traditional X509 structure.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- When dealing with external certificate, use the SignedExact structure</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- not this one.</span></span><span class="mpre">
data </span><span class="warning" data-warning="DataDecl ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-1.4.11/Data/X509/Signed.hs&quot;, srcSpanStartLine = 57, srcSpanStartColumn = 6, srcSpanEndLine = 57, srcSpanEndColumn = 37}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-1.4.11/Data/X509/Signed.hs&quot;, srcSpanStartLine = 57, srcSpanStartColumn = 6, srcSpanEndLine = 57, srcSpanEndColumn = 7},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-1.4.11/Data/X509/Signed.hs&quot;, srcSpanStartLine = 57, srcSpanS"><span class="mpre">(Show a, Eq a, ASN1Object a) =&gt;</span></span><span class="mpre"> </span><a name="loc_57_38_57_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_38_57_44&#39;)"><span class="hl_tycondecl"><span class="mpre">Signed</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> = </span><span class="hl_condecl"><span class="mpre">Signed</span></span><span class="mpre">
    { </span><a name="loc_58_7_58_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_7_58_19&#39;)"><span class="hl_fielddecl"><span class="mpre">signedObject</span></span></a><span class="mpre">    :: </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">            </span><span class="hl_comment"><span class="mpre">-- ^ Object to sign</span></span><span class="mpre">
    , </span><a name="loc_59_7_59_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_7_59_16&#39;)"><span class="hl_fielddecl"><span class="mpre">signedAlg</span></span></a><span class="mpre">       :: </span><a href="Data.X509.AlgorithmIdentifier.html#loc_39_6_39_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.AlgorithmIdentifier.html#loc_39_6_39_18&#39;)"><span class="hl_tyconref"><span class="mpre">SignatureALG</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ Signature Algorithm used</span></span><span class="mpre">
    , </span><a name="loc_60_7_60_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_7_60_22&#39;)"><span class="hl_fielddecl"><span class="mpre">signedSignature</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ Signature as bytes</span></span><span class="mpre">
    } </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-1.4.11/Data/X509/Signed.hs&quot;, srcSpanStartLine = 61, srcSpanStartColumn = 7, srcSpanEndLine = 61, srcSpanEndColumn = 26}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-1.4.11/Data/X509/Signed.hs&quot;, srcSpanStartLine = 61, srcSpanStartColumn = 7, srcSpanEndLine = 61, srcSpanEndColumn = 15},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-1.4.11/Data/X509/Signed.hs&quot;, srcSpanStartLine = 61, srcSpa"><span class="mpre">deriving (Show, Eq)</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Represent the signed object plus the raw data that we need to</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- keep around for non compliant case to be able to verify signature.</span></span><span class="mpre">
data </span><span class="warning" data-warning="DataDecl ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-1.4.11/Data/X509/Signed.hs&quot;, srcSpanStartLine = 65, srcSpanStartColumn = 6, srcSpanEndLine = 65, srcSpanEndColumn = 37}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-1.4.11/Data/X509/Signed.hs&quot;, srcSpanStartLine = 65, srcSpanStartColumn = 6, srcSpanEndLine = 65, srcSpanEndColumn = 7},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-1.4.11/Data/X509/Signed.hs&quot;, srcSpanStartLine = 65, srcSpanS"><span class="mpre">(Show a, Eq a, ASN1Object a) =&gt;</span></span><span class="mpre"> </span><a name="loc_65_38_65_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_38_65_49&#39;)"><span class="hl_tycondecl"><span class="mpre">SignedExact</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> = </span><a name="loc_65_54_65_65" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_54_65_65&#39;)"><span class="hl_condecl"><span class="mpre">SignedExact</span></span></a><span class="mpre">
    { </span><a name="loc_66_7_66_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_7_66_16&#39;)"><span class="hl_fielddecl"><span class="mpre">getSigned</span></span></a><span class="mpre">          :: </span><a href="#loc_57_38_57_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_38_57_44&#39;)"><span class="hl_tyconref"><span class="mpre">Signed</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">     </span><span class="hl_comment"><span class="mpre">-- ^ get the decoded Signed data</span></span><span class="mpre">
    , </span><a name="loc_67_7_67_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_7_67_21&#39;)"><span class="hl_fielddecl"><span class="mpre">exactObjectRaw</span></span></a><span class="mpre">     :: </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ The raw representation of the object a</span></span><span class="mpre">
                                         </span><span class="hl_comment"><span class="mpre">-- TODO: in later version, replace with offset in exactRaw</span></span><span class="mpre">
    , </span><a name="loc_69_7_69_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_7_69_25&#39;)"><span class="hl_fielddecl"><span class="mpre">encodeSignedObject</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- ^ The raw representation of the whole signed structure</span></span><span class="mpre">
    } </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-1.4.11/Data/X509/Signed.hs&quot;, srcSpanStartLine = 70, srcSpanStartColumn = 7, srcSpanEndLine = 70, srcSpanEndColumn = 26}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-1.4.11/Data/X509/Signed.hs&quot;, srcSpanStartLine = 70, srcSpanStartColumn = 7, srcSpanEndLine = 70, srcSpanEndColumn = 15},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-1.4.11/Data/X509/Signed.hs&quot;, srcSpanStartLine = 70, srcSpa"><span class="mpre">deriving (Show, Eq)</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Get the signed data for the signature</span></span><span class="mpre">
</span><a href="#loc_76_1_76_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_1_76_14&#39;)"><span class="mpre">getSignedData</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-1.4.11/Data/X509/Signed.hs&quot;, srcSpanStartLine = 73, srcSpanStartColumn = 18, srcSpanEndLine = 74, srcSpanEndColumn = 17}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-1.4.11/Data/X509/Signed.hs&quot;, srcSpanStartLine = 73, srcSpanStartColumn = 18, srcSpanEndLine = 73, srcSpanEndColumn = 19},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-1.4.11/Data/X509/Signed.hs&quot;, srcSpanStartLine = 73, srcSp"><span class="mpre">(Show a, Eq a, ASN1Object a)
              =&gt;</span></span><span class="mpre"> </span><a href="#loc_65_38_65_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_38_65_49&#39;)"><span class="hl_tyconref"><span class="mpre">SignedExact</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
              -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">
</span><a name="loc_76_1_76_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_1_76_14&#39;)"><span class="hl_vardecl"><span class="mpre">getSignedData</span></span></a><span class="mpre"> = </span><a href="#loc_67_7_67_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_7_67_21&#39;)"><span class="hl_varref"><span class="mpre">exactObjectRaw</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | make a &#39;SignedExact&#39; copy of a &#39;Signed&#39; object</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- As the signature is already generated, expect the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- encoded object to have been made on a compliant DER ASN1 implementation.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- It&#39;s better to use &#39;objectToSignedExact&#39; instead of this.</span></span><span class="mpre">
</span><a href="#loc_87_1_87_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_1_87_14&#39;)"><span class="mpre">signedToExact</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-1.4.11/Data/X509/Signed.hs&quot;, srcSpanStartLine = 84, srcSpanStartColumn = 18, srcSpanEndLine = 85, srcSpanEndColumn = 17}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-1.4.11/Data/X509/Signed.hs&quot;, srcSpanStartLine = 84, srcSpanStartColumn = 18, srcSpanEndLine = 84, srcSpanEndColumn = 19},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-1.4.11/Data/X509/Signed.hs&quot;, srcSpanStartLine = 84, srcSp"><span class="mpre">(Show a, Eq a, ASN1Object a)
              =&gt;</span></span><span class="mpre"> </span><a href="#loc_57_38_57_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_38_57_44&#39;)"><span class="hl_tyconref"><span class="mpre">Signed</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
              -&gt; </span><a href="#loc_65_38_65_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_38_65_49&#39;)"><span class="hl_tyconref"><span class="mpre">SignedExact</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_87_1_87_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_1_87_14&#39;)"><span class="hl_fundecl"><span class="mpre">signedToExact</span></span></a><span class="mpre"> </span><a name="loc_87_15_87_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_15_87_21&#39;)"><span class="hl_vardecl"><span class="mpre">signed</span></span></a><span class="mpre"> = </span><a href="#loc_88_10_88_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_10_88_16&#39;)"><span class="hl_varref"><span class="mpre">sExact</span></span></a><span class="mpre">
  where (</span><a name="loc_88_10_88_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_10_88_16&#39;)"><span class="hl_vardecl"><span class="mpre">sExact</span></span></a><span class="mpre">, </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">)      = </span><a href="#loc_96_1_96_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_1_96_20&#39;)"><span class="hl_varref"><span class="mpre">objectToSignedExact</span></span></a><span class="mpre"> </span><a href="#loc_89_9_89_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_9_89_24&#39;)"><span class="hl_varref"><span class="mpre">fakeSigFunction</span></span></a><span class="mpre"> (</span><a href="#loc_58_7_58_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_7_58_19&#39;)"><span class="hl_varref"><span class="mpre">signedObject</span></span></a><span class="mpre"> </span><a href="#loc_87_15_87_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_15_87_21&#39;)"><span class="hl_varref"><span class="mpre">signed</span></span></a><span class="mpre">)
        </span><a name="loc_89_9_89_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_9_89_24&#39;)"><span class="hl_fundecl"><span class="mpre">fakeSigFunction</span></span></a><span class="mpre"> _ = (</span><a href="#loc_60_7_60_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_7_60_22&#39;)"><span class="hl_varref"><span class="mpre">signedSignature</span></span></a><span class="mpre"> </span><a href="#loc_87_15_87_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_15_87_21&#39;)"><span class="hl_varref"><span class="mpre">signed</span></span></a><span class="mpre">, </span><a href="#loc_59_7_59_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_7_59_16&#39;)"><span class="hl_varref"><span class="mpre">signedAlg</span></span></a><span class="mpre"> </span><a href="#loc_87_15_87_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_15_87_21&#39;)"><span class="hl_varref"><span class="mpre">signed</span></span></a><span class="mpre">, </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Transform an object into a &#39;SignedExact&#39; object</span></span><span class="mpre">
</span><a href="#loc_96_1_96_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_1_96_20&#39;)"><span class="mpre">objectToSignedExact</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-1.4.11/Data/X509/Signed.hs&quot;, srcSpanStartLine = 92, srcSpanStartColumn = 24, srcSpanEndLine = 93, srcSpanEndColumn = 23}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-1.4.11/Data/X509/Signed.hs&quot;, srcSpanStartLine = 92, srcSpanStartColumn = 24, srcSpanEndLine = 92, srcSpanEndColumn = 25},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-1.4.11/Data/X509/Signed.hs&quot;, srcSpanStartLine = 92, srcSp"><span class="mpre">(Show a, Eq a, ASN1Object a)
                    =&gt;</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">, </span><a href="Data.X509.AlgorithmIdentifier.html#loc_39_6_39_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.AlgorithmIdentifier.html#loc_39_6_39_18&#39;)"><span class="hl_tyconref"><span class="mpre">SignatureALG</span></span></a><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">)) </span><span class="hl_comment"><span class="mpre">-- ^ signature function</span></span><span class="mpre">
                    -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">                                             </span><span class="hl_comment"><span class="mpre">-- ^ object to sign</span></span><span class="mpre">
                    -&gt; (</span><a href="#loc_65_38_65_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_38_65_49&#39;)"><span class="hl_tyconref"><span class="mpre">SignedExact</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">)
</span><a name="loc_96_1_96_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_1_96_20&#39;)"><span class="hl_fundecl"><span class="mpre">objectToSignedExact</span></span></a><span class="mpre"> </span><a name="loc_96_21_96_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_21_96_38&#39;)"><span class="hl_vardecl"><span class="mpre">signatureFunction</span></span></a><span class="mpre"> </span><a name="loc_96_39_96_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_39_96_45&#39;)"><span class="hl_vardecl"><span class="mpre">object</span></span></a><span class="mpre"> = (</span><a href="#loc_65_54_65_65" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_54_65_65&#39;)"><span class="hl_conref"><span class="mpre">SignedExact</span></span></a><span class="mpre"> </span><a href="#loc_97_9_97_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_9_97_15&#39;)"><span class="hl_varref"><span class="mpre">signed</span></span></a><span class="mpre"> </span><a href="#loc_109_9_109_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_9_109_15&#39;)"><span class="hl_varref"><span class="mpre">objRaw</span></span></a><span class="mpre"> </span><a href="#loc_101_9_101_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_9_101_18&#39;)"><span class="hl_varref"><span class="mpre">signedRaw</span></span></a><span class="mpre">, </span><a href="#loc_110_25_110_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_25_110_26&#39;)"><span class="hl_varref"><span class="mpre">r</span></span></a><span class="mpre">)
  where </span><a name="loc_97_9_97_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_97_9_97_15&#39;)"><span class="hl_vardecl"><span class="mpre">signed</span></span></a><span class="mpre">     = </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-1.4.11/Data/X509/Signed.hs&quot;, srcSpanStartLine = 97, srcSpanStartColumn = 22, srcSpanEndLine = 100, srcSpanEndColumn = 30}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-1.4.11/Data/X509/Signed.hs&quot;, srcSpanStartLine = 97, srcSpanStartColumn = 29, srcSpanEndLine = 97, srcSpanEndColumn = 30},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-1.4.11/Data/X509/Signed.hs&quot;, srcSpanStartLine = 98, sr"><span class="mpre">Signed { signedObject    = object
                            , signedAlg       = sigAlg
                            , signedSignature = sigBits
                            }</span></span><span class="mpre">
        </span><a name="loc_101_9_101_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_101_9_101_18&#39;)"><span class="hl_vardecl"><span class="mpre">signedRaw</span></span></a><span class="mpre">  = </span><a href="Data.ASN1.Encoding.html#loc_51_1_51_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Encoding.html#loc_51_1_51_12&#39;)"><span class="hl_varref"><span class="mpre">encodeASN1&#39;</span></span></a><span class="mpre"> </span><a href="Data.ASN1.BinaryEncoding.html#loc_30_12_30_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.BinaryEncoding.html#loc_30_12_30_15&#39;)"><span class="hl_conref"><span class="mpre">DER</span></span></a><span class="mpre"> </span><a href="#loc_102_9_102_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_9_102_19&#39;)"><span class="hl_varref"><span class="mpre">signedASN1</span></span></a><span class="mpre">
        </span><a name="loc_102_9_102_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_102_9_102_19&#39;)"><span class="hl_vardecl"><span class="mpre">signedASN1</span></span></a><span class="mpre"> = </span><a href="Data.ASN1.Types.html#loc_55_7_55_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_55_7_55_12&#39;)"><span class="hl_conref"><span class="mpre">Start</span></span></a><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_32_29_32_37" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_32_29_32_37&#39;)"><span class="hl_conref"><span class="mpre">Sequence</span></span></a><span class="mpre">
                       </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_108_9_108_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_9_108_16&#39;)"><span class="hl_varref"><span class="mpre">objASN1</span></span></a><span class="mpre">
                       (</span><a href="Data.ASN1.Types.html#loc_66_5_66_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_66_5_66_11&#39;)"><span class="hl_varref"><span class="mpre">toASN1</span></span></a><span class="mpre"> </span><a href="#loc_110_18_110_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_18_110_24&#39;)"><span class="hl_varref"><span class="mpre">sigAlg</span></span></a><span class="mpre">
                       (</span><a href="Data.ASN1.Types.html#loc_46_7_46_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_46_7_46_16&#39;)"><span class="hl_conref"><span class="mpre">BitString</span></span></a><span class="mpre"> (</span><a href="Data.ASN1.BitArray.html#loc_81_1_81_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.BitArray.html#loc_81_1_81_11&#39;)"><span class="hl_varref"><span class="mpre">toBitArray</span></span></a><span class="mpre"> </span><a href="#loc_110_10_110_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_10_110_17&#39;)"><span class="hl_varref"><span class="mpre">sigBits</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">)
                   </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_56_7_56_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_56_7_56_10&#39;)"><span class="hl_conref"><span class="mpre">End</span></span></a><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_32_29_32_37" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_32_29_32_37&#39;)"><span class="hl_conref"><span class="mpre">Sequence</span></span></a><span class="mpre">
                   </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> []))
        </span><a name="loc_108_9_108_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_9_108_16&#39;)"><span class="hl_vardecl"><span class="mpre">objASN1</span></span></a><span class="mpre">            = \</span><a name="loc_108_31_108_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_31_108_33&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre"> -&gt; </span><a href="Data.ASN1.Types.html#loc_55_7_55_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_55_7_55_12&#39;)"><span class="hl_conref"><span class="mpre">Start</span></span></a><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_32_29_32_37" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_32_29_32_37&#39;)"><span class="hl_conref"><span class="mpre">Sequence</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_66_5_66_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_66_5_66_11&#39;)"><span class="hl_varref"><span class="mpre">toASN1</span></span></a><span class="mpre"> </span><a href="#loc_96_39_96_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_39_96_45&#39;)"><span class="hl_varref"><span class="mpre">object</span></span></a><span class="mpre"> (</span><a href="Data.ASN1.Types.html#loc_56_7_56_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_56_7_56_10&#39;)"><span class="hl_conref"><span class="mpre">End</span></span></a><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_32_29_32_37" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_32_29_32_37&#39;)"><span class="hl_conref"><span class="mpre">Sequence</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_108_31_108_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_31_108_33&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">)
        </span><a name="loc_109_9_109_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_9_109_15&#39;)"><span class="hl_vardecl"><span class="mpre">objRaw</span></span></a><span class="mpre">             = </span><a href="Data.ASN1.Encoding.html#loc_51_1_51_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Encoding.html#loc_51_1_51_12&#39;)"><span class="hl_varref"><span class="mpre">encodeASN1&#39;</span></span></a><span class="mpre"> </span><a href="Data.ASN1.BinaryEncoding.html#loc_30_12_30_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.BinaryEncoding.html#loc_30_12_30_15&#39;)"><span class="hl_conref"><span class="mpre">DER</span></span></a><span class="mpre"> (</span><a href="#loc_108_9_108_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_108_9_108_16&#39;)"><span class="hl_varref"><span class="mpre">objASN1</span></span></a><span class="mpre"> [])
        (</span><a name="loc_110_10_110_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_10_110_17&#39;)"><span class="hl_vardecl"><span class="mpre">sigBits</span></span></a><span class="mpre">,</span><a name="loc_110_18_110_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_18_110_24&#39;)"><span class="hl_vardecl"><span class="mpre">sigAlg</span></span></a><span class="mpre">,</span><a name="loc_110_25_110_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_110_25_110_26&#39;)"><span class="hl_vardecl"><span class="mpre">r</span></span></a><span class="mpre">) = </span><a href="#loc_96_21_96_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_21_96_38&#39;)"><span class="hl_varref"><span class="mpre">signatureFunction</span></span></a><span class="mpre"> </span><a href="#loc_109_9_109_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_109_9_109_15&#39;)"><span class="hl_varref"><span class="mpre">objRaw</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Transform an object into a &#39;Signed&#39; object.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- It&#39;s recommended to use the SignedExact object instead of Signed.</span></span><span class="mpre">
</span><a href="#loc_120_1_120_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_1_120_15&#39;)"><span class="mpre">objectToSigned</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-1.4.11/Data/X509/Signed.hs&quot;, srcSpanStartLine = 115, srcSpanStartColumn = 19, srcSpanEndLine = 116, srcSpanEndColumn = 18}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-1.4.11/Data/X509/Signed.hs&quot;, srcSpanStartLine = 115, srcSpanStartColumn = 19, srcSpanEndLine = 115, srcSpanEndColumn = 20},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-1.4.11/Data/X509/Signed.hs&quot;, srcSpanStartLine = 115, "><span class="mpre">(Show a, Eq a, ASN1Object a)
               =&gt;</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
               -&gt; (</span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">, </span><a href="Data.X509.AlgorithmIdentifier.html#loc_39_6_39_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.X509.AlgorithmIdentifier.html#loc_39_6_39_18&#39;)"><span class="hl_tyconref"><span class="mpre">SignatureALG</span></span></a><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">))
               -&gt; </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
               -&gt; (</span><a href="#loc_57_38_57_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_38_57_44&#39;)"><span class="hl_tyconref"><span class="mpre">Signed</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">, </span><span class="hl_tyvar"><span class="mpre">r</span></span><span class="mpre">)
</span><a name="loc_120_1_120_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_1_120_15&#39;)"><span class="hl_fundecl"><span class="mpre">objectToSigned</span></span></a><span class="mpre"> </span><a name="loc_120_16_120_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_16_120_33&#39;)"><span class="hl_vardecl"><span class="mpre">signatureFunction</span></span></a><span class="mpre"> </span><a name="loc_120_34_120_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_34_120_40&#39;)"><span class="hl_vardecl"><span class="mpre">object</span></span></a><span class="mpre"> = </span><a href="Control.Arrow.html#loc_90_5_90_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Arrow.html#loc_90_5_90_10&#39;)"><span class="hl_varref"><span class="mpre">first</span></span></a><span class="mpre"> </span><a href="#loc_66_7_66_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_7_66_16&#39;)"><span class="hl_varref"><span class="mpre">getSigned</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_96_1_96_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_1_96_20&#39;)"><span class="hl_varref"><span class="mpre">objectToSignedExact</span></span></a><span class="mpre"> </span><a href="#loc_120_16_120_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_16_120_33&#39;)"><span class="hl_varref"><span class="mpre">signatureFunction</span></span></a><span class="mpre"> </span><a href="#loc_120_34_120_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_34_120_40&#39;)"><span class="hl_varref"><span class="mpre">object</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | Try to parse a bytestring that use the typical X509 signed structure format</span></span><span class="mpre">
</span><a href="#loc_126_1_126_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_1_126_19&#39;)"><span class="mpre">decodeSignedObject</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-1.4.11/Data/X509/Signed.hs&quot;, srcSpanStartLine = 123, srcSpanStartColumn = 23, srcSpanEndLine = 124, srcSpanEndColumn = 22}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-1.4.11/Data/X509/Signed.hs&quot;, srcSpanStartLine = 123, srcSpanStartColumn = 23, srcSpanEndLine = 123, srcSpanEndColumn = 24},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-1.4.11/Data/X509/Signed.hs&quot;, srcSpanStartLine = 123, "><span class="mpre">(Show a, Eq a, ASN1Object a)
                   =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre">
                   -&gt; </span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> (</span><a href="#loc_65_38_65_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_38_65_49&#39;)"><span class="hl_tyconref"><span class="mpre">SignedExact</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)
</span><a name="loc_126_1_126_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_1_126_19&#39;)"><span class="hl_fundecl"><span class="mpre">decodeSignedObject</span></span></a><span class="mpre"> </span><a name="loc_126_20_126_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_20_126_21&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">either</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre">) </span><a href="#loc_129_9_129_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_9_129_20&#39;)"><span class="hl_varref"><span class="mpre">parseSigned</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.ASN1.Encoding.html#loc_47_1_47_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Encoding.html#loc_47_1_47_16&#39;)"><span class="hl_varref"><span class="mpre">decodeASN1Repr&#39;</span></span></a><span class="mpre"> </span><a href="Data.ASN1.BinaryEncoding.html#loc_27_12_27_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.BinaryEncoding.html#loc_27_12_27_15&#39;)"><span class="hl_conref"><span class="mpre">BER</span></span></a><span class="mpre"> </span><a href="#loc_126_20_126_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_126_20_126_21&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">
  where </span><span class="hl_comment"><span class="mpre">-- the following implementation is very inefficient.</span></span><span class="mpre">
        </span><span class="hl_comment"><span class="mpre">-- uses reverse and containing, move to a better solution eventually</span></span><span class="mpre">
        </span><a name="loc_129_9_129_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_9_129_20&#39;)"><span class="hl_fundecl"><span class="mpre">parseSigned</span></span></a><span class="mpre"> </span><a name="loc_129_21_129_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_21_129_22&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> = </span><a href="#loc_153_9_153_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_9_153_20&#39;)"><span class="hl_varref"><span class="mpre">onContainer</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fst</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.ASN1.Stream.html#loc_31_1_31_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Stream.html#loc_31_1_31_22&#39;)"><span class="hl_varref"><span class="mpre">getConstructedEndRepr</span></span></a><span class="mpre"> </span><a href="#loc_129_21_129_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_21_129_22&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_129_72_129_74" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_72_129_74&#39;)"><span class="hl_vardecl"><span class="mpre">l2</span></span></a><span class="mpre"> -&gt;
            let (</span><a name="loc_130_18_130_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_18_130_25&#39;)"><span class="hl_vardecl"><span class="mpre">objRepr</span></span></a><span class="mpre">,</span><a name="loc_130_26_130_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_26_130_30&#39;)"><span class="hl_vardecl"><span class="mpre">rem1</span></span></a><span class="mpre">)   = </span><a href="Data.ASN1.Stream.html#loc_31_1_31_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Stream.html#loc_31_1_31_22&#39;)"><span class="hl_varref"><span class="mpre">getConstructedEndRepr</span></span></a><span class="mpre"> </span><a href="#loc_129_72_129_74" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_129_72_129_74&#39;)"><span class="hl_varref"><span class="mpre">l2</span></span></a><span class="mpre">
                (</span><a name="loc_131_18_131_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_18_131_27&#39;)"><span class="hl_vardecl"><span class="mpre">sigAlgSeq</span></span></a><span class="mpre">,</span><a name="loc_131_28_131_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_28_131_32&#39;)"><span class="hl_vardecl"><span class="mpre">rem2</span></span></a><span class="mpre">) = </span><a href="Data.ASN1.Stream.html#loc_31_1_31_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Stream.html#loc_31_1_31_22&#39;)"><span class="hl_varref"><span class="mpre">getConstructedEndRepr</span></span></a><span class="mpre"> </span><a href="#loc_130_26_130_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_26_130_30&#39;)"><span class="hl_varref"><span class="mpre">rem1</span></span></a><span class="mpre">
                (</span><a name="loc_132_18_132_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_18_132_24&#39;)"><span class="hl_vardecl"><span class="mpre">sigSeq</span></span></a><span class="mpre">,_)       = </span><a href="Data.ASN1.Stream.html#loc_31_1_31_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Stream.html#loc_31_1_31_22&#39;)"><span class="hl_varref"><span class="mpre">getConstructedEndRepr</span></span></a><span class="mpre"> </span><a href="#loc_131_28_131_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_28_131_32&#39;)"><span class="hl_varref"><span class="mpre">rem2</span></span></a><span class="mpre">
                </span><a name="loc_133_17_133_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_17_133_20&#39;)"><span class="hl_vardecl"><span class="mpre">obj</span></span></a><span class="mpre">              = </span><a href="#loc_153_9_153_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_9_153_20&#39;)"><span class="hl_varref"><span class="mpre">onContainer</span></span></a><span class="mpre"> </span><a href="#loc_130_18_130_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_18_130_25&#39;)"><span class="hl_varref"><span class="mpre">objRepr</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">either</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Data.ASN1.Types.html#loc_70_5_70_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_70_5_70_13&#39;)"><span class="hl_varref"><span class="mpre">fromASN1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fst</span></span><span class="mpre">)
             in case (</span><a href="#loc_133_17_133_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_133_17_133_20&#39;)"><span class="hl_varref"><span class="mpre">obj</span></span></a><span class="mpre">, </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fst</span></span><span class="mpre"> </span><a href="#loc_132_18_132_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_18_132_24&#39;)"><span class="hl_varref"><span class="mpre">sigSeq</span></span></a><span class="mpre">) of
                    (</span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> (</span><span class="hl_vardecl"><span class="mpre">o</span></span><span class="mpre">,[]), [</span><a href="Data.ASN1.Types.html#loc_46_7_46_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_46_7_46_16&#39;)"><span class="hl_conref"><span class="mpre">BitString</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">signature</span></span><span class="mpre">]) -&gt;
                        let </span><span class="hl_vardecl"><span class="mpre">rawObj</span></span><span class="mpre"> = </span><a href="Data.ASN1.BinaryEncoding.Writer.html#loc_23_1_23_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.BinaryEncoding.Writer.html#loc_23_1_23_13&#39;)"><span class="hl_varref"><span class="mpre">Raw.toByteString</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">concatMap</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">snd</span></span><span class="mpre"> </span><a href="#loc_130_18_130_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_18_130_25&#39;)"><span class="hl_varref"><span class="mpre">objRepr</span></span></a><span class="mpre">
                         in case </span><a href="Data.ASN1.Types.html#loc_70_5_70_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_70_5_70_13&#39;)"><span class="hl_varref"><span class="mpre">fromASN1</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fst</span></span><span class="mpre"> </span><a href="#loc_131_18_131_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_131_18_131_27&#39;)"><span class="hl_varref"><span class="mpre">sigAlgSeq</span></span></a><span class="mpre"> of
                                </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><a name="loc_138_38_138_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_38_138_39&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">           -&gt; </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;signed object error sigalg: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_138_38_138_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_138_38_138_39&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)
                                </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> (</span><span class="hl_vardecl"><span class="mpre">sigAlg</span></span><span class="mpre">,_) -&gt;
                                    let </span><span class="hl_vardecl"><span class="mpre">signed</span></span><span class="mpre"> = </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-1.4.11/Data/X509/Signed.hs&quot;, srcSpanStartLine = 140, srcSpanStartColumn = 50, srcSpanEndLine = 144, srcSpanEndColumn = 54}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-1.4.11/Data/X509/Signed.hs&quot;, srcSpanStartLine = 141, srcSpanStartColumn = 53, srcSpanEndLine = 141, srcSpanEndColumn = 54},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-1.4.11/Data/X509/Signed.hs&quot;, srcSpanStartLine = 142"><span class="mpre">Signed
                                                    { signedObject    = o
                                                    , signedAlg       = sigAlg
                                                    , signedSignature = bitArrayGetData signature
                                                    }</span></span><span class="mpre">
                                     in </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="warning" data-warning="ExpRecConstr (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-1.4.11/Data/X509/Signed.hs&quot;, srcSpanStartLine = 145, srcSpanStartColumn = 49, srcSpanEndLine = 149, srcSpanEndColumn = 50}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-1.4.11/Data/X509/Signed.hs&quot;, srcSpanStartLine = 146, srcSpanStartColumn = 49, srcSpanEndLine = 146, srcSpanEndColumn = 50},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/x509-1.4.11/Data/X509/Signed.hs&quot;, srcSpanStartLine = 147"><span class="mpre">SignedExact
                                                { getSigned          = signed
                                                , exactObjectRaw     = rawObj
                                                , encodeSignedObject = b
                                                }</span></span><span class="mpre">
                    (</span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> (_,</span><a name="loc_150_31_150_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_31_150_37&#39;)"><span class="hl_vardecl"><span class="mpre">remObj</span></span></a><span class="mpre">), _) -&gt;
                        </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;signed object error: remaining stream in object: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_150_31_150_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_31_150_37&#39;)"><span class="hl_varref"><span class="mpre">remObj</span></span></a><span class="mpre">)
                    (</span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><a name="loc_152_27_152_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_27_152_30&#39;)"><span class="hl_vardecl"><span class="mpre">err</span></span></a><span class="mpre">, _) -&gt; </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;signed object error: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_152_27_152_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_27_152_30&#39;)"><span class="hl_varref"><span class="mpre">err</span></span></a><span class="mpre">)
        </span><a name="loc_153_9_153_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_9_153_20&#39;)"><span class="hl_fundecl"><span class="mpre">onContainer</span></span></a><span class="mpre"> ((</span><a href="Data.ASN1.Types.html#loc_55_7_55_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_55_7_55_12&#39;)"><span class="hl_conref"><span class="mpre">Start</span></span></a><span class="mpre"> _, _) </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a name="loc_153_37_153_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_37_153_38&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre">) </span><a name="loc_153_40_153_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_40_153_41&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> =
            case </span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><a href="#loc_153_37_153_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_37_153_38&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> of
                ((</span><a href="Data.ASN1.Types.html#loc_56_7_56_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ASN1.Types.html#loc_56_7_56_10&#39;)"><span class="hl_conref"><span class="mpre">End</span></span></a><span class="mpre"> _, _) </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a name="loc_155_31_155_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_31_155_33&#39;)"><span class="hl_vardecl"><span class="mpre">l2</span></span></a><span class="mpre">) -&gt; </span><a href="#loc_153_40_153_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_40_153_41&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">reverse</span></span><span class="mpre"> </span><a href="#loc_155_31_155_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_155_31_155_33&#39;)"><span class="hl_varref"><span class="mpre">l2</span></span></a><span class="mpre">
                _                 -&gt; </span><a href="#loc_153_40_153_41" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_40_153_41&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> []
        </span><a href="#loc_153_9_153_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_153_9_153_20&#39;)"><span class="hl_fundecl"><span class="mpre">onContainer</span></span></a><span class="mpre"> _ </span><a name="loc_157_23_157_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_23_157_24&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><a href="#loc_157_23_157_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_157_23_157_24&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> []
</span></div></body></html>