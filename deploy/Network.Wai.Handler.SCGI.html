<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE ForeignFunctionInterface #-}
module Network.Wai.Handler.SCGI
    ( run
    , runSendfile
    ) where

import Network.Wai
import Network.Wai.Handler.CGI (</span><a href="Network.Wai.Handler.CGI.html#loc_84_1_84_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Handler.CGI.html#loc_84_1_84_11&#39;)"><span class="mpre">runGeneric</span></a><span class="mpre">, </span><a href="Network.Wai.Handler.CGI.html#loc_188_1_188_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Handler.CGI.html#loc_188_1_188_16&#39;)"><span class="mpre">requestBodyFunc</span></a><span class="mpre">)
import Foreign.Ptr
import Foreign.Marshal.Alloc
import Foreign.C
import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/Network/Wai/Handler/SCGI.hs&quot;, srcSpanStartLine = 12, srcSpanStartColumn = 8, srcSpanEndLine = 12, srcSpanEndColumn = 23}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> (ByteString)
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/Network/Wai/Handler/SCGI.hs&quot;, srcSpanStartLine = 13, srcSpanStartColumn = 18, srcSpanEndLine = 13, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> as S
import qualified Data.ByteString.Unsafe as S
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/Network/Wai/Handler/SCGI.hs&quot;, srcSpanStartLine = 15, srcSpanStartColumn = 18, srcSpanEndLine = 15, srcSpanEndColumn = 39}, srcInfoPoints = []}) &quot;Data.ByteString.Char8&quot;"><span class="mpre">Data.ByteString.Char8</span></span><span class="mpre"> as S8
import Data.IORef
import Data.ByteString.Lazy.Internal (</span><a href="Data.ByteString.Lazy.Internal.html#loc_208_1_208_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Lazy.Internal.html#loc_208_1_208_17&#39;)"><span class="mpre">defaultChunkSize</span></a><span class="mpre">)

</span><a href="#loc_20_1_20_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_1_20_4&#39;)"><span class="mpre">run</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Application</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_20_1_20_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_1_20_4&#39;)"><span class="hl_fundecl"><span class="mpre">run</span></span></a><span class="mpre"> </span><a name="loc_20_5_20_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_5_20_8&#39;)"><span class="hl_vardecl"><span class="mpre">app</span></span></a><span class="mpre"> = </span><a href="#loc_26_1_26_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_1_26_7&#39;)"><span class="hl_varref"><span class="mpre">runOne</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> </span><a href="#loc_20_5_20_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_5_20_8&#39;)"><span class="hl_varref"><span class="mpre">app</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="#loc_20_1_20_4" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_1_20_4&#39;)"><span class="hl_varref"><span class="mpre">run</span></span></a><span class="mpre"> </span><a href="#loc_20_5_20_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_5_20_8&#39;)"><span class="hl_varref"><span class="mpre">app</span></span></a><span class="mpre">

</span><a href="#loc_23_1_23_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_1_23_12&#39;)"><span class="mpre">runSendfile</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Application</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_23_1_23_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_1_23_12&#39;)"><span class="hl_fundecl"><span class="mpre">runSendfile</span></span></a><span class="mpre"> </span><a name="loc_23_13_23_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_13_23_15&#39;)"><span class="hl_vardecl"><span class="mpre">sf</span></span></a><span class="mpre"> </span><a name="loc_23_16_23_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_16_23_19&#39;)"><span class="hl_vardecl"><span class="mpre">app</span></span></a><span class="mpre"> = </span><a href="#loc_26_1_26_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_1_26_7&#39;)"><span class="hl_varref"><span class="mpre">runOne</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="#loc_23_13_23_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_13_23_15&#39;)"><span class="hl_varref"><span class="mpre">sf</span></span></a><span class="mpre">) </span><a href="#loc_23_16_23_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_16_23_19&#39;)"><span class="hl_varref"><span class="mpre">app</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;</span></span><span class="mpre"> </span><a href="#loc_23_1_23_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_1_23_12&#39;)"><span class="hl_varref"><span class="mpre">runSendfile</span></span></a><span class="mpre"> </span><a href="#loc_23_13_23_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_13_23_15&#39;)"><span class="hl_varref"><span class="mpre">sf</span></span></a><span class="mpre"> </span><a href="#loc_23_16_23_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_16_23_19&#39;)"><span class="hl_varref"><span class="mpre">app</span></span></a><span class="mpre">

</span><a href="#loc_26_1_26_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_1_26_7&#39;)"><span class="mpre">runOne</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Application</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_26_1_26_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_1_26_7&#39;)"><span class="hl_fundecl"><span class="mpre">runOne</span></span></a><span class="mpre"> </span><a name="loc_26_8_26_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_8_26_10&#39;)"><span class="hl_vardecl"><span class="mpre">sf</span></span></a><span class="mpre"> </span><a name="loc_26_11_26_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_11_26_14&#39;)"><span class="hl_vardecl"><span class="mpre">app</span></span></a><span class="mpre"> = do
    </span><a name="loc_27_5_27_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_5_27_11&#39;)"><span class="hl_vardecl"><span class="mpre">socket</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">c&#39;accept</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">nullPtr</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">nullPtr</span></span><span class="mpre">
    </span><a name="loc_28_5_28_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_5_28_14&#39;)"><span class="hl_vardecl"><span class="mpre">headersBS</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_67_1_67_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_1_67_14&#39;)"><span class="hl_varref"><span class="mpre">readNetstring</span></span></a><span class="mpre"> </span><a href="#loc_27_5_27_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_5_27_11&#39;)"><span class="hl_varref"><span class="mpre">socket</span></span></a><span class="mpre">
    let </span><a name="loc_29_9_29_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_9_29_16&#39;)"><span class="hl_specname"><span class="mpre">headers</span></span></a><span class="mpre">@((_, </span><a name="loc_29_22_29_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_22_29_29&#39;)"><span class="hl_vardecl"><span class="mpre">conLenS</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_) = </span><a href="#loc_63_1_63_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_1_63_13&#39;)"><span class="hl_varref"><span class="mpre">parseHeaders</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.split</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a href="#loc_28_5_28_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_5_28_14&#39;)"><span class="hl_varref"><span class="mpre">headersBS</span></span></a><span class="mpre">
    let </span><a name="loc_30_9_30_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_9_30_15&#39;)"><span class="hl_vardecl"><span class="mpre">conLen</span></span></a><span class="mpre"> = case </span><span class="hl_varref"><span class="mpre">reads</span></span><span class="mpre"> </span><a href="#loc_29_22_29_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_22_29_29&#39;)"><span class="hl_varref"><span class="mpre">conLenS</span></span></a><span class="mpre"> of
                    (</span><a name="loc_31_22_31_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_22_31_23&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre">, _)</span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_ -&gt; </span><a href="#loc_31_22_31_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_31_22_31_23&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">
                    [] -&gt; </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
    </span><a name="loc_33_5_33_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_5_33_12&#39;)"><span class="hl_vardecl"><span class="mpre">conLenI</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IORef.html#loc_42_1_42_9" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_42_1_42_9&#39;)"><span class="hl_varref"><span class="mpre">newIORef</span></span></a><span class="mpre"> </span><a href="#loc_30_9_30_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_30_9_30_15&#39;)"><span class="hl_varref"><span class="mpre">conLen</span></span></a><span class="mpre">
    </span><a href="Network.Wai.Handler.CGI.html#loc_84_1_84_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Handler.CGI.html#loc_84_1_84_11&#39;)"><span class="hl_varref"><span class="mpre">runGeneric</span></span></a><span class="mpre"> </span><a href="#loc_29_9_29_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_9_29_16&#39;)"><span class="hl_varref"><span class="mpre">headers</span></span></a><span class="mpre"> (</span><a href="Network.Wai.Handler.CGI.html#loc_188_1_188_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.Wai.Handler.CGI.html#loc_188_1_188_16&#39;)"><span class="hl_varref"><span class="mpre">requestBodyFunc</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_46_1_46_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_6&#39;)"><span class="hl_varref"><span class="mpre">input</span></span></a><span class="mpre"> </span><a href="#loc_27_5_27_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_5_27_11&#39;)"><span class="hl_varref"><span class="mpre">socket</span></span></a><span class="mpre"> </span><a href="#loc_33_5_33_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_5_33_12&#39;)"><span class="hl_varref"><span class="mpre">conLenI</span></span></a><span class="mpre">)
              (</span><a href="#loc_41_1_41_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_1_41_6&#39;)"><span class="hl_varref"><span class="mpre">write</span></span></a><span class="mpre"> </span><a href="#loc_27_5_27_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_5_27_11&#39;)"><span class="hl_varref"><span class="mpre">socket</span></span></a><span class="mpre">) </span><a href="#loc_26_8_26_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_8_26_10&#39;)"><span class="hl_varref"><span class="mpre">sf</span></span></a><span class="mpre"> </span><a href="#loc_26_11_26_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_11_26_14&#39;)"><span class="hl_varref"><span class="mpre">app</span></span></a><span class="mpre">
    </span><a href="#loc_57_1_57_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_1_57_6&#39;)"><span class="hl_varref"><span class="mpre">drain</span></span></a><span class="mpre"> </span><a href="#loc_27_5_27_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_5_27_11&#39;)"><span class="hl_varref"><span class="mpre">socket</span></span></a><span class="mpre"> </span><a href="#loc_33_5_33_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_5_33_12&#39;)"><span class="hl_varref"><span class="mpre">conLenI</span></span></a><span class="mpre">
    _ &lt;- </span><span class="hl_varref"><span class="mpre">c&#39;close</span></span><span class="mpre"> </span><a href="#loc_27_5_27_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_5_27_11&#39;)"><span class="hl_varref"><span class="mpre">socket</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">

</span><a href="#loc_41_1_41_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_1_41_6&#39;)"><span class="mpre">write</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">CInt</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_41_1_41_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_1_41_6&#39;)"><span class="hl_fundecl"><span class="mpre">write</span></span></a><span class="mpre"> </span><a name="loc_41_7_41_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_7_41_13&#39;)"><span class="hl_vardecl"><span class="mpre">socket</span></span></a><span class="mpre"> </span><a name="loc_41_14_41_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_14_41_16&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> = </span><a href="Data.ByteString.Unsafe.html#loc_311_1_311_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Unsafe.html#loc_311_1_311_22&#39;)"><span class="hl_varref"><span class="mpre">S.unsafeUseAsCStringLen</span></span></a><span class="mpre"> </span><a href="#loc_41_14_41_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_14_41_16&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \(</span><a name="loc_41_50_41_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_50_41_51&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">, </span><a name="loc_41_53_41_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_53_41_54&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre">) -&gt; do
    _ &lt;- </span><span class="hl_varref"><span class="mpre">c&#39;write</span></span><span class="mpre"> </span><a href="#loc_41_7_41_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_7_41_13&#39;)"><span class="hl_varref"><span class="mpre">socket</span></span></a><span class="mpre"> </span><a href="#loc_41_50_41_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_50_41_51&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_41_53_41_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_41_53_41_54&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">)
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">

</span><a href="#loc_46_1_46_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_6&#39;)"><span class="mpre">input</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">CInt</span></span><span class="mpre"> -&gt; </span><a href="GHC.IORef.html#loc_34_9_34_14" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_34_9_34_14&#39;)"><span class="hl_tyconref"><span class="mpre">IORef</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">)
</span><a name="loc_46_1_46_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_6&#39;)"><span class="hl_fundecl"><span class="mpre">input</span></span></a><span class="mpre"> </span><a name="loc_46_7_46_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_7_46_13&#39;)"><span class="hl_vardecl"><span class="mpre">socket</span></span></a><span class="mpre"> </span><a name="loc_46_14_46_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_14_46_18&#39;)"><span class="hl_vardecl"><span class="mpre">ilen</span></span></a><span class="mpre"> </span><a name="loc_46_19_46_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_19_46_23&#39;)"><span class="hl_vardecl"><span class="mpre">rlen</span></span></a><span class="mpre"> = do
    </span><a name="loc_47_5_47_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_5_47_8&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IORef.html#loc_46_1_46_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_46_1_46_10&#39;)"><span class="hl_varref"><span class="mpre">readIORef</span></span></a><span class="mpre"> </span><a href="#loc_46_14_46_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_14_46_18&#39;)"><span class="hl_varref"><span class="mpre">ilen</span></span></a><span class="mpre">
    case </span><a href="#loc_47_5_47_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_5_47_8&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre"> of
        </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">
        _ -&gt; do
            </span><a name="loc_51_13_51_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_13_51_15&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_81_1_81_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_1_81_15&#39;)"><span class="hl_varref"><span class="mpre">readByteString</span></span></a><span class="mpre"> </span><a href="#loc_46_7_46_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_7_46_13&#39;)"><span class="hl_varref"><span class="mpre">socket</span></span></a><span class="mpre">
                </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">minimum</span></span><span class="mpre"> [</span><a href="Data.ByteString.Lazy.Internal.html#loc_208_1_208_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Lazy.Internal.html#loc_208_1_208_17&#39;)"><span class="hl_varref"><span class="mpre">defaultChunkSize</span></span></a><span class="mpre">, </span><a href="#loc_47_5_47_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_5_47_8&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre">, </span><a href="#loc_46_19_46_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_19_46_23&#39;)"><span class="hl_varref"><span class="mpre">rlen</span></span></a><span class="mpre">]
            </span><a href="GHC.IORef.html#loc_50_1_50_11" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_50_1_50_11&#39;)"><span class="hl_varref"><span class="mpre">writeIORef</span></span></a><span class="mpre"> </span><a href="#loc_46_14_46_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_14_46_18&#39;)"><span class="hl_varref"><span class="mpre">ilen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_47_5_47_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_5_47_8&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">S.length</span></span><span class="mpre"> </span><a href="#loc_51_13_51_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_13_51_15&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
            </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="#loc_51_13_51_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_13_51_15&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">

</span><a href="#loc_57_1_57_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_1_57_6&#39;)"><span class="mpre">drain</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">CInt</span></span><span class="mpre"> -&gt; </span><a href="GHC.IORef.html#loc_34_9_34_14" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_34_9_34_14&#39;)"><span class="hl_tyconref"><span class="mpre">IORef</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- FIXME do it in chunks</span></span><span class="mpre">
</span><a name="loc_57_1_57_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_1_57_6&#39;)"><span class="hl_fundecl"><span class="mpre">drain</span></span></a><span class="mpre"> </span><a name="loc_57_7_57_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_7_57_13&#39;)"><span class="hl_vardecl"><span class="mpre">socket</span></span></a><span class="mpre"> </span><a name="loc_57_14_57_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_14_57_18&#39;)"><span class="hl_vardecl"><span class="mpre">ilen</span></span></a><span class="mpre"> = do
    </span><a name="loc_58_5_58_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_5_58_8&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre"> &lt;- </span><a href="GHC.IORef.html#loc_46_1_46_10" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IORef.html#loc_46_1_46_10&#39;)"><span class="hl_varref"><span class="mpre">readIORef</span></span></a><span class="mpre"> </span><a href="#loc_57_14_57_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_14_57_18&#39;)"><span class="hl_varref"><span class="mpre">ilen</span></span></a><span class="mpre">
    _ &lt;- </span><a href="#loc_81_1_81_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_1_81_15&#39;)"><span class="hl_varref"><span class="mpre">readByteString</span></span></a><span class="mpre"> </span><a href="#loc_57_7_57_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_7_57_13&#39;)"><span class="hl_varref"><span class="mpre">socket</span></span></a><span class="mpre"> </span><a href="#loc_58_5_58_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_5_58_8&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_conref"><span class="mpre">()</span></span><span class="mpre">

</span><a href="#loc_63_1_63_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_1_63_13&#39;)"><span class="mpre">parseHeaders</span></a><span class="mpre"> :: [</span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">] -&gt; [(</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">)]
</span><a name="loc_63_1_63_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_1_63_13&#39;)"><span class="hl_fundecl"><span class="mpre">parseHeaders</span></span></a><span class="mpre"> (</span><a name="loc_63_15_63_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_15_63_16&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_63_17_63_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_17_63_18&#39;)"><span class="hl_vardecl"><span class="mpre">y</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_63_19_63_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_19_63_20&#39;)"><span class="hl_vardecl"><span class="mpre">z</span></span></a><span class="mpre">) = (</span><span class="hl_varref"><span class="mpre">S8.unpack</span></span><span class="mpre"> </span><a href="#loc_63_15_63_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_15_63_16&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">, </span><span class="hl_varref"><span class="mpre">S8.unpack</span></span><span class="mpre"> </span><a href="#loc_63_17_63_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_17_63_18&#39;)"><span class="hl_varref"><span class="mpre">y</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_63_1_63_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_1_63_13&#39;)"><span class="hl_varref"><span class="mpre">parseHeaders</span></span></a><span class="mpre"> </span><a href="#loc_63_19_63_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_19_63_20&#39;)"><span class="hl_varref"><span class="mpre">z</span></span></a><span class="mpre">
</span><a href="#loc_63_1_63_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_63_1_63_13&#39;)"><span class="hl_fundecl"><span class="mpre">parseHeaders</span></span></a><span class="mpre"> _ = []

</span><a href="#loc_67_1_67_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_1_67_14&#39;)"><span class="mpre">readNetstring</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">CInt</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">
</span><a name="loc_67_1_67_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_1_67_14&#39;)"><span class="hl_fundecl"><span class="mpre">readNetstring</span></span></a><span class="mpre"> </span><a name="loc_67_15_67_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_15_67_21&#39;)"><span class="hl_vardecl"><span class="mpre">socket</span></span></a><span class="mpre"> = do
    </span><a name="loc_68_5_68_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_5_68_8&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_73_5_73_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_5_73_12&#39;)"><span class="hl_varref"><span class="mpre">readLen</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
    </span><a name="loc_69_5_69_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_5_69_7&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_81_1_81_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_1_81_15&#39;)"><span class="hl_varref"><span class="mpre">readByteString</span></span></a><span class="mpre"> </span><a href="#loc_67_15_67_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_15_67_21&#39;)"><span class="hl_varref"><span class="mpre">socket</span></span></a><span class="mpre"> </span><a href="#loc_68_5_68_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_5_68_8&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre">
    _ &lt;- </span><a href="#loc_81_1_81_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_1_81_15&#39;)"><span class="hl_varref"><span class="mpre">readByteString</span></span></a><span class="mpre"> </span><a href="#loc_67_15_67_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_15_67_21&#39;)"><span class="hl_varref"><span class="mpre">socket</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- the comma</span></span><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_69_5_69_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_5_69_7&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
  where
    </span><a name="loc_73_5_73_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_5_73_12&#39;)"><span class="hl_fundecl"><span class="mpre">readLen</span></span></a><span class="mpre"> </span><a name="loc_73_13_73_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_13_73_14&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> = do
        </span><a name="loc_74_9_74_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_9_74_11&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_81_1_81_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_1_81_15&#39;)"><span class="hl_varref"><span class="mpre">readByteString</span></span></a><span class="mpre"> </span><a href="#loc_67_15_67_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_15_67_21&#39;)"><span class="hl_varref"><span class="mpre">socket</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
        let [</span><a name="loc_75_14_75_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_14_75_15&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">] = </span><span class="hl_varref"><span class="mpre">S8.unpack</span></span><span class="mpre"> </span><a href="#loc_74_9_74_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_9_74_11&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
        if </span><a href="#loc_75_14_75_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_14_75_15&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;:&#39;</span></span><span class="mpre">
            then </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_73_13_73_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_13_73_14&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">
            else </span><a href="#loc_73_5_73_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_5_73_12&#39;)"><span class="hl_varref"><span class="mpre">readLen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_73_13_73_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_13_73_14&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">*</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">10</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromEnum</span></span><span class="mpre"> </span><a href="#loc_75_14_75_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_14_75_15&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">-</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromEnum</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;0&#39;</span></span><span class="mpre">)

</span><a href="#loc_81_1_81_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_1_81_15&#39;)"><span class="mpre">readByteString</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">CInt</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">S.ByteString</span></span><span class="mpre">
</span><a name="loc_81_1_81_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_1_81_15&#39;)"><span class="hl_fundecl"><span class="mpre">readByteString</span></span></a><span class="mpre"> </span><a name="loc_81_16_81_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_16_81_22&#39;)"><span class="hl_vardecl"><span class="mpre">socket</span></span></a><span class="mpre"> </span><a name="loc_81_23_81_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_23_81_26&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre"> = do
    </span><a name="loc_82_5_82_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_5_82_8&#39;)"><span class="hl_vardecl"><span class="mpre">buf</span></span></a><span class="mpre"> &lt;- </span><a href="Foreign.Marshal.Alloc.html#loc_96_1_96_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Foreign.Marshal.Alloc.html#loc_96_1_96_12&#39;)"><span class="hl_varref"><span class="mpre">mallocBytes</span></span></a><span class="mpre"> </span><a href="#loc_81_23_81_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_23_81_26&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre">
    _ &lt;- </span><span class="hl_varref"><span class="mpre">c&#39;read</span></span><span class="mpre"> </span><a href="#loc_81_16_81_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_16_81_22&#39;)"><span class="hl_varref"><span class="mpre">socket</span></span></a><span class="mpre"> </span><a href="#loc_82_5_82_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_5_82_8&#39;)"><span class="hl_varref"><span class="mpre">buf</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_81_23_81_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_23_81_26&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre">
    </span><a href="Data.ByteString.Unsafe.html#loc_186_1_186_27" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Unsafe.html#loc_186_1_186_27&#39;)"><span class="hl_varref"><span class="mpre">S.unsafePackCStringFinalizer</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">castPtr</span></span><span class="mpre"> </span><a href="#loc_82_5_82_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_5_82_8&#39;)"><span class="hl_varref"><span class="mpre">buf</span></span></a><span class="mpre">) </span><a href="#loc_81_23_81_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_23_81_26&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Foreign.Marshal.Alloc.html#loc_184_1_184_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Foreign.Marshal.Alloc.html#loc_184_1_184_5&#39;)"><span class="hl_varref"><span class="mpre">free</span></span></a><span class="mpre"> </span><a href="#loc_82_5_82_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_5_82_8&#39;)"><span class="hl_varref"><span class="mpre">buf</span></span></a><span class="mpre">

</span><span class="warning" data-warning="DeclForImp (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/Network/Wai/Handler/SCGI.hs&quot;, srcSpanStartLine = 86, srcSpanStartColumn = 1, srcSpanEndLine = 87, srcSpanEndColumn = 50}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/Network/Wai/Handler/SCGI.hs&quot;, srcSpanStartLine = 86, srcSpanStartColumn = 1, srcSpanEndLine = 86, srcSpanEndColumn = 8},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/Network/Wai/Handler/"><span class="mpre">foreign import ccall unsafe &quot;accept&quot;
    c&#39;accept :: CInt -&gt; Ptr a -&gt; Ptr a -&gt; IO CInt</span></span><span class="mpre">

</span><span class="warning" data-warning="DeclForImp (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/Network/Wai/Handler/SCGI.hs&quot;, srcSpanStartLine = 89, srcSpanStartColumn = 1, srcSpanEndLine = 90, srcSpanEndColumn = 31}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/Network/Wai/Handler/SCGI.hs&quot;, srcSpanStartLine = 89, srcSpanStartColumn = 1, srcSpanEndLine = 89, srcSpanEndColumn = 8},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/Network/Wai/Handler/"><span class="mpre">foreign import ccall unsafe &quot;close&quot;
    c&#39;close :: CInt -&gt; IO CInt</span></span><span class="mpre">

</span><span class="warning" data-warning="DeclForImp (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/Network/Wai/Handler/SCGI.hs&quot;, srcSpanStartLine = 92, srcSpanStartColumn = 1, srcSpanEndLine = 93, srcSpanEndColumn = 52}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/Network/Wai/Handler/SCGI.hs&quot;, srcSpanStartLine = 92, srcSpanStartColumn = 1, srcSpanEndLine = 92, srcSpanEndColumn = 8},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/Network/Wai/Handler/"><span class="mpre">foreign import ccall unsafe &quot;write&quot;
    c&#39;write :: CInt -&gt; Ptr CChar -&gt; CInt -&gt; IO CInt</span></span><span class="mpre">

</span><span class="warning" data-warning="DeclForImp (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/Network/Wai/Handler/SCGI.hs&quot;, srcSpanStartLine = 95, srcSpanStartColumn = 1, srcSpanEndLine = 96, srcSpanEndColumn = 51}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/Network/Wai/Handler/SCGI.hs&quot;, srcSpanStartLine = 95, srcSpanStartColumn = 1, srcSpanEndLine = 95, srcSpanEndColumn = 8},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/wai-extra-3.0.0.1/Network/Wai/Handler/"><span class="mpre">foreign import ccall unsafe &quot;read&quot;
    c&#39;read :: CInt -&gt; Ptr CChar -&gt; CInt -&gt; IO CInt</span></span><span class="mpre">
</span></div></body></html>