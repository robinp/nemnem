<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">module Language.Haskell.HsColour.Classify
  ( TokenType(..)
  , tokenise
  ) where

import Data.Char (</span><a href="GHC.Unicode.html#loc_72_1_72_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_72_1_72_8&#39;)"><span class="mpre">isSpace</span></a><span class="mpre">, </span><a href="GHC.Unicode.html#loc_140_1_140_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_140_1_140_8&#39;)"><span class="mpre">isUpper</span></a><span class="mpre">, </span><a href="GHC.Unicode.html#loc_141_1_141_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_141_1_141_8&#39;)"><span class="mpre">isLower</span></a><span class="mpre">, </span><a href="GHC.Unicode.html#loc_103_1_103_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_103_1_103_8&#39;)"><span class="mpre">isDigit</span></a><span class="mpre">)
import Data.List

</span><span class="hl_comment"><span class="mpre">-- | Lex Haskell source code into an annotated token stream, without</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--   discarding any characters or layout.</span></span><span class="mpre">
</span><a href="#loc_12_1_12_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_12_1_12_9&#39;)"><span class="mpre">tokenise</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; [(</span><a href="#loc_89_6_89_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_6_89_15&#39;)"><span class="hl_tyconref"><span class="mpre">TokenType</span></span></a><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">)]
</span><a name="loc_12_1_12_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_12_1_12_9&#39;)"><span class="hl_fundecl"><span class="mpre">tokenise</span></span></a><span class="mpre"> </span><a name="loc_12_10_12_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_12_10_12_13&#39;)"><span class="hl_vardecl"><span class="mpre">str</span></span></a><span class="mpre"> = 
    let </span><a name="loc_13_9_13_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_13_9_13_15&#39;)"><span class="hl_vardecl"><span class="mpre">chunks</span></span></a><span class="mpre"> = </span><a href="#loc_52_1_52_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_1_52_5&#39;)"><span class="hl_varref"><span class="mpre">glue</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_33_1_33_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_1_33_6&#39;)"><span class="hl_varref"><span class="mpre">chunk</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_12_10_12_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_12_10_12_13&#39;)"><span class="hl_varref"><span class="mpre">str</span></span></a><span class="mpre"> 
    in </span><a href="#loc_17_1_17_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_1_17_9&#39;)"><span class="hl_varref"><span class="mpre">markDefs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (\</span><a name="loc_14_25_14_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_14_25_14_26&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">-&gt; (</span><a href="#loc_96_1_96_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_1_96_9&#39;)"><span class="hl_varref"><span class="mpre">classify</span></span></a><span class="mpre"> </span><a href="#loc_14_25_14_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_14_25_14_26&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">,</span><a href="#loc_14_25_14_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_14_25_14_26&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)) </span><a href="#loc_13_9_13_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_13_9_13_15&#39;)"><span class="hl_varref"><span class="mpre">chunks</span></span></a><span class="mpre">

</span><a href="#loc_17_1_17_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_1_17_9&#39;)"><span class="mpre">markDefs</span></a><span class="mpre"> :: [(</span><a href="#loc_89_6_89_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_6_89_15&#39;)"><span class="hl_tyconref"><span class="mpre">TokenType</span></span></a><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">)] -&gt; [(</span><a href="#loc_89_6_89_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_6_89_15&#39;)"><span class="hl_tyconref"><span class="mpre">TokenType</span></span></a><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">)]
</span><a name="loc_17_1_17_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_1_17_9&#39;)"><span class="hl_fundecl"><span class="mpre">markDefs</span></span></a><span class="mpre"> [] = []
</span><a href="#loc_17_1_17_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_1_17_9&#39;)"><span class="hl_fundecl"><span class="mpre">markDefs</span></span></a><span class="mpre"> ((</span><a href="#loc_90_59_90_64" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_59_90_64&#39;)"><span class="hl_conref"><span class="mpre">Varid</span></span></a><span class="mpre">, </span><a name="loc_18_19_18_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_19_18_20&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a name="loc_18_24_18_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_24_18_28&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">) = (</span><a href="#loc_92_3_92_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_3_92_13&#39;)"><span class="hl_conref"><span class="mpre">Definition</span></span></a><span class="mpre">, </span><a href="#loc_18_19_18_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_19_18_20&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_23_1_23_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_1_23_9&#39;)"><span class="hl_varref"><span class="mpre">continue</span></span></a><span class="mpre"> </span><a href="#loc_18_24_18_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_18_24_18_28&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">
</span><a href="#loc_17_1_17_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_1_17_9&#39;)"><span class="hl_fundecl"><span class="mpre">markDefs</span></span></a><span class="mpre"> ((</span><a href="#loc_91_11_91_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_11_91_16&#39;)"><span class="hl_conref"><span class="mpre">Varop</span></span></a><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;&gt;&quot;</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> (</span><a href="#loc_90_3_90_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_3_90_8&#39;)"><span class="hl_conref"><span class="mpre">Space</span></span></a><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot; &quot;</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> (</span><a href="#loc_90_59_90_64" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_59_90_64&#39;)"><span class="hl_conref"><span class="mpre">Varid</span></span></a><span class="mpre">, </span><a name="loc_19_49_19_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_49_19_50&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a name="loc_19_54_19_58" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_54_19_58&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">) =
    (</span><a href="#loc_91_11_91_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_11_91_16&#39;)"><span class="hl_conref"><span class="mpre">Varop</span></span></a><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;&gt;&quot;</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> (</span><a href="#loc_90_3_90_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_3_90_8&#39;)"><span class="hl_conref"><span class="mpre">Space</span></span></a><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot; &quot;</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> (</span><a href="#loc_92_3_92_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_3_92_13&#39;)"><span class="hl_conref"><span class="mpre">Definition</span></span></a><span class="mpre">, </span><a href="#loc_19_49_19_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_49_19_50&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_23_1_23_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_1_23_9&#39;)"><span class="hl_varref"><span class="mpre">continue</span></span></a><span class="mpre"> </span><a href="#loc_19_54_19_58" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_19_54_19_58&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">
</span><a href="#loc_17_1_17_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_1_17_9&#39;)"><span class="hl_fundecl"><span class="mpre">markDefs</span></span></a><span class="mpre"> </span><a name="loc_21_10_21_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_10_21_14&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre"> = </span><a href="#loc_23_1_23_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_1_23_9&#39;)"><span class="hl_varref"><span class="mpre">continue</span></span></a><span class="mpre"> </span><a href="#loc_21_10_21_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_10_21_14&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">

</span><a name="loc_23_1_23_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_1_23_9&#39;)"><span class="hl_fundecl"><span class="mpre">continue</span></span></a><span class="mpre"> </span><a name="loc_23_10_23_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_10_23_14&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre"> 
    = let (</span><a name="loc_24_12_24_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_12_24_20&#39;)"><span class="hl_vardecl"><span class="mpre">thisLine</span></span></a><span class="mpre">, </span><a name="loc_24_22_24_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_22_24_30&#39;)"><span class="hl_vardecl"><span class="mpre">nextLine</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">span</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> (</span><a href="#loc_90_3_90_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_3_90_8&#39;)"><span class="hl_conref"><span class="mpre">Space</span></span></a><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;\n&quot;</span></span><span class="mpre">)) </span><a href="#loc_23_10_23_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_10_23_14&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">
      in
        case </span><a href="#loc_24_22_24_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_22_24_30&#39;)"><span class="hl_varref"><span class="mpre">nextLine</span></span></a><span class="mpre"> of
          [] -&gt; </span><a href="#loc_24_12_24_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_12_24_20&#39;)"><span class="hl_varref"><span class="mpre">thisLine</span></span></a><span class="mpre">
          ((</span><a href="#loc_90_3_90_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_3_90_8&#39;)"><span class="hl_conref"><span class="mpre">Space</span></span></a><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;\n&quot;</span></span><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_28_26_28_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_26_28_35&#39;)"><span class="hl_vardecl"><span class="mpre">nextLine&#39;</span></span></a><span class="mpre">) -&gt; (</span><a href="#loc_24_12_24_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_12_24_20&#39;)"><span class="hl_varref"><span class="mpre">thisLine</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> ((</span><a href="#loc_90_3_90_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_3_90_8&#39;)"><span class="hl_conref"><span class="mpre">Space</span></span></a><span class="mpre">, </span><span class="hl_string"><span class="mpre">&quot;\n&quot;</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> (</span><a href="#loc_17_1_17_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_17_1_17_9&#39;)"><span class="hl_varref"><span class="mpre">markDefs</span></span></a><span class="mpre"> </span><a href="#loc_28_26_28_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_26_28_35&#39;)"><span class="hl_varref"><span class="mpre">nextLine&#39;</span></span></a><span class="mpre">)))


</span><span class="hl_comment"><span class="mpre">-- Basic Haskell lexing, except we keep whitespace.</span></span><span class="mpre">
</span><a href="#loc_33_1_33_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_1_33_6&#39;)"><span class="mpre">chunk</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; [</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">]
</span><a name="loc_33_1_33_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_1_33_6&#39;)"><span class="hl_fundecl"><span class="mpre">chunk</span></span></a><span class="mpre"> []    = []
</span><a href="#loc_33_1_33_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_1_33_6&#39;)"><span class="hl_fundecl"><span class="mpre">chunk</span></span></a><span class="mpre"> (</span><span class="hl_char"><span class="mpre">&#39;\r&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_34_13_34_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_13_34_14&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">) = </span><a href="#loc_33_1_33_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_1_33_6&#39;)"><span class="hl_varref"><span class="mpre">chunk</span></span></a><span class="mpre"> </span><a href="#loc_34_13_34_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_13_34_14&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- get rid of DOS newline stuff</span></span><span class="mpre">
</span><a href="#loc_33_1_33_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_1_33_6&#39;)"><span class="hl_fundecl"><span class="mpre">chunk</span></span></a><span class="mpre"> (</span><span class="hl_char"><span class="mpre">&#39;\n&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_35_13_35_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_13_35_14&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">) = </span><span class="hl_string"><span class="mpre">&quot;\n&quot;</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_33_1_33_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_1_33_6&#39;)"><span class="hl_varref"><span class="mpre">chunk</span></span></a><span class="mpre"> </span><a href="#loc_35_13_35_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_13_35_14&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
</span><a href="#loc_33_1_33_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_1_33_6&#39;)"><span class="hl_fundecl"><span class="mpre">chunk</span></span></a><span class="mpre"> (</span><a name="loc_36_8_36_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_8_36_9&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_36_10_36_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_10_36_11&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">) | </span><a href="#loc_47_1_47_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_1_47_14&#39;)"><span class="hl_varref"><span class="mpre">isLinearSpace</span></span></a><span class="mpre"> </span><a href="#loc_36_8_36_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_8_36_9&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">
            = (</span><a href="#loc_36_8_36_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_8_36_9&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_37_41_37_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_41_37_43&#39;)"><span class="hl_varref"><span class="mpre">ss</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_33_1_33_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_1_33_6&#39;)"><span class="hl_varref"><span class="mpre">chunk</span></span></a><span class="mpre"> </span><a href="#loc_37_44_37_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_44_37_48&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre"> where (</span><a name="loc_37_41_37_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_41_37_43&#39;)"><span class="hl_vardecl"><span class="mpre">ss</span></span></a><span class="mpre">,</span><a name="loc_37_44_37_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_44_37_48&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">span</span></span><span class="mpre"> </span><a href="#loc_47_1_47_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_1_47_14&#39;)"><span class="hl_varref"><span class="mpre">isLinearSpace</span></span></a><span class="mpre"> </span><a href="#loc_36_10_36_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_36_10_36_11&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
</span><a href="#loc_33_1_33_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_1_33_6&#39;)"><span class="hl_fundecl"><span class="mpre">chunk</span></span></a><span class="mpre"> (</span><span class="hl_char"><span class="mpre">&#39;{&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="hl_char"><span class="mpre">&#39;-&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_38_16_38_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_16_38_17&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">) = let (</span><a name="loc_38_26_38_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_26_38_29&#39;)"><span class="hl_vardecl"><span class="mpre">com</span></span></a><span class="mpre">,</span><a name="loc_38_30_38_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_30_38_32&#39;)"><span class="hl_vardecl"><span class="mpre">s&#39;</span></span></a><span class="mpre">) = </span><a href="#loc_73_1_73_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_1_73_12&#39;)"><span class="hl_varref"><span class="mpre">nestcomment</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a href="#loc_38_16_38_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_16_38_17&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
                    in (</span><span class="hl_char"><span class="mpre">&#39;{&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="hl_char"><span class="mpre">&#39;-&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_38_26_38_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_26_38_29&#39;)"><span class="hl_varref"><span class="mpre">com</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_33_1_33_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_1_33_6&#39;)"><span class="hl_varref"><span class="mpre">chunk</span></span></a><span class="mpre"> </span><a href="#loc_38_30_38_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_38_30_38_32&#39;)"><span class="hl_varref"><span class="mpre">s&#39;</span></span></a><span class="mpre">
</span><a href="#loc_33_1_33_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_1_33_6&#39;)"><span class="hl_fundecl"><span class="mpre">chunk</span></span></a><span class="mpre"> </span><a name="loc_40_7_40_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_7_40_8&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> = case </span><span class="hl_varref"><span class="mpre">Prelude.lex</span></span><span class="mpre"> </span><a href="#loc_40_7_40_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_7_40_8&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> of
              []             -&gt; [</span><span class="hl_varref"><span class="mpre">head</span></span><span class="mpre"> </span><a href="#loc_40_7_40_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_7_40_8&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">]</span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_33_1_33_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_1_33_6&#39;)"><span class="hl_varref"><span class="mpre">chunk</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">tail</span></span><span class="mpre"> </span><a href="#loc_40_7_40_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_7_40_8&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">) </span><span class="hl_comment"><span class="mpre">-- e.g. inside comment</span></span><span class="mpre">
              ((</span><a name="loc_42_17_42_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_17_42_20&#39;)"><span class="hl_specname"><span class="mpre">tok</span></span></a><span class="mpre">@(</span><span class="hl_char"><span class="mpre">&#39;-&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="hl_char"><span class="mpre">&#39;-&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_),</span><a name="loc_42_33_42_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_33_42_37&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_)
                  | </span><span class="hl_varref"><span class="mpre">all</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">==</span></span><span class="hl_char"><span class="mpre">&#39;-&#39;</span></span><span class="mpre">) </span><a href="#loc_42_17_42_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_17_42_20&#39;)"><span class="hl_varref"><span class="mpre">tok</span></span></a><span class="mpre"> -&gt; (</span><a href="#loc_42_17_42_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_17_42_20&#39;)"><span class="hl_varref"><span class="mpre">tok</span></span></a><span class="hl_infix"><span class="mpre">++</span></span><a href="#loc_44_47_44_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_47_44_50&#39;)"><span class="hl_varref"><span class="mpre">com</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_33_1_33_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_1_33_6&#39;)"><span class="hl_varref"><span class="mpre">chunk</span></span></a><span class="mpre"> </span><a href="#loc_44_51_44_53" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_51_44_53&#39;)"><span class="hl_varref"><span class="mpre">s&#39;</span></span></a><span class="mpre">
                                       where (</span><a name="loc_44_47_44_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_47_44_50&#39;)"><span class="hl_vardecl"><span class="mpre">com</span></span></a><span class="mpre">,</span><a name="loc_44_51_44_53" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_44_51_44_53&#39;)"><span class="hl_vardecl"><span class="mpre">s&#39;</span></span></a><span class="mpre">) = </span><a href="#loc_83_1_83_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_1_83_11&#39;)"><span class="hl_varref"><span class="mpre">eolcomment</span></span></a><span class="mpre"> </span><a href="#loc_42_33_42_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_33_42_37&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">
              ((</span><a name="loc_45_17_45_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_17_45_20&#39;)"><span class="hl_vardecl"><span class="mpre">tok</span></span></a><span class="mpre">,</span><a name="loc_45_21_45_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_21_45_25&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_) -&gt; </span><a href="#loc_45_17_45_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_17_45_20&#39;)"><span class="hl_varref"><span class="mpre">tok</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_33_1_33_6" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_1_33_6&#39;)"><span class="hl_varref"><span class="mpre">chunk</span></span></a><span class="mpre"> </span><a href="#loc_45_21_45_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_45_21_45_25&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">

</span><a name="loc_47_1_47_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_1_47_14&#39;)"><span class="hl_fundecl"><span class="mpre">isLinearSpace</span></span></a><span class="mpre"> </span><a name="loc_47_15_47_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_15_47_16&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre"> = </span><a href="#loc_47_15_47_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_15_47_16&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`elem`</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot; \t\f&quot;</span></span><span class="mpre"> </span><span class="hl_comment"><span class="mpre">-- &quot; \t\xa0&quot;</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- Glue sequences of tokens into more useful blobs</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--glue (q:&quot;.&quot;:n:rest) | Char.isUpper (head q)        -- qualified names</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--                    = glue ((q++&quot;.&quot;++n): rest)</span></span><span class="mpre">
</span><a name="loc_52_1_52_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_1_52_5&#39;)"><span class="hl_fundecl"><span class="mpre">glue</span></span></a><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;`&quot;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_52_11_52_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_11_52_15&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">) =                                </span><span class="hl_comment"><span class="mpre">-- `varid` -&gt; varop</span></span><span class="mpre">
  case </span><a href="#loc_52_1_52_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_1_52_5&#39;)"><span class="hl_varref"><span class="mpre">glue</span></span></a><span class="mpre"> </span><a href="#loc_52_11_52_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_11_52_15&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre"> of
    (</span><a name="loc_54_6_54_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_6_54_8&#39;)"><span class="hl_vardecl"><span class="mpre">qn</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="hl_string"><span class="mpre">&quot;`&quot;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_54_13_54_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_13_54_17&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">) -&gt; (</span><span class="hl_string"><span class="mpre">&quot;`&quot;</span></span><span class="hl_infix"><span class="mpre">++</span></span><a href="#loc_54_6_54_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_6_54_8&#39;)"><span class="hl_varref"><span class="mpre">qn</span></span></a><span class="hl_infix"><span class="mpre">++</span></span><span class="hl_string"><span class="mpre">&quot;`&quot;</span></span><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_52_1_52_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_1_52_5&#39;)"><span class="hl_varref"><span class="mpre">glue</span></span></a><span class="mpre"> </span><a href="#loc_54_13_54_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_13_54_17&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">
    _             -&gt; </span><span class="hl_string"><span class="mpre">&quot;`&quot;</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_52_1_52_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_1_52_5&#39;)"><span class="hl_varref"><span class="mpre">glue</span></span></a><span class="mpre"> </span><a href="#loc_52_11_52_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_11_52_15&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">
</span><a href="#loc_52_1_52_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_1_52_5&#39;)"><span class="hl_fundecl"><span class="mpre">glue</span></span></a><span class="mpre"> (</span><a name="loc_56_7_56_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_7_56_8&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_56_9_56_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_9_56_11&#39;)"><span class="hl_vardecl"><span class="mpre">ss</span></span></a><span class="mpre">)       | </span><span class="hl_varref"><span class="mpre">all</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">==</span></span><span class="hl_char"><span class="mpre">&#39;-&#39;</span></span><span class="mpre">) </span><a href="#loc_56_7_56_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_7_56_8&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_56_7_56_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_7_56_8&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">        </span><span class="hl_comment"><span class="mpre">-- eol comment</span></span><span class="mpre">
                  = (</span><a href="#loc_56_7_56_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_7_56_8&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="hl_infix"><span class="mpre">++</span></span><span class="hl_varref"><span class="mpre">concat</span></span><span class="mpre"> </span><a href="#loc_58_26_58_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_26_58_27&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_52_1_52_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_1_52_5&#39;)"><span class="hl_varref"><span class="mpre">glue</span></span></a><span class="mpre"> </span><a href="#loc_58_28_58_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_28_58_32&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">
                  where (</span><a name="loc_58_26_58_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_26_58_27&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">,</span><a name="loc_58_28_58_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_28_58_32&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">break</span></span><span class="mpre"> (</span><span class="hl_char"><span class="mpre">&#39;\n&#39;</span></span><span class="hl_infix"><span class="mpre">`elem`</span></span><span class="mpre">) </span><a href="#loc_56_9_56_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_9_56_11&#39;)"><span class="hl_varref"><span class="mpre">ss</span></span></a><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--glue (&quot;{&quot;:&quot;-&quot;:ss)  = (&quot;{-&quot;++c): glue rest        -- nested comment</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--                  where (c,rest) = nestcomment 0 ss</span></span><span class="mpre">
</span><a href="#loc_52_1_52_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_1_52_5&#39;)"><span class="hl_fundecl"><span class="mpre">glue</span></span></a><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;(&quot;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_61_11_61_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_11_61_13&#39;)"><span class="hl_vardecl"><span class="mpre">ss</span></span></a><span class="mpre">) = case </span><a href="#loc_64_28_64_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_28_64_32&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre"> of
                </span><span class="hl_string"><span class="mpre">&quot;)&quot;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_62_21_62_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_21_62_25&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre"> -&gt; (</span><span class="hl_string"><span class="mpre">&quot;(&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">concat</span></span><span class="mpre"> </span><a href="#loc_64_22_64_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_22_64_27&#39;)"><span class="hl_varref"><span class="mpre">tuple</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;)&quot;</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_52_1_52_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_1_52_5&#39;)"><span class="hl_varref"><span class="mpre">glue</span></span></a><span class="mpre"> </span><a href="#loc_62_21_62_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_21_62_25&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">
                _         -&gt; </span><span class="hl_string"><span class="mpre">&quot;(&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_52_1_52_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_1_52_5&#39;)"><span class="hl_varref"><span class="mpre">glue</span></span></a><span class="mpre"> </span><a href="#loc_61_11_61_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_11_61_13&#39;)"><span class="hl_varref"><span class="mpre">ss</span></span></a><span class="mpre">
              where (</span><a name="loc_64_22_64_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_22_64_27&#39;)"><span class="hl_vardecl"><span class="mpre">tuple</span></span></a><span class="mpre">,</span><a name="loc_64_28_64_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_28_64_32&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">span</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">==</span></span><span class="hl_string"><span class="mpre">&quot;,&quot;</span></span><span class="mpre">) </span><a href="#loc_61_11_61_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_61_11_61_13&#39;)"><span class="hl_varref"><span class="mpre">ss</span></span></a><span class="mpre">
</span><a href="#loc_52_1_52_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_1_52_5&#39;)"><span class="hl_fundecl"><span class="mpre">glue</span></span></a><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;[&quot;</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="hl_string"><span class="mpre">&quot;]&quot;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_65_15_65_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_15_65_17&#39;)"><span class="hl_vardecl"><span class="mpre">ss</span></span></a><span class="mpre">) = </span><span class="hl_string"><span class="mpre">&quot;[]&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_52_1_52_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_1_52_5&#39;)"><span class="hl_varref"><span class="mpre">glue</span></span></a><span class="mpre"> </span><a href="#loc_65_15_65_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_15_65_17&#39;)"><span class="hl_varref"><span class="mpre">ss</span></span></a><span class="mpre">
</span><a href="#loc_52_1_52_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_1_52_5&#39;)"><span class="hl_fundecl"><span class="mpre">glue</span></span></a><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;\n&quot;</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="hl_string"><span class="mpre">&quot;#&quot;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_66_16_66_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_16_66_18&#39;)"><span class="hl_vardecl"><span class="mpre">ss</span></span></a><span class="mpre">)= </span><span class="hl_string"><span class="mpre">&quot;\n&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> (</span><span class="hl_char"><span class="mpre">&#39;#&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="hl_varref"><span class="mpre">concat</span></span><span class="mpre"> </span><a href="#loc_67_26_67_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_26_67_30&#39;)"><span class="hl_varref"><span class="mpre">line</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_52_1_52_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_1_52_5&#39;)"><span class="hl_varref"><span class="mpre">glue</span></span></a><span class="mpre"> </span><a href="#loc_67_31_67_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_31_67_35&#39;)"><span class="hl_varref"><span class="mpre">rest</span></span></a><span class="mpre">
                  where (</span><a name="loc_67_26_67_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_26_67_30&#39;)"><span class="hl_vardecl"><span class="mpre">line</span></span></a><span class="mpre">,</span><a name="loc_67_31_67_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_67_31_67_35&#39;)"><span class="hl_vardecl"><span class="mpre">rest</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">break</span></span><span class="mpre"> (</span><span class="hl_char"><span class="mpre">&#39;\n&#39;</span></span><span class="hl_infix"><span class="mpre">`elem`</span></span><span class="mpre">) </span><a href="#loc_66_16_66_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_16_66_18&#39;)"><span class="hl_varref"><span class="mpre">ss</span></span></a><span class="mpre">
</span><a href="#loc_52_1_52_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_1_52_5&#39;)"><span class="hl_fundecl"><span class="mpre">glue</span></span></a><span class="mpre"> (</span><a name="loc_68_7_68_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_7_68_8&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_68_9_68_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_9_68_11&#39;)"><span class="hl_vardecl"><span class="mpre">ss</span></span></a><span class="mpre">)       = </span><a href="#loc_68_7_68_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_7_68_8&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre"> </span><a href="#loc_52_1_52_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_1_52_5&#39;)"><span class="hl_varref"><span class="mpre">glue</span></span></a><span class="mpre"> </span><a href="#loc_68_9_68_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_9_68_11&#39;)"><span class="hl_varref"><span class="mpre">ss</span></span></a><span class="mpre">
</span><a href="#loc_52_1_52_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_1_52_5&#39;)"><span class="hl_fundecl"><span class="mpre">glue</span></span></a><span class="mpre"> []           = []

</span><span class="hl_comment"><span class="mpre">-- Deal with comments.</span></span><span class="mpre">
</span><a href="#loc_73_1_73_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_1_73_12&#39;)"><span class="mpre">nestcomment</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">)
</span><a name="loc_73_1_73_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_1_73_12&#39;)"><span class="hl_fundecl"><span class="mpre">nestcomment</span></span></a><span class="mpre"> </span><a name="loc_73_13_73_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_13_73_14&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> (</span><span class="hl_char"><span class="mpre">&#39;{&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="hl_char"><span class="mpre">&#39;-&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_73_24_73_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_24_73_26&#39;)"><span class="hl_vardecl"><span class="mpre">ss</span></span></a><span class="mpre">) | </span><a href="#loc_73_13_73_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_13_73_14&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> = ((</span><span class="hl_string"><span class="mpre">&quot;{-&quot;</span></span><span class="hl_infix"><span class="mpre">++</span></span><a href="#loc_74_42_74_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_42_74_44&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">),</span><a href="#loc_74_45_74_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_45_74_47&#39;)"><span class="hl_varref"><span class="mpre">rm</span></span></a><span class="mpre">)
                                  where (</span><a name="loc_74_42_74_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_42_74_44&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre">,</span><a name="loc_74_45_74_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_74_45_74_47&#39;)"><span class="hl_vardecl"><span class="mpre">rm</span></span></a><span class="mpre">) = </span><a href="#loc_73_1_73_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_1_73_12&#39;)"><span class="hl_varref"><span class="mpre">nestcomment</span></span></a><span class="mpre"> (</span><a href="#loc_73_13_73_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_13_73_14&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_73_24_73_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_24_73_26&#39;)"><span class="hl_varref"><span class="mpre">ss</span></span></a><span class="mpre">
</span><a href="#loc_73_1_73_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_1_73_12&#39;)"><span class="hl_fundecl"><span class="mpre">nestcomment</span></span></a><span class="mpre"> </span><a name="loc_75_13_75_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_13_75_14&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> (</span><span class="hl_char"><span class="mpre">&#39;-&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="hl_char"><span class="mpre">&#39;}&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_75_24_75_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_24_75_26&#39;)"><span class="hl_vardecl"><span class="mpre">ss</span></span></a><span class="mpre">) | </span><a href="#loc_75_13_75_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_13_75_14&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">  = ((</span><span class="hl_string"><span class="mpre">&quot;-}&quot;</span></span><span class="hl_infix"><span class="mpre">++</span></span><a href="#loc_76_42_76_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_42_76_44&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">),</span><a href="#loc_76_45_76_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_45_76_47&#39;)"><span class="hl_varref"><span class="mpre">rm</span></span></a><span class="mpre">)
                                  where (</span><a name="loc_76_42_76_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_42_76_44&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre">,</span><a name="loc_76_45_76_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_45_76_47&#39;)"><span class="hl_vardecl"><span class="mpre">rm</span></span></a><span class="mpre">) = </span><a href="#loc_73_1_73_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_1_73_12&#39;)"><span class="hl_varref"><span class="mpre">nestcomment</span></span></a><span class="mpre"> (</span><a href="#loc_75_13_75_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_13_75_14&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_75_24_75_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_24_75_26&#39;)"><span class="hl_varref"><span class="mpre">ss</span></span></a><span class="mpre">
</span><a href="#loc_73_1_73_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_1_73_12&#39;)"><span class="hl_fundecl"><span class="mpre">nestcomment</span></span></a><span class="mpre"> </span><a name="loc_77_13_77_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_13_77_14&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> (</span><span class="hl_char"><span class="mpre">&#39;-&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="hl_char"><span class="mpre">&#39;}&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_77_24_77_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_24_77_26&#39;)"><span class="hl_vardecl"><span class="mpre">ss</span></span></a><span class="mpre">) | </span><a href="#loc_77_13_77_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_13_77_14&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">==</span></span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> = (</span><span class="hl_string"><span class="mpre">&quot;-}&quot;</span></span><span class="mpre">,</span><a href="#loc_77_24_77_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_77_24_77_26&#39;)"><span class="hl_varref"><span class="mpre">ss</span></span></a><span class="mpre">)
</span><a href="#loc_73_1_73_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_1_73_12&#39;)"><span class="hl_fundecl"><span class="mpre">nestcomment</span></span></a><span class="mpre"> </span><a name="loc_78_13_78_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_13_78_14&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> (</span><a name="loc_78_16_78_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_16_78_17&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_78_18_78_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_18_78_20&#39;)"><span class="hl_vardecl"><span class="mpre">ss</span></span></a><span class="mpre">)       | </span><a href="#loc_78_13_78_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_13_78_14&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> = ((</span><a href="#loc_78_16_78_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_16_78_17&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_79_42_79_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_42_79_44&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">),</span><a href="#loc_79_45_79_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_45_79_47&#39;)"><span class="hl_varref"><span class="mpre">rm</span></span></a><span class="mpre">)
                                  where (</span><a name="loc_79_42_79_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_42_79_44&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre">,</span><a name="loc_79_45_79_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_45_79_47&#39;)"><span class="hl_vardecl"><span class="mpre">rm</span></span></a><span class="mpre">) = </span><a href="#loc_73_1_73_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_1_73_12&#39;)"><span class="hl_varref"><span class="mpre">nestcomment</span></span></a><span class="mpre"> </span><a href="#loc_78_13_78_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_13_78_14&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_78_18_78_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_18_78_20&#39;)"><span class="hl_varref"><span class="mpre">ss</span></span></a><span class="mpre">
</span><a href="#loc_73_1_73_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_1_73_12&#39;)"><span class="hl_fundecl"><span class="mpre">nestcomment</span></span></a><span class="mpre"> </span><span class="hl_vardecl"><span class="mpre">n</span></span><span class="mpre"> [] = ([],[])

</span><a href="#loc_83_1_83_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_1_83_11&#39;)"><span class="mpre">eolcomment</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">,</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">)
</span><a name="loc_83_1_83_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_1_83_11&#39;)"><span class="hl_fundecl"><span class="mpre">eolcomment</span></span></a><span class="mpre"> </span><a name="loc_83_12_83_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_12_83_13&#39;)"><span class="hl_specname"><span class="mpre">s</span></span></a><span class="mpre">@(</span><span class="hl_char"><span class="mpre">&#39;\n&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">_) = ([], </span><a href="#loc_83_12_83_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_12_83_13&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)
</span><a href="#loc_83_1_83_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_1_83_11&#39;)"><span class="hl_fundecl"><span class="mpre">eolcomment</span></span></a><span class="mpre"> (</span><span class="hl_char"><span class="mpre">&#39;\r&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_84_18_84_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_18_84_19&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">)   = </span><a href="#loc_83_1_83_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_1_83_11&#39;)"><span class="hl_varref"><span class="mpre">eolcomment</span></span></a><span class="mpre"> </span><a href="#loc_84_18_84_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_18_84_19&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
</span><a href="#loc_83_1_83_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_1_83_11&#39;)"><span class="hl_fundecl"><span class="mpre">eolcomment</span></span></a><span class="mpre"> (</span><a name="loc_85_13_85_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_13_85_14&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_85_15_85_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_15_85_16&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">)      = (</span><a href="#loc_85_13_85_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_13_85_14&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_85_43_85_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_43_85_45&#39;)"><span class="hl_varref"><span class="mpre">cs</span></span></a><span class="mpre">, </span><a href="#loc_85_46_85_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_46_85_48&#39;)"><span class="hl_varref"><span class="mpre">s&#39;</span></span></a><span class="mpre">) where (</span><a name="loc_85_43_85_45" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_43_85_45&#39;)"><span class="hl_vardecl"><span class="mpre">cs</span></span></a><span class="mpre">,</span><a name="loc_85_46_85_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_46_85_48&#39;)"><span class="hl_vardecl"><span class="mpre">s&#39;</span></span></a><span class="mpre">) = </span><a href="#loc_83_1_83_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_1_83_11&#39;)"><span class="hl_varref"><span class="mpre">eolcomment</span></span></a><span class="mpre"> </span><a href="#loc_85_15_85_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_15_85_16&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
</span><a href="#loc_83_1_83_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_1_83_11&#39;)"><span class="hl_fundecl"><span class="mpre">eolcomment</span></span></a><span class="mpre"> []         = ([],[])

</span><span class="hl_comment"><span class="mpre">-- | Classification of tokens as lexical entities</span></span><span class="mpre">
data </span><a name="loc_89_6_89_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_6_89_15&#39;)"><span class="hl_tycondecl"><span class="mpre">TokenType</span></span></a><span class="mpre"> =
  </span><a name="loc_90_3_90_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_3_90_8&#39;)"><span class="hl_condecl"><span class="mpre">Space</span></span></a><span class="mpre"> | </span><a name="loc_90_11_90_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_11_90_18&#39;)"><span class="hl_condecl"><span class="mpre">Keyword</span></span></a><span class="mpre"> | </span><a name="loc_90_21_90_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_21_90_29&#39;)"><span class="hl_condecl"><span class="mpre">Keyglyph</span></span></a><span class="mpre"> | </span><a name="loc_90_32_90_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_32_90_38&#39;)"><span class="hl_condecl"><span class="mpre">Layout</span></span></a><span class="mpre"> | </span><a name="loc_90_41_90_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_41_90_48&#39;)"><span class="hl_condecl"><span class="mpre">Comment</span></span></a><span class="mpre"> | </span><a name="loc_90_51_90_56" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_51_90_56&#39;)"><span class="hl_condecl"><span class="mpre">Conid</span></span></a><span class="mpre"> | </span><a name="loc_90_59_90_64" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_59_90_64&#39;)"><span class="hl_condecl"><span class="mpre">Varid</span></span></a><span class="mpre"> |
  </span><a name="loc_91_3_91_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_3_91_8&#39;)"><span class="hl_condecl"><span class="mpre">Conop</span></span></a><span class="mpre"> | </span><a name="loc_91_11_91_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_11_91_16&#39;)"><span class="hl_condecl"><span class="mpre">Varop</span></span></a><span class="mpre">   | </span><a name="loc_91_21_91_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_21_91_27&#39;)"><span class="hl_condecl"><span class="mpre">String</span></span></a><span class="mpre">   | </span><a name="loc_91_32_91_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_32_91_36&#39;)"><span class="hl_condecl"><span class="mpre">Char</span></span></a><span class="mpre">   | </span><a name="loc_91_41_91_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_41_91_47&#39;)"><span class="hl_condecl"><span class="mpre">Number</span></span></a><span class="mpre">  | </span><a name="loc_91_51_91_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_51_91_54&#39;)"><span class="hl_condecl"><span class="mpre">Cpp</span></span></a><span class="mpre">   | </span><a name="loc_91_59_91_64" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_59_91_64&#39;)"><span class="hl_condecl"><span class="mpre">Error</span></span></a><span class="mpre"> |
  </span><a name="loc_92_3_92_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_3_92_13&#39;)"><span class="hl_condecl"><span class="mpre">Definition</span></span></a><span class="mpre">
  </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hscolour-1.20.3/Language/Haskell/HsColour/Classify.hs&quot;, srcSpanStartLine = 93, srcSpanStartColumn = 3, srcSpanEndLine = 93, srcSpanEndColumn = 21}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hscolour-1.20.3/Language/Haskell/HsColour/Classify.hs&quot;, srcSpanStartLine = 93, srcSpanStartColumn = 3, srcSpanEndLine = 93, srcSpanEndColumn = 11},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/hscolour-1.20.3/Lan"><span class="mpre">deriving (Eq,Show)</span></span><span class="mpre">

</span><a href="#loc_96_1_96_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_1_96_9&#39;)"><span class="mpre">classify</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><a href="#loc_89_6_89_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_6_89_15&#39;)"><span class="hl_tyconref"><span class="mpre">TokenType</span></span></a><span class="mpre">
</span><a name="loc_96_1_96_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_1_96_9&#39;)"><span class="hl_fundecl"><span class="mpre">classify</span></span></a><span class="mpre"> </span><a name="loc_96_10_96_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_10_96_11&#39;)"><span class="hl_specname"><span class="mpre">s</span></span></a><span class="mpre">@(</span><a name="loc_96_13_96_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_13_96_14&#39;)"><span class="hl_vardecl"><span class="mpre">h</span></span></a><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_96_15_96_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_15_96_16&#39;)"><span class="hl_vardecl"><span class="mpre">t</span></span></a><span class="mpre">)
    | </span><a href="GHC.Unicode.html#loc_72_1_72_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_72_1_72_8&#39;)"><span class="hl_varref"><span class="mpre">isSpace</span></span></a><span class="mpre"> </span><a href="#loc_96_13_96_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_13_96_14&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre">              = </span><a href="#loc_90_3_90_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_3_90_8&#39;)"><span class="hl_conref"><span class="mpre">Space</span></span></a><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">all</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">==</span></span><span class="hl_char"><span class="mpre">&#39;-&#39;</span></span><span class="mpre">) </span><a href="#loc_96_10_96_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_10_96_11&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">          = </span><a href="#loc_90_41_90_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_41_90_48&#39;)"><span class="hl_conref"><span class="mpre">Comment</span></span></a><span class="mpre">
    | </span><span class="hl_string"><span class="mpre">&quot;--&quot;</span></span><span class="mpre"> </span><a href="Data.List.html#loc_286_1_286_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_286_1_286_11&#39;)"><span class="hl_infix"><span class="mpre">`isPrefixOf`</span></span></a><span class="mpre"> </span><a href="#loc_96_10_96_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_10_96_11&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">
      </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">any</span></span><span class="mpre"> </span><a href="GHC.Unicode.html#loc_72_1_72_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_72_1_72_8&#39;)"><span class="hl_varref"><span class="mpre">isSpace</span></span></a><span class="mpre"> </span><a href="#loc_96_10_96_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_10_96_11&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">       = </span><a href="#loc_90_41_90_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_41_90_48&#39;)"><span class="hl_conref"><span class="mpre">Comment</span></span></a><span class="mpre">                </span><span class="hl_comment"><span class="mpre">-- not fully correct</span></span><span class="mpre">
    | </span><span class="hl_string"><span class="mpre">&quot;{-&quot;</span></span><span class="mpre"> </span><a href="Data.List.html#loc_286_1_286_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_286_1_286_11&#39;)"><span class="hl_infix"><span class="mpre">`isPrefixOf`</span></span></a><span class="mpre"> </span><a href="#loc_96_10_96_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_10_96_11&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">    = </span><a href="#loc_90_41_90_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_41_90_48&#39;)"><span class="hl_conref"><span class="mpre">Comment</span></span></a><span class="mpre">
    | </span><a href="#loc_96_10_96_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_10_96_11&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`elem`</span></span><span class="mpre"> </span><a href="#loc_125_1_125_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_1_125_9&#39;)"><span class="hl_varref"><span class="mpre">keywords</span></span></a><span class="mpre">      = </span><a href="#loc_90_11_90_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_11_90_18&#39;)"><span class="hl_conref"><span class="mpre">Keyword</span></span></a><span class="mpre">
    | </span><a href="#loc_96_10_96_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_10_96_11&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`elem`</span></span><span class="mpre"> </span><a href="#loc_130_1_130_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_1_130_10&#39;)"><span class="hl_varref"><span class="mpre">keyglyphs</span></span></a><span class="mpre">     = </span><a href="#loc_90_21_90_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_21_90_29&#39;)"><span class="hl_conref"><span class="mpre">Keyglyph</span></span></a><span class="mpre">
    | </span><a href="#loc_96_10_96_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_10_96_11&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`elem`</span></span><span class="mpre"> </span><a href="#loc_132_1_132_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_1_132_12&#39;)"><span class="hl_varref"><span class="mpre">layoutchars</span></span></a><span class="mpre">   = </span><a href="#loc_90_32_90_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_32_90_38&#39;)"><span class="hl_conref"><span class="mpre">Layout</span></span></a><span class="mpre">
    | </span><a href="GHC.Unicode.html#loc_140_1_140_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_140_1_140_8&#39;)"><span class="hl_varref"><span class="mpre">isUpper</span></span></a><span class="mpre"> </span><a href="#loc_96_13_96_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_13_96_14&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre">              = </span><a href="#loc_90_51_90_56" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_51_90_56&#39;)"><span class="hl_conref"><span class="mpre">Conid</span></span></a><span class="mpre">
    | </span><a href="#loc_96_10_96_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_10_96_11&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;[]&quot;</span></span><span class="mpre">              = </span><a href="#loc_90_51_90_56" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_51_90_56&#39;)"><span class="hl_conref"><span class="mpre">Conid</span></span></a><span class="mpre">
    | </span><a href="#loc_96_13_96_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_13_96_14&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;(&#39;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_119_1_119_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_1_119_12&#39;)"><span class="hl_varref"><span class="mpre">isTupleTail</span></span></a><span class="mpre"> </span><a href="#loc_96_15_96_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_15_96_16&#39;)"><span class="hl_varref"><span class="mpre">t</span></span></a><span class="mpre"> = </span><a href="#loc_90_51_90_56" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_51_90_56&#39;)"><span class="hl_conref"><span class="mpre">Conid</span></span></a><span class="mpre">
    | </span><a href="#loc_96_13_96_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_13_96_14&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;#&#39;</span></span><span class="mpre">               = </span><a href="#loc_91_51_91_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_51_91_54&#39;)"><span class="hl_conref"><span class="mpre">Cpp</span></span></a><span class="mpre">
    | </span><a href="GHC.Unicode.html#loc_141_1_141_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_141_1_141_8&#39;)"><span class="hl_varref"><span class="mpre">isLower</span></span></a><span class="mpre"> </span><a href="#loc_96_13_96_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_13_96_14&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre">              = </span><a href="#loc_90_59_90_64" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_59_90_64&#39;)"><span class="hl_conref"><span class="mpre">Varid</span></span></a><span class="mpre">
    | </span><a href="#loc_96_13_96_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_13_96_14&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`elem`</span></span><span class="mpre"> </span><a href="#loc_134_1_134_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_1_134_8&#39;)"><span class="hl_varref"><span class="mpre">symbols</span></span></a><span class="mpre">       = </span><a href="#loc_91_11_91_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_11_91_16&#39;)"><span class="hl_conref"><span class="mpre">Varop</span></span></a><span class="mpre">
    | </span><a href="#loc_96_13_96_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_13_96_14&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="hl_infix"><span class="mpre">==</span></span><span class="hl_char"><span class="mpre">&#39;:&#39;</span></span><span class="mpre">                 = </span><a href="#loc_91_3_91_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_3_91_8&#39;)"><span class="hl_conref"><span class="mpre">Conop</span></span></a><span class="mpre">
    | </span><a href="#loc_96_13_96_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_13_96_14&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="hl_infix"><span class="mpre">==</span></span><span class="hl_char"><span class="mpre">&#39;`&#39;</span></span><span class="mpre">                 = </span><a href="#loc_91_11_91_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_11_91_16&#39;)"><span class="hl_conref"><span class="mpre">Varop</span></span></a><span class="mpre">
    | </span><a href="#loc_96_13_96_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_13_96_14&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="hl_infix"><span class="mpre">==</span></span><span class="hl_char"><span class="mpre">&#39;&quot;&#39;</span></span><span class="mpre">                 = </span><a href="#loc_91_21_91_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_21_91_27&#39;)"><span class="hl_conref"><span class="mpre">String</span></span></a><span class="mpre">
    | </span><a href="#loc_96_13_96_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_13_96_14&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="hl_infix"><span class="mpre">==</span></span><span class="hl_char"><span class="mpre">&#39;\&#39;&#39;</span></span><span class="mpre">                = </span><a href="#loc_91_32_91_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_32_91_36&#39;)"><span class="hl_conref"><span class="mpre">Char</span></span></a><span class="mpre">
    | </span><a href="GHC.Unicode.html#loc_103_1_103_8" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.Unicode.html#loc_103_1_103_8&#39;)"><span class="hl_varref"><span class="mpre">isDigit</span></span></a><span class="mpre"> </span><a href="#loc_96_13_96_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_13_96_14&#39;)"><span class="hl_varref"><span class="mpre">h</span></span></a><span class="mpre">              = </span><a href="#loc_91_41_91_47" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_41_91_47&#39;)"><span class="hl_conref"><span class="mpre">Number</span></span></a><span class="mpre">
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">              = </span><a href="#loc_91_59_91_64" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_59_91_64&#39;)"><span class="hl_conref"><span class="mpre">Error</span></span></a><span class="mpre">
</span><a href="#loc_96_1_96_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_1_96_9&#39;)"><span class="hl_fundecl"><span class="mpre">classify</span></span></a><span class="mpre"> _ = </span><a href="#loc_90_3_90_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_3_90_8&#39;)"><span class="hl_conref"><span class="mpre">Space</span></span></a><span class="mpre">

</span><a name="loc_119_1_119_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_1_119_12&#39;)"><span class="hl_fundecl"><span class="mpre">isTupleTail</span></span></a><span class="mpre"> [</span><span class="hl_char"><span class="mpre">&#39;)&#39;</span></span><span class="mpre">] = </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
</span><a href="#loc_119_1_119_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_1_119_12&#39;)"><span class="hl_fundecl"><span class="mpre">isTupleTail</span></span></a><span class="mpre"> (</span><span class="hl_char"><span class="mpre">&#39;,&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><a name="loc_120_18_120_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_18_120_20&#39;)"><span class="hl_vardecl"><span class="mpre">xs</span></span></a><span class="mpre">) = </span><a href="#loc_119_1_119_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_1_119_12&#39;)"><span class="hl_varref"><span class="mpre">isTupleTail</span></span></a><span class="mpre"> </span><a href="#loc_120_18_120_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_120_18_120_20&#39;)"><span class="hl_varref"><span class="mpre">xs</span></span></a><span class="mpre">
</span><a href="#loc_119_1_119_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_119_1_119_12&#39;)"><span class="hl_fundecl"><span class="mpre">isTupleTail</span></span></a><span class="mpre"> _ = </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">-- Haskell keywords</span></span><span class="mpre">
</span><a name="loc_125_1_125_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_125_1_125_9&#39;)"><span class="hl_vardecl"><span class="mpre">keywords</span></span></a><span class="mpre"> =
  [</span><span class="hl_string"><span class="mpre">&quot;case&quot;</span></span><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;class&quot;</span></span><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;data&quot;</span></span><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;default&quot;</span></span><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;deriving&quot;</span></span><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;do&quot;</span></span><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;else&quot;</span></span><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;forall&quot;</span></span><span class="mpre">
  ,</span><span class="hl_string"><span class="mpre">&quot;if&quot;</span></span><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;import&quot;</span></span><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;in&quot;</span></span><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;infix&quot;</span></span><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;infixl&quot;</span></span><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;infixr&quot;</span></span><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;instance&quot;</span></span><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;let&quot;</span></span><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;module&quot;</span></span><span class="mpre">
  ,</span><span class="hl_string"><span class="mpre">&quot;newtype&quot;</span></span><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;of&quot;</span></span><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;qualified&quot;</span></span><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;then&quot;</span></span><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;type&quot;</span></span><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;where&quot;</span></span><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;_&quot;</span></span><span class="mpre">
  ,</span><span class="hl_string"><span class="mpre">&quot;foreign&quot;</span></span><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;ccall&quot;</span></span><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;as&quot;</span></span><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;safe&quot;</span></span><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;unsafe&quot;</span></span><span class="mpre">]
</span><a name="loc_130_1_130_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_1_130_10&#39;)"><span class="hl_vardecl"><span class="mpre">keyglyphs</span></span></a><span class="mpre"> =
  [</span><span class="hl_string"><span class="mpre">&quot;..&quot;</span></span><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;::&quot;</span></span><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;=&quot;</span></span><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;\\&quot;</span></span><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;|&quot;</span></span><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;&lt;-&quot;</span></span><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;-&gt;&quot;</span></span><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;@&quot;</span></span><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;~&quot;</span></span><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;=&gt;&quot;</span></span><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;[&quot;</span></span><span class="mpre">,</span><span class="hl_string"><span class="mpre">&quot;]&quot;</span></span><span class="mpre">]
</span><a name="loc_132_1_132_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_1_132_12&#39;)"><span class="hl_vardecl"><span class="mpre">layoutchars</span></span></a><span class="mpre"> =
  </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">[]) </span><span class="hl_string"><span class="mpre">&quot;;{}(),&quot;</span></span><span class="mpre">
</span><a name="loc_134_1_134_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_1_134_8&#39;)"><span class="hl_vardecl"><span class="mpre">symbols</span></span></a><span class="mpre"> =
  </span><span class="hl_string"><span class="mpre">&quot;!#$%&amp;*+./&lt;=&gt;?@\\^|-~&quot;</span></span><span class="mpre">
</span></div></body></html>