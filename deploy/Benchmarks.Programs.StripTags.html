<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-- | Program to replace HTML tags by whitespace</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- This program was originally contributed by Petr Prokhorenkov.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Tested in this benchmark:</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * Reading the file</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * Replacing text between HTML tags (&lt;&gt;) with whitespace</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- * Writing back to a handle</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
{-# OPTIONS_GHC -fspec-constr-count=5 #-}
module Benchmarks.Programs.StripTags
    ( benchmark
    ) where

import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/benchmarks/haskell/Benchmarks/Programs/StripTags.hs&quot;, srcSpanStartLine = 18, srcSpanStartColumn = 8, srcSpanEndLine = 18, srcSpanEndColumn = 17}, srcInfoPoints = []}) &quot;Criterion&quot;"><span class="mpre">Criterion</span></span><span class="mpre"> (Benchmark, bgroup, bench)
import Data.List (</span><a href="Data.List.html#loc_480_1_480_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_480_1_480_10&#39;)"><span class="mpre">mapAccumL</span></a><span class="mpre">)
import System.IO (Handle, hPutStr)
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/benchmarks/haskell/Benchmarks/Programs/StripTags.hs&quot;, srcSpanStartLine = 21, srcSpanStartColumn = 18, srcSpanEndLine = 21, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> as B
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/benchmarks/haskell/Benchmarks/Programs/StripTags.hs&quot;, srcSpanStartLine = 22, srcSpanStartColumn = 18, srcSpanEndLine = 22, srcSpanEndColumn = 39}, srcInfoPoints = []}) &quot;Data.ByteString.Char8&quot;"><span class="mpre">Data.ByteString.Char8</span></span><span class="mpre"> as BC
import qualified Data.Text as T
import qualified Data.Text.Encoding as T
import qualified Data.Text.IO as T

</span><a href="#loc_28_1_28_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_1_28_10&#39;)"><span class="mpre">benchmark</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">FilePath</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Handle</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Benchmark</span></span><span class="mpre">
</span><a name="loc_28_1_28_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_1_28_10&#39;)"><span class="hl_fundecl"><span class="mpre">benchmark</span></span></a><span class="mpre"> </span><a name="loc_28_11_28_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_11_28_12&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> </span><a name="loc_28_13_28_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_13_28_14&#39;)"><span class="hl_vardecl"><span class="mpre">o</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">bgroup</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;StripTags&quot;</span></span><span class="mpre">
    [ </span><span class="hl_varref"><span class="mpre">bench</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;String&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">readFile</span></span><span class="mpre"> </span><a href="#loc_28_11_28_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_11_28_12&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">hPutStr</span></span><span class="mpre"> </span><a href="#loc_28_13_28_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_13_28_14&#39;)"><span class="hl_varref"><span class="mpre">o</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_37_1_37_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_1_37_7&#39;)"><span class="hl_varref"><span class="mpre">string</span></span></a><span class="mpre">
    , </span><span class="hl_varref"><span class="mpre">bench</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;ByteString&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.readFile</span></span><span class="mpre"> </span><a href="#loc_28_11_28_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_11_28_12&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.hPutStr</span></span><span class="mpre"> </span><a href="#loc_28_13_28_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_13_28_14&#39;)"><span class="hl_varref"><span class="mpre">o</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_43_1_43_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_1_43_11&#39;)"><span class="hl_varref"><span class="mpre">byteString</span></span></a><span class="mpre">
    , </span><span class="hl_varref"><span class="mpre">bench</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Text&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.Text.IO.html#loc_88_1_88_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.IO.html#loc_88_1_88_9&#39;)"><span class="hl_varref"><span class="mpre">T.readFile</span></span></a><span class="mpre"> </span><a href="#loc_28_11_28_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_11_28_12&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="Data.Text.IO.html#loc_174_1_174_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.IO.html#loc_174_1_174_8&#39;)"><span class="hl_varref"><span class="mpre">T.hPutStr</span></span></a><span class="mpre"> </span><a href="#loc_28_13_28_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_13_28_14&#39;)"><span class="hl_varref"><span class="mpre">o</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_40_1_40_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_1_40_5&#39;)"><span class="hl_varref"><span class="mpre">text</span></span></a><span class="mpre">
    , </span><span class="hl_varref"><span class="mpre">bench</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;TextByteString&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
        </span><span class="hl_varref"><span class="mpre">B.readFile</span></span><span class="mpre"> </span><a href="#loc_28_11_28_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_11_28_12&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.hPutStr</span></span><span class="mpre"> </span><a href="#loc_28_13_28_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_13_28_14&#39;)"><span class="hl_varref"><span class="mpre">o</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Data.Text.Encoding.html#loc_386_1_386_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Encoding.html#loc_386_1_386_11&#39;)"><span class="hl_varref"><span class="mpre">T.encodeUtf8</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_40_1_40_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_1_40_5&#39;)"><span class="hl_varref"><span class="mpre">text</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Data.Text.Encoding.html#loc_307_1_307_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Encoding.html#loc_307_1_307_11&#39;)"><span class="hl_varref"><span class="mpre">T.decodeUtf8</span></span></a><span class="mpre">
    ]

</span><a href="#loc_37_1_37_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_1_37_7&#39;)"><span class="mpre">string</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_37_1_37_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_37_1_37_7&#39;)"><span class="hl_vardecl"><span class="mpre">string</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">snd</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Data.List.html#loc_480_1_480_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_480_1_480_10&#39;)"><span class="hl_varref"><span class="mpre">mapAccumL</span></span></a><span class="mpre"> </span><a href="#loc_46_1_46_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_5&#39;)"><span class="hl_varref"><span class="mpre">step</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">

</span><a href="#loc_40_1_40_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_1_40_5&#39;)"><span class="mpre">text</span></a><span class="mpre"> :: </span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">T.Text</span></span></a><span class="mpre"> -&gt; </span><a href="Data.Text.Internal.html#loc_50_6_50_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.html#loc_50_6_50_10&#39;)"><span class="hl_tyconref"><span class="mpre">T.Text</span></span></a><span class="mpre">
</span><a name="loc_40_1_40_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_40_1_40_5&#39;)"><span class="hl_vardecl"><span class="mpre">text</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">snd</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Data.Text.html#loc_941_1_941_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.html#loc_941_1_941_10&#39;)"><span class="hl_varref"><span class="mpre">T.mapAccumL</span></span></a><span class="mpre"> </span><a href="#loc_46_1_46_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_5&#39;)"><span class="hl_varref"><span class="mpre">step</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">

</span><a href="#loc_43_1_43_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_1_43_11&#39;)"><span class="mpre">byteString</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">B.ByteString</span></span><span class="mpre">
</span><a name="loc_43_1_43_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_1_43_11&#39;)"><span class="hl_vardecl"><span class="mpre">byteString</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">snd</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">BC.mapAccumL</span></span><span class="mpre"> </span><a href="#loc_46_1_46_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_5&#39;)"><span class="hl_varref"><span class="mpre">step</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">

</span><a href="#loc_46_1_46_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_5&#39;)"><span class="mpre">step</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre"> -&gt; (</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">)
</span><a name="loc_46_1_46_5" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_1_46_5&#39;)"><span class="hl_fundecl"><span class="mpre">step</span></span></a><span class="mpre"> </span><a name="loc_46_6_46_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_6_46_7&#39;)"><span class="hl_vardecl"><span class="mpre">d</span></span></a><span class="mpre"> </span><a name="loc_46_8_46_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_8_46_9&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">
    | </span><a href="#loc_46_6_46_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_6_46_7&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">||</span></span><span class="mpre"> </span><a href="#loc_50_5_50_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_5_50_7&#39;)"><span class="hl_varref"><span class="mpre">d&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> = (</span><a href="#loc_50_5_50_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_5_50_7&#39;)"><span class="hl_varref"><span class="mpre">d&#39;</span></span></a><span class="mpre">, </span><span class="hl_char"><span class="mpre">&#39; &#39;</span></span><span class="mpre">)
    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">       = (</span><a href="#loc_50_5_50_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_5_50_7&#39;)"><span class="hl_varref"><span class="mpre">d&#39;</span></span></a><span class="mpre">, </span><a href="#loc_46_8_46_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_8_46_9&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">)
  where
    </span><a name="loc_50_5_50_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_5_50_7&#39;)"><span class="hl_vardecl"><span class="mpre">d&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_46_6_46_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_6_46_7&#39;)"><span class="hl_varref"><span class="mpre">d</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_51_5_51_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_5_51_10&#39;)"><span class="hl_varref"><span class="mpre">depth</span></span></a><span class="mpre"> </span><a href="#loc_46_8_46_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_8_46_9&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre">
    </span><a name="loc_51_5_51_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_5_51_10&#39;)"><span class="hl_fundecl"><span class="mpre">depth</span></span></a><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;&gt;&#39;</span></span><span class="mpre"> = </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
    </span><a href="#loc_51_5_51_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_5_51_10&#39;)"><span class="hl_fundecl"><span class="mpre">depth</span></span></a><span class="mpre"> </span><span class="hl_char"><span class="mpre">&#39;&lt;&#39;</span></span><span class="mpre"> = -</span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
    </span><a href="#loc_51_5_51_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_5_51_10&#39;)"><span class="hl_fundecl"><span class="mpre">depth</span></span></a><span class="mpre"> _   = </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">
</span></div></body></html>