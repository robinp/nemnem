<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE MultiParamTypeClasses, FlexibleInstances #-}

</span><span class="hl_comment"><span class="mpre">-- (c) 2002 by Martin Erwig [see file COPYRIGHT]</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- | Static IOArray-based Graphs</span></span><span class="mpre">
module Data.Graph.Inductive.Monad.IOArray(
    </span><span class="hl_comment"><span class="mpre">-- * Graph Representation</span></span><span class="mpre">
    SGr(..), GraphRep, Context&#39;, USGr,
    defaultGraphSize, emptyN,
    </span><span class="hl_comment"><span class="mpre">-- * Utilities</span></span><span class="mpre">
    removeDel,
) where

import Data.Graph.Inductive.Graph
import Data.Graph.Inductive.Monad

import Control.Monad
import Data.Array
import Data.Array.IO
import System.IO.Unsafe



</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- GRAPH REPRESENTATION</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------------</span></span><span class="mpre">

data </span><a name="loc_27_6_27_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_6_27_9&#39;)"><span class="hl_tycondecl"><span class="mpre">SGr</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> = </span><a name="loc_27_16_27_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_16_27_19&#39;)"><span class="hl_condecl"><span class="mpre">SGr</span></span></a><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">GraphRep</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">)

</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Monad/IOArray.hs&quot;, srcSpanStartLine = 29, srcSpanStartColumn = 1, srcSpanEndLine = 29, srcSpanEndColumn = 70}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Monad/IOArray.hs&quot;, srcSpanStartLine = 29, srcSpanStartColumn = 1, srcSpanEndLine = 29, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Induc"><span class="mpre">type GraphRep a b = (Int,Array Node (Context&#39; a b),IOArray Node Bool)</span></span><span class="mpre">
</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Monad/IOArray.hs&quot;, srcSpanStartLine = 30, srcSpanStartColumn = 1, srcSpanEndLine = 30, srcSpanEndColumn = 42}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Monad/IOArray.hs&quot;, srcSpanStartLine = 30, srcSpanStartColumn = 1, srcSpanEndLine = 30, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Induc"><span class="mpre">type Context&#39; a b = Maybe (Adj b,a,Adj b)</span></span><span class="mpre">

</span><span class="warning" data-warning="DeclTypeDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Monad/IOArray.hs&quot;, srcSpanStartLine = 32, srcSpanStartColumn = 1, srcSpanEndLine = 32, srcSpanEndColumn = 22}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Monad/IOArray.hs&quot;, srcSpanStartLine = 32, srcSpanStartColumn = 1, srcSpanEndLine = 32, srcSpanEndColumn = 5},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Induc"><span class="mpre">type USGr = SGr () ()</span></span><span class="mpre">


</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- CLASS INSTANCES</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------------</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- Show</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><a href="#loc_42_1_42_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_1_42_10&#39;)"><span class="mpre">showGraph</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Monad/IOArray.hs&quot;, srcSpanStartLine = 41, srcSpanStartColumn = 14, srcSpanEndLine = 41, srcSpanEndColumn = 32}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Monad/IOArray.hs&quot;, srcSpanStartLine = 41, srcSpanStartColumn = 14, srcSpanEndLine = 41, srcSpanEndColumn = 15},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Ind"><span class="mpre">(Show a,Show b) =&gt;</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">GraphRep</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_42_1_42_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_1_42_10&#39;)"><span class="hl_fundecl"><span class="mpre">showGraph</span></span></a><span class="mpre"> (_,</span><a name="loc_42_14_42_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_14_42_15&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">,</span><a name="loc_42_16_42_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_16_42_17&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">concatMap</span></span><span class="mpre"> </span><a href="#loc_43_11_43_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_11_43_18&#39;)"><span class="hl_varref"><span class="mpre">showAdj</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">indices</span></span><span class="mpre"> </span><a href="#loc_42_14_42_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_14_42_15&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">)
    where </span><a name="loc_43_11_43_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_11_43_18&#39;)"><span class="hl_fundecl"><span class="mpre">showAdj</span></span></a><span class="mpre"> </span><a name="loc_43_19_43_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_19_43_20&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> | </span><a href="GHC.IO.html#loc_165_1_165_16" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_165_1_165_16&#39;)"><span class="hl_varref"><span class="mpre">unsafePerformIO</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">readArray</span></span><span class="mpre"> </span><a href="#loc_42_16_42_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_16_42_17&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><a href="#loc_43_19_43_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_19_43_20&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">) = </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">
                    | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = case </span><a href="#loc_42_14_42_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_14_42_15&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="hl_infix"><span class="mpre">!</span></span><a href="#loc_43_19_43_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_19_43_20&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> of
                        </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">      -&gt; </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">
                        </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (_,</span><a name="loc_46_33_46_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_33_46_34&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre">,</span><a name="loc_46_35_46_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_35_46_36&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">) -&gt; </span><span class="hl_char"><span class="mpre">&#39;\n&#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_43_19_43_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_43_19_43_20&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="hl_infix"><span class="mpre">++</span></span><span class="hl_string"><span class="mpre">&quot;:&quot;</span></span><span class="hl_infix"><span class="mpre">++</span></span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_46_33_46_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_33_46_34&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="hl_infix"><span class="mpre">++</span></span><span class="hl_string"><span class="mpre">&quot;-&gt;&quot;</span></span><span class="hl_infix"><span class="mpre">++</span></span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_47_33_47_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_33_47_35&#39;)"><span class="hl_varref"><span class="mpre">s&#39;</span></span></a><span class="mpre">
                          where </span><a name="loc_47_33_47_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_33_47_35&#39;)"><span class="hl_vardecl"><span class="mpre">s&#39;</span></span></a><span class="mpre"> = </span><a href="GHC.IO.html#loc_165_1_165_16" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_165_1_165_16&#39;)"><span class="hl_varref"><span class="mpre">unsafePerformIO</span></span></a><span class="mpre"> (</span><a href="#loc_111_1_111_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_1_111_10&#39;)"><span class="hl_varref"><span class="mpre">removeDel</span></span></a><span class="mpre"> </span><a href="#loc_42_16_42_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_16_42_17&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><a href="#loc_46_35_46_36" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_46_35_46_36&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)

instance </span><span class="warning" data-warning="InstDecl ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Monad/IOArray.hs&quot;, srcSpanStartLine = 49, srcSpanStartColumn = 10, srcSpanEndLine = 49, srcSpanEndColumn = 28}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Monad/IOArray.hs&quot;, srcSpanStartLine = 49, srcSpanStartColumn = 10, srcSpanEndLine = 49, srcSpanEndColumn = 11},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Ind"><span class="mpre">(Show a,Show b) =&gt;</span></span><span class="mpre"> </span><span class="hl_classref"><span class="mpre">Show</span></span><span class="mpre"> (</span><a href="#loc_27_6_27_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_6_27_9&#39;)"><span class="hl_tyconref"><span class="mpre">SGr</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">) where
  </span><span class="hl_fundecl"><span class="mpre">show</span></span><span class="mpre"> (</span><a href="#loc_27_16_27_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_16_27_19&#39;)"><span class="hl_conref"><span class="mpre">SGr</span></span></a><span class="mpre"> </span><a name="loc_50_13_50_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_13_50_14&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre">) = </span><a href="#loc_42_1_42_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_1_42_10&#39;)"><span class="hl_varref"><span class="mpre">showGraph</span></span></a><span class="mpre"> </span><a href="#loc_50_13_50_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_13_50_14&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">

instance </span><span class="warning" data-warning="InstDecl ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Monad/IOArray.hs&quot;, srcSpanStartLine = 52, srcSpanStartColumn = 10, srcSpanEndLine = 52, srcSpanEndColumn = 28}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Monad/IOArray.hs&quot;, srcSpanStartLine = 52, srcSpanStartColumn = 10, srcSpanEndLine = 52, srcSpanEndColumn = 11},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Ind"><span class="mpre">(Show a,Show b) =&gt;</span></span><span class="mpre"> </span><span class="hl_classref"><span class="mpre">Show</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="#loc_27_6_27_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_6_27_9&#39;)"><span class="hl_tyconref"><span class="mpre">SGr</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">)) where
  </span><span class="hl_fundecl"><span class="mpre">show</span></span><span class="mpre"> </span><a name="loc_53_8_53_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_8_53_9&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> = </span><a href="GHC.IO.html#loc_165_1_165_16" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_165_1_165_16&#39;)"><span class="hl_varref"><span class="mpre">unsafePerformIO</span></span></a><span class="mpre"> (do {(</span><a href="#loc_27_16_27_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_16_27_19&#39;)"><span class="hl_conref"><span class="mpre">SGr</span></span></a><span class="mpre"> </span><a name="loc_53_38_53_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_38_53_40&#39;)"><span class="hl_vardecl"><span class="mpre">g&#39;</span></span></a><span class="mpre">) &lt;- </span><a href="#loc_53_8_53_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_8_53_9&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_42_1_42_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_1_42_10&#39;)"><span class="hl_varref"><span class="mpre">showGraph</span></span></a><span class="mpre"> </span><a href="#loc_53_38_53_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_38_53_40&#39;)"><span class="hl_varref"><span class="mpre">g&#39;</span></span></a><span class="mpre">)})

</span><span class="hl_comment"><span class="mpre">{-
run :: Show (IO a) =&gt; IO a -&gt; IO ()
run x = seq x (print x)
-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- GraphM</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
instance </span><a href="Data.Graph.Inductive.Monad.html#loc_41_18_41_24" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Monad.html#loc_41_18_41_24&#39;)"><span class="hl_classref"><span class="mpre">GraphM</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><a href="#loc_27_6_27_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_6_27_9&#39;)"><span class="hl_tyconref"><span class="mpre">SGr</span></span></a><span class="mpre"> where
  </span><a href="Data.Graph.Inductive.Monad.html#loc_43_3_43_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Monad.html#loc_43_3_43_9&#39;)"><span class="hl_vardecl"><span class="mpre">emptyM</span></span></a><span class="mpre"> = </span><a href="#loc_99_1_99_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_1_99_7&#39;)"><span class="hl_varref"><span class="mpre">emptyN</span></span></a><span class="mpre"> </span><a href="#loc_96_1_96_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_1_96_17&#39;)"><span class="hl_varref"><span class="mpre">defaultGraphSize</span></span></a><span class="mpre">
  </span><a href="Data.Graph.Inductive.Monad.html#loc_44_3_44_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Monad.html#loc_44_3_44_11&#39;)"><span class="hl_fundecl"><span class="mpre">isEmptyM</span></span></a><span class="mpre"> </span><a name="loc_64_12_64_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_12_64_13&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> = do {</span><a href="#loc_27_16_27_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_16_27_19&#39;)"><span class="hl_conref"><span class="mpre">SGr</span></span></a><span class="mpre"> (</span><a name="loc_64_25_64_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_25_64_26&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre">,_,_) &lt;- </span><a href="#loc_64_12_64_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_12_64_13&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_64_25_64_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_64_25_64_26&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">==</span></span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">)}
  </span><a href="Data.Graph.Inductive.Monad.html#loc_45_3_45_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Monad.html#loc_45_3_45_9&#39;)"><span class="hl_fundecl"><span class="mpre">matchM</span></span></a><span class="mpre"> </span><a name="loc_65_10_65_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_10_65_11&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> </span><a name="loc_65_12_65_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_12_65_13&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> = do </span><a name="loc_65_19_65_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_19_65_21&#39;)"><span class="hl_specname"><span class="mpre">g&#39;</span></span></a><span class="mpre">@(</span><a href="#loc_27_16_27_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_16_27_19&#39;)"><span class="hl_conref"><span class="mpre">SGr</span></span></a><span class="mpre"> (</span><a name="loc_65_28_65_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_28_65_29&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre">,</span><a name="loc_65_30_65_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_30_65_31&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">,</span><a name="loc_65_32_65_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_32_65_33&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre">)) &lt;- </span><a href="#loc_65_12_65_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_12_65_13&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">
                  case </span><a href="#loc_65_30_65_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_30_65_31&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="hl_infix"><span class="mpre">!</span></span><a href="#loc_65_10_65_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_10_65_11&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> of
                    </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">,</span><a href="#loc_65_19_65_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_19_65_21&#39;)"><span class="hl_varref"><span class="mpre">g&#39;</span></span></a><span class="mpre">)
                    </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><a name="loc_68_27_68_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_27_68_29&#39;)"><span class="hl_vardecl"><span class="mpre">pr</span></span></a><span class="mpre">,</span><a name="loc_68_30_68_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_30_68_31&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre">,</span><a name="loc_68_32_68_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_32_68_34&#39;)"><span class="hl_vardecl"><span class="mpre">su</span></span></a><span class="mpre">) -&gt;
                       do </span><a name="loc_69_27_69_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_27_69_28&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">readArray</span></span><span class="mpre"> </span><a href="#loc_65_32_65_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_32_65_33&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><a href="#loc_65_10_65_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_10_65_11&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">
                          if </span><a href="#loc_69_27_69_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_69_27_69_28&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> then </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">,</span><a href="#loc_65_19_65_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_19_65_21&#39;)"><span class="hl_varref"><span class="mpre">g&#39;</span></span></a><span class="mpre">) else
                             do </span><a name="loc_71_33_71_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_33_71_34&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">  &lt;- </span><a href="#loc_111_1_111_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_1_111_10&#39;)"><span class="hl_varref"><span class="mpre">removeDel</span></span></a><span class="mpre"> </span><a href="#loc_65_32_65_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_32_65_33&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><a href="#loc_68_32_68_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_32_68_34&#39;)"><span class="hl_varref"><span class="mpre">su</span></span></a><span class="mpre">
                                </span><a name="loc_72_33_72_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_33_72_35&#39;)"><span class="hl_vardecl"><span class="mpre">p&#39;</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_111_1_111_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_1_111_10&#39;)"><span class="hl_varref"><span class="mpre">removeDel</span></span></a><span class="mpre"> </span><a href="#loc_65_32_65_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_32_65_33&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><a href="#loc_68_27_68_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_27_68_29&#39;)"><span class="hl_varref"><span class="mpre">pr</span></span></a><span class="mpre">
                                let </span><a name="loc_73_37_73_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_37_73_38&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">filter</span></span><span class="mpre"> ((</span><span class="hl_infix"><span class="mpre">/=</span></span><a href="#loc_65_10_65_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_10_65_11&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">.</span></span><span class="hl_varref"><span class="mpre">snd</span></span><span class="mpre">) </span><a href="#loc_72_33_72_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_33_72_35&#39;)"><span class="hl_varref"><span class="mpre">p&#39;</span></span></a><span class="mpre">
                                </span><span class="hl_varref"><span class="mpre">writeArray</span></span><span class="mpre"> </span><a href="#loc_65_32_65_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_32_65_33&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><a href="#loc_65_10_65_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_10_65_11&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">True</span></span><span class="mpre">
                                </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><a href="#loc_73_37_73_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_37_73_38&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">,</span><a href="#loc_65_10_65_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_10_65_11&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">,</span><a href="#loc_68_30_68_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_30_68_31&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">,</span><a href="#loc_71_33_71_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_71_33_71_34&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">),</span><a href="#loc_27_16_27_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_16_27_19&#39;)"><span class="hl_conref"><span class="mpre">SGr</span></span></a><span class="mpre"> (</span><a href="#loc_65_28_65_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_28_65_29&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">-</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">,</span><a href="#loc_65_30_65_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_30_65_31&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">,</span><a href="#loc_65_32_65_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_32_65_33&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">))
  </span><a href="Data.Graph.Inductive.Monad.html#loc_46_3_46_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Monad.html#loc_46_3_46_11&#39;)"><span class="hl_fundecl"><span class="mpre">mkGraphM</span></span></a><span class="mpre"> </span><a name="loc_76_12_76_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_12_76_14&#39;)"><span class="hl_vardecl"><span class="mpre">vs</span></span></a><span class="mpre"> </span><a name="loc_76_15_76_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_15_76_17&#39;)"><span class="hl_vardecl"><span class="mpre">es</span></span></a><span class="mpre"> = do </span><a name="loc_76_23_76_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_23_76_24&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">newArray</span></span><span class="mpre"> (</span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">,</span><a href="#loc_83_17_83_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_17_83_18&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">) </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
                      </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_27_16_27_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_16_27_19&#39;)"><span class="hl_conref"><span class="mpre">SGr</span></span></a><span class="mpre"> (</span><a href="#loc_83_17_83_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_17_83_18&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">,</span><a href="#loc_80_17_80_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_17_80_19&#39;)"><span class="hl_varref"><span class="mpre">pr</span></span></a><span class="mpre">,</span><a href="#loc_76_23_76_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_23_76_24&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">))
          where </span><a name="loc_78_17_78_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_17_78_20&#39;)"><span class="hl_vardecl"><span class="mpre">nod</span></span></a><span class="mpre">  = </span><span class="hl_varref"><span class="mpre">array</span></span><span class="mpre"> </span><a href="#loc_81_17_81_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_17_81_21&#39;)"><span class="hl_varref"><span class="mpre">bnds</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (\(</span><a name="loc_78_43_78_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_43_78_44&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">,</span><a name="loc_78_45_78_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_45_78_46&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre">)-&gt;(</span><a href="#loc_78_43_78_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_43_78_44&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">,</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> ([],</span><a href="#loc_78_45_78_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_45_78_46&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">,[]))) </span><a href="#loc_76_12_76_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_12_76_14&#39;)"><span class="hl_varref"><span class="mpre">vs</span></span></a><span class="mpre">)
                </span><a name="loc_79_17_79_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_17_79_19&#39;)"><span class="hl_vardecl"><span class="mpre">su</span></span></a><span class="mpre">   = </span><span class="hl_varref"><span class="mpre">accum</span></span><span class="mpre"> </span><a href="#loc_84_17_84_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_17_84_23&#39;)"><span class="hl_varref"><span class="mpre">addSuc</span></span></a><span class="mpre"> </span><a href="#loc_78_17_78_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_78_17_78_20&#39;)"><span class="hl_varref"><span class="mpre">nod</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (\(</span><a name="loc_79_49_79_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_49_79_50&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">,</span><a name="loc_79_51_79_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_51_79_52&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre">,</span><a name="loc_79_53_79_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_53_79_54&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre">)-&gt;(</span><a href="#loc_79_49_79_50" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_49_79_50&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">,(</span><a href="#loc_79_53_79_54" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_53_79_54&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">,</span><a href="#loc_79_51_79_52" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_51_79_52&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">))) </span><a href="#loc_76_15_76_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_15_76_17&#39;)"><span class="hl_varref"><span class="mpre">es</span></span></a><span class="mpre">)
                </span><a name="loc_80_17_80_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_17_80_19&#39;)"><span class="hl_vardecl"><span class="mpre">pr</span></span></a><span class="mpre">   = </span><span class="hl_varref"><span class="mpre">accum</span></span><span class="mpre"> </span><a href="#loc_86_17_86_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_17_86_23&#39;)"><span class="hl_varref"><span class="mpre">addPre</span></span></a><span class="mpre"> </span><a href="#loc_79_17_79_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_79_17_79_19&#39;)"><span class="hl_varref"><span class="mpre">su</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (\(</span><a name="loc_80_48_80_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_48_80_49&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">,</span><a name="loc_80_50_80_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_50_80_51&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre">,</span><a name="loc_80_52_80_53" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_52_80_53&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre">)-&gt;(</span><a href="#loc_80_50_80_51" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_50_80_51&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">,(</span><a href="#loc_80_52_80_53" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_52_80_53&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">,</span><a href="#loc_80_48_80_49" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_48_80_49&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">))) </span><a href="#loc_76_15_76_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_15_76_17&#39;)"><span class="hl_varref"><span class="mpre">es</span></span></a><span class="mpre">)
                </span><a name="loc_81_17_81_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_81_17_81_21&#39;)"><span class="hl_vardecl"><span class="mpre">bnds</span></span></a><span class="mpre"> = (</span><span class="hl_varref"><span class="mpre">minimum</span></span><span class="mpre"> </span><a href="#loc_82_17_82_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_17_82_20&#39;)"><span class="hl_varref"><span class="mpre">vs&#39;</span></span></a><span class="mpre">,</span><span class="hl_varref"><span class="mpre">maximum</span></span><span class="mpre"> </span><a href="#loc_82_17_82_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_17_82_20&#39;)"><span class="hl_varref"><span class="mpre">vs&#39;</span></span></a><span class="mpre">)
                </span><a name="loc_82_17_82_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_82_17_82_20&#39;)"><span class="hl_vardecl"><span class="mpre">vs&#39;</span></span></a><span class="mpre">  = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fst</span></span><span class="mpre"> </span><a href="#loc_76_12_76_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_12_76_14&#39;)"><span class="hl_varref"><span class="mpre">vs</span></span></a><span class="mpre">
                </span><a name="loc_83_17_83_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_83_17_83_18&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre">    = </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_76_12_76_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_12_76_14&#39;)"><span class="hl_varref"><span class="mpre">vs</span></span></a><span class="mpre">
                </span><a name="loc_84_17_84_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_17_84_23&#39;)"><span class="hl_fundecl"><span class="mpre">addSuc</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><a name="loc_84_31_84_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_31_84_32&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">,</span><a name="loc_84_33_84_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_33_84_35&#39;)"><span class="hl_vardecl"><span class="mpre">l&#39;</span></span></a><span class="mpre">,</span><a name="loc_84_36_84_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_36_84_37&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">)) (</span><a name="loc_84_41_84_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_41_84_42&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre">,</span><a name="loc_84_43_84_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_43_84_44&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre">) = </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><a href="#loc_84_31_84_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_31_84_32&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">,</span><a href="#loc_84_33_84_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_33_84_35&#39;)"><span class="hl_varref"><span class="mpre">l&#39;</span></span></a><span class="mpre">,(</span><a href="#loc_84_41_84_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_41_84_42&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">,</span><a href="#loc_84_43_84_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_43_84_44&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_84_36_84_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_36_84_37&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)
                </span><a href="#loc_84_17_84_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_17_84_23&#39;)"><span class="hl_fundecl"><span class="mpre">addSuc</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> _ = </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;mkGraphM (SGr): addSuc Nothing&quot;</span></span><span class="mpre">
                </span><a name="loc_86_17_86_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_17_86_23&#39;)"><span class="hl_fundecl"><span class="mpre">addPre</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (</span><a name="loc_86_31_86_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_31_86_32&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre">,</span><a name="loc_86_33_86_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_33_86_35&#39;)"><span class="hl_vardecl"><span class="mpre">l&#39;</span></span></a><span class="mpre">,</span><a name="loc_86_36_86_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_36_86_37&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre">)) (</span><a name="loc_86_41_86_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_41_86_42&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre">,</span><a name="loc_86_43_86_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_43_86_44&#39;)"><span class="hl_vardecl"><span class="mpre">w</span></span></a><span class="mpre">) = </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> ((</span><a href="#loc_86_41_86_42" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_41_86_42&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">,</span><a href="#loc_86_43_86_44" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_43_86_44&#39;)"><span class="hl_varref"><span class="mpre">w</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_86_31_86_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_31_86_32&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre">,</span><a href="#loc_86_33_86_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_33_86_35&#39;)"><span class="hl_varref"><span class="mpre">l&#39;</span></span></a><span class="mpre">,</span><a href="#loc_86_36_86_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_36_86_37&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre">)
                </span><a href="#loc_86_17_86_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_17_86_23&#39;)"><span class="hl_fundecl"><span class="mpre">addPre</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> _ = </span><span class="hl_varref"><span class="mpre">error</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;mkGraphM (SGr): addPre Nothing&quot;</span></span><span class="mpre">
  </span><a href="Data.Graph.Inductive.Monad.html#loc_47_3_47_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Graph.Inductive.Monad.html#loc_47_3_47_12&#39;)"><span class="hl_fundecl"><span class="mpre">labNodesM</span></span></a><span class="mpre"> </span><a name="loc_88_13_88_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_13_88_14&#39;)"><span class="hl_vardecl"><span class="mpre">g</span></span></a><span class="mpre"> = do (</span><a href="#loc_27_16_27_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_16_27_19&#39;)"><span class="hl_conref"><span class="mpre">SGr</span></span></a><span class="mpre"> (_,</span><a name="loc_88_28_88_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_28_88_29&#39;)"><span class="hl_vardecl"><span class="mpre">a</span></span></a><span class="mpre">,</span><a name="loc_88_30_88_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_30_88_31&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre">)) &lt;- </span><a href="#loc_88_13_88_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_13_88_14&#39;)"><span class="hl_varref"><span class="mpre">g</span></span></a><span class="mpre">
                   let </span><a name="loc_89_24_89_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_24_89_32&#39;)"><span class="hl_fundecl"><span class="mpre">getLNode</span></span></a><span class="mpre"> </span><a name="loc_89_33_89_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_33_89_35&#39;)"><span class="hl_vardecl"><span class="mpre">vs</span></span></a><span class="mpre"> (_,</span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">)      = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_89_33_89_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_33_89_35&#39;)"><span class="hl_varref"><span class="mpre">vs</span></span></a><span class="mpre">
                       </span><a href="#loc_89_24_89_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_24_89_32&#39;)"><span class="hl_fundecl"><span class="mpre">getLNode</span></span></a><span class="mpre"> </span><a name="loc_90_33_90_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_33_90_35&#39;)"><span class="hl_vardecl"><span class="mpre">vs</span></span></a><span class="mpre"> (</span><a name="loc_90_37_90_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_37_90_38&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">,</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> (_,</span><a name="loc_90_47_90_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_47_90_48&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre">,_)) =
                           do </span><a name="loc_91_31_91_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_31_91_32&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">readArray</span></span><span class="mpre"> </span><a href="#loc_88_30_88_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_30_88_31&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><a href="#loc_90_37_90_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_37_90_38&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">
                              </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (if </span><a href="#loc_91_31_91_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_91_31_91_32&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre"> then </span><a href="#loc_90_33_90_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_33_90_35&#39;)"><span class="hl_varref"><span class="mpre">vs</span></span></a><span class="mpre"> else (</span><a href="#loc_90_37_90_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_37_90_38&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">,</span><a href="#loc_90_47_90_48" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_47_90_48&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">)</span><span class="hl_infix"><span class="mpre">:</span></span><a href="#loc_90_33_90_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_90_33_90_35&#39;)"><span class="hl_varref"><span class="mpre">vs</span></span></a><span class="mpre">)
                   </span><a href="Control.Monad.html#loc_240_1_240_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_240_1_240_6&#39;)"><span class="hl_varref"><span class="mpre">foldM</span></span></a><span class="mpre"> </span><a href="#loc_89_24_89_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_89_24_89_32&#39;)"><span class="hl_varref"><span class="mpre">getLNode</span></span></a><span class="mpre"> [] (</span><span class="hl_varref"><span class="mpre">assocs</span></span><span class="mpre"> </span><a href="#loc_88_28_88_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_28_88_29&#39;)"><span class="hl_varref"><span class="mpre">a</span></span></a><span class="mpre">)

</span><a href="#loc_96_1_96_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_1_96_17&#39;)"><span class="mpre">defaultGraphSize</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">
</span><a name="loc_96_1_96_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_1_96_17&#39;)"><span class="hl_vardecl"><span class="mpre">defaultGraphSize</span></span></a><span class="mpre"> = </span><span class="hl_num"><span class="mpre">100</span></span><span class="mpre">

</span><a href="#loc_99_1_99_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_1_99_7&#39;)"><span class="mpre">emptyN</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><a href="#loc_27_6_27_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_6_27_9&#39;)"><span class="hl_tyconref"><span class="mpre">SGr</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">)
</span><a name="loc_99_1_99_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_1_99_7&#39;)"><span class="hl_fundecl"><span class="mpre">emptyN</span></span></a><span class="mpre"> </span><a name="loc_99_8_99_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_8_99_9&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> = do </span><a name="loc_99_15_99_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_15_99_16&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> &lt;- </span><span class="hl_varref"><span class="mpre">newArray</span></span><span class="mpre"> (</span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">,</span><a href="#loc_99_8_99_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_8_99_9&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">) </span><span class="hl_conref"><span class="mpre">False</span></span><span class="mpre">
              </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><a href="#loc_27_16_27_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_27_16_27_19&#39;)"><span class="hl_conref"><span class="mpre">SGr</span></span></a><span class="mpre"> (</span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre">,</span><span class="hl_varref"><span class="mpre">array</span></span><span class="mpre"> (</span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">,</span><a href="#loc_99_8_99_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_8_99_9&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">) [(</span><a href="#loc_100_57_100_58" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_57_100_58&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">,</span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre">) | </span><a name="loc_100_57_100_58" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_100_57_100_58&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> &lt;- </span><span class="warning" data-warning="ExpEnumFromTo (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Monad/IOArray.hs&quot;, srcSpanStartLine = 100, srcSpanStartColumn = 62, srcSpanEndLine = 100, srcSpanEndColumn = 68}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Graph/Inductive/Monad/IOArray.hs&quot;, srcSpanStartLine = 100, srcSpanStartColumn = 62, srcSpanEndLine = 100, srcSpanEndColumn = 63},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/fgl-5.5.0.1/Data/Gr"><span class="mpre">[1..n]</span></span><span class="mpre">],</span><a href="#loc_99_15_99_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_99_15_99_16&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre">))

</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------------</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- UTILITIES</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">----------------------------------------------------------------------</span></span><span class="mpre">



</span><span class="hl_comment"><span class="mpre">-- | filter list (of successors\/predecessors) through a boolean ST array</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- representing deleted marks</span></span><span class="mpre">
</span><a href="#loc_111_1_111_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_1_111_10&#39;)"><span class="mpre">removeDel</span></a><span class="mpre"> :: </span><a href="GHC.IOArray.html#loc_42_9_42_16" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IOArray.html#loc_42_9_42_16&#39;)"><span class="hl_tyconref"><span class="mpre">IOArray</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Node</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bool</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Adj</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">Adj</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">)
</span><a name="loc_111_1_111_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_1_111_10&#39;)"><span class="hl_fundecl"><span class="mpre">removeDel</span></span></a><span class="mpre"> </span><a name="loc_111_11_111_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_11_111_12&#39;)"><span class="hl_vardecl"><span class="mpre">m</span></span></a><span class="mpre"> = </span><a href="Control.Monad.html#loc_154_1_154_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Control.Monad.html#loc_154_1_154_8&#39;)"><span class="hl_varref"><span class="mpre">filterM</span></span></a><span class="mpre"> (\(_,</span><a name="loc_111_28_111_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_28_111_29&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre">)-&gt;do {</span><a name="loc_111_36_111_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_36_111_37&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">&lt;-</span><span class="hl_varref"><span class="mpre">readArray</span></span><span class="mpre"> </span><a href="#loc_111_11_111_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_11_111_12&#39;)"><span class="hl_varref"><span class="mpre">m</span></span></a><span class="mpre"> </span><a href="#loc_111_28_111_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_28_111_29&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">;</span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">not</span></span><span class="mpre"> </span><a href="#loc_111_36_111_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_111_36_111_37&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">)})



</span></div></body></html>