<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      : Crypto.Cipher.Types</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     : BSD-style</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  : Vincent Hanquez &lt;vincent@snarc.org&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   : Stable</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability : Excellent</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- symmetric cipher basic types</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
{-# LANGUAGE DeriveDataTypeable #-}
module Crypto.Cipher.Types
    (
    </span><span class="hl_comment"><span class="mpre">-- * Cipher classes</span></span><span class="mpre">
      Cipher(..)
    , BlockCipher(..)
    , StreamCipher(..)
    , DataUnitOffset
    , KeySizeSpecifier(..)
    , KeyError(..)
    , AEAD(..)
    , AEADState(..)
    , AEADMode(..)
    , AEADModeImpl(..)
    , cfb8Encrypt
    , cfb8Decrypt
    </span><span class="hl_comment"><span class="mpre">-- * AEAD functions</span></span><span class="mpre">
    , module Crypto.Cipher.Types.AEAD
    </span><span class="hl_comment"><span class="mpre">-- * Key type and constructor</span></span><span class="mpre">
    , Key
    , makeKey
    </span><span class="hl_comment"><span class="mpre">-- * Initial Vector type and constructor</span></span><span class="mpre">
    , IV
    , makeIV
    , nullIV
    , ivAdd
    </span><span class="hl_comment"><span class="mpre">-- * Authentification Tag</span></span><span class="mpre">
    , AuthTag(..)
    ) where

import </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types.hs&quot;, srcSpanStartLine = 40, srcSpanStartColumn = 8, srcSpanEndLine = 40, srcSpanEndColumn = 22}, srcInfoPoints = []}) &quot;Data.SecureMem&quot;"><span class="mpre">Data.SecureMem</span></span><span class="mpre">
import Data.Byteable
import Crypto.Cipher.Types.Base
import Crypto.Cipher.Types.Block
import Crypto.Cipher.Types.Stream
import Crypto.Cipher.Types.AEAD

</span><span class="hl_comment"><span class="mpre">-- | Create a Key for a specified cipher</span></span><span class="mpre">
</span><a href="#loc_49_1_49_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_1_49_8&#39;)"><span class="mpre">makeKey</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types.hs&quot;, srcSpanStartLine = 48, srcSpanStartColumn = 12, srcSpanEndLine = 48, srcSpanEndColumn = 40}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types.hs&quot;, srcSpanStartLine = 48, srcSpanStartColumn = 12, srcSpanEndLine = 48, srcSpanEndColumn = 13},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Cr"><span class="mpre">(ToSecureMem b, Cipher c) =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><a href="Crypto.Cipher.Types.Base.html#loc_27_6_27_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Base.html#loc_27_6_27_14&#39;)"><span class="hl_tyconref"><span class="mpre">KeyError</span></span></a><span class="mpre"> (</span><a href="Crypto.Cipher.Types.Base.html#loc_44_9_44_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Base.html#loc_44_9_44_12&#39;)"><span class="hl_tyconref"><span class="mpre">Key</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">c</span></span><span class="mpre">)
</span><a name="loc_49_1_49_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_1_49_8&#39;)"><span class="hl_fundecl"><span class="mpre">makeKey</span></span></a><span class="mpre"> </span><a name="loc_49_9_49_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_9_49_10&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre"> = </span><a href="#loc_53_9_53_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_9_53_14&#39;)"><span class="hl_varref"><span class="mpre">toKey</span></span></a><span class="mpre"> </span><span class="hl_varref"><span class="mpre">undefined</span></span><span class="mpre">
  where </span><a name="loc_50_9_50_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_9_50_11&#39;)"><span class="hl_vardecl"><span class="mpre">sm</span></span></a><span class="mpre">    = </span><span class="hl_varref"><span class="mpre">toSecureMem</span></span><span class="mpre"> </span><a href="#loc_49_9_49_10" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_9_49_10&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">
        </span><a name="loc_51_9_51_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_9_51_14&#39;)"><span class="hl_vardecl"><span class="mpre">smLen</span></span></a><span class="mpre"> = </span><a href="Data.Byteable.html#loc_27_5_27_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Byteable.html#loc_27_5_27_19&#39;)"><span class="hl_varref"><span class="mpre">byteableLength</span></span></a><span class="mpre"> </span><a href="#loc_50_9_50_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_9_50_11&#39;)"><span class="hl_varref"><span class="mpre">sm</span></span></a><span class="mpre">
        </span><a href="#loc_53_9_53_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_9_53_14&#39;)"><span class="mpre">toKey</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxSingle (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types.hs&quot;, srcSpanStartLine = 52, srcSpanStartColumn = 18, srcSpanEndLine = 52, srcSpanEndColumn = 29}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/crypto-cipher-types-0.0.9/Crypto/Cipher/Types.hs&quot;, srcSpanStartLine = 52, srcSpanStartColumn = 27, srcSpanEndLine = 52, srcSpanEndColumn = 29}]}) (ClassA (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/"><span class="mpre">Cipher c =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">c</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Either</span></span><span class="mpre"> </span><a href="Crypto.Cipher.Types.Base.html#loc_27_6_27_14" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Base.html#loc_27_6_27_14&#39;)"><span class="hl_tyconref"><span class="mpre">KeyError</span></span></a><span class="mpre"> (</span><a href="Crypto.Cipher.Types.Base.html#loc_44_9_44_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Base.html#loc_44_9_44_12&#39;)"><span class="hl_tyconref"><span class="mpre">Key</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">c</span></span><span class="mpre">)
        </span><a name="loc_53_9_53_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_9_53_14&#39;)"><span class="hl_fundecl"><span class="mpre">toKey</span></span></a><span class="mpre"> </span><a name="loc_53_15_53_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_15_53_21&#39;)"><span class="hl_vardecl"><span class="mpre">cipher</span></span></a><span class="mpre"> = case </span><a href="Crypto.Cipher.Types.Base.html#loc_83_5_83_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Base.html#loc_83_5_83_18&#39;)"><span class="hl_varref"><span class="mpre">cipherKeySize</span></span></a><span class="mpre"> </span><a href="#loc_53_15_53_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_15_53_21&#39;)"><span class="hl_varref"><span class="mpre">cipher</span></span></a><span class="mpre"> of
            </span><a href="Crypto.Cipher.Types.Base.html#loc_35_7_35_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Base.html#loc_35_7_35_19&#39;)"><span class="hl_conref"><span class="mpre">KeySizeRange</span></span></a><span class="mpre"> </span><a name="loc_54_26_54_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_26_54_28&#39;)"><span class="hl_vardecl"><span class="mpre">mi</span></span></a><span class="mpre"> </span><a name="loc_54_29_54_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_29_54_31&#39;)"><span class="hl_vardecl"><span class="mpre">ma</span></span></a><span class="mpre"> | </span><a href="#loc_51_9_51_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_9_51_14&#39;)"><span class="hl_varref"><span class="mpre">smLen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_54_26_54_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_26_54_28&#39;)"><span class="hl_varref"><span class="mpre">mi</span></span></a><span class="mpre"> -&gt; </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><a href="Crypto.Cipher.Types.Base.html#loc_28_7_28_23" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Base.html#loc_28_7_28_23&#39;)"><span class="hl_conref"><span class="mpre">KeyErrorTooSmall</span></span></a><span class="mpre">
                               | </span><a href="#loc_51_9_51_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_9_51_14&#39;)"><span class="hl_varref"><span class="mpre">smLen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><a href="#loc_54_29_54_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_54_29_54_31&#39;)"><span class="hl_varref"><span class="mpre">ma</span></span></a><span class="mpre"> -&gt; </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><a href="Crypto.Cipher.Types.Base.html#loc_29_7_29_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Base.html#loc_29_7_29_21&#39;)"><span class="hl_conref"><span class="mpre">KeyErrorTooBig</span></span></a><span class="mpre">
                               | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">  -&gt; </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Crypto.Cipher.Types.Base.html#loc_44_17_44_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Base.html#loc_44_17_44_20&#39;)"><span class="hl_conref"><span class="mpre">Key</span></span></a><span class="mpre"> </span><a href="#loc_50_9_50_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_9_50_11&#39;)"><span class="hl_varref"><span class="mpre">sm</span></span></a><span class="mpre">
            </span><a href="Crypto.Cipher.Types.Base.html#loc_36_7_36_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Base.html#loc_36_7_36_18&#39;)"><span class="hl_conref"><span class="mpre">KeySizeEnum</span></span></a><span class="mpre"> </span><a name="loc_57_25_57_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_25_57_26&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> | </span><a href="#loc_51_9_51_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_9_51_14&#39;)"><span class="hl_varref"><span class="mpre">smLen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`elem`</span></span><span class="mpre"> </span><a href="#loc_57_25_57_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_25_57_26&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">  -&gt; </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Crypto.Cipher.Types.Base.html#loc_44_17_44_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Base.html#loc_44_17_44_20&#39;)"><span class="hl_conref"><span class="mpre">Key</span></span></a><span class="mpre"> </span><a href="#loc_50_9_50_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_9_50_11&#39;)"><span class="hl_varref"><span class="mpre">sm</span></span></a><span class="mpre">
                          | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">       -&gt; </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Crypto.Cipher.Types.Base.html#loc_30_7_30_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Base.html#loc_30_7_30_22&#39;)"><span class="hl_conref"><span class="mpre">KeyErrorInvalid</span></span></a><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;valid size: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_57_25_57_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_57_25_57_26&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">)
            </span><a href="Crypto.Cipher.Types.Base.html#loc_37_7_37_19" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Base.html#loc_37_7_37_19&#39;)"><span class="hl_conref"><span class="mpre">KeySizeFixed</span></span></a><span class="mpre"> </span><a name="loc_59_26_59_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_26_59_27&#39;)"><span class="hl_vardecl"><span class="mpre">v</span></span></a><span class="mpre"> | </span><a href="#loc_51_9_51_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_9_51_14&#39;)"><span class="hl_varref"><span class="mpre">smLen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_59_26_59_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_26_59_27&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">     -&gt; </span><span class="hl_conref"><span class="mpre">Right</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Crypto.Cipher.Types.Base.html#loc_44_17_44_20" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Base.html#loc_44_17_44_20&#39;)"><span class="hl_conref"><span class="mpre">Key</span></span></a><span class="mpre"> </span><a href="#loc_50_9_50_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_50_9_50_11&#39;)"><span class="hl_varref"><span class="mpre">sm</span></span></a><span class="mpre">
                           | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre">      -&gt; </span><span class="hl_conref"><span class="mpre">Left</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Crypto.Cipher.Types.Base.html#loc_30_7_30_22" onmouseover="nemnem.highlightLocalToRemote(&#39;Crypto.Cipher.Types.Base.html#loc_30_7_30_22&#39;)"><span class="hl_conref"><span class="mpre">KeyErrorInvalid</span></span></a><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;valid size: &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_59_26_59_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_26_59_27&#39;)"><span class="hl_varref"><span class="mpre">v</span></span></a><span class="mpre">)
</span></div></body></html>