<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="/static/nemnem.css"><script src="/static/jquery-2.0.3.min.js"></script><script src="/static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE BangPatterns, CPP, Rank2Types #-}

</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      : Data.Text.Internal.Encoding.Fusion</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Copyright   : (c) Tom Harper 2008-2009,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--               (c) Bryan O&#39;Sullivan 2009,</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--               (c) Duncan Coutts 2009</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     : BSD-style</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  : bos@serpentine.com</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   : experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability : portable</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- /Warning/: this is an internal module, and does not have a stable</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- API or name. Functions in this module may not check or enforce</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- preconditions expected by public modules. Use at your own risk!</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Fusible &#39;Stream&#39;-oriented functions for converting between &#39;Text&#39;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- and several common encodings.</span></span><span class="mpre">

module Data.Text.Internal.Encoding.Fusion
    (
    </span><span class="hl_comment"><span class="mpre">-- * Streaming</span></span><span class="mpre">
      streamASCII
    , streamUtf8
    , streamUtf16LE
    , streamUtf16BE
    , streamUtf32LE
    , streamUtf32BE

    </span><span class="hl_comment"><span class="mpre">-- * Unstreaming</span></span><span class="mpre">
    , unstream

    , module Data.Text.Internal.Encoding.Fusion.Common
    ) where

#if defined(ASSERTS)
import Control.Exception (assert)
#endif
import Data.ByteString.Internal (</span><a href="Data.ByteString.Internal.html#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_193_6_193_16&#39;)"><span class="mpre">ByteString</span></a><span class="mpre">(..), </span><a href="Data.ByteString.Internal.html#loc_489_1_489_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_489_1_489_17&#39;)"><span class="mpre">mallocByteString</span></a><span class="mpre">, </span><a href="Data.ByteString.Internal.html#loc_624_1_624_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_624_1_624_7&#39;)"><span class="mpre">memcpy</span></a><span class="mpre">)
import Data.Text.Internal.Fusion (</span><a href="Data.Text.Internal.Fusion.Types.html#loc_59_6_59_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_59_6_59_10&#39;)"><span class="mpre">Step</span></a><span class="mpre">(..), </span><a href="Data.Text.Internal.Fusion.Types.html#loc_88_6_88_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_88_6_88_12&#39;)"><span class="mpre">Stream</span></a><span class="mpre">(..))
import Data.Text.Internal.Fusion.Size
import Data.Text.Encoding.Error
import Data.Text.Internal.Encoding.Fusion.Common
import Data.Text.Internal.Unsafe.Char (</span><a href="Data.Text.Internal.Unsafe.Char.html#loc_44_1_44_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Unsafe.Char.html#loc_44_1_44_10&#39;)"><span class="mpre">unsafeChr</span></a><span class="mpre">, </span><a href="Data.Text.Internal.Unsafe.Char.html#loc_48_1_48_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Unsafe.Char.html#loc_48_1_48_11&#39;)"><span class="mpre">unsafeChr8</span></a><span class="mpre">, </span><a href="Data.Text.Internal.Unsafe.Char.html#loc_52_1_52_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Unsafe.Char.html#loc_52_1_52_12&#39;)"><span class="mpre">unsafeChr32</span></a><span class="mpre">)
import Data.Text.Internal.Unsafe.Shift (</span><a href="Data.Text.Internal.Unsafe.Shift.html#loc_34_5_34_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Unsafe.Shift.html#loc_34_5_34_11&#39;)"><span class="mpre">shiftL</span></a><span class="mpre">, </span><a href="Data.Text.Internal.Unsafe.Shift.html#loc_35_5_35_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Unsafe.Shift.html#loc_35_5_35_11&#39;)"><span class="mpre">shiftR</span></a><span class="mpre">)
import Data.Word (Word8, Word16, Word32)
import Foreign.ForeignPtr (</span><a href="Foreign.ForeignPtr.Imp.html#loc_88_1_88_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Foreign.ForeignPtr.Imp.html#loc_88_1_88_15&#39;)"><span class="mpre">withForeignPtr</span></a><span class="mpre">, ForeignPtr)
import Foreign.Storable (pokeByteOff)
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/Data/Text/Internal/Encoding/Fusion.hs&quot;, srcSpanStartLine = 50, srcSpanStartColumn = 18, srcSpanEndLine = 50, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> as B
import qualified Data.ByteString.Unsafe as B
import qualified Data.Text.Internal.Encoding.Utf8 as U8
import qualified Data.Text.Internal.Encoding.Utf16 as U16
import qualified Data.Text.Internal.Encoding.Utf32 as U32
import Data.Text.Unsafe (</span><a href="GHC.IO.html#loc_182_1_182_23" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_182_1_182_23&#39;)"><span class="mpre">unsafeDupablePerformIO</span></a><span class="mpre">)

</span><a href="#loc_58_1_58_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_1_58_12&#39;)"><span class="mpre">streamASCII</span></a><span class="mpre"> :: </span><a href="Data.ByteString.Internal.html#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">ByteString</span></span></a><span class="mpre"> -&gt; </span><a href="Data.Text.Internal.Fusion.Types.html#loc_88_6_88_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_88_6_88_12&#39;)"><span class="hl_tyconref"><span class="mpre">Stream</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">
</span><a name="loc_58_1_58_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_1_58_12&#39;)"><span class="hl_fundecl"><span class="mpre">streamASCII</span></span></a><span class="mpre"> </span><a name="loc_58_13_58_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_13_58_15&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Stream</span></span><span class="mpre"> </span><a href="#loc_62_7_62_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_7_62_11&#39;)"><span class="hl_varref"><span class="mpre">next</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> (</span><a href="Data.Text.Internal.Fusion.Size.html#loc_57_1_57_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Size.html#loc_57_1_57_8&#39;)"><span class="hl_varref"><span class="mpre">maxSize</span></span></a><span class="mpre"> </span><a href="#loc_60_7_60_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_7_60_8&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">)
    where
      </span><a name="loc_60_7_60_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_7_60_8&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_58_13_58_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_13_58_15&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
      </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_62_7_62_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_7_62_11&#39;)"><span class="mpre">next</span></a><span class="mpre"> #-}</span></span><span class="mpre">
      </span><a name="loc_62_7_62_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_7_62_11&#39;)"><span class="hl_fundecl"><span class="mpre">next</span></span></a><span class="mpre"> </span><a name="loc_62_12_62_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_12_62_13&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre">
          | </span><a href="#loc_62_12_62_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_12_62_13&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><a href="#loc_60_7_60_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_60_7_60_8&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">    = </span><span class="hl_conref"><span class="mpre">Done</span></span><span class="mpre">
          | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Yield</span></span><span class="mpre"> (</span><a href="Data.Text.Internal.Unsafe.Char.html#loc_48_1_48_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Unsafe.Char.html#loc_48_1_48_11&#39;)"><span class="hl_varref"><span class="mpre">unsafeChr8</span></span></a><span class="mpre"> </span><a href="#loc_66_13_66_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_13_66_15&#39;)"><span class="hl_varref"><span class="mpre">x1</span></span></a><span class="mpre">) (</span><a href="#loc_62_12_62_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_12_62_13&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
          where
            </span><a name="loc_66_13_66_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_66_13_66_15&#39;)"><span class="hl_vardecl"><span class="mpre">x1</span></span></a><span class="mpre"> = </span><a href="Data.ByteString.Unsafe.html#loc_135_1_135_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Unsafe.html#loc_135_1_135_12&#39;)"><span class="hl_varref"><span class="mpre">B.unsafeIndex</span></span></a><span class="mpre"> </span><a href="#loc_58_13_58_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_13_58_15&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> </span><a href="#loc_62_12_62_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_12_62_13&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">
</span><span class="warning" data-warning="DeclDeprPragmaDecl (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/Data/Text/Internal/Encoding/Fusion.hs&quot;, srcSpanStartLine = 67, srcSpanStartColumn = 1, srcSpanEndLine = 67, srcSpanEndColumn = 58}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/Data/Text/Internal/Encoding/Fusion.hs&quot;, srcSpanStartLine = 67, srcSpanStartColumn = 1, srcSpanEndLine = 67, srcSpanEndColumn = 15},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/text-1.1.1.3/Data/T"><span class="mpre">{-# DEPRECATED streamASCII &quot;Do not use this function&quot; #-}</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE [0] </span><a href="#loc_58_1_58_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_58_1_58_12&#39;)"><span class="mpre">streamASCII</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | /O(n)/ Convert a &#39;ByteString&#39; into a &#39;Stream Char&#39;, using UTF-8</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- encoding.</span></span><span class="mpre">
</span><a href="#loc_73_1_73_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_1_73_11&#39;)"><span class="mpre">streamUtf8</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">OnDecodeError</span></span><span class="mpre"> -&gt; </span><a href="Data.ByteString.Internal.html#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">ByteString</span></span></a><span class="mpre"> -&gt; </span><a href="Data.Text.Internal.Fusion.Types.html#loc_88_6_88_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_88_6_88_12&#39;)"><span class="hl_tyconref"><span class="mpre">Stream</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">
</span><a name="loc_73_1_73_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_1_73_11&#39;)"><span class="hl_fundecl"><span class="mpre">streamUtf8</span></span></a><span class="mpre"> </span><a name="loc_73_12_73_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_12_73_17&#39;)"><span class="hl_vardecl"><span class="mpre">onErr</span></span></a><span class="mpre"> </span><a name="loc_73_18_73_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_18_73_20&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Stream</span></span><span class="mpre"> </span><a href="#loc_76_7_76_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_7_76_11&#39;)"><span class="hl_varref"><span class="mpre">next</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> (</span><a href="Data.Text.Internal.Fusion.Size.html#loc_57_1_57_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Size.html#loc_57_1_57_8&#39;)"><span class="hl_varref"><span class="mpre">maxSize</span></span></a><span class="mpre"> </span><a href="#loc_75_7_75_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_7_75_8&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">)
    where
      </span><a name="loc_75_7_75_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_7_75_8&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_73_18_73_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_18_73_20&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
      </span><a name="loc_76_7_76_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_7_76_11&#39;)"><span class="hl_fundecl"><span class="mpre">next</span></span></a><span class="mpre"> </span><a name="loc_76_12_76_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_12_76_13&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre">
          | </span><a href="#loc_76_12_76_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_12_76_13&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><a href="#loc_75_7_75_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_7_75_8&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Done</span></span><span class="mpre">
          | </span><a href="Data.Text.Internal.Encoding.Utf8.html#loc_129_1_129_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Encoding.Utf8.html#loc_129_1_129_10&#39;)"><span class="hl_varref"><span class="mpre">U8.validate1</span></span></a><span class="mpre"> </span><a href="#loc_84_13_84_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_13_84_15&#39;)"><span class="hl_varref"><span class="mpre">x1</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Yield</span></span><span class="mpre"> (</span><a href="Data.Text.Internal.Unsafe.Char.html#loc_48_1_48_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Unsafe.Char.html#loc_48_1_48_11&#39;)"><span class="hl_varref"><span class="mpre">unsafeChr8</span></span></a><span class="mpre"> </span><a href="#loc_84_13_84_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_13_84_15&#39;)"><span class="hl_varref"><span class="mpre">x1</span></span></a><span class="mpre">) (</span><a href="#loc_76_12_76_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_12_76_13&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
          | </span><a href="#loc_76_12_76_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_12_76_13&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_75_7_75_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_7_75_8&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="Data.Text.Internal.Encoding.Utf8.html#loc_133_1_133_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Encoding.Utf8.html#loc_133_1_133_10&#39;)"><span class="hl_varref"><span class="mpre">U8.validate2</span></span></a><span class="mpre"> </span><a href="#loc_84_13_84_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_13_84_15&#39;)"><span class="hl_varref"><span class="mpre">x1</span></span></a><span class="mpre"> </span><a href="#loc_85_13_85_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_13_85_15&#39;)"><span class="hl_varref"><span class="mpre">x2</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Yield</span></span><span class="mpre"> (</span><a href="Data.Text.Internal.Encoding.Utf8.html#loc_95_1_95_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Encoding.Utf8.html#loc_95_1_95_5&#39;)"><span class="hl_varref"><span class="mpre">U8.chr2</span></span></a><span class="mpre"> </span><a href="#loc_84_13_84_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_13_84_15&#39;)"><span class="hl_varref"><span class="mpre">x1</span></span></a><span class="mpre"> </span><a href="#loc_85_13_85_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_13_85_15&#39;)"><span class="hl_varref"><span class="mpre">x2</span></span></a><span class="mpre">) (</span><a href="#loc_76_12_76_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_12_76_13&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">)
          | </span><a href="#loc_76_12_76_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_12_76_13&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_75_7_75_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_7_75_8&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="Data.Text.Internal.Encoding.Utf8.html#loc_138_1_138_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Encoding.Utf8.html#loc_138_1_138_10&#39;)"><span class="hl_varref"><span class="mpre">U8.validate3</span></span></a><span class="mpre"> </span><a href="#loc_84_13_84_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_13_84_15&#39;)"><span class="hl_varref"><span class="mpre">x1</span></span></a><span class="mpre"> </span><a href="#loc_85_13_85_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_13_85_15&#39;)"><span class="hl_varref"><span class="mpre">x2</span></span></a><span class="mpre"> </span><a href="#loc_86_13_86_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_13_86_15&#39;)"><span class="hl_varref"><span class="mpre">x3</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Yield</span></span><span class="mpre"> (</span><a href="Data.Text.Internal.Encoding.Utf8.html#loc_104_1_104_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Encoding.Utf8.html#loc_104_1_104_5&#39;)"><span class="hl_varref"><span class="mpre">U8.chr3</span></span></a><span class="mpre"> </span><a href="#loc_84_13_84_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_13_84_15&#39;)"><span class="hl_varref"><span class="mpre">x1</span></span></a><span class="mpre"> </span><a href="#loc_85_13_85_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_13_85_15&#39;)"><span class="hl_varref"><span class="mpre">x2</span></span></a><span class="mpre"> </span><a href="#loc_86_13_86_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_13_86_15&#39;)"><span class="hl_varref"><span class="mpre">x3</span></span></a><span class="mpre">) (</span><a href="#loc_76_12_76_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_12_76_13&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">)
          | </span><a href="#loc_76_12_76_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_12_76_13&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_75_7_75_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_75_7_75_8&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="Data.Text.Internal.Encoding.Utf8.html#loc_155_1_155_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Encoding.Utf8.html#loc_155_1_155_10&#39;)"><span class="hl_varref"><span class="mpre">U8.validate4</span></span></a><span class="mpre"> </span><a href="#loc_84_13_84_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_13_84_15&#39;)"><span class="hl_varref"><span class="mpre">x1</span></span></a><span class="mpre"> </span><a href="#loc_85_13_85_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_13_85_15&#39;)"><span class="hl_varref"><span class="mpre">x2</span></span></a><span class="mpre"> </span><a href="#loc_86_13_86_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_13_86_15&#39;)"><span class="hl_varref"><span class="mpre">x3</span></span></a><span class="mpre"> </span><a href="#loc_87_13_87_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_13_87_15&#39;)"><span class="hl_varref"><span class="mpre">x4</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Yield</span></span><span class="mpre"> (</span><a href="Data.Text.Internal.Encoding.Utf8.html#loc_115_1_115_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Encoding.Utf8.html#loc_115_1_115_5&#39;)"><span class="hl_varref"><span class="mpre">U8.chr4</span></span></a><span class="mpre"> </span><a href="#loc_84_13_84_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_13_84_15&#39;)"><span class="hl_varref"><span class="mpre">x1</span></span></a><span class="mpre"> </span><a href="#loc_85_13_85_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_13_85_15&#39;)"><span class="hl_varref"><span class="mpre">x2</span></span></a><span class="mpre"> </span><a href="#loc_86_13_86_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_13_86_15&#39;)"><span class="hl_varref"><span class="mpre">x3</span></span></a><span class="mpre"> </span><a href="#loc_87_13_87_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_13_87_15&#39;)"><span class="hl_varref"><span class="mpre">x4</span></span></a><span class="mpre">) (</span><a href="#loc_76_12_76_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_12_76_13&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">)
          | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="#loc_203_1_203_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_1_203_12&#39;)"><span class="hl_varref"><span class="mpre">decodeError</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;streamUtf8&quot;</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;UTF-8&quot;</span></span><span class="mpre"> </span><a href="#loc_73_12_73_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_12_73_17&#39;)"><span class="hl_varref"><span class="mpre">onErr</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a href="#loc_84_13_84_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_13_84_15&#39;)"><span class="hl_varref"><span class="mpre">x1</span></span></a><span class="mpre">) (</span><a href="#loc_76_12_76_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_12_76_13&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
          where
            </span><a name="loc_84_13_84_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_13_84_15&#39;)"><span class="hl_vardecl"><span class="mpre">x1</span></span></a><span class="mpre"> = </span><a href="#loc_88_13_88_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_13_88_16&#39;)"><span class="hl_varref"><span class="mpre">idx</span></span></a><span class="mpre"> </span><a href="#loc_76_12_76_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_12_76_13&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">
            </span><a name="loc_85_13_85_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_85_13_85_15&#39;)"><span class="hl_vardecl"><span class="mpre">x2</span></span></a><span class="mpre"> = </span><a href="#loc_88_13_88_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_13_88_16&#39;)"><span class="hl_varref"><span class="mpre">idx</span></span></a><span class="mpre"> (</span><a href="#loc_76_12_76_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_12_76_13&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
            </span><a name="loc_86_13_86_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_86_13_86_15&#39;)"><span class="hl_vardecl"><span class="mpre">x3</span></span></a><span class="mpre"> = </span><a href="#loc_88_13_88_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_13_88_16&#39;)"><span class="hl_varref"><span class="mpre">idx</span></span></a><span class="mpre"> (</span><a href="#loc_76_12_76_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_12_76_13&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">)
            </span><a name="loc_87_13_87_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_87_13_87_15&#39;)"><span class="hl_vardecl"><span class="mpre">x4</span></span></a><span class="mpre"> = </span><a href="#loc_88_13_88_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_13_88_16&#39;)"><span class="hl_varref"><span class="mpre">idx</span></span></a><span class="mpre"> (</span><a href="#loc_76_12_76_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_12_76_13&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">)
            </span><a name="loc_88_13_88_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_13_88_16&#39;)"><span class="hl_vardecl"><span class="mpre">idx</span></span></a><span class="mpre"> = </span><a href="Data.ByteString.Unsafe.html#loc_135_1_135_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Unsafe.html#loc_135_1_135_12&#39;)"><span class="hl_varref"><span class="mpre">B.unsafeIndex</span></span></a><span class="mpre"> </span><a href="#loc_73_18_73_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_18_73_20&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE [0] </span><a href="#loc_73_1_73_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_73_1_73_11&#39;)"><span class="mpre">streamUtf8</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | /O(n)/ Convert a &#39;ByteString&#39; into a &#39;Stream Char&#39;, using little</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- endian UTF-16 encoding.</span></span><span class="mpre">
</span><a href="#loc_94_1_94_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_1_94_14&#39;)"><span class="mpre">streamUtf16LE</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">OnDecodeError</span></span><span class="mpre"> -&gt; </span><a href="Data.ByteString.Internal.html#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">ByteString</span></span></a><span class="mpre"> -&gt; </span><a href="Data.Text.Internal.Fusion.Types.html#loc_88_6_88_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_88_6_88_12&#39;)"><span class="hl_tyconref"><span class="mpre">Stream</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">
</span><a name="loc_94_1_94_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_1_94_14&#39;)"><span class="hl_fundecl"><span class="mpre">streamUtf16LE</span></span></a><span class="mpre"> </span><a name="loc_94_15_94_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_15_94_20&#39;)"><span class="hl_vardecl"><span class="mpre">onErr</span></span></a><span class="mpre"> </span><a name="loc_94_21_94_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_21_94_23&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Stream</span></span><span class="mpre"> </span><a href="#loc_98_7_98_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_7_98_11&#39;)"><span class="hl_varref"><span class="mpre">next</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> (</span><a href="Data.Text.Internal.Fusion.Size.html#loc_57_1_57_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Size.html#loc_57_1_57_8&#39;)"><span class="hl_varref"><span class="mpre">maxSize</span></span></a><span class="mpre"> (</span><a href="#loc_96_7_96_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_7_96_8&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><a href="Data.Text.Internal.Unsafe.Shift.html#loc_35_5_35_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Unsafe.Shift.html#loc_35_5_35_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftR`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">))
    where
      </span><a name="loc_96_7_96_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_7_96_8&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_94_21_94_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_21_94_23&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
      </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_98_7_98_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_7_98_11&#39;)"><span class="mpre">next</span></a><span class="mpre"> #-}</span></span><span class="mpre">
      </span><a name="loc_98_7_98_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_7_98_11&#39;)"><span class="hl_fundecl"><span class="mpre">next</span></span></a><span class="mpre"> </span><a name="loc_98_12_98_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_12_98_13&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre">
          | </span><a href="#loc_98_12_98_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_12_98_13&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><a href="#loc_96_7_96_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_7_96_8&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">                         = </span><span class="hl_conref"><span class="mpre">Done</span></span><span class="mpre">
          | </span><a href="#loc_98_12_98_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_12_98_13&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_96_7_96_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_7_96_8&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="Data.Text.Internal.Encoding.Utf16.html#loc_39_1_39_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Encoding.Utf16.html#loc_39_1_39_10&#39;)"><span class="hl_varref"><span class="mpre">U16.validate1</span></span></a><span class="mpre"> </span><a href="#loc_104_13_104_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_13_104_15&#39;)"><span class="hl_varref"><span class="mpre">x1</span></span></a><span class="mpre">    = </span><span class="hl_conref"><span class="mpre">Yield</span></span><span class="mpre"> (</span><a href="Data.Text.Internal.Unsafe.Char.html#loc_44_1_44_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Unsafe.Char.html#loc_44_1_44_10&#39;)"><span class="hl_varref"><span class="mpre">unsafeChr</span></span></a><span class="mpre"> </span><a href="#loc_104_13_104_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_13_104_15&#39;)"><span class="hl_varref"><span class="mpre">x1</span></span></a><span class="mpre">) (</span><a href="#loc_98_12_98_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_12_98_13&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">)
          | </span><a href="#loc_98_12_98_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_12_98_13&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_96_7_96_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_7_96_8&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="Data.Text.Internal.Encoding.Utf16.html#loc_43_1_43_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Encoding.Utf16.html#loc_43_1_43_10&#39;)"><span class="hl_varref"><span class="mpre">U16.validate2</span></span></a><span class="mpre"> </span><a href="#loc_104_13_104_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_13_104_15&#39;)"><span class="hl_varref"><span class="mpre">x1</span></span></a><span class="mpre"> </span><a href="#loc_105_13_105_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_13_105_15&#39;)"><span class="hl_varref"><span class="mpre">x2</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Yield</span></span><span class="mpre"> (</span><a href="Data.Text.Internal.Encoding.Utf16.html#loc_30_1_30_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Encoding.Utf16.html#loc_30_1_30_5&#39;)"><span class="hl_varref"><span class="mpre">U16.chr2</span></span></a><span class="mpre"> </span><a href="#loc_104_13_104_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_13_104_15&#39;)"><span class="hl_varref"><span class="mpre">x1</span></span></a><span class="mpre"> </span><a href="#loc_105_13_105_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_13_105_15&#39;)"><span class="hl_varref"><span class="mpre">x2</span></span></a><span class="mpre">) (</span><a href="#loc_98_12_98_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_12_98_13&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">)
          | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="#loc_203_1_203_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_1_203_12&#39;)"><span class="hl_varref"><span class="mpre">decodeError</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;streamUtf16LE&quot;</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;UTF-16LE&quot;</span></span><span class="mpre"> </span><a href="#loc_94_15_94_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_15_94_20&#39;)"><span class="hl_varref"><span class="mpre">onErr</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> (</span><a href="#loc_98_12_98_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_12_98_13&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
          where
            </span><a name="loc_104_13_104_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_104_13_104_15&#39;)"><span class="hl_vardecl"><span class="mpre">x1</span></span></a><span class="mpre">    = </span><a href="#loc_106_13_106_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_13_106_16&#39;)"><span class="hl_varref"><span class="mpre">idx</span></span></a><span class="mpre"> </span><a href="#loc_98_12_98_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_12_98_13&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">       </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> (</span><a href="#loc_106_13_106_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_13_106_16&#39;)"><span class="hl_varref"><span class="mpre">idx</span></span></a><span class="mpre"> (</span><a href="#loc_98_12_98_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_12_98_13&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="Data.Text.Internal.Unsafe.Shift.html#loc_34_5_34_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Unsafe.Shift.html#loc_34_5_34_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftL`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">)
            </span><a name="loc_105_13_105_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_105_13_105_15&#39;)"><span class="hl_vardecl"><span class="mpre">x2</span></span></a><span class="mpre">    = </span><a href="#loc_106_13_106_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_13_106_16&#39;)"><span class="hl_varref"><span class="mpre">idx</span></span></a><span class="mpre"> (</span><a href="#loc_98_12_98_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_12_98_13&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> (</span><a href="#loc_106_13_106_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_13_106_16&#39;)"><span class="hl_varref"><span class="mpre">idx</span></span></a><span class="mpre"> (</span><a href="#loc_98_12_98_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_98_12_98_13&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">) </span><a href="Data.Text.Internal.Unsafe.Shift.html#loc_34_5_34_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Unsafe.Shift.html#loc_34_5_34_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftL`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">)
            </span><a name="loc_106_13_106_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_106_13_106_16&#39;)"><span class="hl_vardecl"><span class="mpre">idx</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Data.ByteString.Unsafe.html#loc_135_1_135_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Unsafe.html#loc_135_1_135_12&#39;)"><span class="hl_varref"><span class="mpre">B.unsafeIndex</span></span></a><span class="mpre"> </span><a href="#loc_94_21_94_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_21_94_23&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word16</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE [0] </span><a href="#loc_94_1_94_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_94_1_94_14&#39;)"><span class="mpre">streamUtf16LE</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | /O(n)/ Convert a &#39;ByteString&#39; into a &#39;Stream Char&#39;, using big</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- endian UTF-16 encoding.</span></span><span class="mpre">
</span><a href="#loc_112_1_112_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_1_112_14&#39;)"><span class="mpre">streamUtf16BE</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">OnDecodeError</span></span><span class="mpre"> -&gt; </span><a href="Data.ByteString.Internal.html#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">ByteString</span></span></a><span class="mpre"> -&gt; </span><a href="Data.Text.Internal.Fusion.Types.html#loc_88_6_88_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_88_6_88_12&#39;)"><span class="hl_tyconref"><span class="mpre">Stream</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">
</span><a name="loc_112_1_112_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_1_112_14&#39;)"><span class="hl_fundecl"><span class="mpre">streamUtf16BE</span></span></a><span class="mpre"> </span><a name="loc_112_15_112_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_15_112_20&#39;)"><span class="hl_vardecl"><span class="mpre">onErr</span></span></a><span class="mpre"> </span><a name="loc_112_21_112_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_21_112_23&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Stream</span></span><span class="mpre"> </span><a href="#loc_116_7_116_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_7_116_11&#39;)"><span class="hl_varref"><span class="mpre">next</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> (</span><a href="Data.Text.Internal.Fusion.Size.html#loc_57_1_57_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Size.html#loc_57_1_57_8&#39;)"><span class="hl_varref"><span class="mpre">maxSize</span></span></a><span class="mpre"> (</span><a href="#loc_114_7_114_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_7_114_8&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><a href="Data.Text.Internal.Unsafe.Shift.html#loc_35_5_35_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Unsafe.Shift.html#loc_35_5_35_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftR`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">))
    where
      </span><a name="loc_114_7_114_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_7_114_8&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_112_21_112_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_21_112_23&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
      </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_116_7_116_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_7_116_11&#39;)"><span class="mpre">next</span></a><span class="mpre"> #-}</span></span><span class="mpre">
      </span><a name="loc_116_7_116_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_7_116_11&#39;)"><span class="hl_fundecl"><span class="mpre">next</span></span></a><span class="mpre"> </span><a name="loc_116_12_116_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_12_116_13&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre">
          | </span><a href="#loc_116_12_116_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_12_116_13&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><a href="#loc_114_7_114_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_7_114_8&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">                         = </span><span class="hl_conref"><span class="mpre">Done</span></span><span class="mpre">
          | </span><a href="#loc_116_12_116_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_12_116_13&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_114_7_114_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_7_114_8&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="Data.Text.Internal.Encoding.Utf16.html#loc_39_1_39_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Encoding.Utf16.html#loc_39_1_39_10&#39;)"><span class="hl_varref"><span class="mpre">U16.validate1</span></span></a><span class="mpre"> </span><a href="#loc_122_13_122_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_13_122_15&#39;)"><span class="hl_varref"><span class="mpre">x1</span></span></a><span class="mpre">    = </span><span class="hl_conref"><span class="mpre">Yield</span></span><span class="mpre"> (</span><a href="Data.Text.Internal.Unsafe.Char.html#loc_44_1_44_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Unsafe.Char.html#loc_44_1_44_10&#39;)"><span class="hl_varref"><span class="mpre">unsafeChr</span></span></a><span class="mpre"> </span><a href="#loc_122_13_122_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_13_122_15&#39;)"><span class="hl_varref"><span class="mpre">x1</span></span></a><span class="mpre">) (</span><a href="#loc_116_12_116_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_12_116_13&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">)
          | </span><a href="#loc_116_12_116_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_12_116_13&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_114_7_114_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_114_7_114_8&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="Data.Text.Internal.Encoding.Utf16.html#loc_43_1_43_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Encoding.Utf16.html#loc_43_1_43_10&#39;)"><span class="hl_varref"><span class="mpre">U16.validate2</span></span></a><span class="mpre"> </span><a href="#loc_122_13_122_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_13_122_15&#39;)"><span class="hl_varref"><span class="mpre">x1</span></span></a><span class="mpre"> </span><a href="#loc_123_13_123_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_13_123_15&#39;)"><span class="hl_varref"><span class="mpre">x2</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Yield</span></span><span class="mpre"> (</span><a href="Data.Text.Internal.Encoding.Utf16.html#loc_30_1_30_5" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Encoding.Utf16.html#loc_30_1_30_5&#39;)"><span class="hl_varref"><span class="mpre">U16.chr2</span></span></a><span class="mpre"> </span><a href="#loc_122_13_122_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_13_122_15&#39;)"><span class="hl_varref"><span class="mpre">x1</span></span></a><span class="mpre"> </span><a href="#loc_123_13_123_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_13_123_15&#39;)"><span class="hl_varref"><span class="mpre">x2</span></span></a><span class="mpre">) (</span><a href="#loc_116_12_116_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_12_116_13&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">)
          | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="#loc_203_1_203_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_1_203_12&#39;)"><span class="hl_varref"><span class="mpre">decodeError</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;streamUtf16BE&quot;</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;UTF-16BE&quot;</span></span><span class="mpre"> </span><a href="#loc_112_15_112_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_15_112_20&#39;)"><span class="hl_varref"><span class="mpre">onErr</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> (</span><a href="#loc_116_12_116_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_12_116_13&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
          where
            </span><a name="loc_122_13_122_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_122_13_122_15&#39;)"><span class="hl_vardecl"><span class="mpre">x1</span></span></a><span class="mpre">    = (</span><a href="#loc_124_13_124_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_13_124_16&#39;)"><span class="hl_varref"><span class="mpre">idx</span></span></a><span class="mpre"> </span><a href="#loc_116_12_116_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_12_116_13&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><a href="Data.Text.Internal.Unsafe.Shift.html#loc_34_5_34_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Unsafe.Shift.html#loc_34_5_34_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftL`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">)       </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_124_13_124_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_13_124_16&#39;)"><span class="hl_varref"><span class="mpre">idx</span></span></a><span class="mpre"> (</span><a href="#loc_116_12_116_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_12_116_13&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
            </span><a name="loc_123_13_123_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_123_13_123_15&#39;)"><span class="hl_vardecl"><span class="mpre">x2</span></span></a><span class="mpre">    = (</span><a href="#loc_124_13_124_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_13_124_16&#39;)"><span class="hl_varref"><span class="mpre">idx</span></span></a><span class="mpre"> (</span><a href="#loc_116_12_116_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_12_116_13&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">) </span><a href="Data.Text.Internal.Unsafe.Shift.html#loc_34_5_34_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Unsafe.Shift.html#loc_34_5_34_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftL`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_124_13_124_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_13_124_16&#39;)"><span class="hl_varref"><span class="mpre">idx</span></span></a><span class="mpre"> (</span><a href="#loc_116_12_116_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_116_12_116_13&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">)
            </span><a name="loc_124_13_124_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_124_13_124_16&#39;)"><span class="hl_vardecl"><span class="mpre">idx</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Data.ByteString.Unsafe.html#loc_135_1_135_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Unsafe.html#loc_135_1_135_12&#39;)"><span class="hl_varref"><span class="mpre">B.unsafeIndex</span></span></a><span class="mpre"> </span><a href="#loc_112_21_112_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_21_112_23&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word16</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE [0] </span><a href="#loc_112_1_112_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_112_1_112_14&#39;)"><span class="mpre">streamUtf16BE</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | /O(n)/ Convert a &#39;ByteString&#39; into a &#39;Stream Char&#39;, using big</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- endian UTF-32 encoding.</span></span><span class="mpre">
</span><a href="#loc_130_1_130_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_1_130_14&#39;)"><span class="mpre">streamUtf32BE</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">OnDecodeError</span></span><span class="mpre"> -&gt; </span><a href="Data.ByteString.Internal.html#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">ByteString</span></span></a><span class="mpre"> -&gt; </span><a href="Data.Text.Internal.Fusion.Types.html#loc_88_6_88_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_88_6_88_12&#39;)"><span class="hl_tyconref"><span class="mpre">Stream</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">
</span><a name="loc_130_1_130_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_1_130_14&#39;)"><span class="hl_fundecl"><span class="mpre">streamUtf32BE</span></span></a><span class="mpre"> </span><a name="loc_130_15_130_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_15_130_20&#39;)"><span class="hl_vardecl"><span class="mpre">onErr</span></span></a><span class="mpre"> </span><a name="loc_130_21_130_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_21_130_23&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Stream</span></span><span class="mpre"> </span><a href="#loc_134_7_134_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_7_134_11&#39;)"><span class="hl_varref"><span class="mpre">next</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> (</span><a href="Data.Text.Internal.Fusion.Size.html#loc_57_1_57_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Size.html#loc_57_1_57_8&#39;)"><span class="hl_varref"><span class="mpre">maxSize</span></span></a><span class="mpre"> (</span><a href="#loc_132_7_132_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_7_132_8&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><a href="Data.Text.Internal.Unsafe.Shift.html#loc_35_5_35_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Unsafe.Shift.html#loc_35_5_35_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftR`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">))
    where
      </span><a name="loc_132_7_132_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_7_132_8&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_130_21_130_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_21_130_23&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
      </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_134_7_134_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_7_134_11&#39;)"><span class="mpre">next</span></a><span class="mpre"> #-}</span></span><span class="mpre">
      </span><a name="loc_134_7_134_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_7_134_11&#39;)"><span class="hl_fundecl"><span class="mpre">next</span></span></a><span class="mpre"> </span><a name="loc_134_12_134_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_12_134_13&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre">
          | </span><a href="#loc_134_12_134_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_12_134_13&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><a href="#loc_132_7_132_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_7_132_8&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">                    = </span><span class="hl_conref"><span class="mpre">Done</span></span><span class="mpre">
          | </span><a href="#loc_134_12_134_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_12_134_13&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_132_7_132_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_132_7_132_8&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="Data.Text.Internal.Encoding.Utf32.html#loc_25_1_25_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Encoding.Utf32.html#loc_25_1_25_9&#39;)"><span class="hl_varref"><span class="mpre">U32.validate</span></span></a><span class="mpre"> </span><a href="#loc_139_13_139_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_13_139_14&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Yield</span></span><span class="mpre"> (</span><a href="Data.Text.Internal.Unsafe.Char.html#loc_52_1_52_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Unsafe.Char.html#loc_52_1_52_12&#39;)"><span class="hl_varref"><span class="mpre">unsafeChr32</span></span></a><span class="mpre"> </span><a href="#loc_139_13_139_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_13_139_14&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">) (</span><a href="#loc_134_12_134_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_12_134_13&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">)
          | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="#loc_203_1_203_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_1_203_12&#39;)"><span class="hl_varref"><span class="mpre">decodeError</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;streamUtf32BE&quot;</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;UTF-32BE&quot;</span></span><span class="mpre"> </span><a href="#loc_130_15_130_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_15_130_20&#39;)"><span class="hl_varref"><span class="mpre">onErr</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> (</span><a href="#loc_134_12_134_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_12_134_13&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
          where
            </span><a name="loc_139_13_139_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_139_13_139_14&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">     = </span><a href="Data.Text.Internal.Unsafe.Shift.html#loc_34_5_34_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Unsafe.Shift.html#loc_34_5_34_11&#39;)"><span class="hl_varref"><span class="mpre">shiftL</span></span></a><span class="mpre"> </span><a href="#loc_140_13_140_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_13_140_15&#39;)"><span class="hl_varref"><span class="mpre">x1</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">24</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="Data.Text.Internal.Unsafe.Shift.html#loc_34_5_34_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Unsafe.Shift.html#loc_34_5_34_11&#39;)"><span class="hl_varref"><span class="mpre">shiftL</span></span></a><span class="mpre"> </span><a href="#loc_141_13_141_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_13_141_15&#39;)"><span class="hl_varref"><span class="mpre">x2</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">16</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="Data.Text.Internal.Unsafe.Shift.html#loc_34_5_34_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Unsafe.Shift.html#loc_34_5_34_11&#39;)"><span class="hl_varref"><span class="mpre">shiftL</span></span></a><span class="mpre"> </span><a href="#loc_142_13_142_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_13_142_15&#39;)"><span class="hl_varref"><span class="mpre">x3</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_143_13_143_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_13_143_15&#39;)"><span class="hl_varref"><span class="mpre">x4</span></span></a><span class="mpre">
            </span><a name="loc_140_13_140_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_140_13_140_15&#39;)"><span class="hl_vardecl"><span class="mpre">x1</span></span></a><span class="mpre">    = </span><a href="#loc_144_13_144_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_13_144_16&#39;)"><span class="hl_varref"><span class="mpre">idx</span></span></a><span class="mpre"> </span><a href="#loc_134_12_134_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_12_134_13&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">
            </span><a name="loc_141_13_141_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_141_13_141_15&#39;)"><span class="hl_vardecl"><span class="mpre">x2</span></span></a><span class="mpre">    = </span><a href="#loc_144_13_144_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_13_144_16&#39;)"><span class="hl_varref"><span class="mpre">idx</span></span></a><span class="mpre"> (</span><a href="#loc_134_12_134_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_12_134_13&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
            </span><a name="loc_142_13_142_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_142_13_142_15&#39;)"><span class="hl_vardecl"><span class="mpre">x3</span></span></a><span class="mpre">    = </span><a href="#loc_144_13_144_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_13_144_16&#39;)"><span class="hl_varref"><span class="mpre">idx</span></span></a><span class="mpre"> (</span><a href="#loc_134_12_134_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_12_134_13&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">)
            </span><a name="loc_143_13_143_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_143_13_143_15&#39;)"><span class="hl_vardecl"><span class="mpre">x4</span></span></a><span class="mpre">    = </span><a href="#loc_144_13_144_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_13_144_16&#39;)"><span class="hl_varref"><span class="mpre">idx</span></span></a><span class="mpre"> (</span><a href="#loc_134_12_134_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_134_12_134_13&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">)
            </span><a name="loc_144_13_144_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_144_13_144_16&#39;)"><span class="hl_vardecl"><span class="mpre">idx</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Data.ByteString.Unsafe.html#loc_135_1_135_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Unsafe.html#loc_135_1_135_12&#39;)"><span class="hl_varref"><span class="mpre">B.unsafeIndex</span></span></a><span class="mpre"> </span><a href="#loc_130_21_130_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_21_130_23&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word32</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE [0] </span><a href="#loc_130_1_130_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_130_1_130_14&#39;)"><span class="mpre">streamUtf32BE</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | /O(n)/ Convert a &#39;ByteString&#39; into a &#39;Stream Char&#39;, using little</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- endian UTF-32 encoding.</span></span><span class="mpre">
</span><a href="#loc_150_1_150_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_1_150_14&#39;)"><span class="mpre">streamUtf32LE</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">OnDecodeError</span></span><span class="mpre"> -&gt; </span><a href="Data.ByteString.Internal.html#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">ByteString</span></span></a><span class="mpre"> -&gt; </span><a href="Data.Text.Internal.Fusion.Types.html#loc_88_6_88_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_88_6_88_12&#39;)"><span class="hl_tyconref"><span class="mpre">Stream</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">
</span><a name="loc_150_1_150_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_1_150_14&#39;)"><span class="hl_fundecl"><span class="mpre">streamUtf32LE</span></span></a><span class="mpre"> </span><a name="loc_150_15_150_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_15_150_20&#39;)"><span class="hl_vardecl"><span class="mpre">onErr</span></span></a><span class="mpre"> </span><a name="loc_150_21_150_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_21_150_23&#39;)"><span class="hl_vardecl"><span class="mpre">bs</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Stream</span></span><span class="mpre"> </span><a href="#loc_154_7_154_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_7_154_11&#39;)"><span class="hl_varref"><span class="mpre">next</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> (</span><a href="Data.Text.Internal.Fusion.Size.html#loc_57_1_57_8" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Size.html#loc_57_1_57_8&#39;)"><span class="hl_varref"><span class="mpre">maxSize</span></span></a><span class="mpre"> (</span><a href="#loc_152_7_152_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_7_152_8&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><a href="Data.Text.Internal.Unsafe.Shift.html#loc_35_5_35_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Unsafe.Shift.html#loc_35_5_35_11&#39;)"><span class="hl_infix"><span class="mpre">`shiftR`</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">))
    where
      </span><a name="loc_152_7_152_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_7_152_8&#39;)"><span class="hl_vardecl"><span class="mpre">l</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_150_21_150_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_21_150_23&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre">
      </span><span class="hl_pragma"><span class="mpre">{-# INLINE </span><a href="#loc_154_7_154_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_7_154_11&#39;)"><span class="mpre">next</span></a><span class="mpre"> #-}</span></span><span class="mpre">
      </span><a name="loc_154_7_154_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_7_154_11&#39;)"><span class="hl_fundecl"><span class="mpre">next</span></span></a><span class="mpre"> </span><a name="loc_154_12_154_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_12_154_13&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre">
          | </span><a href="#loc_154_12_154_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_12_154_13&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;=</span></span><span class="mpre"> </span><a href="#loc_152_7_152_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_7_152_8&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre">                    = </span><span class="hl_conref"><span class="mpre">Done</span></span><span class="mpre">
          | </span><a href="#loc_154_12_154_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_12_154_13&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;</span></span><span class="mpre"> </span><a href="#loc_152_7_152_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_152_7_152_8&#39;)"><span class="hl_varref"><span class="mpre">l</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="Data.Text.Internal.Encoding.Utf32.html#loc_25_1_25_9" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Encoding.Utf32.html#loc_25_1_25_9&#39;)"><span class="hl_varref"><span class="mpre">U32.validate</span></span></a><span class="mpre"> </span><a href="#loc_159_13_159_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_13_159_14&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> = </span><span class="hl_conref"><span class="mpre">Yield</span></span><span class="mpre"> (</span><a href="Data.Text.Internal.Unsafe.Char.html#loc_52_1_52_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Unsafe.Char.html#loc_52_1_52_12&#39;)"><span class="hl_varref"><span class="mpre">unsafeChr32</span></span></a><span class="mpre"> </span><a href="#loc_159_13_159_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_13_159_14&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">) (</span><a href="#loc_154_12_154_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_12_154_13&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre">)
          | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><a href="#loc_203_1_203_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_1_203_12&#39;)"><span class="hl_varref"><span class="mpre">decodeError</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;streamUtf32LE&quot;</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;UTF-32LE&quot;</span></span><span class="mpre"> </span><a href="#loc_150_15_150_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_15_150_20&#39;)"><span class="hl_varref"><span class="mpre">onErr</span></span></a><span class="mpre"> </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> (</span><a href="#loc_154_12_154_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_12_154_13&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">)
          where
            </span><a name="loc_159_13_159_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_159_13_159_14&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre">     = </span><a href="Data.Text.Internal.Unsafe.Shift.html#loc_34_5_34_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Unsafe.Shift.html#loc_34_5_34_11&#39;)"><span class="hl_varref"><span class="mpre">shiftL</span></span></a><span class="mpre"> </span><a href="#loc_163_13_163_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_13_163_15&#39;)"><span class="hl_varref"><span class="mpre">x4</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">24</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="Data.Text.Internal.Unsafe.Shift.html#loc_34_5_34_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Unsafe.Shift.html#loc_34_5_34_11&#39;)"><span class="hl_varref"><span class="mpre">shiftL</span></span></a><span class="mpre"> </span><a href="#loc_162_13_162_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_13_162_15&#39;)"><span class="hl_varref"><span class="mpre">x3</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">16</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="Data.Text.Internal.Unsafe.Shift.html#loc_34_5_34_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Unsafe.Shift.html#loc_34_5_34_11&#39;)"><span class="hl_varref"><span class="mpre">shiftL</span></span></a><span class="mpre"> </span><a href="#loc_161_13_161_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_13_161_15&#39;)"><span class="hl_varref"><span class="mpre">x2</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">8</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">+</span></span><span class="mpre"> </span><a href="#loc_160_13_160_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_13_160_15&#39;)"><span class="hl_varref"><span class="mpre">x1</span></span></a><span class="mpre">
            </span><a name="loc_160_13_160_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_160_13_160_15&#39;)"><span class="hl_vardecl"><span class="mpre">x1</span></span></a><span class="mpre">    = </span><a href="#loc_164_13_164_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_13_164_16&#39;)"><span class="hl_varref"><span class="mpre">idx</span></span></a><span class="mpre"> </span><a href="#loc_154_12_154_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_12_154_13&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">
            </span><a name="loc_161_13_161_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_161_13_161_15&#39;)"><span class="hl_vardecl"><span class="mpre">x2</span></span></a><span class="mpre">    = </span><a href="#loc_164_13_164_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_13_164_16&#39;)"><span class="hl_varref"><span class="mpre">idx</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_154_12_154_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_12_154_13&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
            </span><a name="loc_162_13_162_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_162_13_162_15&#39;)"><span class="hl_vardecl"><span class="mpre">x3</span></span></a><span class="mpre">    = </span><a href="#loc_164_13_164_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_13_164_16&#39;)"><span class="hl_varref"><span class="mpre">idx</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_154_12_154_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_12_154_13&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">2</span></span><span class="mpre">
            </span><a name="loc_163_13_163_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_163_13_163_15&#39;)"><span class="hl_vardecl"><span class="mpre">x4</span></span></a><span class="mpre">    = </span><a href="#loc_164_13_164_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_13_164_16&#39;)"><span class="hl_varref"><span class="mpre">idx</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_154_12_154_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_154_12_154_13&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">3</span></span><span class="mpre">
            </span><a name="loc_164_13_164_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_164_13_164_16&#39;)"><span class="hl_vardecl"><span class="mpre">idx</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Data.ByteString.Unsafe.html#loc_135_1_135_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Unsafe.html#loc_135_1_135_12&#39;)"><span class="hl_varref"><span class="mpre">B.unsafeIndex</span></span></a><span class="mpre"> </span><a href="#loc_150_21_150_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_21_150_23&#39;)"><span class="hl_varref"><span class="mpre">bs</span></span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Word32</span></span><span class="mpre">
</span><span class="hl_pragma"><span class="mpre">{-# INLINE [0] </span><a href="#loc_150_1_150_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_150_1_150_14&#39;)"><span class="mpre">streamUtf32LE</span></a><span class="mpre"> #-}</span></span><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | /O(n)/ Convert a &#39;Stream&#39; &#39;Word8&#39; to a &#39;ByteString&#39;.</span></span><span class="mpre">
</span><a href="#loc_169_1_169_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_1_169_9&#39;)"><span class="mpre">unstream</span></a><span class="mpre"> :: </span><a href="Data.Text.Internal.Fusion.Types.html#loc_88_6_88_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_88_6_88_12&#39;)"><span class="hl_tyconref"><span class="mpre">Stream</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><a href="Data.ByteString.Internal.html#loc_193_6_193_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_193_6_193_16&#39;)"><span class="hl_tyconref"><span class="mpre">ByteString</span></span></a><span class="mpre">
</span><a name="loc_169_1_169_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_1_169_9&#39;)"><span class="hl_fundecl"><span class="mpre">unstream</span></span></a><span class="mpre"> (</span><span class="hl_conref"><span class="mpre">Stream</span></span><span class="mpre"> </span><a name="loc_169_18_169_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_18_169_22&#39;)"><span class="hl_vardecl"><span class="mpre">next</span></span></a><span class="mpre"> </span><a name="loc_169_23_169_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_23_169_25&#39;)"><span class="hl_vardecl"><span class="mpre">s0</span></span></a><span class="mpre"> </span><a name="loc_169_26_169_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_26_169_29&#39;)"><span class="hl_vardecl"><span class="mpre">len</span></span></a><span class="mpre">) = </span><a href="GHC.IO.html#loc_182_1_182_23" onmouseover="nemnem.highlightLocalToRemote(&#39;GHC.IO.html#loc_182_1_182_23&#39;)"><span class="hl_varref"><span class="mpre">unsafeDupablePerformIO</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> do
    let </span><a name="loc_170_9_170_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_9_170_13&#39;)"><span class="hl_vardecl"><span class="mpre">mlen</span></span></a><span class="mpre"> = </span><a href="Data.Text.Internal.Fusion.Size.html#loc_138_1_138_11" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Size.html#loc_138_1_138_11&#39;)"><span class="hl_varref"><span class="mpre">upperBound</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">4</span></span><span class="mpre"> </span><a href="#loc_169_26_169_29" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_26_169_29&#39;)"><span class="hl_varref"><span class="mpre">len</span></span></a><span class="mpre">
    </span><a href="Data.ByteString.Internal.html#loc_489_1_489_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_489_1_489_17&#39;)"><span class="hl_varref"><span class="mpre">mallocByteString</span></span></a><span class="mpre"> </span><a href="#loc_170_9_170_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_9_170_13&#39;)"><span class="hl_varref"><span class="mpre">mlen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;&gt;=</span></span><span class="mpre"> </span><a href="#loc_173_7_173_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_7_173_11&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a href="#loc_170_9_170_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_170_9_170_13&#39;)"><span class="hl_varref"><span class="mpre">mlen</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a href="#loc_169_23_169_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_23_169_25&#39;)"><span class="hl_varref"><span class="mpre">s0</span></span></a><span class="mpre">
    where
      </span><a name="loc_173_7_173_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_7_173_11&#39;)"><span class="hl_fundecl"><span class="mpre">loop</span></span></a><span class="mpre"> !</span><a name="loc_173_13_173_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_13_173_14&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> !</span><a name="loc_173_16_173_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_16_173_19&#39;)"><span class="hl_vardecl"><span class="mpre">off</span></span></a><span class="mpre"> !</span><a name="loc_173_21_173_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_21_173_22&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> </span><a name="loc_173_23_173_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_23_173_25&#39;)"><span class="hl_vardecl"><span class="mpre">fp</span></span></a><span class="mpre"> = case </span><a href="#loc_169_18_169_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_169_18_169_22&#39;)"><span class="hl_varref"><span class="mpre">next</span></span></a><span class="mpre"> </span><a href="#loc_173_21_173_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_21_173_22&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> of
          </span><span class="hl_conref"><span class="mpre">Done</span></span><span class="mpre"> -&gt; </span><a href="#loc_188_7_188_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_7_188_13&#39;)"><span class="hl_varref"><span class="mpre">trimUp</span></span></a><span class="mpre"> </span><a href="#loc_173_23_173_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_23_173_25&#39;)"><span class="hl_varref"><span class="mpre">fp</span></span></a><span class="mpre"> </span><a href="#loc_173_13_173_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_13_173_14&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_173_16_173_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_16_173_19&#39;)"><span class="hl_varref"><span class="mpre">off</span></span></a><span class="mpre">
          </span><span class="hl_conref"><span class="mpre">Skip</span></span><span class="mpre"> </span><a name="loc_175_16_175_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_16_175_18&#39;)"><span class="hl_vardecl"><span class="mpre">s&#39;</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_173_7_173_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_7_173_11&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a href="#loc_173_13_173_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_13_173_14&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_173_16_173_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_16_173_19&#39;)"><span class="hl_varref"><span class="mpre">off</span></span></a><span class="mpre"> </span><a href="#loc_175_16_175_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_175_16_175_18&#39;)"><span class="hl_varref"><span class="mpre">s&#39;</span></span></a><span class="mpre"> </span><a href="#loc_173_23_173_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_23_173_25&#39;)"><span class="hl_varref"><span class="mpre">fp</span></span></a><span class="mpre">
          </span><span class="hl_conref"><span class="mpre">Yield</span></span><span class="mpre"> </span><a name="loc_176_17_176_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_17_176_18&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> </span><a name="loc_176_19_176_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_19_176_21&#39;)"><span class="hl_vardecl"><span class="mpre">s&#39;</span></span></a><span class="mpre">
              | </span><a href="#loc_173_16_173_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_16_173_19&#39;)"><span class="hl_varref"><span class="mpre">off</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><a href="#loc_173_13_173_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_13_173_14&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_182_7_182_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_7_182_14&#39;)"><span class="hl_varref"><span class="mpre">realloc</span></span></a><span class="mpre"> </span><a href="#loc_173_23_173_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_23_173_25&#39;)"><span class="hl_varref"><span class="mpre">fp</span></span></a><span class="mpre"> </span><a href="#loc_173_13_173_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_13_173_14&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_173_16_173_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_16_173_19&#39;)"><span class="hl_varref"><span class="mpre">off</span></span></a><span class="mpre"> </span><a href="#loc_176_19_176_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_19_176_21&#39;)"><span class="hl_varref"><span class="mpre">s&#39;</span></span></a><span class="mpre"> </span><a href="#loc_176_17_176_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_17_176_18&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
              | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> -&gt; do
            </span><a href="Foreign.ForeignPtr.Imp.html#loc_88_1_88_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Foreign.ForeignPtr.Imp.html#loc_88_1_88_15&#39;)"><span class="hl_varref"><span class="mpre">withForeignPtr</span></span></a><span class="mpre"> </span><a href="#loc_173_23_173_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_23_173_25&#39;)"><span class="hl_varref"><span class="mpre">fp</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_179_34_179_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_34_179_35&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">pokeByteOff</span></span><span class="mpre"> </span><a href="#loc_179_34_179_35" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_179_34_179_35&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_173_16_173_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_16_173_19&#39;)"><span class="hl_varref"><span class="mpre">off</span></span></a><span class="mpre"> </span><a href="#loc_176_17_176_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_17_176_18&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
            </span><a href="#loc_173_7_173_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_7_173_11&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a href="#loc_173_13_173_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_13_173_14&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> (</span><a href="#loc_173_16_173_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_16_173_19&#39;)"><span class="hl_varref"><span class="mpre">off</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_176_19_176_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_176_19_176_21&#39;)"><span class="hl_varref"><span class="mpre">s&#39;</span></span></a><span class="mpre"> </span><a href="#loc_173_23_173_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_23_173_25&#39;)"><span class="hl_varref"><span class="mpre">fp</span></span></a><span class="mpre">
      </span><span class="hl_pragma"><span class="mpre">{-# NOINLINE </span><a href="#loc_182_7_182_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_7_182_14&#39;)"><span class="mpre">realloc</span></a><span class="mpre"> #-}</span></span><span class="mpre">
      </span><a name="loc_182_7_182_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_7_182_14&#39;)"><span class="hl_fundecl"><span class="mpre">realloc</span></span></a><span class="mpre"> </span><a name="loc_182_15_182_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_15_182_17&#39;)"><span class="hl_vardecl"><span class="mpre">fp</span></span></a><span class="mpre"> </span><a name="loc_182_18_182_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_18_182_19&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre"> </span><a name="loc_182_20_182_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_20_182_23&#39;)"><span class="hl_vardecl"><span class="mpre">off</span></span></a><span class="mpre"> </span><a name="loc_182_24_182_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_24_182_25&#39;)"><span class="hl_vardecl"><span class="mpre">s</span></span></a><span class="mpre"> </span><a name="loc_182_26_182_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_26_182_27&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = do
        let </span><a name="loc_183_13_183_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_13_183_15&#39;)"><span class="hl_vardecl"><span class="mpre">n&#39;</span></span></a><span class="mpre"> = </span><a href="#loc_182_18_182_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_18_182_19&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><a href="#loc_182_18_182_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_18_182_19&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre">
        </span><a name="loc_184_9_184_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_184_9_184_12&#39;)"><span class="hl_vardecl"><span class="mpre">fp&#39;</span></span></a><span class="mpre"> &lt;- </span><a href="#loc_190_7_190_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_7_190_12&#39;)"><span class="hl_varref"><span class="mpre">copy0</span></span></a><span class="mpre"> </span><a href="#loc_182_15_182_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_15_182_17&#39;)"><span class="hl_varref"><span class="mpre">fp</span></span></a><span class="mpre"> </span><a href="#loc_182_18_182_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_18_182_19&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><a href="#loc_183_13_183_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_13_183_15&#39;)"><span class="hl_varref"><span class="mpre">n&#39;</span></span></a><span class="mpre">
        </span><a href="Foreign.ForeignPtr.Imp.html#loc_88_1_88_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Foreign.ForeignPtr.Imp.html#loc_88_1_88_15&#39;)"><span class="hl_varref"><span class="mpre">withForeignPtr</span></span></a><span class="mpre"> </span><a href="#loc_184_9_184_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_184_9_184_12&#39;)"><span class="hl_varref"><span class="mpre">fp&#39;</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_185_31_185_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_31_185_32&#39;)"><span class="hl_vardecl"><span class="mpre">p</span></span></a><span class="mpre"> -&gt; </span><span class="hl_varref"><span class="mpre">pokeByteOff</span></span><span class="mpre"> </span><a href="#loc_185_31_185_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_185_31_185_32&#39;)"><span class="hl_varref"><span class="mpre">p</span></span></a><span class="mpre"> </span><a href="#loc_182_20_182_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_20_182_23&#39;)"><span class="hl_varref"><span class="mpre">off</span></span></a><span class="mpre"> </span><a href="#loc_182_26_182_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_26_182_27&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
        </span><a href="#loc_173_7_173_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_173_7_173_11&#39;)"><span class="hl_varref"><span class="mpre">loop</span></span></a><span class="mpre"> </span><a href="#loc_183_13_183_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_183_13_183_15&#39;)"><span class="hl_varref"><span class="mpre">n&#39;</span></span></a><span class="mpre"> (</span><a href="#loc_182_20_182_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_20_182_23&#39;)"><span class="hl_varref"><span class="mpre">off</span></span></a><span class="hl_infix"><span class="mpre">+</span></span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">) </span><a href="#loc_182_24_182_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_182_24_182_25&#39;)"><span class="hl_varref"><span class="mpre">s</span></span></a><span class="mpre"> </span><a href="#loc_184_9_184_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_184_9_184_12&#39;)"><span class="hl_varref"><span class="mpre">fp&#39;</span></span></a><span class="mpre">
      </span><span class="hl_pragma"><span class="mpre">{-# NOINLINE </span><a href="#loc_188_7_188_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_7_188_13&#39;)"><span class="mpre">trimUp</span></a><span class="mpre"> #-}</span></span><span class="mpre">
      </span><a name="loc_188_7_188_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_7_188_13&#39;)"><span class="hl_fundecl"><span class="mpre">trimUp</span></span></a><span class="mpre"> </span><a name="loc_188_14_188_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_14_188_16&#39;)"><span class="hl_vardecl"><span class="mpre">fp</span></span></a><span class="mpre"> _ </span><a name="loc_188_19_188_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_19_188_22&#39;)"><span class="hl_vardecl"><span class="mpre">off</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$!</span></span><span class="mpre"> </span><a href="Data.ByteString.Internal.html#loc_193_19_193_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_193_19_193_21&#39;)"><span class="hl_conref"><span class="mpre">PS</span></span></a><span class="mpre"> </span><a href="#loc_188_14_188_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_14_188_16&#39;)"><span class="hl_varref"><span class="mpre">fp</span></span></a><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> </span><a href="#loc_188_19_188_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_188_19_188_22&#39;)"><span class="hl_varref"><span class="mpre">off</span></span></a><span class="mpre">
      </span><a href="#loc_190_7_190_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_7_190_12&#39;)"><span class="mpre">copy0</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">ForeignPtr</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> (</span><span class="hl_tyconref"><span class="mpre">ForeignPtr</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">)
      </span><a name="loc_190_7_190_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_7_190_12&#39;)"><span class="hl_fundecl"><span class="mpre">copy0</span></span></a><span class="mpre"> !</span><a name="loc_190_14_190_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_14_190_17&#39;)"><span class="hl_vardecl"><span class="mpre">src</span></span></a><span class="mpre"> !</span><a name="loc_190_19_190_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_19_190_25&#39;)"><span class="hl_vardecl"><span class="mpre">srcLen</span></span></a><span class="mpre"> !</span><a name="loc_190_27_190_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_27_190_34&#39;)"><span class="hl_vardecl"><span class="mpre">destLen</span></span></a><span class="mpre"> =
#if defined(ASSERTS)
        </span><span class="hl_varref"><span class="mpre">assert</span></span><span class="mpre"> (</span><a href="#loc_190_19_190_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_19_190_25&#39;)"><span class="hl_varref"><span class="mpre">srcLen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&lt;=</span></span><span class="mpre"> </span><a href="#loc_190_27_190_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_27_190_34&#39;)"><span class="hl_varref"><span class="mpre">destLen</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre">
#endif
        do
          </span><a name="loc_195_11_195_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_11_195_15&#39;)"><span class="hl_vardecl"><span class="mpre">dest</span></span></a><span class="mpre"> &lt;- </span><a href="Data.ByteString.Internal.html#loc_489_1_489_17" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_489_1_489_17&#39;)"><span class="hl_varref"><span class="mpre">mallocByteString</span></span></a><span class="mpre"> </span><a href="#loc_190_27_190_34" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_27_190_34&#39;)"><span class="hl_varref"><span class="mpre">destLen</span></span></a><span class="mpre">
          </span><a href="Foreign.ForeignPtr.Imp.html#loc_88_1_88_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Foreign.ForeignPtr.Imp.html#loc_88_1_88_15&#39;)"><span class="hl_varref"><span class="mpre">withForeignPtr</span></span></a><span class="mpre"> </span><a href="#loc_190_14_190_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_14_190_17&#39;)"><span class="hl_varref"><span class="mpre">src</span></span></a><span class="mpre">  </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_196_34_196_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_34_196_38&#39;)"><span class="hl_vardecl"><span class="mpre">src&#39;</span></span></a><span class="mpre">  -&gt;
              </span><a href="Foreign.ForeignPtr.Imp.html#loc_88_1_88_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Foreign.ForeignPtr.Imp.html#loc_88_1_88_15&#39;)"><span class="hl_varref"><span class="mpre">withForeignPtr</span></span></a><span class="mpre"> </span><a href="#loc_195_11_195_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_11_195_15&#39;)"><span class="hl_varref"><span class="mpre">dest</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> \</span><a name="loc_197_38_197_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_38_197_43&#39;)"><span class="hl_vardecl"><span class="mpre">dest&#39;</span></span></a><span class="mpre"> -&gt;
                  </span><a href="Data.ByteString.Internal.html#loc_624_1_624_7" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.ByteString.Internal.html#loc_624_1_624_7&#39;)"><span class="hl_varref"><span class="mpre">memcpy</span></span></a><span class="mpre"> </span><a href="#loc_197_38_197_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_197_38_197_43&#39;)"><span class="hl_varref"><span class="mpre">dest&#39;</span></span></a><span class="mpre"> </span><a href="#loc_196_34_196_38" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_196_34_196_38&#39;)"><span class="hl_varref"><span class="mpre">src&#39;</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><a href="#loc_190_19_190_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_190_19_190_25&#39;)"><span class="hl_varref"><span class="mpre">srcLen</span></span></a><span class="mpre">)
          </span><span class="hl_varref"><span class="mpre">return</span></span><span class="mpre"> </span><a href="#loc_195_11_195_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_195_11_195_15&#39;)"><span class="hl_varref"><span class="mpre">dest</span></span></a><span class="mpre">

</span><a href="#loc_203_1_203_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_1_203_12&#39;)"><span class="mpre">decodeError</span></a><span class="mpre"> :: forall </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre">. </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">OnDecodeError</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">Maybe</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Word8</span></span><span class="mpre">
            -&gt; </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> -&gt; </span><a href="Data.Text.Internal.Fusion.Types.html#loc_59_6_59_10" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Text.Internal.Fusion.Types.html#loc_59_6_59_10&#39;)"><span class="hl_tyconref"><span class="mpre">Step</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">s</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Char</span></span><span class="mpre">
</span><a name="loc_203_1_203_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_1_203_12&#39;)"><span class="hl_fundecl"><span class="mpre">decodeError</span></span></a><span class="mpre"> </span><a name="loc_203_13_203_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_13_203_17&#39;)"><span class="hl_vardecl"><span class="mpre">func</span></span></a><span class="mpre"> </span><a name="loc_203_18_203_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_18_203_22&#39;)"><span class="hl_vardecl"><span class="mpre">kind</span></span></a><span class="mpre"> </span><a name="loc_203_23_203_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_23_203_28&#39;)"><span class="hl_vardecl"><span class="mpre">onErr</span></span></a><span class="mpre"> </span><a name="loc_203_29_203_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_29_203_31&#39;)"><span class="hl_vardecl"><span class="mpre">mb</span></span></a><span class="mpre"> </span><a name="loc_203_32_203_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_32_203_33&#39;)"><span class="hl_vardecl"><span class="mpre">i</span></span></a><span class="mpre"> =
    case </span><a href="#loc_203_23_203_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_23_203_28&#39;)"><span class="hl_varref"><span class="mpre">onErr</span></span></a><span class="mpre"> </span><a href="#loc_207_11_207_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_207_11_207_15&#39;)"><span class="hl_varref"><span class="mpre">desc</span></span></a><span class="mpre"> </span><a href="#loc_203_29_203_31" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_29_203_31&#39;)"><span class="hl_varref"><span class="mpre">mb</span></span></a><span class="mpre"> of
      </span><span class="hl_conref"><span class="mpre">Nothing</span></span><span class="mpre"> -&gt; </span><span class="hl_conref"><span class="mpre">Skip</span></span><span class="mpre"> </span><a href="#loc_203_32_203_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_32_203_33&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">
      </span><span class="hl_conref"><span class="mpre">Just</span></span><span class="mpre"> </span><a name="loc_206_12_206_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_12_206_13&#39;)"><span class="hl_vardecl"><span class="mpre">c</span></span></a><span class="mpre">  -&gt; </span><span class="hl_conref"><span class="mpre">Yield</span></span><span class="mpre"> </span><a href="#loc_206_12_206_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_206_12_206_13&#39;)"><span class="hl_varref"><span class="mpre">c</span></span></a><span class="mpre"> </span><a href="#loc_203_32_203_33" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_32_203_33&#39;)"><span class="hl_varref"><span class="mpre">i</span></span></a><span class="mpre">
    where </span><a name="loc_207_11_207_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_207_11_207_15&#39;)"><span class="hl_vardecl"><span class="mpre">desc</span></span></a><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;Data.Text.Internal.Encoding.Fusion.&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_203_13_203_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_13_203_17&#39;)"><span class="hl_varref"><span class="mpre">func</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;: Invalid &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">
                 </span><a href="#loc_203_18_203_22" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_203_18_203_22&#39;)"><span class="hl_varref"><span class="mpre">kind</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot; stream&quot;</span></span><span class="mpre">
</span></div></body></html>