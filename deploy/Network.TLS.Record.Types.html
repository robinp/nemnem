<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE EmptyDataDecls #-}
</span><span class="hl_comment"><span class="mpre">-- |</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Module      : Network.TLS.Record.Types</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- License     : BSD-style</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Maintainer  : Vincent Hanquez &lt;vincent@snarc.org&gt;</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Stability   : experimental</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- Portability : unknown</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- The Record Protocol takes messages to be transmitted, fragments the</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- data into manageable blocks, optionally compresses the data, applies</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- a MAC, encrypts, and transmits the result.  Received data is</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- decrypted, verified, decompressed, reassembled, and then delivered to</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">-- higher-level clients.</span></span><span class="mpre">
</span><span class="hl_comment"><span class="mpre">--</span></span><span class="mpre">
module Network.TLS.Record.Types
    ( Header(..)
    , ProtocolType(..)
    , packetType
    </span><span class="hl_comment"><span class="mpre">-- * TLS Records</span></span><span class="mpre">
    , Record(..)
    </span><span class="hl_comment"><span class="mpre">-- * TLS Record fragment and constructors</span></span><span class="mpre">
    , Fragment
    , fragmentPlaintext
    , fragmentCiphertext
    , Plaintext
    , Compressed
    , Ciphertext
    </span><span class="hl_comment"><span class="mpre">-- * manipulate record</span></span><span class="mpre">
    , onRecordFragment
    , fragmentCompress
    , fragmentCipher
    , fragmentUncipher
    , fragmentUncompress
    </span><span class="hl_comment"><span class="mpre">-- * serialize record</span></span><span class="mpre">
    , rawToRecord
    , recordToRaw
    , recordToHeader
    ) where

import Network.TLS.Struct
import Network.TLS.Record.State
import qualified </span><span class="warning" data-warning="Module not foundModuleName (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Record/Types.hs&quot;, srcSpanStartLine = 42, srcSpanStartColumn = 18, srcSpanEndLine = 42, srcSpanEndColumn = 33}, srcInfoPoints = []}) &quot;Data.ByteString&quot;"><span class="mpre">Data.ByteString</span></span><span class="mpre"> as B
import Data.Byteable
import Control.Applicative (</span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="mpre">(&lt;$&gt;)</span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | Represent a TLS record.</span></span><span class="mpre">
data </span><a name="loc_47_6_47_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_6_47_12&#39;)"><span class="hl_tycondecl"><span class="mpre">Record</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> = </span><a name="loc_47_17_47_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_17_47_23&#39;)"><span class="hl_condecl"><span class="mpre">Record</span></span></a><span class="mpre"> !</span><a href="Network.TLS.Struct.html#loc_112_6_112_18" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_112_6_112_18&#39;)"><span class="hl_tyconref"><span class="mpre">ProtocolType</span></span></a><span class="mpre"> !</span><a href="Network.TLS.Types.html#loc_25_6_25_13" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Types.html#loc_25_6_25_13&#39;)"><span class="hl_tyconref"><span class="mpre">Version</span></span></a><span class="mpre"> !(</span><a href="#loc_49_9_49_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_9_49_17&#39;)"><span class="hl_tyconref"><span class="mpre">Fragment</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Record/Types.hs&quot;, srcSpanStartLine = 47, srcSpanStartColumn = 61, srcSpanEndLine = 47, srcSpanEndColumn = 79}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Record/Types.hs&quot;, srcSpanStartLine = 47, srcSpanStartColumn = 61, srcSpanEndLine = 47, srcSpanEndColumn = 69},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Record/Types.hs&quot;, srcSpanSt"><span class="mpre">deriving (Show,Eq)</span></span><span class="mpre">

newtype </span><a name="loc_49_9_49_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_9_49_17&#39;)"><span class="hl_tycondecl"><span class="mpre">Fragment</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> = </span><a name="loc_49_22_49_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_22_49_30&#39;)"><span class="hl_condecl"><span class="mpre">Fragment</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bytes</span></span><span class="mpre"> </span><span class="warning" data-warning="DataDecl DerivingsDeriving (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Record/Types.hs&quot;, srcSpanStartLine = 49, srcSpanStartColumn = 37, srcSpanEndLine = 49, srcSpanEndColumn = 55}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Record/Types.hs&quot;, srcSpanStartLine = 49, srcSpanStartColumn = 37, srcSpanEndLine = 49, srcSpanEndColumn = 45},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/tls-1.2.8/Network/TLS/Record/Types.hs&quot;, srcSpanSt"><span class="mpre">deriving (Show,Eq)</span></span><span class="mpre">

data </span><a name="loc_51_6_51_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_6_51_15&#39;)"><span class="hl_tycondecl"><span class="mpre">Plaintext</span></span></a><span class="mpre">
data </span><a name="loc_52_6_52_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_6_52_16&#39;)"><span class="hl_tycondecl"><span class="mpre">Compressed</span></span></a><span class="mpre">
data </span><a name="loc_53_6_53_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_6_53_16&#39;)"><span class="hl_tycondecl"><span class="mpre">Ciphertext</span></span></a><span class="mpre">

</span><a href="#loc_56_1_56_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_1_56_18&#39;)"><span class="mpre">fragmentPlaintext</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Bytes</span></span><span class="mpre"> -&gt; </span><a href="#loc_49_9_49_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_9_49_17&#39;)"><span class="hl_tyconref"><span class="mpre">Fragment</span></span></a><span class="mpre"> </span><a href="#loc_51_6_51_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_6_51_15&#39;)"><span class="hl_tyconref"><span class="mpre">Plaintext</span></span></a><span class="mpre">
</span><a name="loc_56_1_56_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_1_56_18&#39;)"><span class="hl_fundecl"><span class="mpre">fragmentPlaintext</span></span></a><span class="mpre"> </span><a name="loc_56_19_56_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_19_56_24&#39;)"><span class="hl_vardecl"><span class="mpre">bytes</span></span></a><span class="mpre"> = </span><a href="#loc_49_22_49_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_22_49_30&#39;)"><span class="hl_conref"><span class="mpre">Fragment</span></span></a><span class="mpre"> </span><a href="#loc_56_19_56_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_56_19_56_24&#39;)"><span class="hl_varref"><span class="mpre">bytes</span></span></a><span class="mpre">

</span><a href="#loc_59_1_59_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_1_59_19&#39;)"><span class="mpre">fragmentCiphertext</span></a><span class="mpre"> :: </span><span class="hl_tyconref"><span class="mpre">Bytes</span></span><span class="mpre"> -&gt; </span><a href="#loc_49_9_49_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_9_49_17&#39;)"><span class="hl_tyconref"><span class="mpre">Fragment</span></span></a><span class="mpre"> </span><a href="#loc_53_6_53_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_6_53_16&#39;)"><span class="hl_tyconref"><span class="mpre">Ciphertext</span></span></a><span class="mpre">
</span><a name="loc_59_1_59_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_1_59_19&#39;)"><span class="hl_fundecl"><span class="mpre">fragmentCiphertext</span></span></a><span class="mpre"> </span><a name="loc_59_20_59_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_20_59_25&#39;)"><span class="hl_vardecl"><span class="mpre">bytes</span></span></a><span class="mpre"> = </span><a href="#loc_49_22_49_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_22_49_30&#39;)"><span class="hl_conref"><span class="mpre">Fragment</span></span></a><span class="mpre"> </span><a href="#loc_59_20_59_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_59_20_59_25&#39;)"><span class="hl_varref"><span class="mpre">bytes</span></span></a><span class="mpre">

instance </span><a href="Data.Byteable.html#loc_22_7_22_15" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Byteable.html#loc_22_7_22_15&#39;)"><span class="hl_classref"><span class="mpre">Byteable</span></span></a><span class="mpre"> (</span><a href="#loc_49_9_49_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_9_49_17&#39;)"><span class="hl_tyconref"><span class="mpre">Fragment</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) where
    </span><a href="Data.Byteable.html#loc_24_5_24_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Byteable.html#loc_24_5_24_12&#39;)"><span class="hl_fundecl"><span class="mpre">toBytes</span></span></a><span class="mpre"> (</span><a href="#loc_49_22_49_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_22_49_30&#39;)"><span class="hl_conref"><span class="mpre">Fragment</span></span></a><span class="mpre"> </span><a name="loc_62_23_62_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_23_62_24&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">) = </span><a href="#loc_62_23_62_24" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_62_23_62_24&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">

</span><a href="#loc_65_1_65_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_1_65_17&#39;)"><span class="mpre">onRecordFragment</span></a><span class="mpre"> :: </span><a href="#loc_47_6_47_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_6_47_12&#39;)"><span class="hl_tyconref"><span class="mpre">Record</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; (</span><a href="#loc_49_9_49_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_9_49_17&#39;)"><span class="hl_tyconref"><span class="mpre">Fragment</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="Network.TLS.Record.State.html#loc_57_9_57_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Record.State.html#loc_57_9_57_16&#39;)"><span class="hl_tyconref"><span class="mpre">RecordM</span></span></a><span class="mpre"> (</span><a href="#loc_49_9_49_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_9_49_17&#39;)"><span class="hl_tyconref"><span class="mpre">Fragment</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">)) -&gt; </span><a href="Network.TLS.Record.State.html#loc_57_9_57_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Record.State.html#loc_57_9_57_16&#39;)"><span class="hl_tyconref"><span class="mpre">RecordM</span></span></a><span class="mpre"> (</span><a href="#loc_47_6_47_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_6_47_12&#39;)"><span class="hl_tyconref"><span class="mpre">Record</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">)
</span><a name="loc_65_1_65_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_1_65_17&#39;)"><span class="hl_fundecl"><span class="mpre">onRecordFragment</span></span></a><span class="mpre"> (</span><a href="#loc_47_17_47_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_17_47_23&#39;)"><span class="hl_conref"><span class="mpre">Record</span></span></a><span class="mpre"> </span><a name="loc_65_26_65_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_26_65_28&#39;)"><span class="hl_vardecl"><span class="mpre">pt</span></span></a><span class="mpre"> </span><a name="loc_65_29_65_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_29_65_32&#39;)"><span class="hl_vardecl"><span class="mpre">ver</span></span></a><span class="mpre"> </span><a name="loc_65_33_65_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_33_65_37&#39;)"><span class="hl_vardecl"><span class="mpre">frag</span></span></a><span class="mpre">) </span><a name="loc_65_39_65_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_39_65_40&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><a href="#loc_47_17_47_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_17_47_23&#39;)"><span class="hl_conref"><span class="mpre">Record</span></span></a><span class="mpre"> </span><a href="#loc_65_26_65_28" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_26_65_28&#39;)"><span class="hl_varref"><span class="mpre">pt</span></span></a><span class="mpre"> </span><a href="#loc_65_29_65_32" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_29_65_32&#39;)"><span class="hl_varref"><span class="mpre">ver</span></span></a><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="#loc_65_39_65_40" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_39_65_40&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_65_33_65_37" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_65_33_65_37&#39;)"><span class="hl_varref"><span class="mpre">frag</span></span></a><span class="mpre">

</span><a href="#loc_68_1_68_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_1_68_12&#39;)"><span class="mpre">fragmentMap</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">Bytes</span></span><span class="mpre"> -&gt; </span><a href="Network.TLS.Record.State.html#loc_57_9_57_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Record.State.html#loc_57_9_57_16&#39;)"><span class="hl_tyconref"><span class="mpre">RecordM</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bytes</span></span><span class="mpre">) -&gt; </span><a href="#loc_49_9_49_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_9_49_17&#39;)"><span class="hl_tyconref"><span class="mpre">Fragment</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="Network.TLS.Record.State.html#loc_57_9_57_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Record.State.html#loc_57_9_57_16&#39;)"><span class="hl_tyconref"><span class="mpre">RecordM</span></span></a><span class="mpre"> (</span><a href="#loc_49_9_49_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_9_49_17&#39;)"><span class="hl_tyconref"><span class="mpre">Fragment</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">b</span></span><span class="mpre">)
</span><a name="loc_68_1_68_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_1_68_12&#39;)"><span class="hl_fundecl"><span class="mpre">fragmentMap</span></span></a><span class="mpre"> </span><a name="loc_68_13_68_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_13_68_14&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> (</span><a href="#loc_49_22_49_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_22_49_30&#39;)"><span class="hl_conref"><span class="mpre">Fragment</span></span></a><span class="mpre"> </span><a name="loc_68_25_68_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_25_68_26&#39;)"><span class="hl_vardecl"><span class="mpre">b</span></span></a><span class="mpre">) = </span><a href="#loc_49_22_49_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_22_49_30&#39;)"><span class="hl_conref"><span class="mpre">Fragment</span></span></a><span class="mpre"> </span><a href="Data.Functor.html#loc_32_1_32_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.Functor.html#loc_32_1_32_6&#39;)"><span class="hl_infix"><span class="mpre">&lt;$&gt;</span></span></a><span class="mpre"> </span><a href="#loc_68_13_68_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_13_68_14&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre"> </span><a href="#loc_68_25_68_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_25_68_26&#39;)"><span class="hl_varref"><span class="mpre">b</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | turn a plaintext record into a compressed record using the compression function supplied</span></span><span class="mpre">
</span><a href="#loc_72_1_72_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_1_72_17&#39;)"><span class="mpre">fragmentCompress</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">Bytes</span></span><span class="mpre"> -&gt; </span><a href="Network.TLS.Record.State.html#loc_57_9_57_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Record.State.html#loc_57_9_57_16&#39;)"><span class="hl_tyconref"><span class="mpre">RecordM</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bytes</span></span><span class="mpre">) -&gt; </span><a href="#loc_49_9_49_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_9_49_17&#39;)"><span class="hl_tyconref"><span class="mpre">Fragment</span></span></a><span class="mpre"> </span><a href="#loc_51_6_51_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_6_51_15&#39;)"><span class="hl_tyconref"><span class="mpre">Plaintext</span></span></a><span class="mpre"> -&gt; </span><a href="Network.TLS.Record.State.html#loc_57_9_57_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Record.State.html#loc_57_9_57_16&#39;)"><span class="hl_tyconref"><span class="mpre">RecordM</span></span></a><span class="mpre"> (</span><a href="#loc_49_9_49_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_9_49_17&#39;)"><span class="hl_tyconref"><span class="mpre">Fragment</span></span></a><span class="mpre"> </span><a href="#loc_52_6_52_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_6_52_16&#39;)"><span class="hl_tyconref"><span class="mpre">Compressed</span></span></a><span class="mpre">)
</span><a name="loc_72_1_72_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_1_72_17&#39;)"><span class="hl_fundecl"><span class="mpre">fragmentCompress</span></span></a><span class="mpre"> </span><a name="loc_72_18_72_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_18_72_19&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><a href="#loc_68_1_68_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_1_68_12&#39;)"><span class="hl_varref"><span class="mpre">fragmentMap</span></span></a><span class="mpre"> </span><a href="#loc_72_18_72_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_72_18_72_19&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | turn a compressed record into a ciphertext record using the cipher function supplied</span></span><span class="mpre">
</span><a href="#loc_76_1_76_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_1_76_15&#39;)"><span class="mpre">fragmentCipher</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">Bytes</span></span><span class="mpre"> -&gt; </span><a href="Network.TLS.Record.State.html#loc_57_9_57_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Record.State.html#loc_57_9_57_16&#39;)"><span class="hl_tyconref"><span class="mpre">RecordM</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bytes</span></span><span class="mpre">) -&gt; </span><a href="#loc_49_9_49_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_9_49_17&#39;)"><span class="hl_tyconref"><span class="mpre">Fragment</span></span></a><span class="mpre"> </span><a href="#loc_52_6_52_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_6_52_16&#39;)"><span class="hl_tyconref"><span class="mpre">Compressed</span></span></a><span class="mpre"> -&gt; </span><a href="Network.TLS.Record.State.html#loc_57_9_57_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Record.State.html#loc_57_9_57_16&#39;)"><span class="hl_tyconref"><span class="mpre">RecordM</span></span></a><span class="mpre"> (</span><a href="#loc_49_9_49_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_9_49_17&#39;)"><span class="hl_tyconref"><span class="mpre">Fragment</span></span></a><span class="mpre"> </span><a href="#loc_53_6_53_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_6_53_16&#39;)"><span class="hl_tyconref"><span class="mpre">Ciphertext</span></span></a><span class="mpre">)
</span><a name="loc_76_1_76_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_1_76_15&#39;)"><span class="hl_fundecl"><span class="mpre">fragmentCipher</span></span></a><span class="mpre"> </span><a name="loc_76_16_76_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_16_76_17&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><a href="#loc_68_1_68_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_1_68_12&#39;)"><span class="hl_varref"><span class="mpre">fragmentMap</span></span></a><span class="mpre"> </span><a href="#loc_76_16_76_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_76_16_76_17&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | turn a ciphertext fragment into a compressed fragment using the cipher function supplied</span></span><span class="mpre">
</span><a href="#loc_80_1_80_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_1_80_17&#39;)"><span class="mpre">fragmentUncipher</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">Bytes</span></span><span class="mpre"> -&gt; </span><a href="Network.TLS.Record.State.html#loc_57_9_57_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Record.State.html#loc_57_9_57_16&#39;)"><span class="hl_tyconref"><span class="mpre">RecordM</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bytes</span></span><span class="mpre">) -&gt; </span><a href="#loc_49_9_49_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_9_49_17&#39;)"><span class="hl_tyconref"><span class="mpre">Fragment</span></span></a><span class="mpre"> </span><a href="#loc_53_6_53_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_53_6_53_16&#39;)"><span class="hl_tyconref"><span class="mpre">Ciphertext</span></span></a><span class="mpre"> -&gt; </span><a href="Network.TLS.Record.State.html#loc_57_9_57_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Record.State.html#loc_57_9_57_16&#39;)"><span class="hl_tyconref"><span class="mpre">RecordM</span></span></a><span class="mpre"> (</span><a href="#loc_49_9_49_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_9_49_17&#39;)"><span class="hl_tyconref"><span class="mpre">Fragment</span></span></a><span class="mpre"> </span><a href="#loc_52_6_52_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_6_52_16&#39;)"><span class="hl_tyconref"><span class="mpre">Compressed</span></span></a><span class="mpre">)
</span><a name="loc_80_1_80_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_1_80_17&#39;)"><span class="hl_fundecl"><span class="mpre">fragmentUncipher</span></span></a><span class="mpre"> </span><a name="loc_80_18_80_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_18_80_19&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><a href="#loc_68_1_68_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_1_68_12&#39;)"><span class="hl_varref"><span class="mpre">fragmentMap</span></span></a><span class="mpre"> </span><a href="#loc_80_18_80_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_80_18_80_19&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | turn a compressed fragment into a plaintext fragment using the decompression function supplied</span></span><span class="mpre">
</span><a href="#loc_84_1_84_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_1_84_19&#39;)"><span class="mpre">fragmentUncompress</span></a><span class="mpre"> :: (</span><span class="hl_tyconref"><span class="mpre">Bytes</span></span><span class="mpre"> -&gt; </span><a href="Network.TLS.Record.State.html#loc_57_9_57_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Record.State.html#loc_57_9_57_16&#39;)"><span class="hl_tyconref"><span class="mpre">RecordM</span></span></a><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">Bytes</span></span><span class="mpre">) -&gt; </span><a href="#loc_49_9_49_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_9_49_17&#39;)"><span class="hl_tyconref"><span class="mpre">Fragment</span></span></a><span class="mpre"> </span><a href="#loc_52_6_52_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_6_52_16&#39;)"><span class="hl_tyconref"><span class="mpre">Compressed</span></span></a><span class="mpre"> -&gt; </span><a href="Network.TLS.Record.State.html#loc_57_9_57_16" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Record.State.html#loc_57_9_57_16&#39;)"><span class="hl_tyconref"><span class="mpre">RecordM</span></span></a><span class="mpre"> (</span><a href="#loc_49_9_49_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_9_49_17&#39;)"><span class="hl_tyconref"><span class="mpre">Fragment</span></span></a><span class="mpre"> </span><a href="#loc_51_6_51_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_6_51_15&#39;)"><span class="hl_tyconref"><span class="mpre">Plaintext</span></span></a><span class="mpre">)
</span><a name="loc_84_1_84_19" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_1_84_19&#39;)"><span class="hl_fundecl"><span class="mpre">fragmentUncompress</span></span></a><span class="mpre"> </span><a name="loc_84_20_84_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_20_84_21&#39;)"><span class="hl_vardecl"><span class="mpre">f</span></span></a><span class="mpre"> = </span><a href="#loc_68_1_68_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_68_1_68_12&#39;)"><span class="hl_varref"><span class="mpre">fragmentMap</span></span></a><span class="mpre"> </span><a href="#loc_84_20_84_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_84_20_84_21&#39;)"><span class="hl_varref"><span class="mpre">f</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | turn a record into an header and bytes</span></span><span class="mpre">
</span><a href="#loc_88_1_88_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_1_88_12&#39;)"><span class="mpre">recordToRaw</span></a><span class="mpre"> :: </span><a href="#loc_47_6_47_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_6_47_12&#39;)"><span class="hl_tyconref"><span class="mpre">Record</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; (</span><a href="Network.TLS.Struct.html#loc_157_6_157_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_157_6_157_12&#39;)"><span class="hl_tyconref"><span class="mpre">Header</span></span></a><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Bytes</span></span><span class="mpre">)
</span><a name="loc_88_1_88_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_1_88_12&#39;)"><span class="hl_fundecl"><span class="mpre">recordToRaw</span></span></a><span class="mpre"> (</span><a href="#loc_47_17_47_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_17_47_23&#39;)"><span class="hl_conref"><span class="mpre">Record</span></span></a><span class="mpre"> </span><a name="loc_88_21_88_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_21_88_23&#39;)"><span class="hl_vardecl"><span class="mpre">pt</span></span></a><span class="mpre"> </span><a name="loc_88_24_88_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_24_88_27&#39;)"><span class="hl_vardecl"><span class="mpre">ver</span></span></a><span class="mpre"> (</span><a href="#loc_49_22_49_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_22_49_30&#39;)"><span class="hl_conref"><span class="mpre">Fragment</span></span></a><span class="mpre"> </span><a name="loc_88_38_88_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_38_88_43&#39;)"><span class="hl_vardecl"><span class="mpre">bytes</span></span></a><span class="mpre">)) = (</span><a href="Network.TLS.Struct.html#loc_157_15_157_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_157_15_157_21&#39;)"><span class="hl_conref"><span class="mpre">Header</span></span></a><span class="mpre"> </span><a href="#loc_88_21_88_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_21_88_23&#39;)"><span class="hl_varref"><span class="mpre">pt</span></span></a><span class="mpre"> </span><a href="#loc_88_24_88_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_24_88_27&#39;)"><span class="hl_varref"><span class="mpre">ver</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_88_38_88_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_38_88_43&#39;)"><span class="hl_varref"><span class="mpre">bytes</span></span></a><span class="mpre">), </span><a href="#loc_88_38_88_43" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_88_38_88_43&#39;)"><span class="hl_varref"><span class="mpre">bytes</span></span></a><span class="mpre">)

</span><span class="hl_comment"><span class="mpre">-- | turn a header and a fragment into a record</span></span><span class="mpre">
</span><a href="#loc_92_1_92_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_1_92_12&#39;)"><span class="mpre">rawToRecord</span></a><span class="mpre"> :: </span><a href="Network.TLS.Struct.html#loc_157_6_157_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_157_6_157_12&#39;)"><span class="hl_tyconref"><span class="mpre">Header</span></span></a><span class="mpre"> -&gt; </span><a href="#loc_49_9_49_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_9_49_17&#39;)"><span class="hl_tyconref"><span class="mpre">Fragment</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="#loc_47_6_47_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_6_47_12&#39;)"><span class="hl_tyconref"><span class="mpre">Record</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">
</span><a name="loc_92_1_92_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_1_92_12&#39;)"><span class="hl_fundecl"><span class="mpre">rawToRecord</span></span></a><span class="mpre"> (</span><a href="Network.TLS.Struct.html#loc_157_15_157_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_157_15_157_21&#39;)"><span class="hl_conref"><span class="mpre">Header</span></span></a><span class="mpre"> </span><a name="loc_92_21_92_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_21_92_23&#39;)"><span class="hl_vardecl"><span class="mpre">pt</span></span></a><span class="mpre"> </span><a name="loc_92_24_92_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_24_92_27&#39;)"><span class="hl_vardecl"><span class="mpre">ver</span></span></a><span class="mpre"> _) </span><a name="loc_92_31_92_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_31_92_39&#39;)"><span class="hl_vardecl"><span class="mpre">fragment</span></span></a><span class="mpre"> = </span><a href="#loc_47_17_47_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_17_47_23&#39;)"><span class="hl_conref"><span class="mpre">Record</span></span></a><span class="mpre"> </span><a href="#loc_92_21_92_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_21_92_23&#39;)"><span class="hl_varref"><span class="mpre">pt</span></span></a><span class="mpre"> </span><a href="#loc_92_24_92_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_24_92_27&#39;)"><span class="hl_varref"><span class="mpre">ver</span></span></a><span class="mpre"> </span><a href="#loc_92_31_92_39" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_92_31_92_39&#39;)"><span class="hl_varref"><span class="mpre">fragment</span></span></a><span class="mpre">

</span><span class="hl_comment"><span class="mpre">-- | turn a record into a header</span></span><span class="mpre">
</span><a href="#loc_96_1_96_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_1_96_15&#39;)"><span class="mpre">recordToHeader</span></a><span class="mpre"> :: </span><a href="#loc_47_6_47_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_6_47_12&#39;)"><span class="hl_tyconref"><span class="mpre">Record</span></span></a><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><a href="Network.TLS.Struct.html#loc_157_6_157_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_157_6_157_12&#39;)"><span class="hl_tyconref"><span class="mpre">Header</span></span></a><span class="mpre">
</span><a name="loc_96_1_96_15" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_1_96_15&#39;)"><span class="hl_fundecl"><span class="mpre">recordToHeader</span></span></a><span class="mpre"> (</span><a href="#loc_47_17_47_23" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_47_17_47_23&#39;)"><span class="hl_conref"><span class="mpre">Record</span></span></a><span class="mpre"> </span><a name="loc_96_24_96_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_24_96_26&#39;)"><span class="hl_vardecl"><span class="mpre">pt</span></span></a><span class="mpre"> </span><a name="loc_96_27_96_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_27_96_30&#39;)"><span class="hl_vardecl"><span class="mpre">ver</span></span></a><span class="mpre"> (</span><a href="#loc_49_22_49_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_49_22_49_30&#39;)"><span class="hl_conref"><span class="mpre">Fragment</span></span></a><span class="mpre"> </span><a name="loc_96_41_96_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_41_96_46&#39;)"><span class="hl_vardecl"><span class="mpre">bytes</span></span></a><span class="mpre">)) = </span><a href="Network.TLS.Struct.html#loc_157_15_157_21" onmouseover="nemnem.highlightLocalToRemote(&#39;Network.TLS.Struct.html#loc_157_15_157_21&#39;)"><span class="hl_conref"><span class="mpre">Header</span></span></a><span class="mpre"> </span><a href="#loc_96_24_96_26" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_24_96_26&#39;)"><span class="hl_varref"><span class="mpre">pt</span></span></a><span class="mpre"> </span><a href="#loc_96_27_96_30" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_27_96_30&#39;)"><span class="hl_varref"><span class="mpre">ver</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">fromIntegral</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">B.length</span></span><span class="mpre"> </span><a href="#loc_96_41_96_46" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_96_41_96_46&#39;)"><span class="hl_varref"><span class="mpre">bytes</span></span></a><span class="mpre">)
</span></div></body></html>