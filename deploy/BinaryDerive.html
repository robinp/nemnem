<html><head><title>NemNem</title><link rel="stylesheet" type="text/css" href="static/nemnem.css"><script src="static/jquery-2.0.3.min.js"></script><script src="static/nemnem.js"></script></head><body><div id="code"><span class="mpre">{-# LANGUAGE ScopedTypeVariables #-}

module BinaryDerive where

import Data.Generics
import Data.List

</span><a href="#loc_9_1_9_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_9_1_9_8&#39;)"><span class="mpre">deriveM</span></a><span class="mpre"> ::  </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/binary-0.7.1.0/tools/derive/BinaryDerive.hs&quot;, srcSpanStartLine = 8, srcSpanStartColumn = 13, srcSpanEndLine = 8, srcSpanEndColumn = 36}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/binary-0.7.1.0/tools/derive/BinaryDerive.hs&quot;, srcSpanStartLine = 8, srcSpanStartColumn = 13, srcSpanEndLine = 8, srcSpanEndColumn = 14},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/binary-0.7.1.0/tools/derive/BinaryDerive.h"><span class="mpre">(Typeable a, Data a) =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">IO</span></span><span class="mpre"> </span><span class="hl_tyconref"><span class="mpre">()</span></span><span class="mpre">
</span><a name="loc_9_1_9_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_9_1_9_8&#39;)"><span class="hl_fundecl"><span class="mpre">deriveM</span></span></a><span class="mpre"> (</span><span class="hl_vardecl"><span class="mpre">a</span></span><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">mapM_</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">putStrLn</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="Data.List.html#loc_1044_1_1044_6" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_1044_1_1044_6&#39;)"><span class="hl_varref"><span class="mpre">lines</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="#loc_12_1_12_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_12_1_12_7&#39;)"><span class="hl_varref"><span class="mpre">derive</span></span></a><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">undefined</span></span><span class="mpre"> :: </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre">)

</span><a href="#loc_12_1_12_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_12_1_12_7&#39;)"><span class="mpre">derive</span></a><span class="mpre"> :: </span><span class="warning" data-warning="ContextCxTuple (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/binary-0.7.1.0/tools/derive/BinaryDerive.hs&quot;, srcSpanStartLine = 11, srcSpanStartColumn = 11, srcSpanEndLine = 11, srcSpanEndColumn = 34}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/binary-0.7.1.0/tools/derive/BinaryDerive.hs&quot;, srcSpanStartLine = 11, srcSpanStartColumn = 11, srcSpanEndLine = 11, srcSpanEndColumn = 12},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/binary-0.7.1.0/tools/derive/BinaryDeri"><span class="mpre">(Typeable a, Data a) =&gt;</span></span><span class="mpre"> </span><span class="hl_tyvar"><span class="mpre">a</span></span><span class="mpre"> -&gt; </span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">
</span><a name="loc_12_1_12_7" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_12_1_12_7&#39;)"><span class="hl_fundecl"><span class="mpre">derive</span></span></a><span class="mpre"> </span><a name="loc_12_8_12_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_12_8_12_9&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = 
    </span><span class="hl_string"><span class="mpre">&quot;instance &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_16_5_16_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_16_5_16_12&#39;)"><span class="hl_varref"><span class="mpre">context</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;Binary &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_20_5_20_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_5_20_9&#39;)"><span class="hl_varref"><span class="mpre">inst</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot; where\n&quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">
    </span><span class="hl_varref"><span class="mpre">concat</span></span><span class="mpre"> </span><a href="#loc_32_5_32_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_5_32_12&#39;)"><span class="hl_varref"><span class="mpre">putDefs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_42_5_42_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_5_42_12&#39;)"><span class="hl_varref"><span class="mpre">getDefs</span></span></a><span class="mpre">
    where
    </span><a name="loc_16_5_16_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_16_5_16_12&#39;)"><span class="hl_vardecl"><span class="mpre">context</span></span></a><span class="mpre">
        | </span><a href="#loc_23_5_23_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_5_23_18&#39;)"><span class="hl_varref"><span class="mpre">nTypeChildren</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> =
            </span><a href="#loc_21_5_21_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_5_21_9&#39;)"><span class="hl_varref"><span class="mpre">wrap</span></span></a><span class="mpre"> (</span><a href="#loc_22_5_22_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_5_22_9&#39;)"><span class="hl_varref"><span class="mpre">join</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot;, &quot;</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;Binary &quot;</span></span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">) </span><a href="#loc_24_5_24_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_5_24_16&#39;)"><span class="hl_varref"><span class="mpre">typeLetters</span></span></a><span class="mpre">)) </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot; =&gt; &quot;</span></span><span class="mpre">
        | </span><span class="hl_varref"><span class="mpre">otherwise</span></span><span class="mpre"> = </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">
    </span><a name="loc_20_5_20_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_20_5_20_9&#39;)"><span class="hl_vardecl"><span class="mpre">inst</span></span></a><span class="mpre"> = </span><a href="#loc_21_5_21_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_5_21_9&#39;)"><span class="hl_varref"><span class="mpre">wrap</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">tyConString</span></span><span class="mpre"> </span><a href="#loc_26_6_26_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_6_26_14&#39;)"><span class="hl_varref"><span class="mpre">typeName</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">concatMap</span></span><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot; &quot;</span></span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">) </span><a href="#loc_24_5_24_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_5_24_16&#39;)"><span class="hl_varref"><span class="mpre">typeLetters</span></span></a><span class="mpre">
    </span><a name="loc_21_5_21_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_5_21_9&#39;)"><span class="hl_fundecl"><span class="mpre">wrap</span></span></a><span class="mpre"> </span><a name="loc_21_10_21_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_10_21_11&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> = if </span><a href="#loc_23_5_23_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_5_23_18&#39;)"><span class="hl_varref"><span class="mpre">nTypeChildren</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> then </span><span class="hl_string"><span class="mpre">&quot;(&quot;</span></span><span class="hl_infix"><span class="mpre">++</span></span><a href="#loc_21_10_21_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_10_21_11&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">++</span></span><span class="hl_string"><span class="mpre">&quot;)&quot;</span></span><span class="mpre"> else </span><a href="#loc_21_10_21_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_21_10_21_11&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre"> 
    </span><a name="loc_22_5_22_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_5_22_9&#39;)"><span class="hl_fundecl"><span class="mpre">join</span></span></a><span class="mpre"> </span><a name="loc_22_10_22_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_10_22_13&#39;)"><span class="hl_vardecl"><span class="mpre">sep</span></span></a><span class="mpre"> </span><a name="loc_22_14_22_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_14_22_17&#39;)"><span class="hl_vardecl"><span class="mpre">lst</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">concat</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><a href="Data.List.html#loc_427_1_427_12" onmouseover="nemnem.highlightLocalToRemote(&#39;Data.List.html#loc_427_1_427_12&#39;)"><span class="hl_varref"><span class="mpre">intersperse</span></span></a><span class="mpre"> </span><a href="#loc_22_10_22_13" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_10_22_13&#39;)"><span class="hl_varref"><span class="mpre">sep</span></span></a><span class="mpre"> </span><a href="#loc_22_14_22_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_14_22_17&#39;)"><span class="hl_varref"><span class="mpre">lst</span></span></a><span class="mpre">
    </span><a name="loc_23_5_23_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_5_23_18&#39;)"><span class="hl_vardecl"><span class="mpre">nTypeChildren</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_26_15_26_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_15_26_27&#39;)"><span class="hl_varref"><span class="mpre">typeChildren</span></span></a><span class="mpre">
    </span><a name="loc_24_5_24_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_24_5_24_16&#39;)"><span class="hl_vardecl"><span class="mpre">typeLetters</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">take</span></span><span class="mpre"> </span><a href="#loc_23_5_23_18" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_23_5_23_18&#39;)"><span class="hl_varref"><span class="mpre">nTypeChildren</span></span></a><span class="mpre"> </span><a href="#loc_25_5_25_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_5_25_16&#39;)"><span class="hl_varref"><span class="mpre">manyLetters</span></span></a><span class="mpre">
    </span><a name="loc_25_5_25_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_5_25_16&#39;)"><span class="hl_vardecl"><span class="mpre">manyLetters</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">[]) </span><span class="warning" data-warning="ExpEnumFromTo (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/binary-0.7.1.0/tools/derive/BinaryDerive.hs&quot;, srcSpanStartLine = 25, srcSpanStartColumn = 29, srcSpanEndLine = 25, srcSpanEndColumn = 39}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/binary-0.7.1.0/tools/derive/BinaryDerive.hs&quot;, srcSpanStartLine = 25, srcSpanStartColumn = 29, srcSpanEndLine = 25, srcSpanEndColumn = 30},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/binary-0.7.1.0/tools/derive/BinaryD"><span class="mpre">[&#39;a&#39;..&#39;z&#39;]</span></span><span class="mpre">
    (</span><a name="loc_26_6_26_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_6_26_14&#39;)"><span class="hl_vardecl"><span class="mpre">typeName</span></span></a><span class="mpre">,</span><a name="loc_26_15_26_27" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_26_15_26_27&#39;)"><span class="hl_vardecl"><span class="mpre">typeChildren</span></span></a><span class="mpre">) = </span><span class="hl_varref"><span class="mpre">splitTyConApp</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">typeOf</span></span><span class="mpre"> </span><a href="#loc_12_8_12_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_12_8_12_9&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)
    </span><a href="#loc_28_5_28_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_5_28_12&#39;)"><span class="mpre">constrs</span></a><span class="mpre"> :: [(</span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">, (</span><span class="hl_tyconref"><span class="mpre">String</span></span><span class="mpre">, </span><span class="hl_tyconref"><span class="mpre">Int</span></span><span class="mpre">))]
    </span><a name="loc_28_5_28_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_5_28_12&#39;)"><span class="hl_vardecl"><span class="mpre">constrs</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">zip</span></span><span class="mpre"> </span><span class="warning" data-warning="ExpEnumFrom (SrcSpanInfo {srcInfoSpan = SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/binary-0.7.1.0/tools/derive/BinaryDerive.hs&quot;, srcSpanStartLine = 28, srcSpanStartColumn = 19, srcSpanEndLine = 28, srcSpanEndColumn = 24}, srcInfoPoints = [SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/binary-0.7.1.0/tools/derive/BinaryDerive.hs&quot;, srcSpanStartLine = 28, srcSpanStartColumn = 19, srcSpanEndLine = 28, srcSpanEndColumn = 20},SrcSpan {srcSpanFilename = &quot;/home/vagrant/nemnem/pull/binary-0.7.1.0/tools/derive/BinaryDer"><span class="mpre">[0..]</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="#loc_29_5_29_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_5_29_8&#39;)"><span class="hl_varref"><span class="mpre">gen</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">dataTypeConstrs</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">dataTypeOf</span></span><span class="mpre"> </span><a href="#loc_12_8_12_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_12_8_12_9&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">)
    </span><a name="loc_29_5_29_8" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_5_29_8&#39;)"><span class="hl_fundecl"><span class="mpre">gen</span></span></a><span class="mpre"> </span><a name="loc_29_9_29_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_9_29_12&#39;)"><span class="hl_vardecl"><span class="mpre">con</span></span></a><span class="mpre"> = ( </span><span class="hl_varref"><span class="mpre">showConstr</span></span><span class="mpre"> </span><a href="#loc_29_9_29_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_9_29_12&#39;)"><span class="hl_varref"><span class="mpre">con</span></span></a><span class="mpre">
              , </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">gmapQ</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">undefined</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">$</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">fromConstr</span></span><span class="mpre"> </span><a href="#loc_29_9_29_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_29_9_29_12&#39;)"><span class="hl_varref"><span class="mpre">con</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">`asTypeOf`</span></span><span class="mpre"> </span><a href="#loc_12_8_12_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_12_8_12_9&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="mpre">
              )
    </span><a name="loc_32_5_32_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_32_5_32_12&#39;)"><span class="hl_vardecl"><span class="mpre">putDefs</span></span></a><span class="mpre"> = </span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> ((</span><span class="hl_infix"><span class="mpre">++</span></span><span class="hl_string"><span class="mpre">&quot;\n&quot;</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> </span><a href="#loc_33_5_33_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_5_33_11&#39;)"><span class="hl_varref"><span class="mpre">putDef</span></span></a><span class="mpre">) </span><a href="#loc_28_5_28_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_5_28_12&#39;)"><span class="hl_varref"><span class="mpre">constrs</span></span></a><span class="mpre">
    </span><a name="loc_33_5_33_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_5_33_11&#39;)"><span class="hl_fundecl"><span class="mpre">putDef</span></span></a><span class="mpre"> (</span><a name="loc_33_13_33_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_13_33_14&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre">, (</span><a name="loc_33_17_33_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_17_33_21&#39;)"><span class="hl_vardecl"><span class="mpre">name</span></span></a><span class="mpre">, </span><a name="loc_33_23_33_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_23_33_25&#39;)"><span class="hl_vardecl"><span class="mpre">ps</span></span></a><span class="mpre">)) =
        let </span><a name="loc_34_13_34_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_13_34_17&#39;)"><span class="hl_vardecl"><span class="mpre">wrap</span></span></a><span class="mpre"> = if </span><a href="#loc_33_23_33_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_23_33_25&#39;)"><span class="hl_varref"><span class="mpre">ps</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> then (</span><span class="hl_string"><span class="mpre">&quot;(&quot;</span></span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">++</span></span><span class="hl_string"><span class="mpre">&quot;)&quot;</span></span><span class="mpre">) else </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">
            </span><a name="loc_35_13_35_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_13_35_20&#39;)"><span class="hl_vardecl"><span class="mpre">pattern</span></span></a><span class="mpre"> = </span><a href="#loc_33_17_33_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_17_33_21&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">concatMap</span></span><span class="mpre"> (</span><span class="hl_char"><span class="mpre">&#39; &#39;</span></span><span class="hl_infix"><span class="mpre">:</span></span><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">take</span></span><span class="mpre"> </span><a href="#loc_33_23_33_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_23_33_25&#39;)"><span class="hl_varref"><span class="mpre">ps</span></span></a><span class="mpre"> </span><a href="#loc_25_5_25_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_5_25_16&#39;)"><span class="hl_varref"><span class="mpre">manyLetters</span></span></a><span class="mpre">)
        in
        </span><span class="hl_string"><span class="mpre">&quot;  put &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_34_13_34_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_34_13_34_17&#39;)"><span class="hl_varref"><span class="mpre">wrap</span></span></a><span class="mpre"> </span><a href="#loc_35_13_35_20" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_35_13_35_20&#39;)"><span class="hl_varref"><span class="mpre">pattern</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="hl_string"><span class="mpre">&quot; = &quot;</span></span><span class="mpre">
        </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">concat</span></span><span class="mpre"> [ </span><span class="hl_string"><span class="mpre">&quot;putWord8 &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_33_13_33_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_13_33_14&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> | </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_28_5_28_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_5_28_12&#39;)"><span class="hl_varref"><span class="mpre">constrs</span></span></a><span class="mpre">  </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> ]
        </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">concat</span></span><span class="mpre"> [ </span><span class="hl_string"><span class="mpre">&quot; &gt;&gt; &quot;</span></span><span class="mpre">                | </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_28_5_28_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_5_28_12&#39;)"><span class="hl_varref"><span class="mpre">constrs</span></span></a><span class="mpre">  </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_33_23_33_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_23_33_25&#39;)"><span class="hl_varref"><span class="mpre">ps</span></span></a><span class="mpre">  </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> ]
        </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">concat</span></span><span class="mpre"> [ </span><span class="hl_string"><span class="mpre">&quot;return ()&quot;</span></span><span class="mpre">           | </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_28_5_28_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_5_28_12&#39;)"><span class="hl_varref"><span class="mpre">constrs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&amp;&amp;</span></span><span class="mpre"> </span><a href="#loc_33_23_33_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_23_33_25&#39;)"><span class="hl_varref"><span class="mpre">ps</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">==</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> ]
        </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_22_5_22_9" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_22_5_22_9&#39;)"><span class="hl_varref"><span class="mpre">join</span></span></a><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot; &gt;&gt; &quot;</span></span><span class="mpre"> (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot;put &quot;</span></span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">take</span></span><span class="mpre"> </span><a href="#loc_33_23_33_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_33_23_33_25&#39;)"><span class="hl_varref"><span class="mpre">ps</span></span></a><span class="mpre"> </span><a href="#loc_25_5_25_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_5_25_16&#39;)"><span class="hl_varref"><span class="mpre">manyLetters</span></span></a><span class="mpre">))
    </span><a name="loc_42_5_42_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_42_5_42_12&#39;)"><span class="hl_vardecl"><span class="mpre">getDefs</span></span></a><span class="mpre"> =
       (if </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_28_5_28_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_5_28_12&#39;)"><span class="hl_varref"><span class="mpre">constrs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
            then </span><span class="hl_string"><span class="mpre">&quot;  get = do\n    tag_ &lt;- getWord8\n    case tag_ of\n&quot;</span></span><span class="mpre">
            else </span><span class="hl_string"><span class="mpre">&quot;  get =&quot;</span></span><span class="mpre">)
        </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">concatMap</span></span><span class="mpre"> ((</span><span class="hl_infix"><span class="mpre">++</span></span><span class="hl_string"><span class="mpre">&quot;\n&quot;</span></span><span class="mpre">)) (</span><span class="hl_varref"><span class="mpre">map</span></span><span class="mpre"> </span><a href="#loc_51_5_51_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_5_51_11&#39;)"><span class="hl_varref"><span class="mpre">getDef</span></span></a><span class="mpre"> </span><a href="#loc_28_5_28_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_5_28_12&#39;)"><span class="hl_varref"><span class="mpre">constrs</span></span></a><span class="mpre">) </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">
       (if </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_28_5_28_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_5_28_12&#39;)"><span class="hl_varref"><span class="mpre">constrs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre">
            then </span><span class="hl_string"><span class="mpre">&quot;      _ -&gt; fail \&quot;no decoding\&quot;&quot;</span></span><span class="mpre">
            else </span><span class="hl_string"><span class="mpre">&quot;&quot;</span></span><span class="mpre">
       )
    </span><a name="loc_51_5_51_11" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_5_51_11&#39;)"><span class="hl_fundecl"><span class="mpre">getDef</span></span></a><span class="mpre"> (</span><a name="loc_51_13_51_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_13_51_14&#39;)"><span class="hl_vardecl"><span class="mpre">n</span></span></a><span class="mpre">, (</span><a name="loc_51_17_51_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_17_51_21&#39;)"><span class="hl_vardecl"><span class="mpre">name</span></span></a><span class="mpre">, </span><a name="loc_51_23_51_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_23_51_25&#39;)"><span class="hl_vardecl"><span class="mpre">ps</span></span></a><span class="mpre">)) =
        let </span><a name="loc_52_13_52_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_13_52_17&#39;)"><span class="hl_vardecl"><span class="mpre">wrap</span></span></a><span class="mpre"> = if </span><a href="#loc_51_23_51_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_23_51_25&#39;)"><span class="hl_varref"><span class="mpre">ps</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">/=</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">0</span></span><span class="mpre"> then (</span><span class="hl_string"><span class="mpre">&quot;(&quot;</span></span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">) </span><span class="hl_infix"><span class="mpre">.</span></span><span class="mpre"> (</span><span class="hl_infix"><span class="mpre">++</span></span><span class="hl_string"><span class="mpre">&quot;)&quot;</span></span><span class="mpre">) else </span><span class="hl_varref"><span class="mpre">id</span></span><span class="mpre">
        in
        </span><span class="hl_varref"><span class="mpre">concat</span></span><span class="mpre"> [ </span><span class="hl_string"><span class="mpre">&quot;      &quot;</span></span><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">show</span></span><span class="mpre"> </span><a href="#loc_51_13_51_14" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_13_51_14&#39;)"><span class="hl_varref"><span class="mpre">n</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot; -&gt;&quot;</span></span><span class="mpre"> | </span><span class="hl_varref"><span class="mpre">length</span></span><span class="mpre"> </span><a href="#loc_28_5_28_12" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_28_5_28_12&#39;)"><span class="hl_varref"><span class="mpre">constrs</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">&gt;</span></span><span class="mpre"> </span><span class="hl_num"><span class="mpre">1</span></span><span class="mpre"> ]
        </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">concatMap</span></span><span class="mpre"> (\</span><a name="loc_55_24_55_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_24_55_25&#39;)"><span class="hl_vardecl"><span class="mpre">x</span></span></a><span class="mpre"> -&gt; </span><span class="hl_string"><span class="mpre">&quot; get &gt;&gt;= \\&quot;</span></span><span class="hl_infix"><span class="mpre">++</span></span><a href="#loc_55_24_55_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_55_24_55_25&#39;)"><span class="hl_varref"><span class="mpre">x</span></span></a><span class="hl_infix"><span class="mpre">++</span></span><span class="hl_string"><span class="mpre">&quot; -&gt;&quot;</span></span><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">take</span></span><span class="mpre"> </span><a href="#loc_51_23_51_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_23_51_25&#39;)"><span class="hl_varref"><span class="mpre">ps</span></span></a><span class="mpre"> </span><a href="#loc_25_5_25_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_5_25_16&#39;)"><span class="hl_varref"><span class="mpre">manyLetters</span></span></a><span class="mpre">)
        </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_string"><span class="mpre">&quot; return &quot;</span></span><span class="mpre">
        </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><a href="#loc_52_13_52_17" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_52_13_52_17&#39;)"><span class="hl_varref"><span class="mpre">wrap</span></span></a><span class="mpre"> (</span><a href="#loc_51_17_51_21" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_17_51_21&#39;)"><span class="hl_varref"><span class="mpre">name</span></span></a><span class="mpre"> </span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre"> </span><span class="hl_varref"><span class="mpre">concatMap</span></span><span class="mpre"> (</span><span class="hl_string"><span class="mpre">&quot; &quot;</span></span><span class="hl_infix"><span class="mpre">++</span></span><span class="mpre">) (</span><span class="hl_varref"><span class="mpre">take</span></span><span class="mpre"> </span><a href="#loc_51_23_51_25" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_51_23_51_25&#39;)"><span class="hl_varref"><span class="mpre">ps</span></span></a><span class="mpre"> </span><a href="#loc_25_5_25_16" onmouseover="nemnem.highlightLocalToLocal(&#39;loc_25_5_25_16&#39;)"><span class="hl_varref"><span class="mpre">manyLetters</span></span></a><span class="mpre">))
</span></div></body></html>